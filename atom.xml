<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zen&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://archks.github.io/"/>
  <updated>2020-07-15T08:42:27.901Z</updated>
  <id>https://archks.github.io/</id>
  
  <author>
    <name>ZEN</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Typora+Gitee图床</title>
    <link href="https://archks.github.io/2020/07/15/Typora-Gitee%E5%9B%BE%E5%BA%8A/"/>
    <id>https://archks.github.io/2020/07/15/Typora-Gitee%E5%9B%BE%E5%BA%8A/</id>
    <published>2020-07-15T08:26:33.000Z</published>
    <updated>2020-07-15T08:42:27.901Z</updated>
    
    <content type="html"><![CDATA[<p>一直以来被如何保存MarkDown图片所困扰，放在本地则不太方便迁移，而且如果Markdown+Hexo，也不太适合放在本地。但上传到网络又太过繁琐，今天找到一种一键上传，自动生成MarkDown的方式，十分方便。</p><p><strong>效果展示：</strong></p><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/archks/img/raw/master/2020-img/image-20200715164051196.png" alt="image-20200715164051196"></p><p>然后就会自动生成这样一个MarkDown链接，再也不用担心图片迁移了。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">![image-20200715164051196](https://gitee.com/archks/img/raw/master/2020-img/image-20200715164051196.png)</span><br></pre></td></tr></table></figure><p><strong>PicGo下载</strong><br>Mac : <a href="https://github.com/Molunerfinn/PicGo/releases/download/v2.3.0-beta.3/PicGo-2.3.0-beta.3.dmg" target="_blank" rel="noopener">https://github.com/Molunerfinn/PicGo/releases/download/v2.3.0-beta.3/PicGo-2.3.0-beta.3.dmg</a></p><p>Win: <a href="https://github.com/Molunerfinn/PicGo/releases/download/v2.3.0-beta.3/PicGo-Setup-2.3.0-beta.3.exe" target="_blank" rel="noopener">https://github.com/Molunerfinn/PicGo/releases/download/v2.3.0-beta.3/PicGo-Setup-2.3.0-beta.3.exe</a></p><p>PicGo 安装在C盘可能会导致Typora调用它的权限不够，建议安装在其他盘。</p><p><strong>Typora</strong><br><a href="https://typora.io/windows/typora-setup-x64.exe" target="_blank" rel="noopener">https://typora.io/windows/typora-setup-x64.exe</a></p><p><strong>Gitee</strong><br><a href="https://gitee.com/" target="_blank" rel="noopener">https://gitee.com/</a></p><p><strong>Typora中一键上传图片到Gitee并生成MarkDown链接</strong></p><blockquote><p><a href="https://lovelijunyi.gitee.io/posts/90b0.html" target="_blank" rel="noopener">https://lovelijunyi.gitee.io/posts/90b0.html</a></p></blockquote><p><strong>Gitee Token如何获得？</strong></p><p><a href="https://gitee.com/profile/personal_access_tokens/new" target="_blank" rel="noopener">https://gitee.com/profile/personal_access_tokens/new</a></p><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://gitee.com/archks/img/raw/master/2020-img/image-20200715163437807.png" alt="权限配置"></p><p><strong>配置过程中遇到的问题</strong></p><blockquote><p><a href="https://www.jianshu.com/p/3f1aa341dcbc" target="_blank" rel="noopener">https://www.jianshu.com/p/3f1aa341dcbc</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;一直以来被如何保存MarkDown图片所困扰，放在本地则不太方便迁移，而且如果Markdown+Hexo，也不太适合放在本地。但上传到网络又太过繁琐，今天找到一种一键上传，自动生成MarkDown的方式，十分方便。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;效果展示：&lt;/strong&gt;
      
    
    </summary>
    
    
    
      <category term="图床" scheme="https://archks.github.io/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>SHELL</title>
    <link href="https://archks.github.io/2020/07/15/SHELL/"/>
    <id>https://archks.github.io/2020/07/15/SHELL/</id>
    <published>2020-07-15T03:11:57.000Z</published>
    <updated>2020-07-15T03:28:21.515Z</updated>
    
    <content type="html"><![CDATA[<p><strong>持续更新</strong></p><br><h3 id="log、ip、location"><a href="#log、ip、location" class="headerlink" title="log、ip、location"></a>log、ip、location</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install jq</span><br><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> `awk --re-interval <span class="string">'&#123;match($0,/([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;/,a); print a[0]&#125;'</span>  /var/<span class="built_in">log</span>/v2ray/access.log | sort  | uniq`;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">curl -s https://ipvigilante.com/<span class="variable">$&#123;ip&#125;</span> | jq -r <span class="string">'.data.ipv4,.data.country_name, .data.subdivision_1_name, .data.city_name'</span> | xargs </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><ul><li>jq：处理json文件，-r 原生输出</li><li>awk正则匹配</li><li>xargs让结果在一行输出</li><li>map ip location <a href="https://ipvigilante.com/8.8.8.8" target="_blank" rel="noopener">https://ipvigilante.com/8.8.8.8</a></li></ul><h3 id="speed-test"><a href="#speed-test" class="headerlink" title="speed test"></a>speed test</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -qO- git.io/superbench.sh | bash</span><br></pre></td></tr></table></figure><h3 id="ban-security"><a href="#ban-security" class="headerlink" title="ban security"></a>ban security</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">setenforce 0</span><br><span class="line">sed -i <span class="string">'s\SELINUX=enforcing\SELINUX=disabled\'</span> /etc/selinux/config</span><br></pre></td></tr></table></figure><h3 id="bkgfwall-old-amp-new"><a href="#bkgfwall-old-amp-new" class="headerlink" title="bkgfwall old &amp; new"></a>bkgfwall old &amp; new</h3><p><em>old</em></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tcp</span></span><br><span class="line">wget  https://raw.githubusercontent.com/chiakge/Linux-NetSpeed/master/tcp.sh &amp;&amp; bash tcp.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">wget https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh &amp;&amp; bash ssr.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># accelerate</span></span><br><span class="line">wget --no-check-certificate -O kcptun_for_ss_ssr.sh https://git.io/fN2EO </span><br><span class="line"></span><br><span class="line"><span class="comment"># linux 4.4 </span></span><br><span class="line">alternatives --<span class="built_in">set</span> python /usr/bin/python3</span><br><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh &amp;&amp; chmod +x ssr.sh &amp;&amp; bash ssr.sh</span><br><span class="line">sysctl -w net.ipv4.tcp_congestion_control=bbr</span><br><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure><p><em>new</em></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># strict time requirement</span></span><br><span class="line">yum -y update</span><br><span class="line">timedatectl <span class="built_in">set</span>-local-rtc 1</span><br><span class="line">timedatectl <span class="built_in">set</span>-timezone Asia/Shanghai</span><br><span class="line">rm -rf /etc/localtime</span><br><span class="line">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"></span><br><span class="line">bash &lt;(curl -L -s https://install.direct/go.sh)</span><br><span class="line">vim /etc/v2ray/config.json</span><br><span class="line"></span><br><span class="line">systemctl start v2ray</span><br><span class="line">yum install -y socat wget </span><br><span class="line">curl  https://get.acme.sh | sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yum -y install wget</span><br><span class="line">wget <span class="string">"https://github.com/chiakge/Linux-NetSpeed/raw/master/tcp.sh"</span> &amp;&amp; chmod +x tcp.sh &amp;&amp; ./tcp.sh </span><br><span class="line"><span class="built_in">source</span> ~/.bashrc </span><br><span class="line">sudo ~/.acme.sh/acme.sh --issue -d 域名 --standalone -k ec-256 </span><br><span class="line">sudo ~/.acme.sh/acme.sh --issue -d 域名 --alpn -k ec-256</span><br><span class="line"></span><br><span class="line">sudo ~/.acme.sh/acme.sh --installcert -d 域名 --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc  </span><br><span class="line"></span><br><span class="line">cat &gt; /etc/v2ray/config.json &lt;&lt; EOF</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"inbounds"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"port"</span>: 443, * </span><br><span class="line">      <span class="string">"protocol"</span>: <span class="string">"vmess"</span>,    </span><br><span class="line">      <span class="string">"settings"</span>: &#123;</span><br><span class="line">        <span class="string">"clients"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">"id"</span>: <span class="string">""</span>,  *</span><br><span class="line">            <span class="string">"alterId"</span>: 64   * </span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">"streamSettings"</span>: &#123;</span><br><span class="line">        <span class="string">"network"</span>: <span class="string">"tcp"</span>,</span><br><span class="line">        <span class="string">"security"</span>: <span class="string">"tls"</span>, </span><br><span class="line">        <span class="string">"tlsSettings"</span>: &#123;</span><br><span class="line">          <span class="string">"certificates"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">"certificateFile"</span>: <span class="string">"/etc/v2ray/v2ray.crt"</span>, *</span><br><span class="line">              <span class="string">"keyFile"</span>: <span class="string">"/etc/v2ray/v2ray.key"</span>  *</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"outbounds"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"protocol"</span>: <span class="string">"freedom"</span>,</span><br><span class="line">      <span class="string">"settings"</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">systemctl restart v2ray</span><br></pre></td></tr></table></figure><h3 id="charset-browser"><a href="#charset-browser" class="headerlink" title="charset browser"></a>charset browser</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install lynx w3m links</span><br></pre></td></tr></table></figure><h3 id="history-command"><a href="#history-command" class="headerlink" title="history command"></a>history command</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Ctrl + i</span></span><br><span class="line">(reverse-i-search)`docker<span class="string">': systemctl enable docker</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># list</span></span><br><span class="line"><span class="string">$ history | grep field</span></span><br></pre></td></tr></table></figure><h3 id="software-amp-epel"><a href="#software-amp-epel" class="headerlink" title="software &amp; epel"></a>software &amp; epel</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install mlocate vim zip unzip tree bash-completion htop lrzsz mycli</span><br><span class="line"></span><br><span class="line">yum -y install wget</span><br><span class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;持续更新&lt;/strong&gt;&lt;/p&gt;
&lt;br&gt;

&lt;h3 id=&quot;log、ip、location&quot;&gt;&lt;a href=&quot;#log、ip、location&quot; class=&quot;headerlink&quot; title=&quot;log、ip、location&quot;&gt;&lt;/a&gt;log、ip
      
    
    </summary>
    
    
      <category term="运维" scheme="https://archks.github.io/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
  </entry>
  
  <entry>
    <title>Kubeadm安装K8S</title>
    <link href="https://archks.github.io/2020/07/14/Kubeadm%E5%AE%89%E8%A3%85K8S/"/>
    <id>https://archks.github.io/2020/07/14/Kubeadm%E5%AE%89%E8%A3%85K8S/</id>
    <published>2020-07-14T03:59:01.000Z</published>
    <updated>2020-07-14T04:21:25.898Z</updated>
    
    <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>安装k8s本身并不复杂，网上太多失败的例子主要是因为以下几点：</p><ol><li>不能上外网</li><li>刚开始的系统配置漏了一两步</li></ol><br><p>先给出我当前的配置环境：</p><blockquote><p>CentOS=7.7<br>Linux=4.4<br>VmWare=14<br>Kubernetes=v1.18.0</p></blockquote><p>kubeadm、kubectl、kubelet功能：</p><ul><li>kubeadm 初始化工具</li><li>kubectl 命令行管理工具</li><li>kubelet 和CRI进行交互，创建Pod</li></ul><br><p>两台机器，一台Master，一台Node</p><table><thead><tr><th>机器</th><th>IP</th></tr></thead><tbody><tr><td>k8s-master</td><td>192.168.224.129</td></tr><tr><td>k8s-node1</td><td>192.168.224.130</td></tr></tbody></table><p>初步环境准备（如果不说明，Master和Slaver都需要做）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导入本地windows代理</span></span><br><span class="line"><span class="built_in">export</span> ALL_PROXY=socks5://192.168.224.1:10808</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭交换分区 </span></span><br><span class="line">swapoff -a </span><br><span class="line">sed -i <span class="string">'s/.*swap/#&amp;/'</span> /etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭防火墙和Selinux</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld </span><br><span class="line">setenforce 0</span><br><span class="line">sed -i <span class="string">'s\SELINUX=enforcing\SELINUX=disabled\'</span> /etc/selinux/config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置DNS</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"192.168.224.129 k8s-master"</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"192.168.224.130 k8s-node1"</span> &gt;&gt; /etc/hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置密钥对【只需要master做】</span></span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">ssh-copy-id k8s-node1</span><br></pre></td></tr></table></figure><br><p>更新内核：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rpm -Uvh https://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm</span><br><span class="line">yum list available --disablerepo=<span class="string">'*'</span> --enablerepo=elrepo-kernel</span><br><span class="line">yum -y --enablerepo=elrepo-kernel install kernel-lt.x86_64</span><br><span class="line">sed -i <span class="string">'s/GRUB_DEFAULT=.*$/GRUB_DEFAULT=0/'</span> /etc/default/grub    </span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg  </span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>进一步环境配置</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 安装依赖包</span></span><br><span class="line">yum install -y epel-release</span><br><span class="line">yum install -y chrony conntrack ipvsadm ipset jq iptables curl sysstat libseccomp wget socat git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 内核优化</span></span><br><span class="line">cat &gt; kubernetes.conf &lt;&lt;EOF</span><br><span class="line">net.bridge.bridge-nf-call-iptables=1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables=1</span><br><span class="line">net.ipv4.ip_forward=1</span><br><span class="line">net.ipv4.tcp_tw_recycle=0</span><br><span class="line">net.ipv4.neigh.default.gc_thresh1=1024</span><br><span class="line">net.ipv4.neigh.default.gc_thresh1=2048</span><br><span class="line">net.ipv4.neigh.default.gc_thresh1=4096</span><br><span class="line">vm.swappiness=0</span><br><span class="line">vm.overcommit_memory=1</span><br><span class="line">vm.panic_on_oom=0</span><br><span class="line">fs.inotify.max_user_instances=8192</span><br><span class="line">fs.inotify.max_user_watches=1048576</span><br><span class="line">fs.file-max=52706963</span><br><span class="line">fs.nr_open=52706963</span><br><span class="line">net.ipv6.conf.all.disable_ipv6=1</span><br><span class="line">EOF</span><br><span class="line">cp kubernetes.conf /etc/sysctl.d/kubernetes.conf</span><br><span class="line">sysctl -p /etc/sysctl.d/kubernetes.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 时区设置</span></span><br><span class="line">timedatectl <span class="built_in">set</span>-timezone Asia/Shanghai</span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd</span><br><span class="line">systemctl start chronyd</span><br><span class="line">timedatectl status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭无关服务</span></span><br><span class="line">systemctl stop postfix &amp;&amp; systemctl <span class="built_in">disable</span> postfix</span><br></pre></td></tr></table></figure><br><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>安装并配置Docker</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># docker安装配置</span></span><br><span class="line">yum update -y &amp;&amp; yum -y install yum-utils device-mapper-persistent-data lvm2 </span><br><span class="line">yum-config-manager --<span class="built_in">enable</span> docker-ce-nightly</span><br><span class="line">yum-config-manager --<span class="built_in">enable</span> docker-ce-test</span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">yum -y install docker-ce docker-ce-cli containerd.io</span><br><span class="line">systemctl <span class="built_in">enable</span> docker &amp;&amp; systemctl start docker</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/docker/daemon.json &lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"exec-opts"</span>: [<span class="string">"native.cgroupdriver=systemd"</span>],</span><br><span class="line">  <span class="string">"log-driver"</span>: <span class="string">"json-file"</span>,</span><br><span class="line">  <span class="string">"log-opts"</span>: &#123;</span><br><span class="line">    <span class="string">"max-size"</span>: <span class="string">"100m"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"storage-driver"</span>: <span class="string">"overlay2"</span>,</span><br><span class="line">  <span class="string">"storage-opts"</span>: [</span><br><span class="line">    <span class="string">"overlay2.override_kernel_check=true"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">systemctl daemon-reload &amp;&amp; systemctl restart docker</span><br></pre></td></tr></table></figure><br><p>安装kubelet kubeadm kubectl</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 配置Google源</span></span><br><span class="line">cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt;EOF </span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">repo_gpgcheck=1</span><br><span class="line">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装kubelet kubeadm kubectl</span></span><br><span class="line">yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes</span><br><span class="line">systemctl start kubelet &amp;&amp; systemctl <span class="built_in">enable</span> kubelet</span><br></pre></td></tr></table></figure><br><blockquote><p> 一下只需要在Master上部署</p></blockquote><br><p>初始化Master节点，有两种方法：</p><p>1、用配置文件初始化</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导出默认配置文件</span></span><br><span class="line">kubeadm config <span class="built_in">print</span> init-defaults &gt; kubeadm-config.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改默认配置文件</span></span><br><span class="line">vim kubeadm-config.yaml</span><br><span class="line"></span><br><span class="line">localAPIEndpoint:</span><br><span class="line">  advertiseAddress: 192.168.224.129</span><br><span class="line">networking:</span><br><span class="line">  dnsDomain: cluster.local</span><br><span class="line">  podSubnet: 10.244.0.0/16</span><br><span class="line">  serviceSubnet: 10.96.0.0/12</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主要修改advertiseAddress和添加podSubnet，podSubnet需要和以上一致</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行初始化</span></span><br><span class="line">kubeadm init --config=kubeadm-config.yaml --upload-certs | tee kubeadm-init.log </span><br><span class="line"></span><br><span class="line"><span class="comment"># ps：初始化过程中回去国外源拉取大量镜像，可以使用kubeadm config images pull查看镜像拉取过程</span></span><br><span class="line"></span><br><span class="line">mkdir -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装Pod网络插件CNI，不安装网络插件Node就会始终处于NotReady状态</span></span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br></pre></td></tr></table></figure><p>将节点加入到K8S</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 这条命令是初始化完成之后自动生成的，只需要复制到Node执行即可</span></span><br><span class="line">kubeadm join 192.168.224.129:6443 --token u4or3g.hhljh4eybldeh1bv \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:e363af78bb503cbc0c20113f296a7f2d4f5340ae8d7a9e9de2eb0bf5ecda1a45</span><br></pre></td></tr></table></figure><p>在Master查看Node状态信息</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s-master ~]<span class="comment"># kubectl get node</span></span><br><span class="line">NAME         STATUS   ROLES    AGE   VERSION</span><br><span class="line">k8s-master   Ready    master   59m   v1.18.5</span><br><span class="line">k8s-node1    Ready    &lt;none&gt;   59m   v1.18.5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看详细状态</span></span><br><span class="line">kubectl get nodes -o wide </span><br><span class="line"></span><br><span class="line"><span class="comment"># 持续刷新</span></span><br><span class="line">kubectl get nodes -o wide -w</span><br></pre></td></tr></table></figure><br><p>部署Dashboard</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取Token</span></span><br><span class="line">kubectl describe secrets -n kube-system $(kubectl -n kube-system get secret|grep deployment-controller-token-w7zc5 | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除DashBoard</span></span><br><span class="line">kubectl delete -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0/aio/deploy/recommended.yaml</span><br></pre></td></tr></table></figure><br><p>安装CentOS7的图形界面，是为了再localhost中访问dashboard</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y groups install <span class="string">"GNOME Desktop"</span> --skip-broken</span><br><span class="line">yum -y install xrdp</span><br><span class="line">yum -y install tigervnc-server.x86_64</span><br><span class="line">systemctl restart xrdp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows下键盘敲Win+R 输入mstcs，输入Master的IP地址，连接，输入账号密码，登录</span></span><br><span class="line"><span class="comment"># 打开Firefox，访问dashboard的地址</span></span><br></pre></td></tr></table></figure><p>开启kube-proxy，访问地址：</p><blockquote><p><a href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/overview?namespace=default" target="_blank" rel="noopener">http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/overview?namespace=default</a></p></blockquote><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s-master ~]<span class="comment"># kubectl proxy</span></span><br><span class="line">Starting to serve on 127.0.0.1:8001</span><br></pre></td></tr></table></figure><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/14/UNr7DS.png" alt="DashBorad"></p><h1 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h1><p>Kubernetes初始化</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s-master ~]<span class="comment"># cat kubeadm-init.log </span></span><br><span class="line">[init] Using Kubernetes version: v1.18.0  <span class="comment"># 版本信息</span></span><br><span class="line">[preflight] Running pre-flight checks</span><br><span class="line">[preflight] Pulling images required <span class="keyword">for</span> setting up a Kubernetes cluster <span class="comment"># 拉取镜像</span></span><br><span class="line">[preflight] This might take a minute or two, depending on the speed of your internet connection</span><br><span class="line">[preflight] You can also perform this action <span class="keyword">in</span> beforehand using <span class="string">'kubeadm config images pull'</span>  <span class="comment"># 查看镜像</span></span><br><span class="line">[kubelet-start] Writing kubelet environment file with flags to file <span class="string">"/var/lib/kubelet/kubeadm-flags.env"</span> <span class="comment"># 写入环境文件位置</span></span><br><span class="line">[kubelet-start] Writing kubelet configuration to file <span class="string">"/var/lib/kubelet/config.yaml"</span> <span class="comment"># kubelet配置文件位置</span></span><br><span class="line">[kubelet-start] Starting the kubelet</span><br><span class="line">[certs] Using certificateDir folder <span class="string">"/etc/kubernetes/pki"</span></span><br><span class="line">[certs] Generating <span class="string">"ca"</span> certificate and key <span class="comment"># 生成ca证书</span></span><br><span class="line">[certs] Generating <span class="string">"apiserver"</span> certificate and key <span class="comment"># 生成apiserver证书</span></span><br><span class="line">[certs] apiserver serving cert is signed <span class="keyword">for</span> DNS names [k8s-master kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 192.168.224.129]</span><br><span class="line">[certs] Generating <span class="string">"apiserver-kubelet-client"</span> certificate and key <span class="comment"># 以下都是各类证书，Kubernetes各组件通过HTTPS证书认证进行通信</span></span><br><span class="line">[certs] Generating <span class="string">"front-proxy-ca"</span> certificate and key</span><br><span class="line">[certs] Generating <span class="string">"front-proxy-client"</span> certificate and key</span><br><span class="line">[certs] Generating <span class="string">"etcd/ca"</span> certificate and key</span><br><span class="line">[certs] Generating <span class="string">"etcd/server"</span> certificate and key</span><br><span class="line">[certs] etcd/server serving cert is signed <span class="keyword">for</span> DNS names [k8s-master localhost] and IPs [192.168.224.129 127.0.0.1 ::1]</span><br><span class="line">[certs] Generating <span class="string">"etcd/peer"</span> certificate and key</span><br><span class="line">[certs] etcd/peer serving cert is signed <span class="keyword">for</span> DNS names [k8s-master localhost] and IPs [192.168.224.129 127.0.0.1 ::1]</span><br><span class="line">[certs] Generating <span class="string">"etcd/healthcheck-client"</span> certificate and key</span><br><span class="line">[certs] Generating <span class="string">"apiserver-etcd-client"</span> certificate and key</span><br><span class="line">[certs] Generating <span class="string">"sa"</span> key and public key</span><br><span class="line">[kubeconfig] Using kubeconfig folder <span class="string">"/etc/kubernetes"</span></span><br><span class="line">[kubeconfig] Writing <span class="string">"admin.conf"</span> kubeconfig file</span><br><span class="line">[kubeconfig] Writing <span class="string">"kubelet.conf"</span> kubeconfig file</span><br><span class="line">[kubeconfig] Writing <span class="string">"controller-manager.conf"</span> kubeconfig file</span><br><span class="line">[kubeconfig] Writing <span class="string">"scheduler.conf"</span> kubeconfig file</span><br><span class="line">[control-plane] Using manifest folder <span class="string">"/etc/kubernetes/manifests"</span></span><br><span class="line">[control-plane] Creating static Pod manifest <span class="keyword">for</span> <span class="string">"kube-apiserver"</span></span><br><span class="line">[control-plane] Creating static Pod manifest <span class="keyword">for</span> <span class="string">"kube-controller-manager"</span></span><br><span class="line">[control-plane] Creating static Pod manifest <span class="keyword">for</span> <span class="string">"kube-scheduler"</span></span><br><span class="line">[etcd] Creating static Pod manifest <span class="keyword">for</span> <span class="built_in">local</span> etcd <span class="keyword">in</span> <span class="string">"/etc/kubernetes/manifests"</span></span><br><span class="line">[<span class="built_in">wait</span>-control-plane] Waiting <span class="keyword">for</span> the kubelet to boot up the control plane as static Pods from directory <span class="string">"/etc/kubernetes/manifests"</span>. This can take up to 4m0s</span><br><span class="line">[apiclient] All control plane components are healthy after 15.506392 seconds</span><br><span class="line">[upload-config] Storing the configuration used <span class="keyword">in</span> ConfigMap <span class="string">"kubeadm-config"</span> <span class="keyword">in</span> the <span class="string">"kube-system"</span> Namespace</span><br><span class="line">[kubelet] Creating a ConfigMap <span class="string">"kubelet-config-1.18"</span> <span class="keyword">in</span> namespace kube-system with the configuration <span class="keyword">for</span> the kubelets <span class="keyword">in</span> the cluster</span><br><span class="line">[upload-certs] Storing the certificates <span class="keyword">in</span> Secret <span class="string">"kubeadm-certs"</span> <span class="keyword">in</span> the <span class="string">"kube-system"</span> Namespace</span><br><span class="line">[upload-certs] Using certificate key:</span><br><span class="line">c00c2202124c09e619c5d7aad8b97d2605266864c2caf9db48f08a864b8167a5</span><br><span class="line">[mark-control-plane] Marking the node k8s-master as control-plane by adding the label <span class="string">"node-role.kubernetes.io/master=''"</span></span><br><span class="line">[mark-control-plane] Marking the node k8s-master as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]</span><br><span class="line">[bootstrap-token] Using token: abcdef.0123456789abcdef</span><br><span class="line">[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to get nodes</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs <span class="keyword">in</span> order <span class="keyword">for</span> nodes to get long term certificate credentials</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow certificate rotation <span class="keyword">for</span> all node client certificates <span class="keyword">in</span> the cluster</span><br><span class="line">[bootstrap-token] Creating the <span class="string">"cluster-info"</span> ConfigMap <span class="keyword">in</span> the <span class="string">"kube-public"</span> namespace</span><br><span class="line">[kubelet-finalize] Updating <span class="string">"/etc/kubernetes/kubelet.conf"</span> to point to a rotatable kubelet client certificate and key</span><br><span class="line">[addons] Applied essential addon: CoreDNS</span><br><span class="line">[addons] Applied essential addon: kube-proxy</span><br><span class="line"></span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br><span class="line"></span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  mkdir -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">  sudo cp -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">  sudo chown $(id -u):$(id -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run <span class="string">"kubectl apply -f [podnetwork].yaml"</span> with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line"></span><br><span class="line">Then you can join any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm join 192.168.224.129:6443 --token abcdef.0123456789abcdef \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:95ff2bd76b5dec945651a4db5412bdfbc5588bf5b8cb1e9df05ddeb648b5ef7a</span><br></pre></td></tr></table></figure><p>加入Node节点</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s-node1 ~]<span class="comment"># kubeadm join 192.168.224.129:6443 --token abcdef.0123456789abcdef \</span></span><br><span class="line">&gt;     --discovery-token-ca-cert-hash sha256:95ff2bd76b5dec945651a4db5412bdfbc5588bf5b8cb1e9df05ddeb648b5ef7a</span><br><span class="line">W0714 10:10:57.574520   54894 join.go:346] [preflight] WARNING: JoinControlPane.controlPlane settings will be ignored when control-plane flag is not <span class="built_in">set</span>.</span><br><span class="line">[preflight] Running pre-flight checks</span><br><span class="line">[preflight] Reading configuration from the cluster...</span><br><span class="line">[preflight] FYI: You can look at this config file with <span class="string">'kubectl -n kube-system get cm kubeadm-config -oyaml'</span></span><br><span class="line">[kubelet-start] Downloading configuration <span class="keyword">for</span> the kubelet from the <span class="string">"kubelet-config-1.18"</span> ConfigMap <span class="keyword">in</span> the kube-system namespace</span><br><span class="line">[kubelet-start] Writing kubelet configuration to file <span class="string">"/var/lib/kubelet/config.yaml"</span></span><br><span class="line">[kubelet-start] Writing kubelet environment file with flags to file <span class="string">"/var/lib/kubelet/kubeadm-flags.env"</span></span><br><span class="line">[kubelet-start] Starting the kubelet</span><br><span class="line">[kubelet-start] Waiting <span class="keyword">for</span> the kubelet to perform the TLS Bootstrap...</span><br><span class="line"></span><br><span class="line">This node has joined the cluster:</span><br><span class="line">* Certificate signing request was sent to apiserver and a response was received.</span><br><span class="line">* The Kubelet was informed of the new secure connection details.</span><br></pre></td></tr></table></figure><p>创建密钥</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@k8s-master ~]<span class="comment"># kubectl describe secrets -n kube-system $(kubectl -n kube-system get secret|grep deployment-controller-token-w7zc5 | awk '&#123;print $1&#125;')</span></span><br><span class="line">Name:         deployment-controller-token-w7zc5</span><br><span class="line">Namespace:    kube-system</span><br><span class="line">Labels:       &lt;none&gt;</span><br><span class="line">Annotations:  kubernetes.io/service-account.name: deployment-controller</span><br><span class="line">              kubernetes.io/service-account.uid: b70c5000-eea5-4df4-9a52-4afa460657aa</span><br><span class="line"></span><br><span class="line">Type:  kubernetes.io/service-account-token</span><br><span class="line"></span><br><span class="line">Data</span><br><span class="line">====</span><br><span class="line">token:      eyJhbGciOiJSUzI1NiIsImtpZCI6InlaQkZhTDhsRDN1UFlOTWNPaXlEUTRWUXFWNmJRcHFBWHB6QWt3OWdsME0ifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkZXBsb3ltZW50LWNvbnRyb2xsZXItdG9rZW4tdzd6YzUiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVwbG95bWVudC1jb250cm9sbGVyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiYjcwYzUwMDAtZWVhNS00ZGY0LTlhNTItNGFmYTQ2MDY1N2FhIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRlcGxveW1lbnQtY29udHJvbGxlciJ9.lRATZAlb-LJkS77HSTNFMZKTApY4uRS4_RBUqTPP9752hMOSilHbDbLeDTI1p8K2aiqTNMbRdBJBBiOwtR2jtX0IOXhXlFcrEagGEWbRbyaHx1Nw9Sn84xE70BYlWbHG4EHnKD65okiQgXwegGG121nlh-F_qWpl-n01cGXDqLp-IxV5ZMWLvbZ9OCblgNJF7bFLVwJKbALdvDME4hUXNAsnFTytkv14E36LL8ywjWTRFhWeCVQ_ndNKI4OtfTZV3HiSNN4ag4M_6yS_8VspFrqrbqcGkb63kjK8W4oz68yj3ocurPA0Yf_zGODEeUSp7fq751Dct4iWDqHZMw8ARw</span><br><span class="line">ca.crt:     1025 bytes</span><br><span class="line">namespace:  11 bytes</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;环境&quot;&gt;&lt;a href=&quot;#环境&quot; class=&quot;headerlink&quot; title=&quot;环境&quot;&gt;&lt;/a&gt;环境&lt;/h1&gt;&lt;p&gt;安装k8s本身并不复杂，网上太多失败的例子主要是因为以下几点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;不能上外网&lt;/li&gt;
&lt;li&gt;刚开始的系统配置漏了
      
    
    </summary>
    
    
      <category term="容器" scheme="https://archks.github.io/categories/%E5%AE%B9%E5%99%A8/"/>
    
    
  </entry>
  
  <entry>
    <title>Web终端GateOne</title>
    <link href="https://archks.github.io/2020/07/12/Web%E7%BB%88%E7%AB%AFGateOne/"/>
    <id>https://archks.github.io/2020/07/12/Web%E7%BB%88%E7%AB%AFGateOne/</id>
    <published>2020-07-12T14:58:59.000Z</published>
    <updated>2020-07-15T08:10:36.720Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/liftoff/GateOne" target="_blank" rel="noopener">https://github.com/liftoff/GateOne</a></p></blockquote><p>GateOne 是一款使用 HTML5 技术编写的网页版 SSH 终端模拟器。基于现代的 HTML5 技术，无需任何浏览器插件、支持多个 SSH 进程、可以嵌入到其他任意应用程序中、支持使用 JavaScript，Python 甚至纯 CSS 编写的插件、支持 SSH 进程副本，打开多个进程而无需重复输入密码、 支持各种服务器端的日志功能，支持 Keberos-based 单点登录甚至活动目录、 支持操作日志记录，具有操作记录回放功能。</p><p>先看一下效果（实现网页登陆SSH）：</p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/12/UGSHpt.png" alt="GateOne Web终端初体验" style="zoom: 50%;" /><br><h1 id="安装和几点坑"><a href="#安装和几点坑" class="headerlink" title="安装和几点坑"></a>安装和几点坑</h1><p>安装：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -itd --restart=always -p 555:8000 --privileged --name gateone arush/gateone:latest</span><br></pre></td></tr></table></figure><ul><li>之所以用到privileged是因为改时间需要特权！</li></ul><p>1、安装后需要修改配置文件，不然会出现如下报错</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[W 200712 22:51:42 iostream:1451] SSL Error on 12 (<span class="string">'113.118.227.104'</span>, 32699): [SSL: HTTP_REQUEST] http request (_ssl.c:590)</span><br></pre></td></tr></table></figure><p>修改配置文件，将其中的SSL选项改为True</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sed -i <span class="string">'s/disable_ssl": false/disable_ssl": true/'</span> /etc/gateone/conf.d/10server.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证一下</span></span><br><span class="line">$ grep <span class="string">'disable_ssl'</span> /etc/gateone/conf.d/10server.conf </span><br><span class="line"><span class="string">"disable_ssl"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启生效</span></span><br><span class="line">docker restart gateone</span><br></pre></td></tr></table></figure><p>2、修改时间，尝试通过挂在/etc/timezone来同步时间，但是失败了，只好手动修改时间和宿主机同步了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">date -s 07/12/2020</span><br><span class="line">date -s 22:51:17</span><br></pre></td></tr></table></figure><p>3、修改完这些之后，基本就能用了，查看一下输出信息，如下就没问题了：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ docker logs -f gateone</span><br><span class="line">[I 200712 22:59:33 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 74ms</span><br><span class="line">[I 200712 23:00:38 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 164ms</span><br><span class="line">[I 200712 23:01:43 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 101ms</span><br><span class="line">[I 200712 23:02:48 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 110ms</span><br><span class="line">[I 200712 23:03:53 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 95ms</span><br><span class="line">[I 200712 23:04:58 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 105ms</span><br><span class="line">[I 200712 23:06:03 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 123ms</span><br><span class="line">[I 200712 23:07:08 server:1796] &#123;<span class="string">"ip_address"</span>: <span class="string">"113.118.227.104"</span>, <span class="string">"location"</span>: <span class="string">"default"</span>, <span class="string">"upn"</span>: <span class="string">"ANONYMOUS"</span>&#125; WebSocket Latency: 111ms</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/liftoff/GateOne&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/liftoff/GateOne&lt;/a&gt;&lt;/p&gt;
&lt;/blo
      
    
    </summary>
    
    
      <category term="运维" scheme="https://archks.github.io/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
  </entry>
  
  <entry>
    <title>【摘文】人类简史</title>
    <link href="https://archks.github.io/2020/07/12/%E4%BA%BA%E7%B1%BB%E7%AE%80%E5%8F%B2/"/>
    <id>https://archks.github.io/2020/07/12/%E4%BA%BA%E7%B1%BB%E7%AE%80%E5%8F%B2/</id>
    <published>2020-07-12T14:21:43.000Z</published>
    <updated>2020-07-11T23:24:28.000Z</updated>
    
    <content type="html"><![CDATA[<p> 这种“八卦理论”听起来有点荒唐，但其实有大量的研究结果支持这种说法。即使到了今天，绝大多数的人际沟通（不论是电子邮件、电话还是报纸专栏）讲的都还是八卦。这对我们来说真是再自然不过，就好像我们的语言天生就是为了这个目的而生的。你认为一群历史学教授碰面吃午餐的时候，聊的会是第一次世界大战的起因吗？而核物理学家在研讨会中场茶叙的时候，难道讲的会是夸克？确实有时候是如此，但更多时候其实讲的都是哪个教授逮到老公偷吃，哪些人想当上系主任或院长，或者说又有哪个同事拿研究经费买了一台雷克萨斯之类。八卦通常聊的都是坏事。这些嚼舌根的人，所掌握的正是最早的第四权力，就像是记者总在向社会爆料，从而保护大众免遭欺诈和占便宜。</p><p>虚构的事物可能造成误导或分心，带来危险。</p><p>即使到了今天，人类的团体还是继续受到这个神奇的数字影响。只要在150人以下，不论是社群、公司、社会网络还是军事单位，只要靠着大家都认识、彼此互通消息，就能够运作顺畅，而不需要规定出正式的阶层、职称、规范。所以，究竟智人是怎么跨过这个门槛值，最后创造出了有数万居民的城市、有上亿人口的帝国？这里的秘密很可能就在于虚构的故事。就算是大批互不相识的人，只要同样相信某个故事，就能共同合作。</p><p>如果我们不想想采集者祖先的饮食习惯，就很难解释为什么我们一碰到最甜、最油的食物就难以抵抗。当时他们住在草原上或森林里，高热量的甜食非常罕见，永远供不应求。如果是个3万年前的采集者，想吃甜食只有一种可能来源：熟透的水果。所以，如果石器时代的女性碰到一棵长满甜美无花果的树，最明智的做法就是立刻吃到吃不下为止，否则等到附近的狒狒也发现这棵树，可就一颗也吃不到了。于是，这种想大口吃下高热量食物的直觉本能就这样深植在我们的基因里。</p><p>有证据显示，自从采集时代以来，智人的脑容量其实是逐渐减少！11要在那个时代活下来，每个人都必须有高超的心智能力。而等到农业和工业时代开展，人类开始能靠着别人的技能生存下来，就算是低能的人也开始有了生存空间。例如只要肯挑水或是当个生产线的工人，就能活下来，并把自己那些平庸无奇的基因传下去。</p><p>即使到了今天，虽然人类有着种种先进科技，但食物热量超过90%的来源仍然是来自人类祖先在公元前9500年到公元前3500年间驯化的植物：小麦、稻米、玉米、马铃薯、小米和大麦。</p><p>于是，种种想让生活变得轻松的努力，反而给人带来无穷的麻烦；而且这可不是史上的最后一次。就算今天，仍然如此。有多少年轻的大学毕业生投身大企业、从事各种劳心劳力的工作，发誓要努力赚钱，好在35岁就退休，去从事他们真正有兴趣的事业？但等他们到了35岁，却发现自己背着巨额贷款，要付子女的学费，要养在高级住宅区的豪宅，每家得有两部车，而且觉得生活里不能没有高级红酒和国外的假期。他们该怎么做？他们会放下一切，回去野外采果子挖树根吗？当然不可能，而是加倍努力，继续把自己累得半死。</p><p>  在传统信件的年代，我们通常只有最重要、不得不联络的事才会写信。写起信来也不是想起什么就写什么，而是字斟句酌、考虑再三。而且，通常对方的回信也会同样慎重。对大多数人来说，每个月来来去去的信顶多就是几封，也不会有人急于立刻回复。但在今天，我每天都会收到几十封电子邮件，而且所有人都希望你立刻响应。我们以为自己省下了时间；然而，我们其实是把生活的步调加速成过去的十倍快，于是我们整天忙忙碌碌、焦躁不安。</p><p>每当人类整体的能力大幅增加、看来似乎大获成功，个人的苦痛也总是随之增长。</p><p>在农业革命之后，人类成了远比过去更以自我为中心的生物，与“自己家”紧密相连，但与周遭其他物种画出界线。</p><p>自然界的秩序是稳定不变的，就算人类不再相信世界上有重力，重力也不会一夜之间就消失。但相反的是，想象所建构出来的秩序总是有一夕崩溃的风险，因为这些秩序背后靠的都是虚构的故事，只要人们不再相信，一切就风云变色。为了维持想象建构出来的秩序，必须持续投入大量心力，甚至还得掺入些暴力和胁迫的成分。像是为了让民众不违反想象建构的秩序，国家就需要有军队、警察、法院和监狱不分昼夜发挥作用。如果一个古巴比伦人让邻居眼睛瞎了，想要执行“以眼还眼”的规定，就不得不有些暴力的措施。</p><p>不管是基督宗教、民主还是资本主义，都只是由想象所建构出来的秩序。而要怎样才能让人相信这些秩序？第一，对外的说法绝对要坚持它们千真万确、绝非虚构。永远要强调，这种维持社会稳定的秩序是个客观事实，是由伟大的神或是自然的法则所创造。如果要说人人不平等，不是因为汉谟拉比自己这么说，而是因为恩利尔和马杜克这两位神的旨意。如果要说人人平等，也不是因为托马斯·杰斐逊自己这么说，而是因为这是上帝造人的方式。如果要说自由市场是最好的经济制度，不是因为亚当·斯密（Adam Smith）自己这么说，而是因为这是自然不变的规律。</p><p>第二，在教育上也要彻底贯彻同一套原则。从人出生的那一刻起，就要不断提醒他们这套想象建构出来的秩序，要在一切事物中融入这套原则，不管是童话、戏剧、绘画、歌曲、礼仪、政治宣传、建筑、食谱还是时尚。举例来说，我们现在相信平等的概念，所以富人家的子弟穿起牛仔裤，觉得这是种时尚。</p><p>浪漫主义告诉我们，为了要尽量发挥潜力，就必须尽量累积不同的经验。必须体会不同的情感，尝试不同的关系，品尝不同的美食，还必须学会欣赏不同风格的音乐。而其中最好的一种办法，就是摆脱日常生活及工作，远离熟悉的环境，前往遥远的国度，好亲身“体验”不同的文化、气味、美食和规范。我们总会不断听到浪漫主义的神话，告诉我们“那次的经验让我眼界大开，从此整个生活都不一样了”。</p><p>身为人类，我们不可能脱离想象所建构出的秩序。每一次我们以为自己打破了监狱的高墙、迈向自由的前方，其实只是到了另一间更大的监狱，把活动范围稍稍加以扩大。</p><p>1.想象建构的秩序深深与真实的世界结合。<br>2.想象建构的秩序塑造了我们的欲望。<br>3.想象建构的秩序存在于人和人之间思想的连接。</p><p>从古至今，我们都知道文书和会计的想法就是有点没人性，像个文件柜一样。但这不是他们的错。如果他们不这样想，他们的抽屉就会一片混乱，也就无法为政府、公司或组织提供所需的服务。而这也正是文字对人类历史所造成最重要的影响：它逐渐改变了人类思维和看待这个世界的方式。过去的自由连接、整体思考，已经转变为分割思考、官僚制度。</p><p>天生带来允许，文化造成封闭</p><p>文化总会说，它只是禁止“不自然的事”。但从生物学的角度来看，这世界上根本没有什么是不自然的。只要有可能发生的事，就是自然。真正完全“不自然”的事，是指违背了自然规律，但这种事情根本就不会存在，所以也没有禁止的必要。举例来说，没有任何一种文化会“禁止男性进行光合作用”，“禁止女性跑得比光速快”，或是“禁止带负电荷的电子互相吸引”，就是因为这讲了只是白讲，完全没有必要。</p><p>演化本来就没有唯一的目的</p><p>就算是在宗教上水火不容的基督徒和穆斯林，也可以在金钱制度上达成同样的信仰。原因就在于宗教信仰的重点是自己相信，但金钱信仰的重点是“别人相信”。</p><p>往来于印度和地中海之间的商人，开始注意到黄金的价差，于是在印度便宜购入黄金，再回到地中海高价出售。于是，印度市场上的黄金需求暴增，价格跟着水涨船高。与此同时，在地中海黄金供给大量增加，价格因此下降。不用多久，黄金在印度和地中海的价格就相去无几。正因为地中海人相信黄金有价，印度人也开始跟着相信。就算黄金对印度人来说仍然没有实际用途，光是因为地中海人重视黄金，就足以让印度人跟着重视起来。</p><p>钱同时也是人类最能接受的东西。比起语言、法律、文化、宗教和社会习俗，钱的心胸更为开阔。</p><p>只有金钱能够跨越几乎所有文化鸿沟，不会因为宗教、性别、种族、年龄或性取向而有所歧视。也多亏有了金钱制度，才让人就算互不相识、不清楚对方人品，也能携手合作。</p><p>我们用金钱来促进与陌生人的合作，但又害怕这会破坏人类的价值和亲密的关系。一方面，我们也想打破那些限制金钱和商业流动的社会大坝；但另一方面，我们又不断筑起新的大坝，希望保护社会、宗教和环境免受市场力量的奴役。</p><p>现代西方认为所谓公义的世界应该是由各个独立的民族国家组成，但古代中国的概念却正好相反，认为政治分裂的时代不仅动荡不安，而且公义不行。这种看法对中国的历史产生深远的影响。每次一个帝国朝代崩溃，这种政治理论主流就让各方竞逐的势力不安于各自为政，而一心追求统一。</p><p>据我们所知，要到了公元前1000年间，才开始出现具备普世和推广特质的宗教。这可以说是史上最重要的革命之一，对于人类的统一有重大贡献，绝不亚于帝国或金钱。</p><p>从历史上来看，一神论就像是个万花筒，承继了一神论、二元论、多神论和泛神论，收纳在同一个神圣论述之下。结果就是，基督徒大致上是信奉一神论的上帝，相信二元论的魔鬼，崇拜多神论的圣人，还相信泛神论的鬼魂。像这样同时有着不同甚至矛盾的思想，而又结合各种不同来源的仪式和做法，宗教学上有一个特别的名称：综摄（syncretism）。很有可能，综摄才是全球最大的单一宗教。</p><hr><blockquote><p>佛教的故事</p></blockquote><p>佛教的核心人物释迦牟尼不是神而是人，俗名乔达摩·悉达多（Siddhartha Gautama）。根据佛教经典，释迦牟尼大约在公元前500年是个喜马拉雅山区小国的王子，看到身边的人深深陷于苦难之中，而心生不忍。他看到人不分男女老幼，不仅时常受到战争和瘟疫等灾难袭击，还无法免于种种焦虑、沮丧和不满的情绪，似乎这一切都是人生难以避免的事。人类追求财富和权力，获得知识和财富，生儿育女，建起宫殿和房屋。但不论取得多少成就，却仍然无法满足。穷人梦想着要变富，有一百万的想要两百万，有两百万的想要一千万。而且就算真的有钱了、有名了，他们还是不满意，还是有无尽的烦恼和忧虑，无法从生老病死中解脱。至死，一切如梦幻泡影消失，生命就像是毫无意义的追寻。然而，这个轮回该怎样才能跳出？<br>在29岁时，释迦牟尼半夜离宫，抛下了财富和家人，流浪走遍印度北部，希望为这一切痛苦寻找出路。他前往各个修院修行，聆听各个大师讲道，但还是无法完全感到解脱，有什么不满依然萦绕。他并未绝望，决心反求诸己，直到找到彻底解决的方法为止。他入禅六年，思索各种人类苦痛的本质、原因和解决方式。最后他体会到，一切苦难并非来自噩运、社会不公或是神祇的任性，而是出于每个人自己心中的思想模式。</p><p>释迦牟尼认为，人遇到事情通常就会产生欲念，而欲念总是会造成不满。遇到不喜欢的事，就想躲开；遇到喜欢的事，就想维持并增加这份愉快。但正因如此，人心就永远不满、永远不安。这点在碰上不悦的时候格外明显，像是感觉疼痛的时候，只要疼痛持续，我们就一直感到不满，用尽办法想要解决。然而，就算是遇上欢乐的事，我们也从不会真正满足，而是一直担心这种欢乐终将结束或是无法再持续或增强。有些人多年来一直在寻找爱情，但等到真的找着了爱情，却还是不满足。有的开始整天担心对方可能会离开；有的又觉得自己太过屈就，应该再找更好的人。</p><p>释迦牟尼找到一种方法可以跳出这种恶性循环。在事物带来快乐或痛苦的时候，重点是要看清事物的本质，而不是着重在它带来的感受，于是就能不再为此所困。虽然感受悲伤，但不要希望悲伤结束，于是虽然仍有悲伤，也能不再为此而困。即使仍然悲伤，也是一种丰硕的经验。虽然感受快乐，但不要希望快乐继续，于是虽然仍有快乐，也能不失去心中的平静。<br>但要怎样才能让心里接受事物的本质，而放下种种欲求，知道苦即为苦、乐即为乐？释迦牟尼制定一套冥想的技巧，能够训练心灵感受事物的本质而排除种种欲求。通过训练，心灵专注在“我现在是什么感受？”，而不是问：“为什么是我？”这种境界很难达到，但并非不可能。</p><p>迦牟尼将冥想落实在各种道德规范上，好让信众更能专注在实际的感受，而不会落入各种欲求和幻想之中。他要求信众不杀生、不邪淫、不偷盗，因为这些作为一定会让欲望如野火燎原，而一心追求权力、感官享受或财富。等到这些火焰彻底扑灭，原本的欲求就换成了圆满和寂静，称为涅槃。达到涅槃，也就是解脱了所有苦痛，能够无比清晰地感受身边的现实，没有什么幻想和幻象。虽然人们很有可能还是会遇到苦痛，但苦痛已经不再能影响他们。毕竟，无欲则无苦。</p><p>根据佛教经典，释迦牟尼本人就达到了涅槃，从痛苦中完全解脱。而在这之后他就被称为“佛陀”，意为“觉悟者”。接着，佛陀一生前往各地普传佛法，希望让所有人离苦得乐。佛陀的教诲一言以蔽之：痛苦来自欲望；要从痛苦中解脱，就要放下欲望；而要放下欲望，就必须训练心智，体验事物的本质。</p><hr><p>甚至还有学者认为，文化就像是精神感染或寄生虫，而人类就是毫不知情的宿主。寄生虫或病毒就是这样住在宿主体内，繁殖、传播，从一个宿主到另一个宿主，夺取养分，让宿主衰弱，有时甚至丧命。只要宿主能够活着让寄生虫继续繁衍，寄生虫就很少关心宿主的情形。至于文化，其实也是以这种方式寄生在人类的心中。它们从一个宿主传播到另一个宿主，有时候让宿主变得衰弱，有时候甚至让宿主丧命。任何一个文化概念（像是基督教在天上的天堂），都可能让某个人毕生致力于传播这种想法，甚至为此牺牲生命。于是，人类死亡了，但想法持续传播。根据这种说法，文化并不是某些人为了剥削他人而设计出的阴谋，而是因为种种机缘巧合所出现的心理寄生虫，从出现之后就开始剥削所有受到感染的人。</p><p>科学革命并不是“知识的革命”，而是“无知的革命”。真正让科学革命起步的伟大发现，就是发现“人类对于最重要的问题其实毫无所知”。</p><p>对于像是伊斯兰教、基督教、佛教、儒教这些前现代知识体系来说，它们假设世上所有重要的事情都已经为人或为神所知。这些全知者可能是某些伟大的神、某个全能的神或是某些过去的智者，通过经典或口传，将这些智慧传给后人。而对于平民百姓而言，重点就是要钻研这些古籍和传统，正确加以理解，就能获得知识。</p><p>现代科学没有需要严格遵守的教条，但研究方法有一个共同的核心：收集各种实证观察（可以用感官感受到的），并以数学工具整理。<br>人类从历史一开始就不断进行实证观察，但其影响常常十分有限。毕竟，如果我们觉得已经有了所有问题的答案，为什么还要浪费资源进行新的观察？然而，现代人们开始承认自己在某些非常重要的问题上几近无知，就开始觉得需要寻找取得全新的知识。</p><p>科学研究之所以能得到经费，多半是因为有人认为这些研究有助于达到某些政治、经济或宗教的目的。例如在16世纪，国王和银行业者对于前往世界各地进行地理探勘可以说是挥金如土，但讲到要研究儿童心理学可就一毛不拔。原因就在于，国王和银行家认为新的地理知识能够让他们征服新的土地、成立贸易帝国，但他们在儿童心理学这一块，则看不到任何利益。</p><p>科学研究一定得和某些宗教或意识形态联手，才有蓬勃发展的可能。意识形态能够让研究所耗的成本合理化。而代价就是意识形态能够影响科学的进程表，并且决定如何使用研究成果。因此，如果想知道人类究竟是怎样做出核弹，怎样登上月球，光是研究物理学家、生物学家和社会学家的成就还不够。我们还必须考虑到当时的思想、政治和经济力量，看看这些力量如何形塑了物理学、生物学和社会学，将它们推往某些特定的方向。</p><p>中国和波斯其实并不缺乏制作蒸汽机的科技（当时要照抄或是购买都完全不成问题），他们缺少的是西方的价值观、故事、司法系统和社会政治结构，这些在西方花了数个世纪才形成及成熟，就算想要照抄，也无法在一夕之间内化。之所以法国和美国能够很快跟上英国的脚步，是因为他们本来就和英国共享一套最重要的故事和社会结构。而中国和波斯总是追赶不及，则是因为整个关于社会的想法和组织就是不同。</p><p>欧洲帝国主义和先前的所有帝国完全不同。过去的帝国主义者都认为自己已经了解了整个世界，“征服世界”只是为了要利用及传播他们自己对于世界的看法。以阿拉伯人为例，他们征服埃及、西班牙和印度并不是为了想找出什么自己不知道的事。古罗马人、蒙古人和阿兹特克人之所以积极四方征讨，为的是权力和财富，也不是为了新知。相较之下，欧洲帝国主义之所以要前往遥远的彼岸，除了为了新领土，也是为了新知识。</p><p>在几十年间，这种种族主义理论曾经甚嚣尘上，但现在已经成了科学家和政治家不敢再提的诅咒禁忌话题。虽然我们还是英勇地抵抗着种族主义，但却没发现战线已经转移，过去种族主义在帝国思想中所占的位置，现在都由“文化主义”（culturism）所取代。目前这个词尚未明确定义，但差不多是可以提出这个概念的时候了。对今日许多精英分子而言，要比较判断不同人群的优劣，几乎讲的总是历史上的文化差异，而不再是种族上的生物差异。</p><p>接着，历史上出现了科学革命和关于进步的概念。所谓的“进步”，是在承认我们的无知之后，认为只要投资进行研究，一切就能变得更好。这个想法很快地就应用到了经济上。只要是相信“进步”的人，就会相信各种地理发现、科技发明和组织发展，能够提升人类生产、贸易和财富的总量。发现了大西洋的新航道而大发利市，并不需要牺牲过去在印度洋的旧航道。推出新的产品时，也不一定就代表要减少旧产品的产量。举例来说，我们开了一家法式面包店，并不代表过去的传统面包店必然关门大吉。民众会培养出新的喜好、吃得更多。我赚钱，不代表你就赔钱；我变壮了，不代表你就得饿死。全球的这块饼，可以有变大的潜力。</p><p>这一切的立论基础必须取决于富人是不是用这些利润来新建工厂、雇用新员工，而不是将利润浪费在无生产力的活动上。</p><p>在新的资本主义教条里，最神圣的开宗明义第一条就是：“生产的利润，必须再投资于提高产量。”</p><p>资本主义之名正是由此而来。所谓的“资本主义”（Capitalism），认为“资本”（capital）与“财富”（wealth）有所不同。资本指的是投入生产的各种金钱、物品和资源。而财富指的则是那些埋在地下或是浪费在非生产性活动的金钱、物品和资源。</p><p>生产的利润，必须再投资于提高产量。前现代时期，当时的人们认为生产这件事并不会造成太大的改变。所以，如果不管做什么，生产都不会带来太了不起的利润，为什么还要把利润重新投入生产呢？</p><p>帝国资本主义的奇妙循环：信贷资助新发现，新发现带来殖民地，殖民地带来利润，利润建立起信任，信任转化为更多的信贷。</p><p>因为所有能量转换只能靠人类和动物的身体，当时几乎所有人类活动靠的就是肌肉的力量。人类的肌肉能用来造车盖房，牛的肌肉能用来拖犁耕田，马的肌肉能用来运输货物。而所有能用来供应这些“有机肌肉机器”的能量来源只有一种：植物。至于植物的能量，则是来自太阳。植物靠着光合作用，将太阳能转为有机化合物。由此看来，历史上人类成就的几乎所有事情，第一步靠的都是将植物取得的太阳能转换为肌肉的力量。</p><p>工业革命的核心，其实就是能源转换的革命。我们已经一再看到，我们能使用的能源其实无穷无尽。讲得更精确，唯一的限制只在于我们的无知。每隔几十年，我们就能找到新的能源来源，所以人类能用的能源总量其实在不断增加。</p><p>在工业革命之前，人类的能源市场几乎完全只能靠植物。这就像是住在一个容量每年3000艾焦的水库旁边，想办法尽可能多抽一点水出来。然而，这里有个明确的总容量。但到了工业革命时期，人类发现能用的能源不是一个水库，而是一整片海洋，容量可能有几千亿艾焦。我们唯一需要的，只是个更好的抽水泵罢了。</p><p>现代资本主义经济如果想要存活，就得不断提高产量，很像是鲨鱼，如果不一直游动就会窒息。然而，光是生产还不够。生产出来之后，还得有人买，否则业者或投资人都得关门大吉。为了避免这种灾难，确保不管什么新产品都有人买账，就出现了一种新的伦理观：消费主义。</p><p>消费主义的美德就是消费更多的产品和服务，鼓励所有人应该善待自己、宠爱自己，就算因为过度消费而慢慢走上绝路，也是在所不惜。</p><p>在历史上的大多数时候，这种文案不但无法引起消费欲望，反而还会激起极度的反感。在过去的人眼中，这种内容真是自私、堕落、道德沦丧！消费主义除了自身非常努力，还在大众心理学（像是“做就对了！”）的推波助澜之下，不断说服大众“放纵对你有益，而节俭是自我压抑”。<br>在中世纪欧洲，贵族浪掷千金、尽享奢华，而农民则是省吃俭用、锱铢必较。但今天情况正相反。大富豪管理资产和投资非常谨慎，反而是没那么有钱的人，买起没那么需要的汽车和电视机却毫不手软。</p><p>在过去，从来没有这种四方和平、难以想象战争爆发的年代。<br>目前已经有许多学者发表许多著作和文章，解释为何现在会有这个令人愉悦的发展，其中大致提出几项重要因素。首先，战争的成本大幅上升。如果说有个最高诺贝尔和平奖，应该把奖颁给罗伯特·奥本海默以及和他一起研发出原子弹的同事。有了核武器之后，超级大国之间如果再开战，无异等于集体自杀。因此，想要武力征服全球也成了不可能的任务。<br>其次，正因为战争的成本飙升，也就代表其利润下降，在史上大多数时候，只要掠夺或兼并敌人的领土，就能为自己的国力注入一剂强心针。过去的财富多半就是田地、牛、奴隶和黄金，无论要抢劫或占领都十分方便。但到了今天，财富的形式变成了人力资本、科技知识，以及像是银行这种复杂的社会经济结构，想要抢夺或是占领都相当困难。</p><p>同时，虽然战争已经不再那么有利可图，但和平却成了一笔越来越划算的生意。在过去的农业经济中，长途贸易和外国投资并非重点，因此和平顶多只是省下战争费用，其他并无太大好处。例如在1500年，如果日韩两国处于和平状态，韩国大众就不用负担沉重的战争税，也不用担心日本毁灭性的侵略攻击；但除此之外，荷包并不会变满。但到了现代的资本主义经济，外贸和投资变得至关重要，和平可以说也开始有了特殊的红利。只要日本和韩国相安无事，韩国人可以把产品卖给日本，可以在日本交易股票，也可以接受日本来的投资，而这些都能振兴韩国的经济。</p><p>所以，现在有四大因素形成了一个良性循环。核子末日的威胁促进了和平主义；和平主义大行其道，于是战争退散、贸易兴旺；贸易成长，也就让和平的利润更高，而战争的成本也更高。随着时间过去，这个良性循环也就对战争造成另一个阻碍，而且可能最后看来会是最重要的阻碍：因为国际网络日渐紧密，使得多数国家无法再维持全然独立，所以其中任何一国片面宣战的机会也就大幅降低。大多数国家之所以不再发动全面战争的原因很简单，就是因为他们已经不再能够完全独立行事。</p><p>人类演化的结果，就是不会太快乐，也不会太痛苦。我们会短暂感受到快感，但不会永远持续。迟早快感会消退，让我们再次感受到痛苦。</p><p>我们对生活所赋予的任何意义，其实都只是错觉。不管是中世纪那种超脱凡世的生活意义，或是现代人文主义、民族主义和资本主义，本质上都完全相同，没有高下之别。像是可能有科学家觉得自己增加了人类的知识，所以他的生命有意义；有士兵觉得他保卫自己的国家，所以他的生命有意义。不论是创业者想要开新公司，或是中世纪的人想要读经、参与圣战、兴建新庙，他们从中感受到的意义，都只是错觉与幻想。</p><p>正因如此，大多数宗教和哲学看待快乐的方式，都与自由主义非常不同。114最看重快乐这个问题的，就是佛教。两千五百多年来，佛教有系统地研究了快乐的本质和成因；正因如此，最近有越来越多科学团体开始研究佛教哲学和冥想。佛教认为，快乐既不是主观感受到愉悦，也不是主观觉得生命有意义，反而是在于放下追求主观感受这件事。</p><p>据佛教的观点，大多数人太看重自己的感受，以为快感就是快乐，不愉悦的感受就是受苦。于是，人类就渴望能有快感，并希望避免不愉悦的感受。然而，这是大大的误解。事实是，人类的主观感受没有任何实质或意义。主观感受就只是一种电光石火的波动，每个瞬间都在改变，就像海浪一样。不论你感受到的是快感或不快，觉得生命是否有着意义，这都只是一瞬间的波动而已。</p><p>如果我们太看重这些内部的波动，就会变得太过执迷，心灵也就焦躁不安、感到不满。每次碰上不快，就感觉受苦。而且就算已经得到快感，因为我们还希望快感能够增强或是害怕快感将会减弱，所以心里还是不能感到满足。追求这些主观感受十分耗费心神，而且终是徒劳，只是让我们受制于追求本身。因此，苦的根源既不在于感到悲伤或疼痛，也不在于感觉一切没有意义。苦真正的根源就在于“追求”主观感受这件事，不管追求的是什么，都会让人陷入持续的紧张、困惑和不满之中。</p><p>这就像是有人已经在海滩上站了数十年，总是想抓住“好的海浪”，让这些海浪永远留下来，同时又想躲开某些“坏的海浪”，希望这些海浪永远别靠近。就这样一天又一天，这个人站在海滩上徒劳无功，被自己累得几近发疯。最后终于气力用尽，瘫坐在海滩上，让海浪就这样自由来去。忽然发现，这样多么平静啊！</p><p>总结来说，我们现在会使用主观幸福感问卷，希望找出来我们主观认定什么时候有幸福感，而且认为找到特定的情绪状态就是找到了快乐。但相反的是，许多传统哲学和宗教（如佛教）则认为，快乐的关键在于追求真我、真正了解自己。大多数人都以为自己的感觉、想法、好恶就组成了自己，但这是一大错误。他们感觉愤怒的时候，心里想“我很生气，这是我的愤怒”。于是这一辈子做的，都是想要避开某些感受并追求另外某些感受。但他们从来没有发现，苦真正的来源不在于感受本身，而是对感受的不断追求。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt; 这种“八卦理论”听起来有点荒唐，但其实有大量的研究结果支持这种说法。即使到了今天，绝大多数的人际沟通（不论是电子邮件、电话还是报纸专栏）讲的都还是八卦。这对我们来说真是再自然不过，就好像我们的语言天生就是为了这个目的而生的。你认为一群历史学教授碰面吃午餐的时候，聊的会是第
      
    
    </summary>
    
    
      <category term="摘录" scheme="https://archks.github.io/categories/%E6%91%98%E5%BD%95/"/>
    
    
  </entry>
  
  <entry>
    <title>Minikube初体验</title>
    <link href="https://archks.github.io/2020/07/12/Minikube%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <id>https://archks.github.io/2020/07/12/Minikube%E5%88%9D%E4%BD%93%E9%AA%8C/</id>
    <published>2020-07-12T08:41:51.000Z</published>
    <updated>2020-07-13T11:53:17.433Z</updated>
    
    <content type="html"><![CDATA[<p>先吐槽一下K8S的官网，一个搞技术的，非得被逼成这样，这tm都是什么氛围！</p><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/12/U3bY9g.png" alt="https://kubernetes.io/docs/setup/learning-environment/minikube/"></p><br><blockquote><p>依照官网配置，始终不能启动minikube，官网并没有写太多细节，类似ipv4转发，Linux版本这些官网并没有提到，但是这些因素也决定minikube能否安装成功，我根据官网流程和部署，整理绝大部分安装时涉及到的点，如果环境相同，是能配置成功的。</p></blockquote><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>先介绍一下运行环境：</p><table><thead><tr><th>类型</th><th>配置</th></tr></thead><tbody><tr><td>系统</td><td>系统 Vmware14 + CentOS7 + Linux4.4</td></tr><tr><td>网络</td><td>Proxy代理，所有socks5代理带本地Windows，Windows可以直接连接Google，所有没有配置国内的源</td></tr></tbody></table><p><strong>需要注意的点：</strong></p><ul><li>宿主机参数调整： <ul><li>关闭防火墙 &amp; Selinux </li><li>关闭交换分区</li><li>配置至少2CPU，这次安装配置为2核4G</li><li>内核版本4.10，3.10的版本安装不了</li><li>开启ipv4、bridge内核转发</li><li>确保各项服务自启没问题</li></ul></li><li>docker配置<ul><li>docker的driver要和k8s一样，这里设置的是systemd，有时候也会设置cgroup</li></ul></li></ul><br><p>1、升级内核—-不要在Linux3.10的内核上安装，会有很多bug，建议升级到4.14</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rpm -Uvh https://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm</span><br><span class="line">yum list available --disablerepo=<span class="string">'*'</span> --enablerepo=elrepo-kernel</span><br><span class="line">yum --enablerepo=elrepo-kernel install kernel-ml</span><br><span class="line">vim /etc/default/grub    【 Change GRUB_DEFAULT=X ===&gt; GRUB_DEFAULT=0 】</span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg  【 recreate the kernel configuration 】</span><br></pre></td></tr></table></figure><p>2、设置本地代理，Windows上跑的Vmware，Windows可以直连外网，具体可以google，这里不方便展示</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ALL_PROXY=socks5://windowsIp:port</span><br><span class="line"></span><br><span class="line">取消代理</span><br><span class="line"><span class="built_in">unset</span> ALL_PROXY</span><br><span class="line"></span><br><span class="line">需要注意的是，配置完代理之后，并不能ping通google.com，但是用curl -I google.com 返回码是301显示可以访问</span><br></pre></td></tr></table></figure><p>3、关闭交换分区</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">swapoff -a                         暂时关闭</span><br><span class="line">sed -i <span class="string">'s/.*swap/#&amp;/'</span> /etc/fstab   永久关闭</span><br></pre></td></tr></table></figure><p>4、禁用防火墙和Selinux</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld </span><br><span class="line">setenforce 0</span><br><span class="line">sed -i <span class="string">'s\SELINUX=enforcing\SELINUX=disabled\'</span> /etc/selinux/config</span><br></pre></td></tr></table></figure><p>5、调整内核参数</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/bridge/bridge-nf-call-iptables</span><br></pre></td></tr></table></figure><p>6、设置域名解析：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"Master01 192.168.100.30"</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><p>7、安装依赖包和docker</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加docker仓库</span></span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用夜间测试库</span></span><br><span class="line">yum-config-manager --<span class="built_in">enable</span> docker-ce-nightly</span><br><span class="line">yum-config-manager --<span class="built_in">enable</span> docker-ce-test</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装最新版的docker</span></span><br><span class="line">yum install docker-ce docker-ce-cli containerd.io conntrack -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动docker并允许自启动（这一步在minikube运行的时候是必须的）</span></span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br></pre></td></tr></table></figure><p>8、修改docker和kubelte的Cgroup driver</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat &gt; /etc/docker/daemon.json &lt;&lt; EOF</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"exec-opts"</span>: [<span class="string">"native.cgroupdriver=systemd"</span>]</span><br><span class="line">  <span class="comment"># "exec-opts": ["native.cgroupdriver=cgroupfs"] 有时候cgroupfs就有用，不知道抽的什么风，应该是要和kubeadm匹配</span></span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">最后检查一下</span><br><span class="line">docker info | grep -i cgroup</span><br><span class="line">- Cgroup Driver: systemd</span><br></pre></td></tr></table></figure><p>9、安装kubectl、kubeadm、minikube</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 添加Google源</span></span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">repo_gpgcheck=1</span><br><span class="line">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br><span class="line">yum install -y kubectl kubeadm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># vim /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</span></span><br><span class="line"><span class="comment"># - 增加 --cgroup-driver=cgroupfs</span></span><br><span class="line"><span class="comment"># Environment="KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --cgroup-driver=cgroupfs"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置自启</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br><span class="line">systemctl restart kubelet</span><br><span class="line">systemctl <span class="built_in">enable</span> kubelet.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装minikube，并添加到环境变量</span></span><br><span class="line">curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64</span><br><span class="line">chmod +x minikube &amp;&amp; sudo mkdir -p /usr/<span class="built_in">local</span>/bin/ &amp;&amp; sudo install minikube /usr/<span class="built_in">local</span>/bin/</span><br></pre></td></tr></table></figure><p>10、完成安装</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ minikube status</span><br><span class="line">- minikube</span><br><span class="line">- <span class="built_in">type</span>: Control Plane</span><br><span class="line">- host: Running</span><br><span class="line">- kubelet: Running</span><br><span class="line">- apiserver: Running</span><br><span class="line">- kubeconfig: Configured</span><br></pre></td></tr></table></figure><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p><strong>运行一个简单的HTTP Server</strong></p><p>拉取镜像</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl create deployment hello-minikube --image=k8s.gcr.io/echoserver:1.10</span><br><span class="line">deployment.apps/hello-minikube created</span><br></pre></td></tr></table></figure><p>部署服务</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl expose deployment hello-minikube --<span class="built_in">type</span>=NodePort --port=8080</span><br><span class="line">service/hello-minikube exposed</span><br></pre></td></tr></table></figure><p>查看状态</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl get pod</span><br><span class="line">NAME                              READY   STATUS    RESTARTS   AGE</span><br><span class="line">hello-minikube-64b64df8c9-rcrfl   1/1     Running   0          98s</span><br></pre></td></tr></table></figure><p>得到这个服务的URL</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ minikube service hello-minikube --url</span><br><span class="line">http://192.168.134.129:32056</span><br></pre></td></tr></table></figure><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/12/U3Tepj.png" alt="第一个K8S服务"></p><p>删除这个Service</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl delete services hello-minikube</span><br><span class="line">service <span class="string">"hello-minikube"</span> deleted</span><br></pre></td></tr></table></figure><p>删除这个Deployment</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ kubectl delete deployment hello-minikube</span><br><span class="line">deployment.apps <span class="string">"hello-minikube"</span> deleted</span><br></pre></td></tr></table></figure><p>停止minikube集群</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ minikube stop</span><br><span class="line">* Stopping <span class="string">"minikube"</span> <span class="keyword">in</span> none ...</span><br><span class="line">* Node <span class="string">"minikube"</span> stopped.</span><br></pre></td></tr></table></figure><p>删除本地minikube集群</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ minikube delete</span><br><span class="line">* Uninstalling Kubernetes v1.18.3 using kubeadm ...</span><br><span class="line">* Deleting <span class="string">"minikube"</span> <span class="keyword">in</span> none ...</span><br><span class="line">* Removed all traces of the <span class="string">"minikube"</span> cluster.</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;先吐槽一下K8S的官网，一个搞技术的，非得被逼成这样，这tm都是什么氛围！&lt;/p&gt;
&lt;p&gt;&lt;img src= &quot;img/loading.gif&quot; data-src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEs
      
    
    </summary>
    
    
      <category term="容器" scheme="https://archks.github.io/categories/%E5%AE%B9%E5%99%A8/"/>
    
    
  </entry>
  
  <entry>
    <title>宿主机设置操作容器的定时任务无效</title>
    <link href="https://archks.github.io/2020/07/11/Docker-Err1/"/>
    <id>https://archks.github.io/2020/07/11/Docker-Err1/</id>
    <published>2020-07-11T08:26:21.000Z</published>
    <updated>2020-07-10T17:34:00.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看定时任务</span></span><br><span class="line">[root@ ~]<span class="comment"># crontab -l</span></span><br><span class="line">0 */1 * * * sh /data/cront/wx_sgin.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行的脚本</span></span><br><span class="line">[root@ ~]<span class="comment"># cat /data/cront/wx_sgin.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mys /bin/bash -c <span class="string">'python3 /data/wx_sign.py'</span> </span><br><span class="line">docker cp mys:/img/SignInResult.png /data/<span class="built_in">log</span>/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 该脚本执行完之后，会在/data/log/下生成一张图片，但是并没有看到图片，可见定时任务没有执行</span></span><br><span class="line"><span class="comment"># 查看/var/spool/mail/root，发现如下报错</span></span><br></pre></td></tr></table></figure><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/11/UllSBR.png" alt="UllSBR.png" style="zoom:50%;" /><p>具体原因出在这条命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it mys /bin/bash -c <span class="string">'python3 /data/wx_sign.py'</span></span><br></pre></td></tr></table></figure><p>脚本操纵docker容器不可以是TTY(交互模式)，修改如下：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -i mys /bin/bash -c <span class="string">'python3 /data/wx_sign.py'</span></span><br></pre></td></tr></table></figure><p>把-t参数去掉即可。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@ ~]<span class="comment"># docker exec --help</span></span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -d, --detach               Detached mode: run <span class="built_in">command</span> <span class="keyword">in</span> the background</span><br><span class="line">      --detach-keys string   Override the key sequence <span class="keyword">for</span> detaching a container</span><br><span class="line">  -e, --env list             Set environment variables (default [])</span><br><span class="line">      --<span class="built_in">help</span>                 Print usage</span><br><span class="line">  -i, --interactive          Keep STDIN open even <span class="keyword">if</span> not attached</span><br><span class="line">      --privileged           Give extended privileges to the <span class="built_in">command</span></span><br><span class="line">  -t, --tty                  Allocate a pseudo-TTY</span><br><span class="line">  -u, --user string          Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看定时任务&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span cla
      
    
    </summary>
    
    
      <category term="报错" scheme="https://archks.github.io/categories/%E6%8A%A5%E9%94%99/"/>
    
    
  </entry>
  
  <entry>
    <title>Django3.0.8访问url报错Forbidden(CSRF Cookie Not Set)</title>
    <link href="https://archks.github.io/2020/07/11/Django-Err2/"/>
    <id>https://archks.github.io/2020/07/11/Django-Err2/</id>
    <published>2020-07-11T08:13:50.000Z</published>
    <updated>2020-07-10T17:24:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>修该settings.py文件，注释其中关于CSRF防御机制：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">'django.middleware.security.SecurityMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.middleware.common.CommonMiddleware'</span>,</span><br><span class="line">     <span class="comment">#'django.middleware.csrf.CsrfViewMiddleware',</span></span><br><span class="line">    <span class="string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages.middleware.MessageMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>Middleware是Django请求/响应处理的插件框架。它是一个轻巧的低级”插件”系统，用于全局改变Django的输入或输出，每个中间件组件负责执行某些特定功能。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;修该settings.py文件，注释其中关于CSRF防御机制：&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;MIDDLEWARE = [&lt;/
      
    
    </summary>
    
    
      <category term="报错" scheme="https://archks.github.io/categories/%E6%8A%A5%E9%94%99/"/>
    
    
  </entry>
  
  <entry>
    <title>【摘文】月亮与六便士</title>
    <link href="https://archks.github.io/2020/07/11/%E6%9C%88%E4%BA%AE%E4%B8%8E%E5%85%AD%E4%BE%BF%E5%A3%AB/"/>
    <id>https://archks.github.io/2020/07/11/%E6%9C%88%E4%BA%AE%E4%B8%8E%E5%85%AD%E4%BE%BF%E5%A3%AB/</id>
    <published>2020-07-11T04:03:15.000Z</published>
    <updated>2020-07-10T13:04:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>我认为有些人诞生在某个地方，他们会认为那不是自己心甘情愿的。只是一个偶然的原因，自己被随便扔到某个地方，某种环境下，而他们却一直梦想着某个连自己都不清楚的地方，好像那才是他的故乡。在出生的地方他们像过客；从孩提时就熟悉的绿树成荫的原野，同小伙伴一起玩耍的街巷小道，对他们不过是旅途中的一个驿站。这种人在自己亲友中可能终生郁郁寡欢，在他们唯一熟悉的环境里也始终孑然一身。也许正是对乡土的生疏使得他们远走他乡，寻找一处可以永恒定居的寓所。说不定在他们内心深处仍然隐伏着多少世代前祖的习性和癖好，引导他们回到他们祖先在远古时期就已经离开的故土。有时候一个人偶然到了一个地方，会神秘地感觉到这正是自己栖身之所，是他一直寻找的家园。于是他就在那个似曾相识的环境下，在那些素未谋面的人中找到了归属感，留了下来。倒像是这里的一切才是她从小就熟悉的一样。他在这里终于找到了宁静。</p><p>一般来说，爱情对于男人来说不过是插曲，是日常生活中许多事物中的一件，但是小说却把爱情夸大了，给了他违反生活真实性的重要地位。尽管少数男人把爱情当作头等大事，但这些人常常是一些毫无情趣的家伙；即便那些把爱情当成生活的女人，也不太看得起这类男人。女人会被这样的男人吸引，会被他们奉承的心花怒放，但心里却不会有安全感——这些人是种可怜的生物。男人们即使在恋爱的短暂期间，也不停的去干些别的事以分散精力：首先他们得赚钱；其次他们还会沉湎于体育活动；最后还可能对艺术感兴趣。大多数情况下，他们会把自己不同的活动在时空里间隔开来，在进行一种活动时，暂时把另一种放下。男人们有专心致志于正在从事的活动的专注力；如果一种活动受到另一种影响，他们会非常恼火。至于坠入情网的男人于女人的区别是：女人能整天整夜谈恋爱，而男人却只能有时有晌的顾及一下它。</p><p>女人可以原谅男人对他的伤害，但永远不能原谅男人对她做出的牺牲。</p><p>布兰奇·施特勒夫的行为我容易解释，我认为她做出那种事来只不过是屈服于肉体的诱惑。现在回想起来，他对自己丈夫从来就没有真正的感情，我认为她对施特勒夫的情感，只是因为施特勒夫能提供她所需要的关爱与舒适安定的生活。那应该是一种本能地回应，大多数女人都把自己这种回应误以为是爱情。这其实是一种可以对任何一个人产生被动的感情，正像藤曼一样随便攀附在哪棵树上。这种感情可以让一个女孩子嫁给任何一个需要她，并能满足她所需要的东西的男人，也许时间久了也会对这个男人产生爱情，所以人们认为这种情感的力量，把它跟真正的爱情混为一谈。但这种情感究竟是什么呢？它只不过是安全感，对安定保障生活的本能需求，还有就是虚荣心，丰富的物质生活能带来满足感、荣誉感以及他人的认可；女人们禀性善良、喜爱虚荣，认为这种感情一样富于精神价值。但在冲动的热情面前，这种感情毫无防卫能力。</p><p>“如果他生活真的贫困不堪，我还是准备帮帮他。我会给你寄笔钱去，在他需要时，你可以一点一点给他。”但我知道她答应这件事并不是出于善心。有人说不幸可以使人性变得高贵，这句话并不总对；使人变得高尚的有时候反而是幸福，不幸在大多数情况下只会使人心胸狭隘，报复心强。</p><p>正是这点使我狼狈。有人也说过自己不在乎别人的看法。但多半是自欺欺人。一般来说他们能够自行其是都是因为相信别人不理解自己那些怪异的想法。最甚者也是因为有几个好友知交表示支持才敢不顾大多数人的意见。一个人如果做一些违背传统的事儿，而事实上这是他所属那个群体的常态的话，人们对此也就不会觉得不可思议。相反，这个人还会为此洋洋自得，因为它既可以标榜自己有足够的勇气，又不至冒太大的风险。我觉得渴望得到他人的认可，是人类文明的天性。一个做出来有悖传统的事的女人，招致大众的非议后，再没有谁会比她还快的跑到尊严体面那里寻求庇护。</p><p>我是绝对不相信那些说自己不在乎他人说什么的人，这不过是一种虚张声势。他们的意思是，他们相信别人，根本不会发现自己那些小的过错，就算是被指责一下也不会造成什么太大的损失。</p><p>家庭的生活，心里不无艳羡。这家人感情似乎 非常融洽，经常说一些外人无从理解的小笑话，然后自顾自地笑得要命。由这点我想到了查理斯·斯特里克兰先生。他不善言辞，也不是很聪明，但在他自己那个环境下，他的智慧应付起来还是绰绰有余，这不仅是事业成功的保证，也是生活幸福的保障。斯特里克兰太太是个招人喜爱的女人，她很爱她的丈夫。我想这对夫妻的生活，如果不受任何干扰，诚实、体面，两个孩子中规中矩，正在健康成长着;而不知不觉间，他俩会慢慢变老，儿女逐渐长大成人，一个出息成美丽的姑娘，将来会结婚生子;另一个则成为仪表堂堂的男子汉，很可能会成为一名军人。最后这对夫妻告老引退，子孙绕膝，过着富足、体面的晚年生活。他们会尽享天年，安详度过一生。这是世间无数对夫妻的故事。这种生活有着一种和谐安静的美，使人想到一条平静的小河，蜿蜒流过绿草茵茵的田野、牧场，流过河岸边郁郁的树荫，最后汇人浩瀚的大海;可大海是如此平静，如此沉默，我突然有了某种无法名状的不安，某种失落。这也许只是我自己的感触(这种感触在那时那些日子里，经常出现在我心里)，我总觉得人这样度过一生似乎缺点什么。</p><p>我不否认所看到的这种生活的社会价值，也看到了它井然有序的幸福。但我血液里却有种强烈的躁动，某种对未知世界的渴望。这种宁静安详的生活，让我不时会产生焦虑与恐惧。我渴望改变，无论怎样的改变，只要不是这样按部就班地活着就行。为此，我愿意面对任何的艰险。——（妻离子散，家破人亡）</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;我认为有些人诞生在某个地方，他们会认为那不是自己心甘情愿的。只是一个偶然的原因，自己被随便扔到某个地方，某种环境下，而他们却一直梦想着某个连自己都不清楚的地方，好像那才是他的故乡。在出生的地方他们像过客；从孩提时就熟悉的绿树成荫的原野，同小伙伴一起玩耍的街巷小道，对他们不过
      
    
    </summary>
    
    
      <category term="摘录" scheme="https://archks.github.io/categories/%E6%91%98%E5%BD%95/"/>
    
    
  </entry>
  
  <entry>
    <title>【摘文】追风筝的人</title>
    <link href="https://archks.github.io/2020/07/11/%E8%BF%BD%E9%A3%8E%E7%AD%9D%E7%9A%84%E4%BA%BA/"/>
    <id>https://archks.github.io/2020/07/11/%E8%BF%BD%E9%A3%8E%E7%AD%9D%E7%9A%84%E4%BA%BA/</id>
    <published>2020-07-11T04:01:49.000Z</published>
    <updated>2020-07-10T13:04:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>最后一批哀悼者已经致哀完毕，清真寺人去楼空，只有那个毛拉在收起麦克风，用一块绿布裹起《古兰经》。将军和我走进黄昏的阳光中，我们走下台阶，走过一群吸烟的男人。我零星听到他们的谈话，下个周末在尤宁有场足球赛，圣克拉拉新开了一家阿富汗餐厅，生活已然前进，留爸爸在了后面。</p><p> 有那么一阵，即使癌症也没能阻止爸爸到跳蚤市场去，我们仍搜罗各处车库市场，爸爸当司机，我指路，并且在星期天摆摊。爸爸和那个古老国家的人互致问候，我和顾客为一两块钱讨价还价。仿佛一切如常，仿佛我成为孤儿的日子并没有随着每次收摊渐渐逼近。</p><p> 想着她锁骨上方那美丽的凹陷，我在脑海里一遍又一遍回放着我们的对话。她说的是:“听说你是个作家”还是“我听说你写作”</p><p>“我知道美国给你输入了乐观的性子，这也是她了不起的地方。那非常好，我们是忧郁的民族，我们阿富汗人，对吧?我们总是陷在悲伤和自恋中，我们在失败，灾难面前屈服，将这些当成生活的实质，甚至为必须，我们总是说生活会继续的。”</p><p>我成为今天的我，是在1975年某个阴云密布的寒冷冬日，那年我十二岁。我清楚的记得当时自己趴在一度坍塌的泥墙后面，窥探着那条小巷，旁边是结冰的小溪。许多年过去了，人们说陈年旧事可以被埋葬，然而我终于明白这是错的，因为往事会自行爬上来。回首前尘，我意识到在过去的二十六年里，自己始终在窥视着荒芜的巷子。</p><p>“现在，不管那个毛拉怎么说，罪行只有一种，那就是盗窃，其他罪行都是盗窃的变种。”“当你说谎，你就偷走别人知道真相的权利，当你诈骗，你偷走公平的权利。”</p><p>无关乎这些事情，因为历史不会轻易改变，宗教也是。最终，我是普什图人，他是哈扎拉人，我是逊尼派，他是什叶派，这些没有什么能改变，没有。<br>但我们是一起蹒跚学步的孩子，这点也没有任何历史、种族、社会或者宗教能改变得了。十二岁以前，我大部分时间都在根哈桑玩耍，有时候回想起来，我的整个童年，似乎就是和哈桑一起度过的某个懒洋洋的悠长夏日，我们在爸爸院子里那些交错的树木中彼此追逐，玩捉迷藏，玩警察与强盗，玩牛仔和印第安人，折磨昆虫，这带给我们无与伦比的快乐。</p><p>那儿有再次成为好人的路。我抬眼看看那比翼齐飞的风筝。我忆起哈桑，我缅怀爸爸。我想到阿里。我思念喀布尔。我想起曾经的生活，想起1975年那个改变了一切的冬天。那造就了今天的我。</p><p>我看着窗外的雨水，像是熔化了的白银。</p><p>那天早些时候，我确信无人注意，做了一件二十六年前就已经做过的事情，将一把皱皱的钞票塞在草席下面。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;最后一批哀悼者已经致哀完毕，清真寺人去楼空，只有那个毛拉在收起麦克风，用一块绿布裹起《古兰经》。将军和我走进黄昏的阳光中，我们走下台阶，走过一群吸烟的男人。我零星听到他们的谈话，下个周末在尤宁有场足球赛，圣克拉拉新开了一家阿富汗餐厅，生活已然前进，留爸爸在了后面。&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="摘录" scheme="https://archks.github.io/categories/%E6%91%98%E5%BD%95/"/>
    
    
  </entry>
  
  <entry>
    <title>【摘文】人间失格</title>
    <link href="https://archks.github.io/2020/07/11/%E4%BA%BA%E9%97%B4%E5%A4%B1%E6%A0%BC/"/>
    <id>https://archks.github.io/2020/07/11/%E4%BA%BA%E9%97%B4%E5%A4%B1%E6%A0%BC/</id>
    <published>2020-07-11T04:00:21.000Z</published>
    <updated>2020-07-10T13:04:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>作者背景：<br>昭和6年，太宰治与初代同居，后又开始从事共产主义运动，为此几次搬家，在此期间，他发现自己一直信任的妻子在认识他之前早己与人有染，内心受到极大的打击，于是，他去青森警察署自首，为自己的共产主义革命生涯划上了句号。昭和10年，太宰治在镰仓山企图自缢未果。<br>自缢事件之后，太宰治患上盲肠炎，因治疗中大量使用镇痛药而上瘾，不得不入院治疗了三个月之久，其间因其没有按时交纳学费被东京大学开除学籍。出院后不久，因镇痛剂注射上瘾，不惜举债买药，生活陷入了混乱之中。昭和11年10月，在亲朋好友的劝说和哄骗之下住进精神病院，这次入院经历成为他一生都无法释怀的经历，也成为写作《人间失格》的原动力。</p><p>太宰治，日本“无赖派”文学代表作家，与川端康成、三岛由纪夫并称战后文学的巅峰人物。出生于富<br>豪之家，本名津岛修治。中学期间，开始创作小说、杂文、戏剧，对泉镜花、芥川龙之介的作品相当倾倒。芥川的自杀对他产生了相当大的冲击与影响。一九三〇年，进入东大法文科，初会井伏鳟二，奉为终生之师。同年他以资金援助的形式参与了日本共产党的重建工作，两年后与左翼活动脱离关系。一九三五年凭借《逆行》入围第一届芥川奖。他的很多重要作品，如《东京八景》、《小丑之花》、《晚年》、《斜阳》、《人间失格》等，多为自我生活的写照，表现日本社会与现代人精神与感官世界的双重萎靡。太宰治曾多次自杀未遂，最终在三十九岁时与最后一位爱人相约投水自尽。 [2] </p><p>《人间失格》<br>内容摘要：<br>俗话说：“金钱散尽，情缘两断”。其实人们对于这句话的解释是颠倒的。并不是说男人的钱一用光，就会被女人甩掉。而是说男人一旦没有钱，就会意志消沉，变得颓废窝囊，连笑的力气都没有。性格也开始扭曲，最终破罐子破摔，主动甩掉女人。</p><p>我的想法：<br>主角大庭叶藏，生于惶惶不安之中，讨好他人，表面做一些滑稽之事，是为了掩藏内心的恐惧和不安。这种不安恐惧出自对其他人的不信任，无论是对于他的朋友家庭还是亲人。他长得俊美，但整日酗酒，对于女人，抱着可有可无的态度。他不会直接去拒绝一个女人，而是用自己独特的滑稽手段，去敷衍去奉承。<br>看完这篇手札，不想再娱乐自己了，看着叶藏用自己滑稽去逗乐其他人，把他们逗得捧腹大笑，而自己却惶惶不安，不禁想这样是为了什么。人生在世，一本正经的活着，不苟言笑，谨言慎行；亦或是逗逼气质十足，弄些恶心的言语色情的言语，找人世中微不足道的存在感，沦为别人眼中的笑柄。</p><p>读书摘录：<br>我自幼体弱多病，长期卧床在铺。躺在床上，我笃定地认为这些床单，枕头套、被套都是单调乏味的装饰品。将满二十岁时，才得知这些竟也都是实用品。颇感意外，对于人活于世的简朴，不禁悲从中来。</p><p>百度书评：<br>一个封闭在自己世界里的主人公。<br>书中的主人公叶藏既不能理解女人心的浅薄，也不断被朋友利用，却认为妥协退让才是活下去的方法，甚至为了混迹世间，学习人性的种种卑劣。第一手札描写的三张照片可说是其一生的缩影。从强颜欢笑到矫饰轻薄，最后是而无表情的“死相”，正是叶藏极力迎合社会却最终失败的一生。叙述者“我”对三张照片的评价毫不客气—古怪，令人生厌。这无疑是站在社会一般人的角度去评价叶藏；也可以说是太宰治分裂出来一个“正常”的人格来痛斥自己。这种自虐式的叙述却很难读出讽刺的意味，反倒情真意切得令人同情。接下来的第二手札则是叶藏对自己“罪孽”的陈述。幼年叶藏的本性曾与人类最丑恶的七宗罪之一—欺骗发生了第一次冲击。父亲的演讲会上，男佣们背地里批评演讲枯燥无味，一转身又为了讨好主人而赞不绝口。叶藏口睹了这一“可恨罪想”，为人类在生活中表现出来的心口不一而惊异，同时又认为这必是活下去的“妙谛”。他是个与常识社会格格不入的“外人”，故而他对人类种种常态的评述就显得分外客观有力。</p><p>Goodby<br>田岛想要离开自己的十个情人，与自己将要从乡下来到城市的妻子同居安分守己的日子。但无奈自己过于软弱，不想在告别情人的同时伤害他们，于是就让绢子打扮起来，让那些情人自己察觉。无奈绢子过分贪财，而且嗓门又像乌鸦。处处占小便宜，自己不舍得花钱，却很喜欢用别人的钱，田岛请客的时候，她恨不得吃撑死。如此一个道德品质低劣的女人，然后就没有然后了。<br>个人十分不喜绢子的设定。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;作者背景：&lt;br&gt;昭和6年，太宰治与初代同居，后又开始从事共产主义运动，为此几次搬家，在此期间，他发现自己一直信任的妻子在认识他之前早己与人有染，内心受到极大的打击，于是，他去青森警察署自首，为自己的共产主义革命生涯划上了句号。昭和10年，太宰治在镰仓山企图自缢未果。&lt;br
      
    
    </summary>
    
    
      <category term="摘录" scheme="https://archks.github.io/categories/%E6%91%98%E5%BD%95/"/>
    
    
  </entry>
  
  <entry>
    <title>解决Hexo+Github网络图片无法加载问题</title>
    <link href="https://archks.github.io/2020/07/08/%E8%A7%A3%E5%86%B3Hexo-Github%E7%BD%91%E7%BB%9C%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E5%8A%A0%E8%BD%BD%E9%97%AE%E9%A2%98/"/>
    <id>https://archks.github.io/2020/07/08/%E8%A7%A3%E5%86%B3Hexo-Github%E7%BD%91%E7%BB%9C%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E5%8A%A0%E8%BD%BD%E9%97%AE%E9%A2%98/</id>
    <published>2020-07-08T05:03:47.000Z</published>
    <updated>2020-07-07T14:14:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>如下图是我将Hexo搬到Github上时，网络图片加载不出来的情况，图片链接是完好的：</p><img no-lazy src= "img/loading.gif" data-src="https://s1.ax1x.com/2020/07/08/UEzfJI.png" alt="UEzfJI.png"  /><p>解决方法：</p><blockquote><p><a href="https://github.com/Troy-Yang/hexo-lazyload-image" target="_blank" rel="noopener">https://github.com/Troy-Yang/hexo-lazyload-image</a></p></blockquote><p>1、安装hexo-lazyload-image</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-lazyload-image --save</span><br></pre></td></tr></table></figure><p>2、修改project里的主_config.yml配置</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lazyload:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  onlypost: <span class="literal">false</span> <span class="comment"># optional</span></span><br><span class="line">  loadingImg: <span class="comment"># optional eg ./images/loading.gif</span></span><br><span class="line">  isSPA: <span class="literal">false</span> <span class="comment"># optional</span></span><br></pre></td></tr></table></figure><p>3、设置图片样式，只需要设置一个图片样式</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;img no-lazy src=<span class="string">"abc.png"</span> /&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;如下图是我将Hexo搬到Github上时，网络图片加载不出来的情况，图片链接是完好的：&lt;/p&gt;
&lt;img no-lazy src= &quot;img/loading.gif&quot; data-src=&quot;https://s1.ax1x.com/2020/07/08/UEzfJI.png&quot; 
      
    
    </summary>
    
    
      <category term="报错" scheme="https://archks.github.io/categories/%E6%8A%A5%E9%94%99/"/>
    
    
  </entry>
  
  <entry>
    <title>Docker中Django迁移无效</title>
    <link href="https://archks.github.io/2020/07/08/Django-Err1/"/>
    <id>https://archks.github.io/2020/07/08/Django-Err1/</id>
    <published>2020-07-08T02:12:54.000Z</published>
    <updated>2020-07-07T14:02:20.000Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">django-admin startproject project</span><br><span class="line">cd project</span><br><span class="line">python manage.py startapp api</span><br></pre></td></tr></table></figure><p>可以看到，虽然执行了<code>python manage.py makemigrations</code>，但是models.py中定义的模型并没有迁移到数据库中，网上找了很久，发现是要再后面加上APP名，即<code>python manage.py makemigrations api</code></p><hr><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/08/UERPOO.png" alt="UERPOO.png"></p><img no-lazy src= "img/loading.gif" data-src="https://s1.ax1x.com/2020/07/08/UE26Qf.png" alt="UE26Qf.png"  /><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/08/UE2bOU.png" alt="UE2bOU.png"></p><hr><p>我的文件目录是这样的：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[root@ project]<span class="comment"># tree -L 2</span></span><br><span class="line">.</span><br><span class="line">├── api</span><br><span class="line">│   ├── admin.py</span><br><span class="line">│   ├── apps.py</span><br><span class="line">│   ├── __init__.py</span><br><span class="line">│   ├── migrations</span><br><span class="line">│   ├── models.py</span><br><span class="line">│   ├── __pycache__</span><br><span class="line">│   ├── tests.py</span><br><span class="line">│   ├── urls.py</span><br><span class="line">│   └── views.py</span><br><span class="line">├── manage.py</span><br><span class="line">└── project</span><br><span class="line">    ├── asgi.py</span><br><span class="line">    ├── __init__.py</span><br><span class="line">    ├── __pycache__</span><br><span class="line">    ├── settings.py</span><br><span class="line">    ├── urls.py</span><br><span class="line">    └── wsgi.p</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;django-a
      
    
    </summary>
    
    
      <category term="报错" scheme="https://archks.github.io/categories/%E6%8A%A5%E9%94%99/"/>
    
    
  </entry>
  
  <entry>
    <title>SSH——用户密钥未在远程主机注册</title>
    <link href="https://archks.github.io/2020/07/06/SSH%E2%80%94%E7%94%A8%E6%88%B7%E5%AF%86%E9%92%A5%E6%9C%AA%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E6%B3%A8%E5%86%8C/"/>
    <id>https://archks.github.io/2020/07/06/SSH%E2%80%94%E7%94%A8%E6%88%B7%E5%AF%86%E9%92%A5%E6%9C%AA%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%B8%BB%E6%9C%BA%E6%B3%A8%E5%86%8C/</id>
    <published>2020-07-06T03:43:16.000Z</published>
    <updated>2020-07-05T12:57:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>如图：</p><div align="center"><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/07/06/UCaFDe.png" style="zoom:33%;" /></div><p>刚开始以为是上传的公钥不对，结果生成了几次公钥，发现还是老样子。后来去检查<code>/etc/ssh/sshd_config</code>配置文件，没检查出什么问题，于是从其他主机（能用私钥登录的主机）上复制了SSH的配置文件到本故障主机，然后重启SSHD服务，再用私钥连接，还是出现以上问题！</p><p>查看<code>/var/log/secure</code>日志文件：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Authentication refused: bad ownership or modes <span class="keyword">for</span> file /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>发现是权限不匹配的问题</p><p>解决：</p><blockquote><p><a href="https://www.bo56.com/ssh%E5%85%8D%E5%AF%86%E7%A0%81%E7%99%BB%E9%99%86%E8%AE%BE%E7%BD%AE%E6%97%B6authentication-refused-bad-ownership-or-modes%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" target="_blank" rel="noopener">https://www.bo56.com/ssh%E5%85%8D%E5%AF%86%E7%A0%81%E7%99%BB%E9%99%86%E8%AE%BE%E7%BD%AE%E6%97%B6authentication-refused-bad-ownership-or-modes%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</a></p></blockquote><p>sshd为了安全，对属主的目录和文件权限有所要求。如果权限不对，则ssh的免密码登陆不生效。<br>用户目录权限为 755 或者 700，就是不能是77x。<br>.ssh目录权限一般为755或者700。<br>rsa_id.pub 及authorized_keys权限一般为644<br>rsa_id权限必须为600</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;如图：&lt;/p&gt;
&lt;div align=&quot;center&quot;&gt;
&lt;img src= &quot;img/loading.gif&quot; data-src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAA
      
    
    </summary>
    
    
      <category term="报错" scheme="https://archks.github.io/categories/%E6%8A%A5%E9%94%99/"/>
    
    
  </entry>
  
  <entry>
    <title>Dockerfile制作Nginx容器</title>
    <link href="https://archks.github.io/2020/06/29/Produce-the-docker-image-about-nginx/"/>
    <id>https://archks.github.io/2020/06/29/Produce-the-docker-image-about-nginx/</id>
    <published>2020-06-29T02:59:50.000Z</published>
    <updated>2020-07-07T14:08:22.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>念两句诗<br>飞絮飞花何处是，层冰积雪摧残，疏疏一树五更寒。爱他明月好，憔悴也相关。<br>最是繁丝摇落后，转教人忆春山。湔裙梦断续应难。西风多少恨，吹不散眉弯。</p></blockquote><a id="more"></a><h1 id="困难"><a href="#困难" class="headerlink" title="困难"></a>困难</h1><ul><li><input checked="" disabled="" type="checkbox"> 容器启动流程</li><li><input checked="" disabled="" type="checkbox"> Sed替换等命令</li><li><input checked="" disabled="" type="checkbox"> CMD和EntryPoint的异同</li><li><input checked="" disabled="" type="checkbox"> 动态指定全局、局部参数</li><li><input checked="" disabled="" type="checkbox"> 优化哪些方面</li><li><input disabled="" type="checkbox"> 脚本能够正确的读取参数，且正确的写入到配置文件!!!</li></ul><h1 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h1><p>Docker镜像制作/容器运行<br>1、制作一个Nginx镜像，遵循镜像可迁移、可复制原则、镜像、层级、体积最小化原则<br>2、要求启动能支持指定Nginx进程的监听端口<br>3、首页输出一个hello world<br>4、容器支持开机启动、异常能自拉起<br>5、能够任意指定Nginx的公共参数，包括global、http等全局模块的参数；<br>6、通过启动指定Nginx优化参数，实现首页性能并发超2万（4核服务器）。</p><h1 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h1><h2 id="1、制作Nginx容器？"><a href="#1、制作Nginx容器？" class="headerlink" title="1、制作Nginx容器？"></a>1、制作Nginx容器？</h2><p>一开始的时候，以为是要从CentOS7中一步一步用命令安装Nginx，后来发现这样不太合理[中间层不够精简]，就用了Nginx的官方镜像。</p><h2 id="2、动态指定参数"><a href="#2、动态指定参数" class="headerlink" title="2、动态指定参数?"></a>2、动态指定参数?</h2><p>方法一：模板！<br>如果想要修改端口，那么就必须在Nginx服务起来之前改才有效(了解Docker容器启动流程对完成这一步很有帮助，下面会讲到Docker启动流程)。Nginx官方的template支持该端口，在宿主机编写nginx.conf.template模板，然后复制到容器的/etc/nginx/tempalte/目录，容器会自动把template模板语法填入变量，然后生成conf配置文件且放到容器的/etc/nginx/conf.d/</p><p>方法二：脚本！<br>脚本必须是容器启动时执行的脚本，一般就是EntryPoint的执行脚本。通过在<code>docker run -e ENV=XXX</code>的时候指明环境变量，然后再脚本中调用环境变量，通过sed替换配置文件，然后启动nginx，来达到修改端口，这种方法也可以修改Nginx的其他参数。</p><h2 id="3、Nginx优化？"><a href="#3、Nginx优化？" class="headerlink" title="3、Nginx优化？"></a>3、Nginx优化？</h2><h3 id="维度1：网络"><a href="#维度1：网络" class="headerlink" title="维度1：网络"></a>维度1：网络</h3><ul><li><input checked="" disabled="" type="checkbox"> 提高连接数</li><li><input checked="" disabled="" type="checkbox"> 选择响应模型</li><li><input disabled="" type="checkbox"> Gzip</li><li><input checked="" disabled="" type="checkbox"> sendfile</li><li><input checked="" disabled="" type="checkbox"> tcp_nopush</li></ul><p><strong>（1）提高连接并发</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">worker_processes  # Nginx进程</span><br><span class="line">worker_connections # 每个进程的最大连接数</span><br></pre></td></tr></table></figure><blockquote><p>官方建议Nignx进程数目和CPU核心数相同， 这样可以减少上下文切换带来的消耗，但是Nginx接受响应的机制是：当有一个请求过来时，先抢到的worker就处理这个请求，也就意味着，worker数量越多，Nginx并发就越高，同时需要考虑进程切换带来的损耗，把上下文切换损耗、Worker进程并发维持在一个合理的值？</p></blockquote><p>CPU数量为2<br>先设置Worker数量为2，查看并发：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@cmd ~]<span class="comment"># for i in &#123;1..3&#125;;do ./hey -c 20000 -z 5s http://localhost:8080 | grep Request; done</span></span><br><span class="line">  Requests/sec:18919.2902</span><br><span class="line">  Requests/sec:20607.1078</span><br><span class="line">  Requests/sec:21383.8651</span><br></pre></td></tr></table></figure><p>设置Worker数量为4，查看并发：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@cmd ~]# for i in &#123;1..3&#125;;do ./hey -c 20000 -z 5s http://localhost:8080 | grep Request; done</span><br><span class="line">  Requests/sec:20987.5554</span><br><span class="line">  Requests/sec:20566.2954</span><br><span class="line">  Requests/sec:21486.3096</span><br></pre></td></tr></table></figure><p>设置Worker数量为8，查看并发：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@cmd ~]# for i in &#123;1..3&#125;;do ./hey -c 20000 -z 5s http://localhost:8080 | grep Request; done</span><br><span class="line">  Requests/sec:18960.3266</span><br><span class="line">  Requests/sec:19998.3097</span><br><span class="line">  Requests/sec:19924.4970</span><br></pre></td></tr></table></figure><blockquote><p>可见适当提高Worker的数量确实可以提高并发，但是并不明显，而且如果Worker数量过多，甚至会减少并发。</p></blockquote><br><p><strong>（2）改变请求响应机制</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">events&#123;</span><br><span class="line">    use epoll;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p><strong>（3）Gzip相关</strong><br>原本打算开Gzip的，这个对大文件有效，但是对于小文件，开了Gzip反而会消耗CPU资源[当然这个消耗也很小]，会得不偿失。</p><br><p><strong>（4）零拷贝</strong></p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sendfile</span> <span class="literal">on</span>;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-zerocopy2/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/l-cn-zerocopy2/index.html</a><br>可以直接在内核中完成文件传输<br>如果应用程序可以直接访问网络接口存储，那么在应用程序访问数据之前存储总线就不需要被遍历，数据传输所引起的开销将会是最小的。应用程序或者运行在用户模式下的库函数可以直接访问硬件设备的存储，操作系统内核除了进行必要的虚拟存储配置工作之外，不参与数据传输过程中的其它任何事情。直接 I/O 使得数据可以直接在应用程序和外围设备之间进行传输，完全不需要操作系统内核页缓存的支持。</p></blockquote><br><p><strong>（5）Nopush</strong><br>这个选项Nginx默认关闭，我们选择打开。在<code>sendfile</code>开启情况下，tcp_nopush可以提高网络包的<code>传输效率</code>，所有资源一起打包然后发送，但没有实时性。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcp_nopush on;</span><br></pre></td></tr></table></figure><br><br><h3 id="维度2：磁盘"><a href="#维度2：磁盘" class="headerlink" title="维度2：磁盘"></a>维度2：磁盘</h3><p><strong>（1）加缓存</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">proxy_cache_path /tmp/cache levels=1:2 keys_zone=code_cache:10m max_size=10g inactive=60m use_temp_path=off;</span><br></pre></td></tr></table></figure><p>还是2核CPU，2个Worker：【不加tcp_nopush】</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@cmd ~]# for i in &#123;1..3&#125;;do ./hey -c 30000 -z 5s http://127.0.0.1:80 | grep Request;done</span><br><span class="line">  Requests/sec:52213.8096</span><br><span class="line">  Requests/sec:53834.7774</span><br><span class="line">  Requests/sec:55434.2433</span><br></pre></td></tr></table></figure><p>可以看到加了缓存之后，并发涨了2.5倍。</p><br><p><strong>（2）减读写</strong><br>因为日志写入需要占用大量的IO，所以关闭了日志写入，如果不想做的太极端，可以调整写入级别，尽量只写入少量日志。</p><br><p><strong>（3）调整最大文件打开数目</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ulimit -n 65535</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 同时连接的数量受限于系统上可用的文件描述符的数量</span></span><br><span class="line">worker_rlimit_nofile  # 将此值增加到大于worker_processes * worker_connections的值</span><br></pre></td></tr></table></figure><br><h3 id="维度3：CPU"><a href="#维度3：CPU" class="headerlink" title="维度3：CPU"></a>维度3：CPU</h3><p>绑定Worker进程到指定CPU</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">worker_processes</span>  <span class="number">4</span>;         <span class="comment"># 4核CPU的配置</span></span><br><span class="line"><span class="attribute">worker_cpu_affinity</span> <span class="number">0001</span> <span class="number">0010</span> <span class="number">0100</span> <span class="number">1000</span>; <span class="comment"># 将每个Worker进程绑定到一个CPU</span></span><br></pre></td></tr></table></figure><p>作用不大！</p><br><hr><p><strong>总结</strong>：如果不加缓存，磁盘会成为瓶颈，加了缓存，CPU会成为瓶颈。</p><img no-lazy src= "img/loading.gif" data-src="https://s1.ax1x.com/2020/06/29/NflGTA.png" alt="宿主机资源占用"  /><center>[1,2 分别是两颗CPU]</center><h1 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h1><ul><li><input checked="" disabled="" type="checkbox"> Version 1 【镜像制作】</li><li><input checked="" disabled="" type="checkbox"> Version 2 【指定参数，优化并发】</li><li><input checked="" disabled="" type="checkbox"> Version 3 【指定参数，优化并发】</li><li><input checked="" disabled="" type="checkbox"> Version 4 【任意参数指定，进一步提升并发】</li></ul><hr><p><strong>Version 1</strong></p><ul><li><input checked="" disabled="" type="checkbox"> 制作Nginx镜像</li><li><input checked="" disabled="" type="checkbox"> 修改监听端口</li><li><input checked="" disabled="" type="checkbox"> 能正常访问</li><li><input disabled="" type="checkbox"> 指定任意参数</li><li><input disabled="" type="checkbox"> Nginx优化</li></ul><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/29/NW6z9K.png" alt="CentOS安装Nginx的Dockerfile"></p><p>为什么一开始注释掉了<code>CMD [&quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot;]</code> ———— 因为不注释就会导致容器拉起异常！原因是因为容器开机会执行docker-entrypoint脚本，然而我的EntryPoint脚本中并没有写”exec $@”，就不会把Nginx放到前台执行，导致了容器执行完脚本直接退出。刚开始用的解决办法是把Nginx进程直接写到check.sh中，通过EntryPoint执行，这样也能保证前台有Nginx任务，docker容器不至于异常退出。</p><blockquote><p>Docker容器进程需要放在前台执行，如果那么脚本执行完前台没有任务，那么容器会自动退出。<br>容器启动时会加载CMD命令，如果有EntryPoint，那么就加载EntryPoint，CMD作为参数传给EntryPoint。</p></blockquote><br><br><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/29/NWcwDJ.png" alt="容器中的健康检查脚本"></p><p>这个健康检查脚本应该没什么用，如果一号进程退出了，容器就挂了，给自己的健康检查也就做不了了，后来换成了再docker run的时候加上–restart=always参数，并且保证docker daemon能够开机自启。</p><br><br><hr><p><strong>Version 2</strong></p><ul><li><input checked="" disabled="" type="checkbox"> 尝试在命令行着替换部分参数，用的是容器内部读取环境变量的方法</li><li><input disabled="" type="checkbox"> 还是未能完成全部参数的动态指定</li><li><input disabled="" type="checkbox"> 优化了Nginx并发</li></ul><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/29/NWfU0g.png" alt="NWfU0g.png"></p><br><br><hr><p><strong>Version 3</strong></p><ul><li><input disabled="" type="checkbox"> 未能实现全部配置可自定义</li><li><input checked="" disabled="" type="checkbox"> 优化了Nginx并发</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@nginx ~ ]#cat start.sh   # &lt;====这是个容器开机启动脚本</span><br><span class="line">append()&#123;</span><br><span class="line">    echo "$&#123;1&#125;" &gt;&gt; /etc/nginx/nginx.conf</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rm /etc/nginx/nginx.conf -rf</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> WORK_PROGRESSES=4</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WORKER_CPU_AFFINITY=<span class="string">"0001 0010 0100 1000"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WORKER_RLIMIT_NOFILE=65535</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WORKER_CONNECTIONS=65535</span></span><br><span class="line"></span><br><span class="line">append  "user  nginx;"</span><br><span class="line">append  "worker_processes $&#123;WORK_PROGRESSES&#125;;"</span><br><span class="line">append  "worker_cpu_affinity $&#123;WORKER_CPU_AFFINITY&#125;;"</span><br><span class="line">append  "worker_rlimit_nofile $&#123;WORKER_RLIMIT_NOFILE&#125;;"</span><br><span class="line">append  "pid /var/run/nginx.pid;"</span><br><span class="line">append  "events &#123; use epoll; worker_connections $&#123;WORKER_CONNECTIONS&#125;;&#125;"</span><br><span class="line">append  "http &#123;"</span><br><span class="line">append  "include       /etc/nginx/mime.types;"</span><br><span class="line">append  "default_type  application/octet-stream;"</span><br><span class="line">append  "open_file_cache max=65535 inactive=60s;"</span><br><span class="line">append  " sendfile       on;"</span><br><span class="line">append  " tcp_nopush     on;"</span><br><span class="line">append  " tcp_nodelay     on;"</span><br><span class="line">append  " keepalive_timeout $&#123;KEEPALIVE_TIMEOUT&#125;;"</span><br><span class="line">append  " include /etc/nginx/conf.d/*.conf;"</span><br><span class="line">append  "&#125;"</span><br><span class="line">sed -i '0,/listen.*;/s/listen.*;/listen '$&#123;LISTEN&#125;';/' /etc/nginx/conf.d/default.conf</span><br><span class="line">exec "$@"</span><br></pre></td></tr></table></figure><p>直接把环境变量echo进nginx配置文件，这样写比sed简单，且能达到同样的效果。</p><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@nginx ~ ]# cat dockerfile</span><br><span class="line">FROM nginx:latest</span><br><span class="line">MAINTAINER zen &lt;2212585023@qq.com&gt;</span><br><span class="line">ENV NGINX_VERSION 1.19.1</span><br><span class="line">COPY ./index.html /usr/share/nginx/html/</span><br><span class="line">COPY ./start.sh /</span><br><span class="line">RUN chmod +x /start.sh</span><br><span class="line">STOPSIGNAL SIGTERM # 这个是kill -15 温柔的杀死容器里的1号进程</span><br><span class="line">EXPOSE 80</span><br><span class="line">ENTRYPOINT ["/start.sh"]</span><br><span class="line">CMD ["nginx", "-g", "daemon off;"]</span><br></pre></td></tr></table></figure><p>拉去Nginx镜像，复制HTML文件，复制开机启动脚本，需要注意的是，Nginx官方默认docker-entrypoint.d/目录下的脚本就是开机启动脚本，执行Nginx启动命令。</p><blockquote><p>关于 CMD [“nginx”,”-g”,”daemon off;”] 这个命令，刚开始我以为是在命令行执行nginx -g daemon off，但是在容器内，这条命始终执行不了，以至于我怀疑CMD到底是干什么？命令到底是怎么执行的？越搞越乱！后来发现这条命令执行还需要加一些符号，即Nginx -g “daemon off;” ，这个问题纠结了很久！</p></blockquote><br><p>运行方式</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -itd  \</span><br><span class="line"> -e WORK_PROGRESSES=2 \</span><br><span class="line"> -e WORKER_RLIMIT_NOFILE=65535 \</span><br><span class="line"> -e WORKER_CONNECTIONS=65535 \</span><br><span class="line"> -e KEEPALIVE_TIMEOUT=15 \</span><br><span class="line"> -e LISTEN=80\</span><br><span class="line"> --net=host --name x1 nginx/v1</span><br></pre></td></tr></table></figure><br><hr><p><strong>Version 4</strong></p><ul><li><input checked="" disabled="" type="checkbox"> 任意参数指定</li><li><input checked="" disabled="" type="checkbox"> 更高的并发</li></ul><p>先看结果，还是原来的两核CPU，实现了57000左右的并发</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@cmd ~]# for i in &#123;1..3&#125;;do ./hey -c 30000 -z 5s http://127.0.0.1:8080 | grep Requests;done</span><br><span class="line">  Requests/sec:58493.2355</span><br><span class="line">  Requests/sec:55574.4684</span><br><span class="line">  Requests/sec:56862.8460</span><br></pre></td></tr></table></figure><p>思路还是在启动容器的时候执行EntryPoint脚本修改Nginx参数，不同的地方在于将Nginx参数位置作为前缀，通过前缀指定参数插入的位置，比如</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Global   -- ngx_glo_worker_progress     相当于全局配置下的worker_progress</span><br><span class="line">Events   -- ngx_evt_worker_connections  相当于events中的worker_connections</span><br><span class="line">Http     -- ngx_http_sendfile           相当于http模块中的sendfile</span><br><span class="line">Server   -- ngx_ser_listen              相当于server模块中的listen</span><br><span class="line">Location -- ngx_loc_root                相当于location模块中的root</span><br></pre></td></tr></table></figure><br>通过case进行筛选，然后插入到nginx.conf配置文件的不同位置,脚本代码如下：<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">CONFIG_PATH=/etc/nginx/nginx.conf </span><br><span class="line"></span><br><span class="line">cat &gt;/etc/nginx/nginx.conf &lt;&lt; 'EOF'</span><br><span class="line">user nginx;</span><br><span class="line">pid /run/nginx.pid;</span><br><span class="line">include /usr/share/nginx/modules/*.conf;</span><br><span class="line">events &#123;</span><br><span class="line">    use epoll;</span><br><span class="line">    worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include             /etc/nginx/mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80 default_server;</span><br><span class="line">        server_name  _;</span><br><span class="line">        root         /usr/share/nginx/html;</span><br><span class="line">        include /etc/nginx/default.d/*.conf;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root /usr/share/nginx/html/;</span><br><span class="line">            add_header Nginx-Cache "$upstream_cache_status";</span><br><span class="line">            proxy_set_header Host $http_host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            include params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/nginx/params &lt;&lt; 'EOF'</span><br><span class="line">proxy_connect_timeout 30;</span><br><span class="line">proxy_send_timeout 60;</span><br><span class="line">proxy_read_timeout 60;</span><br><span class="line">proxy_buffer_size 32k;</span><br><span class="line">proxy_buffering on;</span><br><span class="line">proxy_buffers 4 128k;</span><br><span class="line">proxy_busy_buffers_size 256k;</span><br><span class="line">proxy_max_temp_file_size 256k;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 读出来的时候只有：ngx_http_proxy_cache_path=/tmp/cache</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 遗留Bug！！！</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 已有的替换 出现[include]会替换多个</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 没有的插入 [<span class="variable">$proxy_add_x_forwarded_for</span>] 没有测试能否插入变量，\<span class="variable">$xxx</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 用line循环可以避免中间有空行的变量：ngx_http_proxy_cache_path=/tmp/cache levels=1:2 keys_zone=code_cache:10m max_size=10g inactive=60m use_temp_path=off</span></span><br><span class="line">line=$(env | grep -E "^ngx" | wc -l)</span><br><span class="line">for i in `seq $line`;</span><br><span class="line">do</span><br><span class="line"><span class="meta">   #</span><span class="bash"> 这里将第一个<span class="string">'='</span>号替换为0x80是为了防止后面有相同的等号误操作，比如ngx_http_proxy_cache_path=/tmp/cache levels=1:2;这样的变量</span></span><br><span class="line">    one=$(env | grep -E "^ngx" | sed -n $&#123;i&#125;'p')</span><br><span class="line">    value=$(echo  "$&#123;one&#125;"  | sed 's/=/0x80/1' | awk -F '0x80' '&#123;print $2&#125;' )</span><br><span class="line">    field=$(echo  "$&#123;one&#125;"  | sed 's/=/0x80/1' | awk -F '0x80' '&#123;print $1&#125;' ) # field=前缀+后缀 </span><br><span class="line">    prefix=$(echo "$&#123;field&#125;"  | sed 's/_/ /2' | awk '&#123;print $1&#125;') # 前缀决定字段的位置 ngx_loc</span><br><span class="line">    suffix=$(echo "$&#123;field&#125;" | sed 's/_/ /2' | awk '&#123;print $2&#125;')  # 后缀决定什么字段 listen</span><br><span class="line"></span><br><span class="line">    glo_ins()&#123;</span><br><span class="line">        field=$&#123;1&#125;" "$&#123;2&#125;";"</span><br><span class="line">        if [[ -z $(grep "$1" $&#123;CONFIG_PATH&#125;) ]];then</span><br><span class="line">        # 由于出现过ngx_http_tcp_nopush会插入到proxy_set_header Host $http_host;下面，所有在sed侧加入了完全匹配\&lt;\&gt;</span><br><span class="line">            sed -i '/\&lt;events\&gt;/i '"$&#123;field&#125;" $&#123;CONFIG_PATH&#125;</span><br><span class="line">        else </span><br><span class="line">            sed -i '/\&lt;'"$&#123;1&#125;"'\&gt;/c '"$&#123;field&#125;" $&#123;CONFIG_PATH&#125;</span><br><span class="line">        fi</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    oth_insrt()&#123;</span><br><span class="line">        module="$&#123;1&#125;"</span><br><span class="line">        field="$&#123;2&#125; $&#123;3&#125;;"</span><br><span class="line">        if [[ -z $(grep "$2" $&#123;CONFIG_PATH&#125;) ]];then</span><br><span class="line">            sed -i '/\&lt;'"$&#123;module&#125;"'\&gt;/a '"$&#123;field&#125;"  $&#123;CONFIG_PATH&#125;</span><br><span class="line">        else </span><br><span class="line">            sed -i '/\&lt;'"$&#123;2&#125;"'\&gt;/c '"$&#123;field&#125;"  $&#123;CONFIG_PATH&#125;</span><br><span class="line">        fi</span><br><span class="line">    &#125;</span><br><span class="line">    # 主要逻辑如下：</span><br><span class="line">    case $&#123;prefix&#125; in</span><br><span class="line">    ngx_glo)</span><br><span class="line">        glo_ins "$suffix" "$value"</span><br><span class="line">        ;;</span><br><span class="line">    ngx_evt)</span><br><span class="line">        oth_insrt events "$suffix" "$value"</span><br><span class="line">        ;;</span><br><span class="line">    ngx_http)</span><br><span class="line">        oth_insrt http "$suffix" "$value"</span><br><span class="line">        ;;</span><br><span class="line">    ngx_ser)</span><br><span class="line">        oth_insrt server "$suffix" "$value"</span><br><span class="line">        ;;</span><br><span class="line">    ngx_loc)</span><br><span class="line">        oth_insrt location "$suffix" "$value"</span><br><span class="line">        ;;</span><br><span class="line">    esac</span><br><span class="line">done</span><br><span class="line">exec "$@"</span><br></pre></td></tr></table></figure><ul><li><input checked="" disabled="" type="checkbox"> &nbsp;&nbsp;Sed各种匹配替换</li><li><input checked="" disabled="" type="checkbox"> “${var}”所包含的是一个完整的变量，如果用${var}且变量为”x=1 y=2 z=3”,那么从环境变量里取出来的时候，往往只能取到x=1</li></ul><p>参数指定如下：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat run.sh </span></span><br><span class="line">docker rm $(docker ps -a | grep -E '\&lt;x1\&gt;' | awk '&#123;print $1&#125;') -f</span><br><span class="line">docker rmi $(docker image ls | grep 'nginx/v1' |awk '&#123;print $3&#125;')  --force</span><br><span class="line">docker build -t nginx/v1 .</span><br><span class="line">docker run -itd --cpuset-cpus="0,1" \</span><br><span class="line">-e ngx_glo_worker_processes=4 \</span><br><span class="line">-e ngx_glo_worker_rlimit_nofile=65535 \</span><br><span class="line">-e ngx_evt_worker_connections=65535 \</span><br><span class="line">-e ngx_http_tcp_nopush=on \</span><br><span class="line">-e ngx_http_sendfile=on \</span><br><span class="line">-e ngx_http_proxy_cache_path="/tmp/cache levels=1:2 keys_zone=code_cache:10m max_size=10g inactive=60m use_temp_path=off" \</span><br><span class="line">-e ngx_ser_listen=8080 \</span><br><span class="line">-e ngx_loc_proxy_cache=code_cache \</span><br><span class="line">-e ngx_loc_proxy_cache_valid="any 30m" \</span><br><span class="line">--net=host --name --restart=always x1 nginx/v1</span><br></pre></td></tr></table></figure><hr><br><br><br>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;念两句诗&lt;br&gt;飞絮飞花何处是，层冰积雪摧残，疏疏一树五更寒。爱他明月好，憔悴也相关。&lt;br&gt;最是繁丝摇落后，转教人忆春山。湔裙梦断续应难。西风多少恨，吹不散眉弯。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="容器" scheme="https://archks.github.io/categories/%E5%AE%B9%E5%99%A8/"/>
    
    
      <category term="Docker" scheme="https://archks.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>VsCode远程开发</title>
    <link href="https://archks.github.io/2020/06/18/VsCode_Remote_Config/"/>
    <id>https://archks.github.io/2020/06/18/VsCode_Remote_Config/</id>
    <published>2020-06-18T02:50:36.000Z</published>
    <updated>2020-07-04T02:18:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>念两句诗<br>草铺横野六七里，笛弄晚风三四声。<br>归来饱饭黄昏后，不脱蓑衣卧月明。</p></blockquote><a id="more"></a><p>Powershell下安装OpenSSH，安装失败也不要紧</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Get-WindowsCapability -Online | ? Name -like <span class="string">'OpenSSH*'</span></span><br><span class="line">Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0</span><br><span class="line">Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0</span><br></pre></td></tr></table></figure><p>1、下载插件：Remote Development</p><p>2、Ctrl+Shift+P打开设置Remote SSH Settings，设置Remote.SSH:Show Login Terminal为true</p><p><a href="https://imgchr.com/i/NeFgxO" target="_blank" rel="noopener"><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/18/NeFgxO.png" alt="NeFgxO.png"></a></p><p>3、左下角会多出来一个远程连接的图标，点击图标会弹出选择框，选择Connect to Host</p><p>4、选择一个Host，或者采用如下形式登录</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh root@x.x.x.x -A</span><br></pre></td></tr></table></figure><p>5、输入登录密码</p><p>6、添加远程文件夹</p><p>7、选择终端解释器，这里我选择了/bin/bash，Ctrl+Shift+` 新建终端</p><p><a href="https://imgchr.com/i/NeFcRK" target="_blank" rel="noopener"><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/18/NeFcRK.png" alt="NeFcRK.png"></a></p><p>相关链接：</p><blockquote><p><a href="https://blog.csdn.net/yh0503/article/details/89851899" target="_blank" rel="noopener">https://blog.csdn.net/yh0503/article/details/89851899</a></p></blockquote><blockquote><p><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/openssh/openssh_install_firstuse" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows-server/administration/openssh/openssh_install_firstuse</a></p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;念两句诗&lt;br&gt;草铺横野六七里，笛弄晚风三四声。&lt;br&gt;归来饱饭黄昏后，不脱蓑衣卧月明。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="运维" scheme="https://archks.github.io/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="VsCode" scheme="https://archks.github.io/tags/VsCode/"/>
    
  </entry>
  
  <entry>
    <title>Win快捷键</title>
    <link href="https://archks.github.io/2020/06/18/Win_ShotCut/"/>
    <id>https://archks.github.io/2020/06/18/Win_ShotCut/</id>
    <published>2020-06-18T00:37:32.000Z</published>
    <updated>2020-07-04T02:17:42.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>念两句诗<br>十年生死两茫茫，不思量，自难忘。<br>千里孤坟，无处话凄凉。<br>纵使相逢应不识，尘满面，鬓如霜。<br>夜来幽梦忽还乡，小轩窗，正梳妆。<br>相顾无言，惟有泪千行。<br>料得年年肠断处，明月夜，短松冈。</p></blockquote><a id="more"></a><p>Win+P 投影<br>Win+K 蓝牙<br>Win+D 桌面<br>Win+E 此电脑<br>Win+R 调出”运行”</p><hr><p>Win+Q 搜索<br>Win+W 截图<br>Win+i 设置<br>Win+A 通知<br>Win+F 反馈<br>Win+L 锁屏<br>Win+X 左下功能界面<br>Win+V 历史剪贴板<br>Win+M 最小化当前界面<br>Win+&gt; 表情符号😊🤦‍♂️</p><hr><p>Ctrl+Win+⬅ 切换到左边的桌面<br>Ctrl+Win+➡ 切换到右边的桌面</p><p>分屏功能键<br>Win+up<br>Win+left<br>Win+right<br>Win+down</p><hr><p>Alt+F4+[Fn] 关机<br>Win+Nbr[1,2,3] 打开任务栏第Nbr位的软件<br>Win+Space 切换输入法<br>F2  重命名<br>F11 全屏</p><hr>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;念两句诗&lt;br&gt;十年生死两茫茫，不思量，自难忘。&lt;br&gt;千里孤坟，无处话凄凉。&lt;br&gt;纵使相逢应不识，尘满面，鬓如霜。&lt;br&gt;夜来幽梦忽还乡，小轩窗，正梳妆。&lt;br&gt;相顾无言，惟有泪千行。&lt;br&gt;料得年年肠断处，明月夜，短松冈。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
    
      <category term="快捷键" scheme="https://archks.github.io/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    
  </entry>
  
  <entry>
    <title>Ls根目录卡死</title>
    <link href="https://archks.github.io/2020/06/17/ls_root_broken_down/"/>
    <id>https://archks.github.io/2020/06/17/ls_root_broken_down/</id>
    <published>2020-06-17T14:46:04.000Z</published>
    <updated>2020-07-05T12:43:54.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>念两句诗<br>无善无恶心之体，有善有恶意之动<br>知善知恶是良知，为善去恶是格物</p></blockquote><a id="more"></a><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>只要涉及到根目录，使用ls和df命令就会出现卡死情况。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@zen] <span class="built_in">pwd</span></span><br><span class="line">/root</span><br><span class="line">[root@zen] ls /</span><br><span class="line">^C</span><br><span class="line">[root@zen] df h</span><br><span class="line">^C</span><br><span class="line">[root@zen] ls /opt</span><br><span class="line">containerd  google  jumpserver  mysql  prometheus</span><br></pre></td></tr></table></figure><h1 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h1><p>1、起初在网上找了一些方法，大多是目录挂载的问题；里面叫你用strace定位问题，然后在lstate的时候会发现是目录没挂载上去，但是我用strace的时候，是正常退出的，因为流程过长，strace的log放在结尾了。</p><p>类似于这样： </p><blockquote><p><a href="https://blog.51cto.com/chaichuan/2104093" target="_blank" rel="noopener">https://blog.51cto.com/chaichuan/2104093</a><br><a href="https://blog.csdn.net/u010801696/article/details/78490103" target="_blank" rel="noopener">https://blog.csdn.net/u010801696/article/details/78490103</a></p></blockquote><p>2、后来发现可能是日志文件过大，或者是文件细碎导致ls太慢，通常是/var/spool/postfix/这个目录下的maildrop太大，但是我看了一下我的，并没有太大。maildrop 爆满的问题一般是 crontab 未屏蔽错误造成的,可以将crontab里的条目指定到&amp;&gt;/dev/null</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@zen]<span class="comment"># ll /var/spool/postfix/</span></span><br><span class="line">total 56</span><br><span class="line">drwx------. 2 postfix root     4096 Oct 31  2018 active</span><br><span class="line">drwx------. 2 postfix root     4096 Oct 31  2018 bounce</span><br><span class="line">drwx------. 2 postfix root     4096 Oct 31  2018 flush</span><br><span class="line">drwx------. 2 postfix root     4096 Oct 31  2018 hold</span><br><span class="line">drwx------. 2 postfix root     4096 Oct 31  2018 incoming</span><br><span class="line">drwx-wx---. 2 postfix postdrop 4096 Oct 31  2018 maildrop</span><br></pre></td></tr></table></figure><p>3、第三种可能是磁盘挂载的问题，根目录丢失之类的。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /etc/fstab</span><br><span class="line">cat /etc/mtab</span><br><span class="line">grep -v rootfs /proc/mounts <span class="comment"># 修复</span></span><br></pre></td></tr></table></figure><p>/etc/fstab 中的挂载点是开机加载的<br>/etc/mtab  中的挂载点是内核动态实时更新的<br>简单来说就是一次修复挂载的问题，但是我做完这几部操作，依旧没有用</p><blockquote><p><a href="https://zhang.ge/5107.html" target="_blank" rel="noopener">https://zhang.ge/5107.html</a></p></blockquote><h1 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h1><p>其实和另一台服务器有关，我们暂时把它称之为O[other]，我们这台服务器为M[me],O上开启了NFS服务，Me服务器挂载了O上的磁盘。过了段时间，O服务器进行了重装，但是M服务器还在挂载O上的磁盘，此时other服务器没有开启NFS服务，但是Me服务器依旧挂载着O的磁盘。</p><p>于是执行ls / 命令的时候，me服务器加载目录，加载前几个好好的，在strace中可以看到，但加载到/mount_point的时候，就会向O服务器发送请求，[应该是某个NFSBug，明明O上的NFS Down了，这个M服务器还是在一直等待响应]，于是看上去就像是me服务器卡死了，其实它是在等待NFS的响应。</p><p>采取的解决措施：重启，有尝试过umount卸载挂载点，但会卡住。</p><hr><p>2020/6/22 看鸟哥Linux私房菜发现也有这方面的情况：</p><p>只要有用到文件系统， 那么整个目录树系统就会主动的去查询全部的挂载点。如果你的 NFS 服务器与客户端之间的联机因为网络问题， 或者是服务器端先关机了，却没有通知客户端，那么客户端只要动到文件系统的指令 (例如 df, ls, cp 等等) ，整个系统就会慢到爆！因为你必须要等到文件系统搜寻等待逾时后，系统才会饶了你！(鸟哥等过 df 指令 30 分钟过…)</p><table><thead><tr><th>参数</th><th>参数功能</th><th>预设参数</th></tr></thead><tbody><tr><td>fg，bg</td><td>当执行挂载时，该挂载的行为会在前景 (fg) 还是在背景 (bg) 执行？ 若在前景执行时，则 mount 会持续尝试挂载，直到成功或 time out 为止，若为背景执行， 则 mount 会在背景持续多次进行 mount ，而不会影响到前景的程序操作。 如果你的网络联机有点不稳定，或是服务器常常需要开关机，那建议使用 bg 比较妥当。</td><td>fg</td></tr><tr><td>soft，hard</td><td>如果是 hard 的情况，则当两者之间有任何一部主机脱机，则 RPC 会持续的呼叫，直到对方恢复联机为止。如果是 soft 的话，那 RPC 会在 time out 后『重复』呼叫，而非『持续』呼叫， 因此系统的延迟会比较不这么明显。同上，如果你的服务器可能开开关关，建议用 soft 喔！</td><td>hard</td></tr><tr><td>intr</td><td>当你使用上头提到的 hard 方式挂载时，若加上 intr 这个参数， 则当 RPC 持续呼叫中，该次的呼叫是可以被中断的 (interrupted)。</td><td>没有</td></tr><tr><td>rsize，wsize</td><td>读出(rsize)与写入(wsize)的区块大小 (block size)。 这个设定值可以影响客户端与服务器端传输数据的缓冲记忆容量。一般来说， 如果在局域网络内 (LAN) ，并且客户端与服务器端都具有足够的内存，那这个值可以设定大一点， 比如说 32768 (bytes) 等，提升缓冲记忆区块将可提升 NFS 文件系统的传输能力！ 但要注意设定的值也不要太大，最好是达到网络能够传输的最大值为限。</td><td>rsize=1024 wsize=1024</td></tr></tbody></table><p>for example:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mount -t nfs -o nosuid,noexec,nodev,rw  192.168.1.1:/data /tmp</span><br></pre></td></tr></table></figure><p>最后补充下NFS无法挂载的原因分析：</p><ol><li>客户端主机和IP网段不被允许使用, ‘mount to NFS x.x.x.x failed:system error connection refused’</li><li>服务器或客户端服务未启动,’mount to NFS x.x.x.x failed:RPC Error : programe not registered’</li><li>被防火墙拦截</li></ol><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@zen]<span class="comment"># strace  ls / </span></span><br><span class="line">execve(<span class="string">"/usr/bin/ls"</span>, [<span class="string">"ls"</span>, <span class="string">"/"</span>], [/* 23 vars */]) = 0</span><br><span class="line">brk(NULL)                               = 0x169f000</span><br><span class="line">mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d51a1000</span><br><span class="line">access(<span class="string">"/etc/ld.so.preload"</span>, R_OK)      = -1 ENOENT (No such file or directory)</span><br><span class="line">open(<span class="string">"/etc/ld.so.cache"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0644, st_size=52409, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 52409, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fd6d5194000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libselinux.so.1"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\220j\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=155744, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 2255216, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d4d5a000</span><br><span class="line">mprotect(0x7fd6d4d7e000, 2093056, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d4f7d000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x23000) = 0x7fd6d4f7d000</span><br><span class="line">mmap(0x7fd6d4f7f000, 6512, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7fd6d4f7f000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libcap.so.2"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\20\26\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=20048, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 2114112, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d4b55000</span><br><span class="line">mprotect(0x7fd6d4b59000, 2093056, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d4d58000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x3000) = 0x7fd6d4d58000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libacl.so.1"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p\37\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=37064, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d5193000</span><br><span class="line">mmap(NULL, 2130560, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d494c000</span><br><span class="line">mprotect(0x7fd6d4953000, 2097152, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d4b53000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x7000) = 0x7fd6d4b53000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libc.so.6"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0`&amp;\2\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=2156240, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 3985920, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d457e000</span><br><span class="line">mprotect(0x7fd6d4741000, 2097152, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d4941000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1c3000) = 0x7fd6d4941000</span><br><span class="line">mmap(0x7fd6d4947000, 16896, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7fd6d4947000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libpcre.so.1"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\360\25\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=402384, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 2494984, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d431c000</span><br><span class="line">mprotect(0x7fd6d437c000, 2097152, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d457c000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x60000) = 0x7fd6d457c000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libdl.so.2"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0P\16\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=19248, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d5192000</span><br><span class="line">mmap(NULL, 2109744, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d4118000</span><br><span class="line">mprotect(0x7fd6d411a000, 2097152, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d431a000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7fd6d431a000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libattr.so.1"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\320\23\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=19896, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 2113904, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d3f13000</span><br><span class="line">mprotect(0x7fd6d3f17000, 2093056, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d4116000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x3000) = 0x7fd6d4116000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">open(<span class="string">"/lib64/libpthread.so.0"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\200m\0\0\0\0\0\0"</span>..., 832) = 832</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0755, st_size=142144, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 2208904, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7fd6d3cf7000</span><br><span class="line">mprotect(0x7fd6d3d0e000, 2093056, PROT_NONE) = 0</span><br><span class="line">mmap(0x7fd6d3f0d000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x16000) = 0x7fd6d3f0d000</span><br><span class="line">mmap(0x7fd6d3f0f000, 13448, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7fd6d3f0f000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d5191000</span><br><span class="line">mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d518f000</span><br><span class="line">arch_prctl(ARCH_SET_FS, 0x7fd6d518f840) = 0</span><br><span class="line">mprotect(0x7fd6d4941000, 16384, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d3f0d000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d4116000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d431a000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d457c000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d4b53000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d4d58000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x7fd6d4f7d000, 4096, PROT_READ) = 0</span><br><span class="line">mprotect(0x61a000, 4096, PROT_READ)     = 0</span><br><span class="line">mprotect(0x7fd6d51a2000, 4096, PROT_READ) = 0</span><br><span class="line">munmap(0x7fd6d5194000, 52409)           = 0</span><br><span class="line">set_tid_address(0x7fd6d518fb10)         = 23051</span><br><span class="line">set_robust_list(0x7fd6d518fb20, 24)     = 0</span><br><span class="line">rt_sigaction(SIGRTMIN, &#123;0x7fd6d3cfd860, [], SA_RESTORER|SA_SIGINFO, 0x7fd6d3d06630&#125;, NULL, 8) = 0</span><br><span class="line">rt_sigaction(SIGRT_1, &#123;0x7fd6d3cfd8f0, [], SA_RESTORER|SA_RESTART|SA_SIGINFO, 0x7fd6d3d06630&#125;, NULL, 8) = 0</span><br><span class="line">rt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0</span><br><span class="line">getrlimit(RLIMIT_STACK, &#123;rlim_cur=8192*1024, rlim_max=RLIM64_INFINITY&#125;) = 0</span><br><span class="line">statfs(<span class="string">"/sys/fs/selinux"</span>, 0x7ffca215e650) = -1 ENOENT (No such file or directory)</span><br><span class="line">statfs(<span class="string">"/selinux"</span>, 0x7ffca215e650)      = -1 ENOENT (No such file or directory)</span><br><span class="line">brk(NULL)                               = 0x169f000</span><br><span class="line">brk(0x16c0000)                          = 0x16c0000</span><br><span class="line">open(<span class="string">"/proc/filesystems"</span>, O_RDONLY)     = 3</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0444, st_size=0, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d51a0000</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">"nodev\tsysfs\nnodev\trootfs\nnodev\tr"</span>..., 1024) = 371</span><br><span class="line"><span class="built_in">stat</span>(<span class="string">"/etc/sysconfig/64bit_strstr_via_64bit_strstr_sse2_unaligned"</span>, 0x7ffca215dbb0) = -1 ENOENT (No such file or directory)</span><br><span class="line"><span class="built_in">read</span>(3, <span class="string">""</span>, 1024)                       = 0</span><br><span class="line">close(3)                                = 0</span><br><span class="line">munmap(0x7fd6d51a0000, 4096)            = 0</span><br><span class="line">access(<span class="string">"/etc/selinux/config"</span>, F_OK)     = 0</span><br><span class="line">open(<span class="string">"/usr/lib/locale/locale-archive"</span>, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0644, st_size=106172832, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 106172832, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7fd6cd7b5000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">ioctl(1, TCGETS, &#123;B38400 opost isig icanon <span class="built_in">echo</span> ...&#125;) = 0</span><br><span class="line">ioctl(1, TIOCGWINSZ, &#123;ws_row=39, ws_col=105, ws_xpixel=0, ws_ypixel=0&#125;) = 0</span><br><span class="line"><span class="built_in">stat</span>(<span class="string">"/"</span>, &#123;st_mode=S_IFDIR|0555, st_size=4096, ...&#125;) = 0</span><br><span class="line">openat(AT_FDCWD, <span class="string">"/"</span>, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 3</span><br><span class="line">getdents(3, /* 29 entries */, 32768)    = 800</span><br><span class="line">getdents(3, /* 0 entries */, 32768)     = 0</span><br><span class="line">close(3)                                = 0</span><br><span class="line">fstat(1, &#123;st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...&#125;) = 0</span><br><span class="line">mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fd6d51a0000</span><br><span class="line">write(1, <span class="string">"baiduds  CloudResetPwdAgentNew\t "</span>..., 76baiduds  CloudResetPwdAgentNew   data  homelost+found  opt   runsys  usr</span><br><span class="line">) = 76</span><br><span class="line">write(1, <span class="string">"bin\t CloudResetPwdUpdateAgent  d"</span>..., 70bin CloudResetPwdUpdateAgent  dev libmedia    proc  sbintmp  var</span><br><span class="line">) = 70</span><br><span class="line">write(1, <span class="string">"boot\t CloudrResetPwdAgent\t   etc"</span>..., 62boot CloudrResetPwdAgent   etc lib64mnt    root  srvtms</span><br><span class="line">) = 62</span><br><span class="line">close(1)                                = 0</span><br><span class="line">munmap(0x7fd6d51a0000, 4096)            = 0</span><br><span class="line">close(2)                                = 0</span><br><span class="line">exit_group(0)                           = ?</span><br><span class="line">+++ exited with 0 +++</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;念两句诗&lt;br&gt;无善无恶心之体，有善有恶意之动&lt;br&gt;知善知恶是良知，为善去恶是格物&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="报错" scheme="https://archks.github.io/categories/%E6%8A%A5%E9%94%99/"/>
    
    
      <category term="NFS" scheme="https://archks.github.io/tags/NFS/"/>
    
  </entry>
  
  <entry>
    <title>Vimium快捷键</title>
    <link href="https://archks.github.io/2020/06/16/Vimium_ShotCut/"/>
    <id>https://archks.github.io/2020/06/16/Vimium_ShotCut/</id>
    <published>2020-06-16T10:02:13.000Z</published>
    <updated>2020-07-04T02:18:04.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>念两句诗<br>世味年來薄似紗，誰令騎馬客京華。<br>小樓一夜聽春雨，深巷明朝賣杏花。<br>矮紙斜行閒作草，晴窗細乳戲分茶。<br>素衣莫起風塵嘆，猶及清明可到家。</p></blockquote><a id="more"></a><p>转自： <a href="https://sspai.com/post/27723" target="_blank" rel="noopener">https://sspai.com/post/27723</a></p><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/16/NkPFhQ.png" alt="NkPFhQ.png"></p><h1 id="1、常用快捷键"><a href="#1、常用快捷键" class="headerlink" title="1、常用快捷键"></a>1、常用快捷键</h1><ul><li>j：向下滚动一点</li><li>k：向上滚动一点</li><li>gg：到页面最底部</li><li>G：到页面最底部</li><li>d：向下翻一屏</li><li>u：向上翻一屏</li><li>gs: 查看网页源代码</li><li>yy：拷贝当前页面的URL到剪贴板</li><li>gu：跳转到父页面</li><li>K：跳转到右边标签页</li><li>J：跳转到左边标签页</li><li>x：关闭当前标签页</li><li>X：恢复刚刚关闭的标签页</li><li>H：在历史记录中后退</li><li>L：在历史记录中前进</li><li>？：查看帮助页面</li></ul><h1 id="2、打开新页面"><a href="#2、打开新页面" class="headerlink" title="2、打开新页面"></a>2、打开新页面</h1><ul><li><p>复制一段链接：经常在网页上看到一段链接文字，但却是不可点的。原来你需要先复制，然后新建标签页，再粘贴，敲回车后才能打开。现在呢？你只需要把要打开的链接复制一下，直接按「p」或「P」就可以打开了，小写的 p 是在当前标签页打开，大写的 P 则新建标签页打开。 </p></li><li><p>从收藏夹、历史记录打开：是不是之前看过什么网页，现在又想看了，还需要再打开历史记录找？或者想打开收藏夹里的某个链接？现在，直接按下「o」，输入对应的关键字后，会一起搜索你的历史记录和收藏夹，如果你输的是一个网址，回车还能直接打开。</p></li></ul><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/16/NkPbD0.png" alt="NkPbD0.png"></p><h1 id="3、只用敲三下，打开当前页面上任意一个链接"><a href="#3、只用敲三下，打开当前页面上任意一个链接" class="headerlink" title="3、只用敲三下，打开当前页面上任意一个链接"></a>3、只用敲三下，打开当前页面上任意一个链接</h1><p>如果说，任意一个页面上，哪所有再多链接，你也不用鼠标，最多只需要敲三个键，你就可以迅速打开任意一个链接，你信不信？Vimium 就可以办到。</p><p>你只需要按一下「f」，然后当前页面上所有可点击的元素，都会生成一个对应的快捷键分派给这些链接。比如我现在想点击导航栏上的「专题」，只需要再输入「GJ」，OK！完成了，你只敲了三个键，就打开了「专题」页面。</p><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/16/NkiE5D.png" alt="NkiE5D.png"></p><h1 id="4、显示当前所有的标签页，并快速切换"><a href="#4、显示当前所有的标签页，并快速切换" class="headerlink" title="4、显示当前所有的标签页，并快速切换"></a>4、显示当前所有的标签页，并快速切换</h1><p>有时候在查找信息、翻阅资料时，经常会一口气打开几十个网站，东西一多，Chrome 会自动将每个标签页的宽度缩小，几乎就看不到它们的标题了。用了 Vimium，你可以按一下大写的「T」，就可以显示当前打开的所有标签页，并支持快捷搜索和跳转。</p><p><img src= "img/loading.gif" data-src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s1.ax1x.com/2020/06/16/Nkie8H.png" alt="Nkie8H.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;念两句诗&lt;br&gt;世味年來薄似紗，誰令騎馬客京華。&lt;br&gt;小樓一夜聽春雨，深巷明朝賣杏花。&lt;br&gt;矮紙斜行閒作草，晴窗細乳戲分茶。&lt;br&gt;素衣莫起風塵嘆，猶及清明可到家。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
    
      <category term="快捷键" scheme="https://archks.github.io/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    
  </entry>
  
  <entry>
    <title>Jetbrains快捷键</title>
    <link href="https://archks.github.io/2020/06/16/Jetbrains_ShutCut/"/>
    <id>https://archks.github.io/2020/06/16/Jetbrains_ShutCut/</id>
    <published>2020-06-16T03:23:57.000Z</published>
    <updated>2020-07-04T02:19:26.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>念两句诗<br>高城鼓动兰釭灺。睡也还醒，醉也还醒：忽听孤鸿三两声。<br>人生只似风前絮。欢也零星，悲也零星，都作连江点点萍。</p></blockquote><a id="more"></a><p>转自： <a href="https://segmentfault.com/a/1190000007206543" target="_blank" rel="noopener">https://segmentfault.com/a/1190000007206543</a></p><h2 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h2><hr><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>Ctrl + Space</td><td>代码自动完成提示（选择）</td></tr><tr><td>Alt + Enter</td><td>显示意图动作和快速修复</td></tr><tr><td>Ctrl + P</td><td>参数信息（在调用方法参数忘记的时候，提示）</td></tr><tr><td>Ctrl + Q</td><td>快速查找文件，可以查找当前类定义的文件等</td></tr><tr><td>Ctrl + 鼠标滑过</td><td>基本信息</td></tr><tr><td>Alt + Insert</td><td>生成代码…(细节需要多次操作会发现很有意思)</td></tr><tr><td>Ctrl + O</td><td>重写方法（在PHPStorm中是重写父类方法，会有选择框）</td></tr><tr><td>Ctrl + I</td><td>实现方法（一般是指实现接口类或抽象类方法）</td></tr><tr><td>Ctrl + Alt + T</td><td>环绕代码块 (if..else, try..catch, for, 等)</td></tr><tr><td>Ctrl + /</td><td>单行注释(//)</td></tr><tr><td>Ctrl + Shift + /</td><td>块注释 (/**/)</td></tr><tr><td>Ctrl + W</td><td>选择依次递增的代码块，具体使用目前来看比较少</td></tr><tr><td>Ctrl + Shift + W</td><td>去掉当前选择返回上一个选择，类似于撤销选择，与上面的相反</td></tr><tr><td>Ctrl + Alt + L</td><td>格式化代码，一般来说，写的代码格式不整齐统一，这个很有用</td></tr><tr><td>Ctrl + Alt + I</td><td>自啮合线，这个解释不太好解释，测试结果就是会自动根据代码来进行对齐</td></tr><tr><td>Ctrl + D</td><td>复制当前行或选定的块</td></tr><tr><td>Ctrl + Y</td><td>删除插入符号所在行</td></tr><tr><td>Ctrl + Shift + J</td><td>智能线连接（HTML和JavaScript才有用）</td></tr><tr><td>Ctrl + Enter</td><td>智能分割线 (HTML 和 JavaScript 才有用)</td></tr><tr><td>Shift + Enter</td><td>开始新行，比如光标在当前行，不需要切换到行尾按Enter，直接按这个组合键即可</td></tr><tr><td>Ctrl + Shift + U</td><td>切换选中的英文文字的大小写，此处其实用到挺多的</td></tr><tr><td>Ctrl + Shift + ] 或 [</td><td>选择直到代码块的开始或结束，我之前不知道这个，其实很有用</td></tr><tr><td>Ctrl + Delete</td><td>删除从当前光标到当前单词结尾</td></tr><tr><td>Ctrl + Backspace</td><td>从光标位置删除到当前单词的开始</td></tr><tr><td>Ctrl + + 或 -</td><td>这里是ctrl和加号或者减号产生的组合，可以折叠或展开当前代码块</td></tr><tr><td>Ctrl + F4</td><td>关闭活动中的tab</td></tr><tr><td>Ctrl + Shift + V</td><td>从历史粘贴</td></tr></tbody></table><h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><hr><p><em>此处我是用得很少</em></p><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>F8</td><td>跳过</td></tr><tr><td>F7</td><td>步进</td></tr><tr><td>Shift + F8</td><td>跳出</td></tr><tr><td>Alt + F8</td><td>表达式求值</td></tr><tr><td>F9</td><td>恢复程序</td></tr><tr><td>Ctrl + F8</td><td>切断断点</td></tr><tr><td>Ctrl+Shift+F8</td><td>查看断点</td></tr></tbody></table><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><hr><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>Shift + F10</td><td>运行</td></tr><tr><td>Shift + F9</td><td>调试</td></tr><tr><td>Ctrl + Shift + F10</td><td>从编辑器运行上下文配置（Run context configuration from editor），此处可能翻译不够准确</td></tr><tr><td>Ctrl + Shift + X</td><td>在命令行运行</td></tr></tbody></table><h2 id="搜索-替换"><a href="#搜索-替换" class="headerlink" title="搜索/替换"></a>搜索/替换</h2><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>Ctrl + F/R</td><td>查找/替换</td></tr><tr><td>F3/Shift + F3</td><td>查找下一个/上一个</td></tr><tr><td>Ctrl + Shift + F/R</td><td>在目录中查找/替换</td></tr></tbody></table><h2 id="查找哪些地方使用"><a href="#查找哪些地方使用" class="headerlink" title="查找哪些地方使用"></a>查找哪些地方使用</h2><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>Alt + F7 / Ctrl + F7</td><td>当前文件查找被使用/在文件中查找哪些地方使用</td></tr><tr><td>Ctrl + Shift + F7</td><td>文件中搜索并在使用的地方高亮显示</td></tr><tr><td>Ctrl + Alt + F7</td><td>显示哪些地方被使用</td></tr></tbody></table><h2 id="导航"><a href="#导航" class="headerlink" title="导航"></a>导航</h2><hr><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>Ctrl + N</td><td>跳转到指定类</td></tr><tr><td>Ctrl + Shift + N</td><td>跳转到文件</td></tr><tr><td>Ctrl + Alt + Shift + N</td><td>跳转到符号</td></tr><tr><td>Ctrl + G</td><td>跳转到第几行</td></tr><tr><td>Alt + Right/Left</td><td>切换编辑器活动窗</td></tr><tr><td>Esc</td><td>Go to editor (from tool window)</td></tr><tr><td>Ctrl + E</td><td>弹出最近编辑文件，我也是在写这文档才知道，太方便了</td></tr><tr><td>Ctrl + Alt + Left/Right</td><td>导航前进/后退</td></tr><tr><td>Ctrl + Shift + Backspace</td><td>跳转到最近编辑的代码位置</td></tr><tr><td>Alt + F1</td><td>在任何视图中选择当前文件或符号</td></tr><tr><td>Ctrl + B 或 Ctrl + Click</td><td>跳到申明（如跳转到当前函数声明的地方，这个很常用，可以实操一下）</td></tr><tr><td>Ctrl + Alt + B</td><td>与上面相反，跳到执行位置</td></tr><tr><td>Ctrl + Shift + I</td><td>打开快速定义查找</td></tr><tr><td>Ctrl + Shift + B</td><td>跳转到类型声明</td></tr><tr><td>Ctrl + U</td><td>跳到超级方法(super-method)/超类 (super-class)</td></tr><tr><td>Alt + Up/Down</td><td>跳转到上一个或者下一个方法，在编辑一个类的时候，方便一个一个的方法进行查看</td></tr><tr><td>Ctrl + ] / [</td><td>跳转到代码块的开始或结束</td></tr><tr><td>F2 / Shift + F2</td><td>跳转到上一个或下一个高亮错误地方，这个检查代码语法错误很有用</td></tr><tr><td>F4 / Ctrl + Enter</td><td>编辑源代码/查看源代码</td></tr></tbody></table><h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><hr><table><thead><tr><th>快捷键组合</th><th>说明</th></tr></thead><tbody><tr><td>快速按两次 Shift</td><td>搜索任何一个地方</td></tr><tr><td>Ctrl + Shift + A</td><td>查找方法(Action)</td></tr><tr><td>Alt + #[0-9]</td><td>打开相应的工具窗口（这个我也没搞明白）</td></tr><tr><td>Ctrl + Alt + F11</td><td>开启或关闭全屏模式</td></tr><tr><td>Ctrl + Shift + F12</td><td>开启或关闭最大化编辑</td></tr><tr><td>Alt + Shift + F</td><td>添加到收藏列表（我觉得这个功能很神奇，不知道为啥要这么做）</td></tr><tr><td>Alt + Shift + I</td><td>检查当前文件以及当前配置文件</td></tr><tr><td>Ctrl + Alt + S</td><td>打开设置对话框（表示会与QQ默认快捷键冲突）</td></tr><tr><td>Ctrl + Tab</td><td>在 tabs 和工具窗口间切换</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;念两句诗&lt;br&gt;高城鼓动兰釭灺。睡也还醒，醉也还醒：忽听孤鸿三两声。&lt;br&gt;人生只似风前絮。欢也零星，悲也零星，都作连江点点萍。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
    
      <category term="快捷键" scheme="https://archks.github.io/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    
  </entry>
  
</feed>
