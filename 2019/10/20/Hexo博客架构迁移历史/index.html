<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>Hexo博客架构迁移历史</title><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=Edge，chrome=1"><meta name="description"><meta name="keywords"><meta name="author" content="ZEN"><link rel="short icon" href="/images/favicon.png"><link rel="icon" href="/images/favicon.png"><!--[if lt IE 9]>
<script src="/js/modernizr.js"></script>
<![endif]-->
<link rel="stylesheet" href="/css/iconfont.css">

<link rel="stylesheet" href="/css/index.css?v=202006161606.css">
<link rel="stylesheet" href="/css/info.css?v=202006161606.css">
<link href="https://cdn.bootcss.com/highlight.js/9.15.9/styles/github.min.css" rel="stylesheet"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="无心而为" type="application/atom+xml">
</head><body><header id="header" class="header-navigation"><nav><div class="logo"><a href="http://ymlog.cn">无心而为</a></div><h2 id="mnavh"><span class="navicon"></span></h2><ul id="starlist"><li><a href="/">首页</a></li><li><a href="/time.html">时间轴</a></li></ul><div class="searchbox"><div id="search_bar" class="search_bar"><input id="keyboard" placeholder="想搜点什么呢.." type="text" name="keyboard" autocomplete="off" class="input"><p class="search_ico"><span></span></p></div></div></nav></header><article><main><div class="con_warp"><div class="infosbox"><div class="newsview"><h3 class="news_title">Hexo博客架构迁移历史</h3><div class="bloginfo"><ul><li class="author">作者：<a href="/">ZEN</a></li><li class="lmname"><a href="/">Linux</a></li><li class="timer">时间：2019-10-20 21:58:02</li><li class="view"><span id="busuanzi_value_page_pv">99</span><span>次访问</span></li></ul></div><div class="tags"></div><div class="news_con"><p>在2019年10月20日之前，一直在使用叶落阁的主题。之后换到了Clic的主题，期间有一系列的报错导致Clic的主题不能部署在容器中，所以重构了网站结构，特此纪念。或许当某一天用不习惯Clic的主题，这篇文章就又会更新了。</p>
<h1 id="叶落阁主题"><a href="#叶落阁主题" class="headerlink" title="叶落阁主题"></a>叶落阁主题</h1><blockquote>
<p><a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank" rel="noopener">https://github.com/yelog/hexo-theme-3-hexo</a></p>
</blockquote>
<p><img src="https://i.loli.net/2019/10/20/O2PCKLY4bolufX6.png" alt="叶落阁"></p>
<p>这个Hexo的内容是放在Linux主机中的，然后用NFS文件共享同步到Windows本地。只需在Windows本地编辑，即可上传。</p>
<p>Hexo容器生成命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d --name my-hexo -p 80:4000 -v /Log/:/opt/hexo/ipple1986/<span class="built_in">source</span>/_posts ipple1986/hexo</span><br></pre></td></tr></table></figure>

<p>我还开启了weavescope监控，但由于端口暴露在外面，别人可以轻而易举的访问Linux主机和Docker容器，所以一般情况下选择禁用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo curl -L git.io/scope -o /usr/<span class="built_in">local</span>/bin/scope</span><br><span class="line">sudo chmod a+x /usr/<span class="built_in">local</span>/bin/scope</span><br><span class="line">scope launch</span><br></pre></td></tr></table></figure>

<p>文件传输模式</p>
<p><img src="https://i.loli.net/2019/10/20/JMGuF75O3e6iY9z.png" alt="File_Move"></p>
<h1 id="Clic主题"><a href="#Clic主题" class="headerlink" title="Clic主题"></a>Clic主题</h1><blockquote>
<p><a href="https://github.com/Siricee/hexo-theme-Chic#introduction" target="_blank" rel="noopener">https://github.com/Siricee/hexo-theme-Chic#introduction</a></p>
</blockquote>
<p><img src="https://camo.githubusercontent.com/58dfbf6fc501c3cefa5d63bfe5c6baaace41a9b5/68747470733a2f2f692e6c6f6c692e6e65742f323031392f30362f31322f3564303036626432383961613332353033372e706e67" alt="Clic Theme"></p>
<p>在使用Hexo这个主题时，我是将其部署在docker中，但docker中hexo的版本很低，没有办法，只好换了方式部署。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@~ipple1986]# hexo -v</span><br><span class="line">hexo: 3.3.7</span><br><span class="line">hexo-cli: 3.1.0</span><br><span class="line">node: 10.16.3</span><br></pre></td></tr></table></figure>

<p>文件迁移过程：</p>
<p><img src="https://i.loli.net/2019/10/20/KiXM9bYRFZsjx74.png" alt="File_Move"></p>
<p>现在是将hexo生成静态网页，然后用Nginx部署。在windows本地写博客，然后把写好的博客推送到Github上，然后在服务器端写一个脚本，每天凌晨一点半下载Github上的静态页面，然后存储到本地/usr/share/nginx/html/blog下。<br>这样写有两点好处</p>
<ul>
<li>一是直接访问Github托管的网站，用户速度会很慢，影响使用体验</li>
<li>而是可以用Nginx，对访问进行监管和记录，达到学习Nginx的目的。</li>
</ul>
<p>拉取Github静态网站的脚本：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/ArchKS/ArchKS.github.io.git blog</span><br><span class="line">rm /usr/share/nginx/html/blog -rf</span><br><span class="line">mv blog /usr/share/nginx/html/</span><br><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure>

<p>定时任务:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@niki important]# crontab -l</span><br><span class="line">30 1 * * * bash &#x2F;root&#x2F;important&#x2F;blog.sh</span><br></pre></td></tr></table></figure>



<h1 id="Pure主题"><a href="#Pure主题" class="headerlink" title="Pure主题"></a>Pure主题</h1><p>2019年12月25日，圣诞节，换了个主题，以前用的Chic的主题不用了，换成了pure的主题，但工作原理和流程和上面的那个一样，这里就不过多赘述了。先上图纪念一下以前用的那个主题：</p>
<p><img src="https://i.loli.net/2019/12/26/CvWYopaZ1wmR29J.png" alt="image.png"></p>
<p>也打算精简一下我的博客内容了，以前是什么笔记都网上放，现在尽量放一些整理的东西。</p>
</div></div><div class="nextinfo"><p>上一篇：<a href="/2019/10/21/Python%E7%88%AC%E8%99%AB%E5%A4%A7%E7%BA%B2%E6%A6%82%E8%BF%B0/">Python爬虫大纲概述</a></p><p>下一篇：<a href="/2019/10/10/Vim%E5%BF%AB%E6%8D%B7%E9%94%AE/">Vim快捷键</a></p></div><div class="news_pl"><div id="comment_container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script src="/js/md5.min.js"></script>
<script>const gitalk = new Gitalk({
    clientID: 'you github Client ID',
    clientSecret: 'you github Client Secret',
    repo: 'you github repository',
    owner: 'you github repository owner',
    admin: ['you github repository owner'],
    id: md5("2019/10/20/Hexo博客架构迁移历史/"),      // Ensure uniqueness and length less than 50
    distractionFreeMode: true  // Facebook-like distraction free mode
})
gitalk.render('comment_container')</script></div></div></div></main><aside class="r_box"><div class="card box"><h2>我的名片</h2><div class="box_con"><p>网名：一笑奈何。</p>
<p>职业：全栈软件工程师、Java劝退师</p>
<p>Email：2212585023@qq.com</p>
</div></div><div class="category box"><h2>文章分类</h2><div class="box_con"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%B9%E5%99%A8/">容器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B7%AF%E7%94%B1%E6%8A%80%E6%9C%AF/">路由技术</a><span class="category-list-count">3</span></li></ul></div></div></aside></article><footer><section class="footer_bottom"><div class="footer_container"><p class="copyright">Design by
<a href='http://ymlog.cn' target='_blank'>ZEN</a>
苏ICP备19049121号-1
</p><ul class="social_network"></ul></div></section></footer><div class="cd-top"><i class="iconfont icon-top"></i></div>
<script src="/js/jquery.min.js"></script>
<script src="/js/scrollreveal.js"></script>
<script src="/js/hc-sticky.js"></script>
<script src="/js/canvas-nest.js" type="text/javascript" color="47,135,193" opacity="0.7" zIndex="-2" count="199"></script><script src="https://cdn.bootcss.com/highlight.js/9.15.9/highlight.min.js"></script><script src="https://cdn.bootcss.com/highlight.js/9.15.9/languages/java.min.js"></script><script src="https://cdn.bootcss.com/highlight.js/9.15.9/languages/javascript.min.js"></script><script type="text/javascript">hljs.initHighlightingOnLoad();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="/js/common.js?v=202006161606.js"></script>
<script src="/js/index.js?v=202006161606.js"></script>
</body></html>