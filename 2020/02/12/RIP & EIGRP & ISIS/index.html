<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>RIP & EIGRP & ISIS</title><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=Edge，chrome=1"><meta name="description"><meta name="keywords"><meta name="author" content="ZEN"><link rel="short icon" href="/images/favicon.png"><link rel="icon" href="/images/favicon.png"><!--[if lt IE 9]>
<script src="/js/modernizr.js"></script>
<![endif]-->
<link rel="stylesheet" href="/css/iconfont.css">

<link rel="stylesheet" href="/css/index.css?v=202006161606.css">
<link rel="stylesheet" href="/css/info.css?v=202006161606.css">
<link href="https://cdn.bootcss.com/highlight.js/9.15.9/styles/github.min.css" rel="stylesheet"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="无心而为" type="application/atom+xml">
</head><body><header id="header" class="header-navigation"><nav><div class="logo"><a href="http://ymlog.cn">无心而为</a></div><h2 id="mnavh"><span class="navicon"></span></h2><ul id="starlist"><li><a href="/">首页</a></li><li><a href="/time.html">时间轴</a></li></ul><div class="searchbox"><div id="search_bar" class="search_bar"><input id="keyboard" placeholder="想搜点什么呢.." type="text" name="keyboard" autocomplete="off" class="input"><p class="search_ico"><span></span></p></div></div></nav></header><article><main><div class="con_warp"><div class="infosbox"><div class="newsview"><h3 class="news_title">RIP & EIGRP & ISIS</h3><div class="bloginfo"><ul><li class="author">作者：<a href="/">ZEN</a></li><li class="lmname"><a href="/">路由技术</a></li><li class="timer">时间：2020-02-12 19:44:41</li><li class="view"><span id="busuanzi_value_page_pv">99</span><span>次访问</span></li></ul></div><div class="tags"></div><div class="news_con"><h1 id="简介"><a href="#简介" class="headerlink" title="*简介"></a>*简介</h1><p>  路由协议可以分为静态路由协议和动态路由协议，动态路由协议有两类。一类是用于内部网路互联互通的IGP协议，其中代表的有RIP、EIGRP、OSPF、ISIS等，另一类是用于区域与区域之间互通的外部网关协议，目前只有BGP。</p>
<p>  本章主要总结内部网关协议中的RIP、EIGRP和ISIS。其中RIP和EIGRP是距离矢量协议，而ISIS和OSPF同属于链路状态协议。</p>
<blockquote>
<ul>
<li>距离矢量协议：传递路由条目，网络能见度只有一跳 ——基于Bellman算法</li>
<li>链路状态协议：传递链路信息，网络能见度是整个拓扑结构——基于SPF(Short Path First)，最短路径算法</li>
</ul>
</blockquote>
<h1 id="RIP"><a href="#RIP" class="headerlink" title="RIP"></a>RIP</h1><ol>
<li>RIP使用跳数来描述一条路由的好坏，每经过一台路由器，跳数加一，当跳数为16跳的时候，这条路由就会作废。</li>
<li>RIP消息封装的时候，使用UDP，端口号是520，并且源端口和目的端口都是520</li>
<li>RIP迄今为止有三个版本，分别为：RIP1，RIP2，RIPng，目前IPv4使用的是Version2 IPV6使用的是Version RIPing。</li>
<li>RIP在Cisco设备的管理距离为120</li>
</ol>
<table>
<thead>
<tr>
<th>RIPv1</th>
<th>RIPv2</th>
</tr>
</thead>
<tbody><tr>
<td>使用广播更新路由表</td>
<td>使用组播更新路由表</td>
</tr>
<tr>
<td>有类路由协议</td>
<td>无类路由协议</td>
</tr>
<tr>
<td>不支持VLSM</td>
<td>支持VLSM</td>
</tr>
<tr>
<td>不支持手工汇总</td>
<td>支持手工汇总</td>
</tr>
<tr>
<td>不支持路由表及Tag</td>
<td>支持路由标记</td>
</tr>
<tr>
<td>更新消息中的路由条目没有Next-hop信息</td>
<td>有Next-hop信息</td>
</tr>
</tbody></table>
<p>有类路由协议更新不携带子网掩码，所以RIP宣告不能加mask，如果宣告1.1.1.0/24，最后宣告的还是1.0.0.0/8。</p>
<p>RIPv2使用的组播地址为 <strong>224.0.0.9</strong> 。</p>
<p>RIP的消息通知机制：</p>
<blockquote>
<p>RIP默认30s会从所有参与RIP的接口发出路由表信息，当180s没有收到某条路由的时候，就会判断那 条路由可能失效了，但是依旧会放在路由表里面，只是不会再给别人了，当240s都没有收到这条路由的时候，就会彻底删除。</p>
</blockquote>
<h2 id="RIP配置"><a href="#RIP配置" class="headerlink" title="RIP配置"></a>RIP配置</h2><p><img src="http://q5q3e2ctx.bkt.clouddn.com/RIP%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE.png" alt="http://q5q3e2ctx.bkt.clouddn.com/RIP简单配置.png"></p>
<p>宣告RIP路由：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">router rip                  #启动RIP协议</span><br><span class="line">network 1.0.0.0         #将1.0.0.0加入到更新路由表中，将1.0.0.0所在接口也加入更新接口中</span><br><span class="line">network 192.168.12.0 </span><br><span class="line"></span><br><span class="line">#当宣告完之后，R1就可以Ping通R4了</span><br><span class="line"></span><br><span class="line">#修改RIP时间</span><br><span class="line">router rip</span><br><span class="line">timers basic 30 180 180 240     #分别是Updates、Invalid、Holddown、Flush</span><br></pre></td></tr></table></figure>



<h2 id="RIP机制"><a href="#RIP机制" class="headerlink" title="RIP机制"></a>RIP机制</h2><p>查看R1的路由表,可以发现去往R2~R4逐跳递增：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R     2.0.0.0&#x2F;8 [120&#x2F;1] via 192.168.12.2, 00:00:27, Ethernet0&#x2F;0</span><br><span class="line">R     3.0.0.0&#x2F;8 [120&#x2F;2] via 192.168.12.2, 00:00:27, Ethernet0&#x2F;0</span><br><span class="line">R     4.0.0.0&#x2F;8 [120&#x2F;3] via 192.168.12.2, 00:00:06, Ethernet0&#x2F;0</span><br><span class="line">#并且这里的时间也是正向计时，一到30s就重置。如果是失效的路由条目，则会经历180s和240s</span><br></pre></td></tr></table></figure>

<p>查看RIP协议相关：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1<span class="comment">#sh ip protocols</span></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">Routing Protocol is <span class="string">"rip"</span></span><br><span class="line">  Outgoing update filter list <span class="keyword">for</span> all interfaces is not <span class="built_in">set</span></span><br><span class="line">  Incoming update filter list <span class="keyword">for</span> all interfaces is not <span class="built_in">set</span></span><br><span class="line">  <span class="comment"># 每隔30s发送一次更新消息，下一次预计在14s之后。</span></span><br><span class="line">  Sending updates every 30 seconds, next due <span class="keyword">in</span> 14 seconds</span><br><span class="line">  <span class="comment"># 180s判断为down，240删除无效</span></span><br><span class="line">  Invalid after 180 seconds, hold down 180, flushed after 240 </span><br><span class="line">  Redistributing: rip</span><br><span class="line">  <span class="comment"># 默认版本</span></span><br><span class="line">  Default version control: send version 2, receive version 2</span><br><span class="line">  <span class="comment"># 配置接口</span></span><br><span class="line">    Interface             Send  Recv  Triggered RIP  Key-chain</span><br><span class="line">    Ethernet0/0           2     2                                    </span><br><span class="line">    Loopback0             2     2                                    </span><br><span class="line">    Interface             Send  Recv  Triggered RIP  Key-chain</span><br><span class="line">  <span class="comment"># 自动网络汇总生效，会将所有子网划分的地址汇总为主类，主类就是子网掩码按照ABC类来</span></span><br><span class="line">  Automatic network summarization is <span class="keyword">in</span> effect</span><br><span class="line">  <span class="comment"># 最大负载均衡为4</span></span><br><span class="line">  Maximum path: 4</span><br><span class="line">  <span class="comment"># 已经宣告的路由，这里也可以看出我们宣告的1.1.1.0变成了1.0.0.0，不加子网掩码</span></span><br><span class="line">  Routing <span class="keyword">for</span> Networks:</span><br><span class="line">    1.0.0.0</span><br><span class="line">    192.168.12.0</span><br><span class="line">  <span class="comment"># 路由信息来源 上一次更新时间是累加的，到30s刷新，和上面的预计14s形成呼应</span></span><br><span class="line">  Routing Information Sources:</span><br><span class="line">    Gateway         Distance      Last Update   <span class="comment">#16s之前更新过</span></span><br><span class="line">    192.168.12.2         120      00:00:16</span><br><span class="line">  <span class="comment">#默认管理距离为120</span></span><br><span class="line">  Distance: (default is 120)</span><br></pre></td></tr></table></figure>



<p>关于RIP的30s、180s、240s，这里shutdown了R4的e0/0接口，在R3上观察现象，之后R3删除后，才会反应到R1上：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#R3 -- 180的down</span></span><br><span class="line">R     1.0.0.0/8 [120/2] via 192.168.23.2, 00:00:21, Ethernet0/0</span><br><span class="line">R     2.0.0.0/8 [120/1] via 192.168.23.2, 00:00:21, Ethernet0/0</span><br><span class="line">R     4.0.0.0/8 [120/1] via 192.168.34.4, 00:01:32, Ethernet0/1</span><br><span class="line">R     192.168.12.0/24 [120/1] via 192.168.23.2, 00:00:21, Ethernet0/0</span><br><span class="line"><span class="comment">#R3 -- 240s后，R1、R2、R3的4.4.4.0都被删除了</span></span><br><span class="line">R     1.0.0.0/8 [120/2] via 192.168.23.2, 00:00:16, Ethernet0/0</span><br><span class="line">R     2.0.0.0/8 [120/1] via 192.168.23.2, 00:00:16, Ethernet0/0</span><br><span class="line">R     4.0.0.0/8 is possibly down, routing via 192.168.34.4, Ethernet0/1</span><br><span class="line">R     192.168.12.0/24 [120/1] via 192.168.23.2, 00:00:16, Ethernet0/0</span><br></pre></td></tr></table></figure>





<h2 id="RIP汇总"><a href="#RIP汇总" class="headerlink" title="RIP汇总"></a>RIP汇总</h2><p>RIP的自动汇总功能总是打开的，我们可以手动关闭：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R1(config-router)#no auto-summary</span><br><span class="line">int lo1</span><br><span class="line">ip add 172.16.1.1 255.255.255.0</span><br><span class="line">int lo2</span><br><span class="line">ip add 172.16.2.1 255.255.255.0</span><br><span class="line">int lo3</span><br><span class="line">ip add 172.16.3.1 255.255.255.0</span><br><span class="line">router rip</span><br><span class="line">net 172.16.1.0</span><br><span class="line">net 172.16.2.0</span><br><span class="line">net 172.16.3.0</span><br><span class="line"></span><br><span class="line">#当完成这一切，在R2的路由表上可以看到</span><br><span class="line">R        172.16.1.0 [120&#x2F;1] via 192.168.12.1, 00:00:02, Ethernet0&#x2F;0</span><br><span class="line">R        172.16.2.0 [120&#x2F;1] via 192.168.12.1, 00:00:02, Ethernet0&#x2F;0</span><br><span class="line">R        172.16.3.0 [120&#x2F;1] via 192.168.12.1, 00:00:02, Ethernet0&#x2F;0</span><br><span class="line"></span><br><span class="line">#现在在R1的出接口对路由进行汇总</span><br><span class="line">R1(config)#int e0&#x2F;0</span><br><span class="line">R1(config-if)#ip summary-address rip 172.16.0.0 255.255.0.0 </span><br><span class="line"></span><br><span class="line">#之后再看R2的路由表，就会发现RIP好慢，明细路由还是要经历180-240的过程C：</span><br><span class="line">      172.16.0.0&#x2F;16 is variably subnetted, 4 subnets, 2 masks</span><br><span class="line">R        172.16.0.0&#x2F;16 [120&#x2F;1] via 192.168.12.1, 00:00:22, Ethernet0&#x2F;0</span><br><span class="line">R        172.16.1.0&#x2F;24 [120&#x2F;1] via 192.168.12.1, 00:00:52, Ethernet0&#x2F;0</span><br><span class="line">R        172.16.2.0&#x2F;24 [120&#x2F;1] via 192.168.12.1, 00:00:52, Ethernet0&#x2F;0</span><br><span class="line">R        172.16.3.0&#x2F;24 [120&#x2F;1] via 192.168.12.1, 00:00:52, Ethernet0&#x2F;0</span><br></pre></td></tr></table></figure>



<p>不得不介绍一下清理路由表的办法了，RIP实在是太慢了： <code>clear ip route *</code> 。</p>
<h2 id="RIP认证"><a href="#RIP认证" class="headerlink" title="RIP认证"></a>RIP认证</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R1(config)#key chain Cisco                              &#x2F;&#x2F;设置钥匙的名字               </span><br><span class="line">R1(config-keychain)#key 1                                   &#x2F;&#x2F;第一把钥匙</span><br><span class="line">R1(config-keychain-key)#key-string Cisco1 &#x2F;&#x2F;第一把钥匙的内容</span><br><span class="line">R1(config-keychain-key)#key 2</span><br><span class="line">R1(config-keychain-key)#key-string Cisco2           </span><br><span class="line"></span><br><span class="line">R1(config-keychain-key)#int e0&#x2F;0                                                &#x2F;&#x2F;在接口上配置加密</span><br><span class="line">R1(config-if)#ip rip authentication key-chain Cisco         &#x2F;&#x2F;用钥匙Cisco给RIP的加密</span><br><span class="line">R1(config-if)#ip rip authentication mode md5                        &#x2F;&#x2F;加密格式为md5，也可以明文加密</span><br></pre></td></tr></table></figure>

<p>当在R1上配置完认证之后，就会发现R2在R1上学到的条目进入了 <code>180-240</code> 的过程。此时R2已经不能学习到R1的路由条目了，除非在R2上也配置认证。</p>
<p>Key-chain的其他配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R2(config-keychain-key)#?</span><br><span class="line">Key-chain key configuration commands:</span><br><span class="line">  accept-lifetime          Set accept lifetime of key</span><br><span class="line">  cryptographic-algorithm  Set cryptographic authentication algorithm</span><br><span class="line">  default                  Set a command to its defaults</span><br><span class="line">  exit                     Exit from key-chain key configuration mode</span><br><span class="line">  key-string               Set key string</span><br><span class="line">  no                       Negate a command or set its defaults</span><br><span class="line">  send-lifetime            Set send lifetime of key</span><br></pre></td></tr></table></figure>





<h2 id="RIP防环"><a href="#RIP防环" class="headerlink" title="RIP防环"></a>RIP防环</h2><ol>
<li>定义最大跳数，一个路由最远可以到15跳的地方，如果是16跳，就会认为不可达</li>
<li>水平分割，如果从接口上收到某条路由的更新，那么就不会将该路由再发回去</li>
<li>毒性逆转，和水平分隔矛盾，只能二选一，如果从接口上收到某路由的更新，那么就立即从收到的接口将该路由发回去，但是跳数是16，这样就不会从这个方向去学习路由了。</li>
<li>毒性路由，如果某个接口down了，就会立即更新该接口的网段，但是跳数是16，这样邻居收到后就立即删除</li>
<li>抑制计时器，180s没有收到路由更新就会判断可能失效，240s没有收到就会直接删除</li>
<li>触发更新，如果路由发生了变化，立即进行更新而不用等待30s</li>
</ol>
<p>毒性路由实验：shutdownR4的lo0接口，然后在R3上观察现象</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#R3</span><br><span class="line">R     1.0.0.0&#x2F;8 [120&#x2F;2] via 192.168.23.2, 00:00:01, Ethernet0&#x2F;0</span><br><span class="line">R     2.0.0.0&#x2F;8 [120&#x2F;1] via 192.168.23.2, 00:00:01, Ethernet0&#x2F;0</span><br><span class="line">R     4.0.0.0&#x2F;8 [120&#x2F;1] via 192.168.34.4, 00:00:18, Ethernet0&#x2F;1</span><br><span class="line"></span><br><span class="line">R4(config-if)#shutdown</span><br><span class="line"></span><br><span class="line">R     1.0.0.0&#x2F;8 [120&#x2F;2] via 192.168.23.2, 00:00:02, Ethernet0&#x2F;0</span><br><span class="line">R     2.0.0.0&#x2F;8 [120&#x2F;1] via 192.168.23.2, 00:00:02, Ethernet0&#x2F;0</span><br><span class="line"></span><br><span class="line">#竟然只用了几秒钟中就反应过来了。</span><br></pre></td></tr></table></figure>



<h2 id="RIP命令"><a href="#RIP命令" class="headerlink" title="RIP命令"></a>RIP命令</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">router rip                                                  #启动RIP协议</span><br><span class="line">    version 2</span><br><span class="line">    network 1.1.1.0                         #将1.0.0.0加入到更新路由表中，将1.0.0.0所在接口也加入更新接口中</span><br><span class="line">    timers basic 30 180 180 240             #分别是Updates、Invalid、Holddown、Flush</span><br><span class="line">    no auto-summary                                     #关闭自动汇总</span><br><span class="line"></span><br><span class="line"> #手动汇总</span><br><span class="line">(config-if)# ip summary-address rip 172.16.0.0 255.255.0.0 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">认证配置：</span><br><span class="line">key chain NAME                              #设置钥匙的名字  </span><br><span class="line">key 1                                               #第一把钥匙</span><br><span class="line">key-string STRING                       #第一把钥匙的内容</span><br><span class="line"></span><br><span class="line">int e0&#x2F;0                                            #在接口上配置</span><br><span class="line">ip rip authentication key-chain NAME        #用钥匙给RIP的加密</span><br><span class="line">ip rip authentication mode md5                  #加密格式为md5，也可以明文加密</span><br></pre></td></tr></table></figure>





<h1 id="EIGRP"><a href="#EIGRP" class="headerlink" title="EIGRP"></a>EIGRP</h1><p>增强型内部网关路由选择协议(Enhanced Interior Gateway Routing protocol,EIGRP)</p>
<p>EIGRP协议的特点：</p>
<ul>
<li><p>EIGRP有自治系统，一个EIGRP网络，必须所有的路由器都属于同一个自治系统才可以传递路由。</p>
</li>
<li><p>EIGRP使用DUAL扩散更新算法来保障无环路最优路径计算</p>
</li>
<li><p>是无类路由协议，每个路由条目都包含子网掩码</p>
</li>
<li><p>传输模块RTP（Reliable Transport Protocol），使用组播224.0.0.10</p>
</li>
<li><p>EIGRP的非周期、有边界、和部分；非周期：只在度量和网络拓扑变化时才更新，部分：只发送变化的路由条目，有边界：更新仅发给受影响的路由</p>
</li>
<li><p>更新消息直接存放于IP包头之后，所有没有传输层。在IP包头协议字段中用88表示。</p>
</li>
<li><p>管理距离在Cisco设备上有三种，分别是5,90,170</p>
</li>
<li><p>EIGRP的更新是可靠传输的，任何一个给邻居的路由信息都必须得到邻居的确认。</p>
</li>
<li><p>EIGRP的度量值(Metric)计算会包含：带宽(Bandwidth)、延迟(delay)、可靠性(reliability)、负载(loading)、最大传输单元(MTU)</p>
</li>
</ul>
<p>EIGRP的数据报：</p>
<ul>
<li>Hello，用于邻居的发现和恢复，Hello数据报使用组播方式发送，而且使用不可靠的发送方式</li>
<li>ACK，是不包含数据的Hello数据报，ACK总是用单播方、不可靠的发送方式</li>
<li>Update，传递路由更新信息，仅传递给有需要的路由，单台路由单播发送，多台路由组播发送</li>
<li>Query &amp; Reply，查询和答复，是DUAL用来管理它的扩散计算的</li>
</ul>
<h2 id="EIGRP三张表"><a href="#EIGRP三张表" class="headerlink" title="EIGRP三张表"></a>EIGRP三张表</h2><p>1、邻居表</p>
<p>​    EIGRP路由器在启动之后，就会每隔5秒钟，发送一个hello消息，且从任何接口的222.0.0.10组播地址收到hello，就会立即将对方加入到自己的邻居表</p>
<p>​    邻居表中的邻居都会有一个死亡事假你，是3倍hello消息间隔，每次收到邻居的hello都会重置死亡计时器，死亡计时器一旦到零，就会直接删除和这个邻居有关的一切路由信息。</p>
<p>查看EIGRP的邻居表</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1<span class="comment">#show ip eigrp neighbors </span></span><br><span class="line">EIGRP-IPv4 Neighbors <span class="keyword">for</span> AS(100)</span><br><span class="line">												    平均往返时间</span><br><span class="line">H   Address                 Interface              Hold Uptime   SRTT   RTO  Q  Seq</span><br><span class="line">                                                   (sec)         (ms)       Cnt Num</span><br><span class="line">1   192.168.15.5            Et0/1                    11 00:01:03 1280  5000  0  8</span><br><span class="line">0   192.168.12.2            Et0/0                    10 00:02:24    9   100  0  15</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Hold Uptime：</span><br><span class="line">SRTT：平均往返时间</span><br><span class="line">RTO：重传计时，基于SRTT</span><br><span class="line">QCnt：重传队列</span><br><span class="line">SeqNum：</span><br></pre></td></tr></table></figure>



<p>度量值Metric计算</p>
<p>2、拓扑表</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1<span class="comment">#sh ip eigrp topology </span></span><br><span class="line">EIGRP-IPv4 Topology Table <span class="keyword">for</span> AS(100)/ID(1.1.1.1)</span><br><span class="line">Codes: P - Passive, A - Active, U - Update, Q - Query, R - Reply,</span><br><span class="line">       r - reply Status, s - sia Status </span><br><span class="line"></span><br><span class="line">P 192.168.23.0/24, 1 successors, FD is 307200</span><br><span class="line">        via 192.168.12.2 (307200/281600), Ethernet0/0</span><br><span class="line">P 192.168.34.0/24, 2 successors, FD is 332800</span><br><span class="line">        via 192.168.12.2 (332800/307200), Ethernet0/0</span><br><span class="line">        via 192.168.15.5 (332800/307200), Ethernet0/1</span><br><span class="line">P 192.168.12.0/24, 1 successors, FD is 281600</span><br><span class="line">        via Connected, Ethernet0/0</span><br><span class="line">P 5.5.5.0/24, 1 successors, FD is 409600</span><br><span class="line">        via 192.168.15.5 (409600/128256), Ethernet0/1</span><br><span class="line">P 192.168.45.0/24, 1 successors, FD is 307200</span><br><span class="line">        via 192.168.15.5 (307200/281600), Ethernet0/1</span><br><span class="line">P 2.2.2.0/24, 1 successors, FD is 409600</span><br><span class="line">        via 192.168.12.2 (409600/128256), Ethernet0/0</span><br><span class="line">P 3.3.3.0/24, 1 successors, FD is 435200</span><br><span class="line">        via 192.168.12.2 (435200/409600), Ethernet0/0</span><br><span class="line">P 192.168.15.0/24, 1 successors, FD is 281600</span><br><span class="line">        via Connected, Ethernet0/1</span><br><span class="line">P 1.1.1.0/24, 1 successors, FD is 128256</span><br><span class="line">        via Connected, Loopback0</span><br><span class="line">P 4.4.4.0/24, 1 successors, FD is 435200</span><br><span class="line">        via 192.168.15.5 (435200/409600), Ethernet0/1</span><br><span class="line"></span><br><span class="line"><span class="comment">#拓扑表中记录了每个目的地的相关信息，比如后继路由器、可行 后继路由器、可行距离、通告距离。</span></span><br><span class="line"><span class="comment">#FD：可行距离(Feasible Distance),到达目的地的最小度量值就是可行距离,类似Metric</span></span><br><span class="line"><span class="comment">#FC：可行性条件(Feasibility Condition)，邻居比自己的FD小</span></span><br><span class="line"><span class="comment">#FS：可行性后继路由器(Feasible Successor)，满足FC后，这个邻居就会变成该网络的可行后继路由器</span></span><br><span class="line"><span class="comment">#通告距离：就是去往这个目的地的下一跳到目的地的度量值，相当于邻居表到这个目的地的度量值</span></span><br></pre></td></tr></table></figure>

<p>当拓扑表中最佳后继路由器失效了，会导致EIGRP向所有的邻居发起查询，并且会将邻居标记为（q）</p>
<p>如果3分钟内，邻居都没有任何形式的回复，那么就会主动断开和这个邻居的关系</p>
<p>3、EIGRP路由表</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1<span class="comment">#show ip route eigrp </span></span><br><span class="line">		 2.0.0.0/24 is subnetted, 1 subnets</span><br><span class="line">D        2.2.2.0 [90/409600] via 192.168.12.2, 00:10:49, Ethernet0/0</span><br><span class="line">      3.0.0.0/24 is subnetted, 1 subnets</span><br><span class="line">D        3.3.3.0 [90/435200] via 192.168.12.2, 00:08:41, Ethernet0/0</span><br><span class="line">      4.0.0.0/24 is subnetted, 1 subnets</span><br><span class="line">D        4.4.4.0 [90/435200] via 192.168.15.5, 00:08:41, Ethernet0/1</span><br><span class="line">      5.0.0.0/24 is subnetted, 1 subnets</span><br><span class="line">D        5.5.5.0 [90/409600] via 192.168.15.5, 00:09:29, Ethernet0/1</span><br><span class="line">D     192.168.23.0/24 [90/307200] via 192.168.12.2, 00:10:29, Ethernet0/0</span><br><span class="line">D     192.168.34.0/24 [90/332800] via 192.168.15.5, 00:08:43, Ethernet0/1</span><br><span class="line">                      [90/332800] via 192.168.12.2, 00:08:43, Ethernet0/0</span><br><span class="line">D     192.168.45.0/24 [90/307200] via 192.168.15.5, 00:09:29, Ethernet0/1</span><br><span class="line">[AD/FD]</span><br><span class="line"><span class="comment">#eigrp的管理距离</span></span><br><span class="line">内部路由：90</span><br><span class="line">外部路由：170</span><br><span class="line">汇总路由：5</span><br></pre></td></tr></table></figure>

<p>metric maximum hops 102 修改最大跳数</p>
<p>路由汇总 – 在路由出口手动汇总</p>
<p>EIGRP的自动汇总默认是关闭着的，无论是手动汇总还是自动汇总都会影响本地路由表，这个条目管理距离为5，并且吓一跳距离为NULL0，NULL0和loopback一样，都是软件模拟出来的接口，不过Loopback在通信过程中会正常响应，而NULL0会将数据直接丢弃不会回复，等于NULL0就是黑洞。</p>
<p>汇总的时候产生的NULL0是为了尽快结束路由查找，因为汇总丢失了明细，所以当出现路由访问的时候，明细路由应该优先形成匹配，如果明细路由没有被匹配上，说明地址不存在，可以直接丢弃。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ip summary-address eigrp 100 172.16.0.0 255.255.0.0</span><br><span class="line">no auto-summary</span><br></pre></td></tr></table></figure>



<h2 id="EIGRP的配置"><a href="#EIGRP的配置" class="headerlink" title="EIGRP的配置"></a>EIGRP的配置</h2><p><img src="http://q5q3e2ctx.bkt.clouddn.com/EIGRP%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE.png" alt="http://q5q3e2ctx.bkt.clouddn.com/EIGRP简单配置.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1(config-if)<span class="comment">#router eigrp 100						</span></span><br><span class="line">R1(config-router)<span class="comment">#network 192.168.12.0 0.0.0.255</span></span><br><span class="line">R1(config-router)<span class="comment">#network 1.1.1.0 0.0.0.255</span></span><br><span class="line"></span><br><span class="line">EIGRP是无类路由，宣告加上通配符掩码可以保留子网掩码</span><br><span class="line">R1(config-router)<span class="comment">#do sh run | sec eigrp </span></span><br><span class="line">router eigrp 100</span><br><span class="line"> network 1.1.1.0 0.0.0.255</span><br><span class="line"> network 192.168.12.0</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bandwidth 9000 <span class="comment">#设置带宽</span></span><br><span class="line">delay 999      <span class="comment">#设置延迟</span></span><br></pre></td></tr></table></figure>



<h2 id="EIGRP的认证"><a href="#EIGRP的认证" class="headerlink" title="EIGRP的认证"></a>EIGRP的认证</h2><p>key-chain配置和RIP一样，剩下的是套在接口上，这里我们配置R3-R4的EIGRP认证</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R3(config-keychain)<span class="comment">#int e0/1</span></span><br><span class="line">R3(config-if)<span class="comment">#ip authentication key-chain eigrp 100 Cisco</span></span><br><span class="line">R3(config-if)<span class="comment">#ip authentication mode eigrp 100 md5</span></span><br></pre></td></tr></table></figure>

<p>把R5任意接口down掉，此时发现，R3<code>ping</code> R4的e0/0接口还是能<code>ping</code>通，我一度以为是认证对EIGRP无效，搞了半天，才发现他们是直连，C。接着R1<code>ping</code>R4就<code>ping</code>不通了。</p>
<h2 id="EIGRP的汇总"><a href="#EIGRP的汇总" class="headerlink" title="EIGRP的汇总"></a>EIGRP的汇总</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int lo1</span><br><span class="line">ip add 172.16.1.1 255.255.255.0</span><br><span class="line">int lo2</span><br><span class="line">ip add 172.16.2.1 255.255.255.0</span><br><span class="line">int lo3</span><br><span class="line">ip add 172.16.3.1 255.255.255.0</span><br><span class="line">router eigrp 100</span><br><span class="line">network 172.16.1.0 0.0.0.255</span><br><span class="line">network 172.16.2.0 0.0.0.255</span><br><span class="line">network 172.16.3.0 0.0.0.255</span><br><span class="line">int e0/0</span><br><span class="line">ip summary-address eigrp 100 172.16.0.0 255.255.0.0</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#EIGRP默认开启自动汇总</span></span><br><span class="line">R5<span class="comment">#show ip route eigrp</span></span><br></pre></td></tr></table></figure>



<p><strong>汇总前：</strong></p>
<pre><code>172.16.0.0/24 is subnetted, 3 subnets
    D        172.16.1.0 [90/409600] via 192.168.15.1, 00:01:13, Ethernet0/0
  D        172.16.2.0 [90/409600] via 192.168.15.1, 00:01:13, Ethernet0/0
  D        172.16.3.0 [90/409600] via 192.168.15.1, 00:01:13, Ethernet0/0</code></pre><p><strong>汇总后：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R2<span class="comment">#show ip route eigrp</span></span><br><span class="line">      172.16.0.0/16 is variably subnetted, 4 subnets, 2 masks</span><br><span class="line">D        172.16.0.0/16 [90/409600] via 192.168.12.1, 00:00:35, Ethernet0/0</span><br><span class="line">D        172.16.1.0/24 [90/486400] via 192.168.23.3, 00:00:35, Ethernet0/1</span><br><span class="line">D        172.16.2.0/24 [90/486400] via 192.168.23.3, 00:00:35, Ethernet0/1</span><br><span class="line">D        172.16.3.0/24 [90/486400] via 192.168.23.3, 00:00:35, Ethernet0/1</span><br></pre></td></tr></table></figure>



<p>会发现，即使是汇总，和R1相邻的路由器上也可以收到明细路由，但是R3等不和R1相邻的路由器上，就只能收到汇总后的路由。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D     172.16.0.0/16 [90/435200] via 192.168.23.2, 00:00:02, Ethernet0/0</span><br></pre></td></tr></table></figure>





<h2 id="EIGRP–FD值"><a href="#EIGRP–FD值" class="headerlink" title="EIGRP–FD值"></a>EIGRP–FD值</h2><p>修改EIGRP的AD值和FD值，可以通过掉接口的带宽和延迟做到。</p>
<p>现在可以看到R1去往34网段负载均衡，我们现在想让R1只从R2走，所以这里调高R1的e0/1接口的带宽和延迟，接口的带宽和延迟可以用<code>show interfaces e0/1</code>查看。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#R1路由表</span></span><br><span class="line">D     192.168.34.0/24 [90/332800] via 192.168.15.5, 00:00:17, Ethernet0/1</span><br><span class="line">                      [90/332800] via 192.168.12.2, 00:00:17, Ethernet0/0</span><br><span class="line"></span><br><span class="line"><span class="comment">#R1拓扑表</span></span><br><span class="line">P 192.168.34.0/24, 2 successors, FD is 332800</span><br><span class="line">        via 192.168.12.2 (332800/307200), Ethernet0/0</span><br><span class="line">        via 192.168.15.5 (332800/307200), Ethernet0/1</span><br></pre></td></tr></table></figure>



<p>调整带宽，如果是在接口下修改，可能会影响多条路径，建议使用偏移列表offset-set。</p>
<p>offset只能增加从某个接口进入或者出去的路由</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1(config-if)<span class="comment">#bandwidth 5000</span></span><br><span class="line"></span><br><span class="line">再看拓扑表：</span><br><span class="line"><span class="comment">#R1</span></span><br><span class="line">P 192.168.34.0/24, 1 successors, FD is 332800</span><br><span class="line">        via 192.168.12.2 (332800/307200), Ethernet0/0</span><br><span class="line">        via 192.168.15.5 (588800/307200), Ethernet0/1</span><br><span class="line"><span class="comment">#R1的路由表中，也只会选择从R2走了</span></span><br><span class="line"></span><br><span class="line">调整时延类似：</span><br><span class="line">R1(config-if)<span class="comment">#delay 10000</span></span><br></pre></td></tr></table></figure>



<p>时延和带宽可以影响FD，影响EIGRP度量值的五个要素：带宽(Bandwidth)、延迟(delay)、可靠性(reliability)、负载(loading)、最大传输单元(MTU)。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">FD=metric = 256 * &#123; 10^7/bw + delaysum / 10 &#125;</span><br></pre></td></tr></table></figure>





<h1 id="ISIS"><a href="#ISIS" class="headerlink" title="ISIS"></a>ISIS</h1><p>ISIS采用了 面向无连接的CLNS协议，但需要保留IP地址做ISIS的Router-ID。其中CLNP地址的写法为：</p>
<blockquote>
<p>49.0001.0000.0000.0001.00</p>
<p>49：是标志地址的作用，这里是私有地址的意思</p>
<p>0001：区域号</p>
<p>0000.0000.0001：设备ID</p>
<p>00：端口号 —NSEL</p>
</blockquote>
<p>简介</p>
<blockquote>
<p>ISIS最早不是给TCP/IP设计的，是给CLNS无连接网络设计的，但是CLNS被淘汰了。ISIS的开发者给ISIS协议加上了TCP/IP的支持模块，将其变为集成的ISIS，但是依旧不如OSPF流行，所以渐渐被人遗忘。</p>
<p>近年来云计算数据中心崛起，数据中心网络日益复杂，而OSPF的区域划分很不自由，并且OSPF是基于IP来进行信息传递的，而数据中心并不是完全的TCP/IP的网络环境，所以OSPF使用受到很大的限制。FC网络不允许浪费传输效率</p>
</blockquote>
<ul>
<li>ISIS在Cisco设备中的管理距离为115</li>
</ul>
<h2 id="ISIS配置"><a href="#ISIS配置" class="headerlink" title="ISIS配置"></a>ISIS配置</h2><p><img src="http://q5q3e2ctx.bkt.clouddn.com/image-20200215102028992.png" alt="http://q5q3e2ctx.bkt.clouddn.com/image-20200215102028992.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">router isis							<span class="comment">#启动协议</span></span><br><span class="line">net 49.0001.0000.0000.0001.00		<span class="comment">#宣告CLNP地址</span></span><br><span class="line">int e0/0,lo0						<span class="comment">#在接口下配置ISIS</span></span><br><span class="line">ip router isis</span><br></pre></td></tr></table></figure>





<h2 id="ISIS邻居"><a href="#ISIS邻居" class="headerlink" title="ISIS邻居"></a>ISIS邻居</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R3<span class="comment">#show isis neighbors </span></span><br><span class="line"></span><br><span class="line">System Id      Type Interface   IP Address      State Holdtime Circuit Id</span><br><span class="line">R1             L1   Et0/0       192.168.123.1   UP    22       R3.01              </span><br><span class="line">R1             L2   Et0/0       192.168.123.1   UP    27       R3.01              </span><br><span class="line">R2             L1   Et0/0       192.168.123.2   UP    22       R3.01              </span><br><span class="line">R2             L2   Et0/0       192.168.123.2   UP    26       R3.01              </span><br><span class="line">R4             L2   Et0/1       192.168.34.4    UP    9        R4.01</span><br></pre></td></tr></table></figure>



<p>ISIS的Hello包正常情况下，10s一次，30s没收到就判定死亡。ISIS有指定路由器的概念，但是ISIS的世界中，路由器不叫路由器，而叫中间系统，所以DR就变成了DIS</p>
<p>DIS的Hello包是3.3s一次，10s没收到就判定DIS死亡，剩下的路由器会重新选举一台路由器作为DIS。</p>
<p>DIS没有备份的概念，谁都可以随时抢占。DIS会优先判定优先级，优先级为0的设备，依旧可以做DIS。</p>
<p>DIS在优先级一样的情况下，会通过比较MAC地址数值大小，越打越优。</p>
<h2 id="ISIS角色"><a href="#ISIS角色" class="headerlink" title="ISIS角色"></a>ISIS角色</h2><ol>
<li><p>Level-1 Router：</p>
<blockquote>
<p> 区域内部路由器，用来在区域内部学习和交换LSP（相当于OSPF的LSA）</p>
<p> L1路由器只能和L1或者L12路由器建立邻居</p>
<p> L1路由器可以知道整个区域的拓扑，但是其他区域连路由都学不到，通过默认路由离开这个区域</p>
</blockquote>
</li>
<li><p>Level-2 Router</p>
<blockquote>
<p>区域间路由器，用来在区域间传递LSP信息</p>
<p>L2路由器只能和L2或者L12路由器建立邻居</p>
<p>L2路由器知道整个AS的区域情况，可以学习到每个区域的路由条目</p>
</blockquote>
</li>
<li><p>Level-1-2 Router</p>
<blockquote>
<p>用来将L1和L2路由器相连，一般是区域边界路由器（相当于OSPF的ABR）</p>
<p>L12路由器可以和L1和L2建立邻居</p>
<p>L12路由器拥有L1和L2所有的能力</p>
<p>默认情况下，路由器启动ISIS后，就是L12路由器</p>
<p>L12路由器会给L1路由器下发一个默认路由</p>
</blockquote>
</li>
</ol>
<p>L1邻居关系</p>
<ul>
<li>同一个区域才可以建立L1邻居关系</li>
</ul>
<p>L2邻居关系</p>
<ul>
<li>不管是不是一个区域，都可以建立L2邻居关系</li>
</ul>
<p>由于ISIS路由器默认是L12路由器，相当于同时开启L1和L2，所以会建立两个邻居关系。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#修改ISIS当前路由器的角色</span></span><br><span class="line">is-type level-1</span><br><span class="line"></span><br><span class="line"><span class="comment">#或者在接口上修改邻居类型</span></span><br><span class="line">isis circuit-type level-1</span><br></pre></td></tr></table></figure>



<p>在ISIS数据库中，1200s倒计时，每900s一次泛洪。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1<span class="comment">#sh isis database level-1</span></span><br><span class="line">IS-IS Level-1 Link State Database:</span><br><span class="line">LSPID                 LSP Seq Num  LSP Checksum  LSP Holdtime      ATT/P/OL</span><br><span class="line">R1.00-00            * 0x00000008   0x1564        785               1/0/0</span><br><span class="line">R2.00-00              0x00000009   0xC590        1062              1/0/0</span><br><span class="line">R3.00-00              0x00000008   0x50F3        1105              1/0/0</span><br><span class="line">R3.01-00              0x00000003   0x734B        740               0/0/0</span><br><span class="line">R4.00-00              0x00000006   0x83FE        75                1/0/0</span><br><span class="line">R4.01-00              0x00000002   0xBA8F        123               0/0/0</span><br><span class="line">R4.02-00              0x00000002   0x9AAF        64                0/0/0</span><br></pre></td></tr></table></figure>



<p>ATT：如果这个被写为1，说明必须产生一条默认路由指向这个路由器</p>
<p>P：如果L2或者L12路由器链断开，可以使用带P置为的LSP数据进行打通</p>
<p>OL：overload，以前的路由器性能不佳，会超载。但是现在OL被利用来作为故障修复，设备升级的时候的故障路标。</p>
<p>我们会发现R3收到了两个LSP，那个<code>R3.00-00</code>是本体，<code>R3.01-00</code>是PSN（伪节点）发来的。</p>
<p><code>show isis database detail</code></p>
<h2 id="ISIS汇总"><a href="#ISIS汇总" class="headerlink" title="ISIS汇总"></a>ISIS汇总</h2><p>路由器汇总只能做在区域边界的L1/L2或者L2路由器上，并且只能汇总自己这个区域的。</p>
<p>R5：添加环回口<code>lo1~lo3</code>，并且添加到isis进行路由汇总</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Loopback1                  172.16.1.1      YES manual up                    up</span><br><span class="line">Loopback2                  172.16.2.1      YES manual up                    up</span><br><span class="line">Loopback3                  172.16.3.1      YES manual up                    up</span><br><span class="line">R5(config-router)<span class="comment">#int range lo1 -3</span></span><br><span class="line">R5(config-if-range)<span class="comment">#ip router isis</span></span><br><span class="line">R5(config-if-range)<span class="comment">#router isis</span></span><br><span class="line">R5(config-router)<span class="comment"># summary-address 172.16.0.0 255.255.0.0</span></span><br></pre></td></tr></table></figure>



<h2 id="ISIS其他"><a href="#ISIS其他" class="headerlink" title="ISIS其他"></a>ISIS其他</h2><p><strong>ISIS度量值</strong>本来是衡量4个数值，但是目前来说，一个也不支持，所以当前的集成ISIS度量值可以理解为跳数，没经过一个入口，路由metric + 10；</p>
<p><strong>ISIS默认路由注入</strong>，<code>default-information originate</code>，这个命令只有在L1/L2或者L2路由器上有效。ISIS的L1/2路由器默认会给L1路由器下发默认路由，通过数据库ATT位置来通知的。可以在L2或者L1/2路由器上配置默认路由器来影响其他L1/2或者L2路由器。默认路由需要在ISIS下宣告。</p>
<h2 id="ISIS命令"><a href="#ISIS命令" class="headerlink" title="ISIS命令"></a>ISIS命令</h2><p><img src="http://q5q3e2ctx.bkt.clouddn.com/image-20200215102028992.png" alt="http://q5q3e2ctx.bkt.clouddn.com/image-20200215102028992.png"></p>
<ol>
<li>R1<code>ping</code>R5</li>
<li>在R5上创建lo1-3：172.16.x.1/24，并且通告金isis，level-2，要求R4学到的是汇总的条目</li>
<li>在R5上下发默认路由，让所有的路由器都可以学习到，并且可以ping同R5没有被宣告的100.1.1.1/24 lo100的地址。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#R1</span></span><br><span class="line">router isis</span><br><span class="line"> net 49.0001.0000.0000.0001.00</span><br><span class="line">interface Loopback0</span><br><span class="line"> ip address 1.1.1.1 255.255.255.0</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/0</span><br><span class="line"> ip address 192.168.123.1 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis  </span><br><span class="line"> </span><br><span class="line"><span class="comment">#R2 </span></span><br><span class="line">router isis</span><br><span class="line">	net 49.0001.0000.0000.0002.00</span><br><span class="line">interface Loopback0</span><br><span class="line"> ip address 2.2.2.2 255.255.255.0</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/0</span><br><span class="line"> ip address 192.168.123.2 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/1</span><br><span class="line"> ip address 192.168.24.2 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis </span><br><span class="line"> </span><br><span class="line"><span class="comment">#R3</span></span><br><span class="line">router isis</span><br><span class="line"> net 49.0001.0000.0000.0003.00</span><br><span class="line">interface Loopback0</span><br><span class="line"> ip address 3.3.3.3 255.255.255.0</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/0</span><br><span class="line"> ip address 192.168.123.3 255.255.255.0</span><br><span class="line"> no shutdown </span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/1</span><br><span class="line"> ip address 192.168.34.3 255.255.255.0</span><br><span class="line"> no shutdown </span><br><span class="line"> ip router isis</span><br><span class="line"> </span><br><span class="line"><span class="comment">#R4</span></span><br><span class="line">router isis</span><br><span class="line"> net 49.00020000.0000.0004.00 </span><br><span class="line">interface Loopback0</span><br><span class="line"> ip address 4.4.4.4 255.255.255.0</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/0</span><br><span class="line"> ip address 192.168.34.4 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/1</span><br><span class="line"> ip address 192.168.24.4 255.255.255.0</span><br><span class="line"> no shutdown </span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/2</span><br><span class="line"> ip address 192.168.45.4 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis</span><br><span class="line"> </span><br><span class="line"><span class="comment">#R5</span></span><br><span class="line">router isis</span><br><span class="line"> net 49.0003.0000.0000.0005.00</span><br><span class="line">interface Loopback0</span><br><span class="line"> ip address 5.5.5.5 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis </span><br><span class="line">interface Ethernet0/0</span><br><span class="line"> ip address 192.168.45.5 255.255.255.0</span><br><span class="line"> no shutdown</span><br><span class="line"> ip router isis </span><br><span class="line"></span><br><span class="line"><span class="comment">#配置完这些R1就可以Ping通R5了</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------------------</span><br><span class="line"><span class="comment">#R5  --- 汇总</span></span><br><span class="line">int lo10</span><br><span class="line">ip add 172.16.1.1 255.255.255.0</span><br><span class="line">ip router isis</span><br><span class="line">int lo20</span><br><span class="line">ip add 172.16.2.1 255.255.255.0</span><br><span class="line">ip router isis</span><br><span class="line">int lo30</span><br><span class="line">ip add 172.16.3.1 255.255.255.0</span><br><span class="line">ip router isis</span><br><span class="line"></span><br><span class="line">router isis </span><br><span class="line">summary-address 172.16.0.0 255.255.0.0</span><br><span class="line"><span class="comment">#配置完这些，R4上就可以看到：</span></span><br><span class="line">i L2  172.16.0.0/16 [115/20] via 192.168.45.5, 00:00:04, Ethernet0/2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------------------</span><br><span class="line"><span class="comment">#R5 --- 默认路由</span></span><br><span class="line">interface Loopback2</span><br><span class="line"> ip address 100.1.1.5 255.255.255.255</span><br><span class="line">router isis</span><br><span class="line">default-information originate</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">show isis database level-1			<span class="comment">#查看链路状态数据库</span></span><br><span class="line">show isis neighbors					<span class="comment">#查看ISIS邻居</span></span><br></pre></td></tr></table></figure>


</div></div><div class="nextinfo"><p>上一篇：<a href="/2020/02/17/Docker%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%9E%84%E5%BB%BAHaProxy/">Docker环境下构建HaProxy</a></p><p>下一篇：<a href="/2020/01/19/%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%BD%91%E7%BB%9C%E5%91%BD%E4%BB%A4/">系统和网络命令</a></p></div><div class="news_pl"><div id="comment_container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script src="/js/md5.min.js"></script>
<script>const gitalk = new Gitalk({
    clientID: 'you github Client ID',
    clientSecret: 'you github Client Secret',
    repo: 'you github repository',
    owner: 'you github repository owner',
    admin: ['you github repository owner'],
    id: md5("2020/02/12/RIP &amp; EIGRP &amp; ISIS/"),      // Ensure uniqueness and length less than 50
    distractionFreeMode: true  // Facebook-like distraction free mode
})
gitalk.render('comment_container')</script></div></div></div></main><aside class="r_box"><div class="card box"><h2>我的名片</h2><div class="box_con"><p>网名：一笑奈何。</p>
<p>职业：全栈软件工程师、Java劝退师</p>
<p>Email：2212585023@qq.com</p>
</div></div><div class="category box"><h2>文章分类</h2><div class="box_con"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%B9%E5%99%A8/">容器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B7%AF%E7%94%B1%E6%8A%80%E6%9C%AF/">路由技术</a><span class="category-list-count">3</span></li></ul></div></div></aside></article><footer><section class="footer_bottom"><div class="footer_container"><p class="copyright">Design by
<a href='http://ymlog.cn' target='_blank'>ZEN</a>
苏ICP备19049121号-1
</p><ul class="social_network"></ul></div></section></footer><div class="cd-top"><i class="iconfont icon-top"></i></div>
<script src="/js/jquery.min.js"></script>
<script src="/js/scrollreveal.js"></script>
<script src="/js/hc-sticky.js"></script>
<script src="/js/canvas-nest.js" type="text/javascript" color="47,135,193" opacity="0.7" zIndex="-2" count="199"></script><script src="https://cdn.bootcss.com/highlight.js/9.15.9/highlight.min.js"></script><script src="https://cdn.bootcss.com/highlight.js/9.15.9/languages/java.min.js"></script><script src="https://cdn.bootcss.com/highlight.js/9.15.9/languages/javascript.min.js"></script><script type="text/javascript">hljs.initHighlightingOnLoad();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="/js/common.js?v=202006161606.js"></script>
<script src="/js/index.js?v=202006161606.js"></script>
</body></html>